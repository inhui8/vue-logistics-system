"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[599],{4287:(e,l,a)=>{a.d(l,{A:()=>W});var t=a(641),o=a(33);const n={class:"upload-container"},i={class:"form-section"},d={class:"form-content"},p={class:"form-section"},s={class:"form-content"},u={class:"form-section"},r={class:"form-content"},m={key:0,class:"form-section"},b={class:"form-content"},c={class:"preview-container"},k={class:"preview-header"},f={class:"preview-title"},v={class:"preview-content"},h=["src"],w={key:1,class:"preview-placeholder"},y={class:"dialog-footer"};function F(e,l,a,F,x,g){const _=(0,t.g2)("el-radio"),T=(0,t.g2)("el-radio-group"),V=(0,t.g2)("el-input"),C=(0,t.g2)("upload-filled"),W=(0,t.g2)("el-icon"),U=(0,t.g2)("el-upload"),P=(0,t.g2)("el-button"),E=(0,t.g2)("document"),R=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(R,{title:"文件上传",modelValue:F.dialogVisible,"onUpdate:modelValue":l[2]||(l[2]=e=>F.dialogVisible=e),width:"600px","close-on-click-modal":!1,onClose:F.handleClose},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",y,[(0,t.bF)(P,{onClick:F.handleClose},{default:(0,t.k6)((()=>l[13]||(l[13]=[(0,t.eW)("取消")]))),_:1},8,["onClick"]),(0,t.bF)(P,{type:"primary",onClick:F.handleSubmit,disabled:!F.isValid,loading:F.uploading},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(F.uploading?"上传中...":"确定"),1)])),_:1},8,["onClick","disabled","loading"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[l[5]||(l[5]=(0,t.Lk)("div",{class:"form-label required"},"文件类型：",-1)),(0,t.Lk)("div",d,[(0,t.bF)(T,{modelValue:F.form.fileType,"onUpdate:modelValue":l[0]||(l[0]=e=>F.form.fileType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(_,{label:"record"},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("留底文件")]))),_:1}),(0,t.bF)(_,{label:"abnormal"},{default:(0,t.k6)((()=>l[4]||(l[4]=[(0,t.eW)("异常文件")]))),_:1})])),_:1},8,["modelValue"])])]),(0,t.Lk)("div",p,[l[6]||(l[6]=(0,t.Lk)("div",{class:"form-label"},"备注：",-1)),(0,t.Lk)("div",s,[(0,t.bF)(V,{modelValue:F.form.remark,"onUpdate:modelValue":l[1]||(l[1]=e=>F.form.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])])]),(0,t.Lk)("div",u,[l[9]||(l[9]=(0,t.Lk)("div",{class:"form-label required"},"上传文件：",-1)),(0,t.Lk)("div",r,[(0,t.bF)(U,{ref:"uploadRef",class:"upload-area",action:"#","auto-upload":!1,"on-change":F.handleFileChange,"on-remove":F.handleFileRemove,"on-preview":F.handleFilePreview,"file-list":F.fileList,limit:5,multiple:"",drag:"",accept:".pdf,.jpg,.jpeg,.png"},{tip:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.Lk)("div",{class:"el-upload__tip"}," 支持 .pdf、.jpg、.jpeg、.png 格式，单个文件不超过 10MB ",-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(W,{class:"el-icon-upload"},{default:(0,t.k6)((()=>[(0,t.bF)(C)])),_:1}),l[8]||(l[8]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))])),_:1},8,["on-change","on-remove","on-preview","file-list"])])]),F.previewVisible?((0,t.uX)(),(0,t.CE)("div",m,[l[12]||(l[12]=(0,t.Lk)("div",{class:"form-label"},"预览：",-1)),(0,t.Lk)("div",b,[(0,t.Lk)("div",c,[(0,t.Lk)("div",k,[(0,t.Lk)("div",f,(0,o.v_)(F.previewFile.name),1),(0,t.bF)(P,{type:"text",onClick:F.closePreview},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("关闭")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",v,[F.isImageFile(F.previewFile)?((0,t.uX)(),(0,t.CE)("img",{key:0,src:F.previewUrl,class:"preview-image"},null,8,h)):((0,t.uX)(),(0,t.CE)("div",w,[(0,t.bF)(E,{class:"preview-icon"}),(0,t.Lk)("div",null,(0,o.v_)(F.previewFile.name),1),(0,t.bF)(P,{type:"primary",size:"small",onClick:F.downloadFile},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("下载查看")]))),_:1},8,["onClick"])]))])])])])):(0,t.Q3)("",!0)])])),_:1},8,["modelValue","onClose"])}var x=a(953),g=a(8548),_=a(163);const T={name:"TrainFileUploadDialog",components:{UploadFilled:g.m8m,Document:g.yoT},props:{visible:{type:Boolean,default:!1},trainId:{type:[String,Number],default:""}},emits:["update:visible","submit","cancel"],setup(e,{emit:l}){const a=(0,t.EW)({get:()=>e.visible,set:e=>l("update:visible",e)}),o=(0,x.KR)(null),n=(0,x.KR)(!1),i=(0,x.KR)({fileType:"record",remark:"",files:[]}),d=(0,x.KR)([]),p=(0,x.KR)(!1),s=(0,x.KR)({}),u=(0,x.KR)(""),r=(0,t.EW)((()=>i.value.fileType&&i.value.files.length>0)),m=e=>{const l=["application/pdf","image/jpeg","image/png","image/jpg"],a=e.raw.type;if(!l.includes(a))return _.nk.error("不支持的文件类型"),!1;const t=10485760;if(e.raw.size>t)return _.nk.error("文件大小不能超过 10MB"),!1;i.value.files.includes(e.raw)||i.value.files.push(e.raw)},b=e=>{const l=i.value.files.findIndex((l=>l===e.raw));l>-1&&i.value.files.splice(l,1)},c=e=>{if(!e||!e.name)return!1;const l=e.name.split(".").pop().toLowerCase();return["jpg","jpeg","png"].includes(l)},k=e=>{s.value=e,c(e)?u.value=URL.createObjectURL(e.raw):u.value="",p.value=!0},f=()=>{p.value=!1,u.value&&(URL.revokeObjectURL(u.value),u.value="")},v=()=>{if(s.value&&s.value.raw){const e=URL.createObjectURL(s.value.raw),l=document.createElement("a");l.href=e,l.download=s.value.name,document.body.appendChild(l),l.click(),setTimeout((()=>{document.body.removeChild(l),URL.revokeObjectURL(e)}),0)}},h=async()=>{if(r.value){n.value=!0;try{const a={trainId:e.trainId,fileTag:i.value.fileType,remark:i.value.remark,files:i.value.files};l("submit",a)}catch(a){console.error("文件上传失败:",a),_.nk.error("文件上传失败")}finally{n.value=!1}}else _.nk.warning("请选择文件类型并上传文件")},w=()=>{u.value&&URL.revokeObjectURL(u.value),i.value={fileType:"record",remark:"",files:[]},d.value=[],p.value=!1,l("cancel"),a.value=!1};return(0,t.wB)((()=>e.visible),(e=>{e&&(i.value={fileType:"record",remark:"",files:[]},d.value=[],p.value=!1)})),{dialogVisible:a,form:i,fileList:d,uploadRef:o,uploading:n,previewVisible:p,previewFile:s,previewUrl:u,isValid:r,handleFileChange:m,handleFileRemove:b,handleFilePreview:k,isImageFile:c,closePreview:f,downloadFile:v,handleSubmit:h,handleClose:w}}};var V=a(6262);const C=(0,V.A)(T,[["render",F],["__scopeId","data-v-1bb54d49"]]),W=C},9650:(e,l,a)=>{a.r(l),a.d(l,{default:()=>L});var t=a(641),o=a(33);const n={class:"train-detail-container"},i={class:"detail-header"},d={class:"header-actions"},p={class:"basic-info-section"},s={class:"pc-detail-section"},u={class:"section-header"},r={class:"section-actions"},m={class:"expense-detail-section"},b={class:"expense-header"},c={class:"expense-actions"},k={class:"expense-summary"},f={class:"total-amount"},v={class:"paid-amount"},h={class:"unpaid-amount"},w={class:"file-upload-section"},y={class:"upload-header"},F={key:1};function x(e,l,a,x,g,_){const T=(0,t.g2)("el-button"),V=(0,t.g2)("el-descriptions-item"),C=(0,t.g2)("el-option"),W=(0,t.g2)("el-select"),U=(0,t.g2)("el-date-picker"),P=(0,t.g2)("el-input"),E=(0,t.g2)("el-tag"),R=(0,t.g2)("el-input-number"),S=(0,t.g2)("el-descriptions"),L=(0,t.g2)("el-tab-pane"),z=(0,t.g2)("el-table-column"),D=(0,t.g2)("el-dropdown-item"),N=(0,t.g2)("el-dropdown-menu"),I=(0,t.g2)("el-dropdown"),A=(0,t.g2)("el-table"),K=(0,t.g2)("el-tabs"),B=(0,t.g2)("expense-detail-dialog"),X=(0,t.g2)("train-file-upload-dialog"),O=(0,t.g2)("upload-pod-dialog"),j=(0,t.g2)("FileUploadWithTagDialog");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",i,[(0,t.bF)(T,{onClick:x.goBack,icon:"el-icon-back"},{default:(0,t.k6)((()=>l[16]||(l[16]=[(0,t.eW)("返回")]))),_:1},8,["onClick"]),l[19]||(l[19]=(0,t.Lk)("div",{class:"header-title"},"运单详情",-1)),(0,t.Lk)("div",d,[(0,t.bF)(T,{type:"primary",onClick:x.handleEdit},{default:(0,t.k6)((()=>l[17]||(l[17]=[(0,t.eW)("编辑")]))),_:1},8,["onClick"]),(0,t.bF)(T,{onClick:x.handleExport},{default:(0,t.k6)((()=>l[18]||(l[18]=[(0,t.eW)("导出")]))),_:1},8,["onClick"])])]),(0,t.bF)(K,{modelValue:x.activeTab,"onUpdate:modelValue":l[11]||(l[11]=e=>x.activeTab=e),class:"detail-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(L,{label:"基本信息",name:"basic"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",p,[l[20]||(l[20]=(0,t.Lk)("h3",{class:"section-title"},"运单基本信息",-1)),(0,t.bF)(S,{column:3,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"车次号"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(x.basicInfo.trainNumber),1)])),_:1}),(0,t.bF)(V,{label:"装车类型"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{modelValue:x.basicInfo.loadingType,"onUpdate:modelValue":l[0]||(l[0]=e=>x.basicInfo.loadingType=e),size:"small",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(C,{label:"卡板",value:"卡板"}),(0,t.bF)(C,{label:"地板",value:"地板"}),(0,t.bF)(C,{label:"混装",value:"混装"}),(0,t.bF)(C,{label:"快递",value:"快递"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"派送类型"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{modelValue:x.basicInfo.deliveryType,"onUpdate:modelValue":l[1]||(l[1]=e=>x.basicInfo.deliveryType=e),size:"small",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(C,{label:"整车",value:"整车"}),(0,t.bF)(C,{label:"散板",value:"散板"}),(0,t.bF)(C,{label:"一提多卸",value:"一提多卸"}),(0,t.bF)(C,{label:"多提一卸",value:"多提一卸"}),(0,t.bF)(C,{label:"多提多卸",value:"多提多卸"}),(0,t.bF)(C,{label:"快递",value:"快递"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"创建时间"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(x.basicInfo.createTime),1)])),_:1}),(0,t.bF)(V,{label:"装车预约时间"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:x.basicInfo.loadingAppointmentTime,"onUpdate:modelValue":l[2]||(l[2]=e=>x.basicInfo.loadingAppointmentTime=e),type:"datetime",size:"small",style:{width:"180px"},placeholder:"选择日期时间"},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"车牌号"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:x.basicInfo.licensePlate,"onUpdate:modelValue":l[3]||(l[3]=e=>x.basicInfo.licensePlate=e),size:"small",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"司机电话"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:x.basicInfo.driverPhone,"onUpdate:modelValue":l[4]||(l[4]=e=>x.basicInfo.driverPhone=e),size:"small",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"司机姓名"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:x.basicInfo.driverName,"onUpdate:modelValue":l[5]||(l[5]=e=>x.basicInfo.driverName=e),size:"small",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"供应商"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{modelValue:x.basicInfo.supplier,"onUpdate:modelValue":l[6]||(l[6]=e=>x.basicInfo.supplier=e),size:"small",style:{width:"150px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.supplierOptions,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(E,{type:x.getStatusTagType(x.basicInfo.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(x.basicInfo.status),1)])),_:1},8,["type"])])),_:1}),(0,t.bF)(V,{label:"板数"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:x.basicInfo.palletCount,"onUpdate:modelValue":l[7]||(l[7]=e=>x.basicInfo.palletCount=e),size:"small",min:0,style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"货物重量"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:x.basicInfo.weight,"onUpdate:modelValue":l[8]||(l[8]=e=>x.basicInfo.weight=e),size:"small",min:0,precision:2,style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"方数(CBM)"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:x.basicInfo.cbm,"onUpdate:modelValue":l[9]||(l[9]=e=>x.basicInfo.cbm=e),size:"small",min:0,precision:2,style:{width:"120px"}},null,8,["modelValue"])])),_:1})])),_:1})])])),_:1}),(0,t.bF)(L,{label:"PC明细",name:"pc"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",s,[(0,t.Lk)("div",u,[l[23]||(l[23]=(0,t.Lk)("h3",{class:"section-title"},"PC明细",-1)),(0,t.Lk)("div",r,[(0,t.bF)(T,{type:"primary",size:"small",onClick:x.handleAddPC},{default:(0,t.k6)((()=>l[21]||(l[21]=[(0,t.eW)("添加PC")]))),_:1},8,["onClick"]),(0,t.bF)(T,{size:"small",onClick:x.handleExportPC},{default:(0,t.k6)((()=>l[22]||(l[22]=[(0,t.eW)("导出PC")]))),_:1},8,["onClick"])])]),(0,t.bF)(A,{data:x.pcDetailData,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{prop:"pcNumber",label:"PC号",width:"120"}),(0,t.bF)(z,{prop:"palletCount",label:"板数",width:"80"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.palletCount,"onUpdate:modelValue":l=>e.row.palletCount=l,size:"small",min:0,style:{width:"80px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"weight",label:"重量",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.weight,"onUpdate:modelValue":l=>e.row.weight=l,size:"small",min:0,precision:2,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"volume",label:"方数",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.volume,"onUpdate:modelValue":l=>e.row.volume=l,size:"small",min:0,precision:2,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"appointmentNumber",label:"预约号",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.appointmentNumber,"onUpdate:modelValue":l=>e.row.appointmentNumber=l,size:"small",style:{width:"120px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"appointmentTime",label:"预约时间",width:"150"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.appointmentTime,"onUpdate:modelValue":l=>e.row.appointmentTime=l,type:"datetime",size:"small",style:{width:"150px"},placeholder:"选择日期时间"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"appointmentParty",label:"预约方",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.appointmentParty,"onUpdate:modelValue":l=>e.row.appointmentParty=l,size:"small",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getPCStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.status),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"remark",label:"备注",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.remark,"onUpdate:modelValue":l=>e.row.remark=l,size:"small",style:{width:"120px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{label:"操作",width:"220",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleViewPC(e.row)},{default:(0,t.k6)((()=>l[24]||(l[24]=[(0,t.eW)("查看")]))),_:2},1032,["onClick"]),(0,t.bF)(I,{size:"small",onCommand:l=>x.handlePCCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(N,null,{default:(0,t.k6)((()=>[(0,t.bF)(D,{command:"uploadPod"},{default:(0,t.k6)((()=>l[26]||(l[26]=[(0,t.eW)("上传POD")]))),_:1}),(0,t.bF)(D,{command:"followUp"},{default:(0,t.k6)((()=>l[27]||(l[27]=[(0,t.eW)("跟进记录")]))),_:1}),(0,t.bF)(D,{command:"memo"},{default:(0,t.k6)((()=>l[28]||(l[28]=[(0,t.eW)("MEMO")]))),_:1}),(0,t.bF)(D,{command:"exception"},{default:(0,t.k6)((()=>l[29]||(l[29]=[(0,t.eW)("标记异常")]))),_:1}),(0,t.bF)(D,{command:"delete"},{default:(0,t.k6)((()=>l[30]||(l[30]=[(0,t.eW)("删除PC")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(T,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[25]||(l[25]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])])),_:1}),(0,t.bF)(L,{label:"费用明细",name:"expense"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",m,[(0,t.Lk)("div",b,[l[34]||(l[34]=(0,t.Lk)("h3",{class:"section-title"},"费用明细",-1)),(0,t.Lk)("div",c,[(0,t.bF)(T,{type:"primary",size:"small",onClick:x.handleAddExpense},{default:(0,t.k6)((()=>l[31]||(l[31]=[(0,t.eW)("添加费用")]))),_:1},8,["onClick"]),(0,t.bF)(T,{type:"success",size:"small",onClick:x.handleBatchPushExpense},{default:(0,t.k6)((()=>l[32]||(l[32]=[(0,t.eW)("批量推送费用")]))),_:1},8,["onClick"]),(0,t.bF)(T,{size:"small",onClick:x.handleExportExpense},{default:(0,t.k6)((()=>l[33]||(l[33]=[(0,t.eW)("导出费用")]))),_:1},8,["onClick"])])]),(0,t.bF)(K,{modelValue:x.expenseActiveTab,"onUpdate:modelValue":l[10]||(l[10]=e=>x.expenseActiveTab=e),type:"card",class:"expense-type-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(L,{label:"全部费用",name:"all"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{data:x.allExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"selection",width:"55"}),(0,t.bF)(z,{prop:"pcNumber",label:"PC号",width:"120"}),(0,t.bF)(z,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getExpenseStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.status),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"fromWarehouse",label:"起始仓库",width:"120"}),(0,t.bF)(z,{prop:"toWarehouse",label:"目的仓库",width:"120"}),(0,t.bF)(z,{prop:"paymentNo",label:"付款申请号",width:"150"}),(0,t.bF)(z,{prop:"supplier",label:"供应商",width:"120"}),(0,t.bF)(z,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"amount",label:"金额",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.amount,"onUpdate:modelValue":l=>e.row.amount=l,size:"small",min:0,precision:2,step:100,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"expenseDate",label:"费用日期",width:"120"}),(0,t.bF)(z,{prop:"operator",label:"操作人",width:"100"}),(0,t.bF)(z,{prop:"operateTime",label:"操作时间",width:"150"}),(0,t.bF)(z,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[35]||(l[35]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(I,{size:"small",onCommand:l=>x.handleExpenseCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(N,null,{default:(0,t.k6)((()=>[(0,t.bF)(D,{command:"push"},{default:(0,t.k6)((()=>l[37]||(l[37]=[(0,t.eW)("推送费用")]))),_:1}),(0,t.bF)(D,{command:"delete"},{default:(0,t.k6)((()=>l[38]||(l[38]=[(0,t.eW)("删除")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(T,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[36]||(l[36]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"派送费",name:"delivery"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{data:x.deliveryExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"selection",width:"55"}),(0,t.bF)(z,{prop:"pcNumber",label:"PC号",width:"120"}),(0,t.bF)(z,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getExpenseStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.status),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"fromWarehouse",label:"起始仓库",width:"120"}),(0,t.bF)(z,{prop:"toWarehouse",label:"目的仓库",width:"120"}),(0,t.bF)(z,{prop:"paymentNo",label:"付款申请号",width:"150"}),(0,t.bF)(z,{prop:"supplier",label:"供应商",width:"120"}),(0,t.bF)(z,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"amount",label:"金额",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.amount,"onUpdate:modelValue":l=>e.row.amount=l,size:"small",min:0,precision:2,step:100,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"expenseDate",label:"费用日期",width:"120"}),(0,t.bF)(z,{prop:"operator",label:"操作人",width:"100"}),(0,t.bF)(z,{prop:"operateTime",label:"操作时间",width:"150"}),(0,t.bF)(z,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[39]||(l[39]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(I,{size:"small",onCommand:l=>x.handleExpenseCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(N,null,{default:(0,t.k6)((()=>[(0,t.bF)(D,{command:"push"},{default:(0,t.k6)((()=>l[41]||(l[41]=[(0,t.eW)("推送费用")]))),_:1}),(0,t.bF)(D,{command:"delete"},{default:(0,t.k6)((()=>l[42]||(l[42]=[(0,t.eW)("删除")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(T,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[40]||(l[40]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"异常费",name:"abnormal"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{data:x.abnormalExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"selection",width:"55"}),(0,t.bF)(z,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(z,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(z,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[43]||(l[43]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[44]||(l[44]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"等时费",name:"waiting"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{data:x.waitingExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"selection",width:"55"}),(0,t.bF)(z,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(z,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(z,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[45]||(l[45]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[46]||(l[46]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"装车费",name:"loading"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{data:x.loadingExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"selection",width:"55"}),(0,t.bF)(z,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(z,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(z,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[47]||(l[47]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[48]||(l[48]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"其他费用",name:"other"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{data:x.otherExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{type:"selection",width:"55"}),(0,t.bF)(z,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(x.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(z,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(z,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(z,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[49]||(l[49]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(T,{type:"text",size:"small",onClick:l=>x.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[50]||(l[50]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Lk)("div",k,[(0,t.bF)(S,{column:3,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"总费用"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",f,(0,o.v_)(x.totalExpense),1)])),_:1}),(0,t.bF)(V,{label:"已支付"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",v,(0,o.v_)(x.paidExpense),1)])),_:1}),(0,t.bF)(V,{label:"未支付"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",h,(0,o.v_)(x.unpaidExpense),1)])),_:1})])),_:1})])])])),_:1}),(0,t.bF)(L,{label:"文件上传",name:"file"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",w,[(0,t.Lk)("div",y,[l[52]||(l[52]=(0,t.Lk)("h3",{class:"section-title"},"文件管理",-1)),(0,t.bF)(T,{type:"primary",onClick:x.showFileUploadDialog},{default:(0,t.k6)((()=>l[51]||(l[51]=[(0,t.eW)("上传文件")]))),_:1},8,["onClick"])]),(0,t.bF)(A,{data:x.fileList,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(z,{prop:"fileName",label:"文件名","min-width":"200"}),(0,t.bF)(z,{prop:"fileType",label:"文件类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:x.getFileTypeTagType(e.row.fileType)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(x.getFileTypeLabel(e.row.fileType)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(z,{prop:"fileSize",label:"文件大小",width:"120"}),(0,t.bF)(z,{prop:"uploadTime",label:"上传时间",width:"180"}),(0,t.bF)(z,{prop:"uploadBy",label:"上传人",width:"120"}),(0,t.bF)(z,{prop:"podStatus",label:"POD审核状态",width:"120"},{default:(0,t.k6)((e=>["pod"===e.row.fileType?((0,t.uX)(),(0,t.Wv)(E,{key:0,type:x.getPodStatusTagType(e.row.podStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(x.getPodStatusLabel(e.row.podStatus)),1)])),_:2},1032,["type"])):((0,t.uX)(),(0,t.CE)("span",F,"-"))])),_:1}),(0,t.bF)(z,{prop:"remark",label:"备注","min-width":"150"}),(0,t.bF)(z,{label:"操作",width:"200",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(I,{size:"small",onCommand:l=>x.handleFileCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(N,null,{default:(0,t.k6)((()=>[(0,t.bF)(D,{command:"preview"},{default:(0,t.k6)((()=>l[54]||(l[54]=[(0,t.eW)("预览")]))),_:1}),(0,t.bF)(D,{command:"download"},{default:(0,t.k6)((()=>l[55]||(l[55]=[(0,t.eW)("下载")]))),_:1}),"pod"===e.row.fileType?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(D,{command:"view"},{default:(0,t.k6)((()=>l[56]||(l[56]=[(0,t.eW)("查看文件")]))),_:1}),"pending"===e.row.podStatus?((0,t.uX)(),(0,t.Wv)(D,{key:0,command:"approve"},{default:(0,t.k6)((()=>l[57]||(l[57]=[(0,t.eW)("审核通过")]))),_:1})):(0,t.Q3)("",!0),"pending"===e.row.podStatus?((0,t.uX)(),(0,t.Wv)(D,{key:1,command:"reject"},{default:(0,t.k6)((()=>l[58]||(l[58]=[(0,t.eW)("审核不通过")]))),_:1})):(0,t.Q3)("",!0)],64)):(0,t.Q3)("",!0),(0,t.bF)(D,{command:"delete"},{default:(0,t.k6)((()=>l[59]||(l[59]=[(0,t.eW)("删除")]))),_:1})])),_:2},1024)])),default:(0,t.k6)((()=>[(0,t.bF)(T,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[53]||(l[53]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(B,{visible:x.expenseDialogVisible,"onUpdate:visible":l[12]||(l[12]=e=>x.expenseDialogVisible=e),"expense-data":x.currentExpense,"expense-type":x.expenseActiveTab,onSubmit:x.handleExpenseSubmit,onCancel:x.handleExpenseCancel},null,8,["visible","expense-data","expense-type","onSubmit","onCancel"]),(0,t.bF)(X,{visible:x.fileUploadDialogVisible,"onUpdate:visible":l[13]||(l[13]=e=>x.fileUploadDialogVisible=e),"train-id":x.basicInfo.id,onSubmit:x.handleFileUploadSubmit,onCancel:x.handleFileUploadCancel},null,8,["visible","train-id","onSubmit","onCancel"]),(0,t.bF)(O,{visible:x.podDialogVisible,"onUpdate:visible":l[14]||(l[14]=e=>x.podDialogVisible=e),"current-pod-row":x.currentPodRow,onSubmit:x.handlePodSubmit,onCancel:x.handlePodCancel},null,8,["visible","current-pod-row","onSubmit","onCancel"]),(0,t.bF)(j,{modelValue:x.fileUploadWithTagVisible,"onUpdate:modelValue":l[15]||(l[15]=e=>x.fileUploadWithTagVisible=e),"current-row":x.currentFileRow,onSubmit:x.handleFileUploadWithTagSubmit,onCancel:x.handleFileUploadWithTagCancel},null,8,["modelValue","current-row","onSubmit","onCancel"])])}var g=a(953),_=a(5220),T=a(163),V=a(7918),C=a(5493),W=a(4287),U=a(616),P=a(3473);const E={name:"TrainDetail",components:{ExpenseDetailDialog:C.A,TrainFileUploadDialog:W.A,UploadPodDialog:U.A,FileUploadWithTagDialog:P.A},setup(){const e=(0,_.rd)(),l=(0,_.lq)(),a=l.params.id,o=(0,g.KR)("basic"),n=(0,g.KR)(!1),i=(0,g.KR)(!1),d=(0,g.KR)(null),p=(0,g.KR)(!1),s=(0,g.KR)(null),u=(0,g.KR)([{id:"1",fileName:"POD_20230715.pdf",fileType:"pod",fileSize:"2.5MB",uploadTime:"2023-07-15 10:30:00",uploadBy:"供应商A",podStatus:"pending",remark:"供应商POD文件"},{id:"2",fileName:"invoice.pdf",fileType:"normal",fileSize:"1.2MB",uploadTime:"2023-07-15 11:00:00",uploadBy:"供应商A",remark:"发票文件"}]),r=(0,g.KR)({id:a,trainNumber:"TRAIN20230715001",loadingType:"整车",deliveryType:"派送",createTime:"2023-07-15 10:00:00",loadingAppointmentTime:"2023-07-15 14:00:00",licensePlate:"粤B12345",driverPhone:"13800138000",driverName:"张三",supplier:"物流供应商A",status:"已登记",palletCount:"20",weight:"5000kg",cbm:"10m³"}),m=(0,g.KR)([{pcNumber:"PC123456",loadingType:"整车",orderType:"普通订单",destination:"深圳市南山区",palletCount:"10",weight:"2500kg",volume:"5m³",appointmentNumber:"APT20230715001",appointmentTime:"2023-07-15 14:00:00",appointmentParty:"客户A",status:"待装车",remark:"无"}]),b=(0,g.KR)("all"),c=(0,g.KR)([{id:"1",pcNumber:"PC123456",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715001",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"基础派送费",amount:"2000.00",expenseDate:"2023-07-15",operator:"张三",operateTime:"2023-07-15 10:30:00",type:"delivery"},{id:"2",pcNumber:"PC123457",status:"已审核",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715002",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"偏远地区附加费",amount:"500.00",expenseDate:"2023-07-15",operator:"李四",operateTime:"2023-07-15 11:20:00",type:"delivery"},{id:"3",pcNumber:"PC123458",status:"已锁单",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715003",supplier:"物流供应商A",expenseType:"exception",expenseRemark:"货物破损赔偿",amount:"800.00",expenseDate:"2023-07-16",operator:"王五",operateTime:"2023-07-16 09:15:00",type:"abnormal"}]),k=(0,g.KR)([{id:"1",pcNumber:"PC123456",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715001",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"基础派送费",amount:"2000.00",expenseDate:"2023-07-15",operator:"张三",operateTime:"2023-07-15 10:30:00"},{id:"2",pcNumber:"PC123457",status:"已审核",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715002",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"偏远地区附加费",amount:"500.00",expenseDate:"2023-07-15",operator:"李四",operateTime:"2023-07-15 11:20:00"}]),f=(0,g.KR)([{id:"3",pcNumber:"PC123458",status:"已锁单",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715003",supplier:"物流供应商A",expenseType:"exception",expenseRemark:"货物破损赔偿",amount:"800.00",expenseDate:"2023-07-16",operator:"王五",operateTime:"2023-07-16 09:15:00"}]),v=(0,g.KR)([{id:"4",pcNumber:"PC123456",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715004",supplier:"物流供应商A",expenseType:"waiting",expenseRemark:"装货等待费",amount:"300.00",expenseDate:"2023-07-16",operator:"赵六",operateTime:"2023-07-16 14:30:00"}]),h=(0,g.KR)([{id:"5",pcNumber:"PC123457",status:"已审核",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715005",supplier:"物流供应商A",expenseType:"loading",expenseRemark:"装车人工费",amount:"600.00",expenseDate:"2023-07-16",operator:"钱七",operateTime:"2023-07-16 16:45:00"}]),w=(0,g.KR)([{id:"6",pcNumber:"PC123458",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715006",supplier:"物流供应商A",expenseType:"other",expenseRemark:"保险费",amount:"200.00",expenseDate:"2023-07-17",operator:"孙八",operateTime:"2023-07-17 09:00:00"}]),y=(0,t.EW)((()=>{const e=[...k.value,...f.value,...v.value,...h.value,...w.value];return e.reduce(((e,l)=>e+Number(l.amount)),0).toFixed(2)})),F=(0,t.EW)((()=>{const e=[...k.value,...f.value,...v.value,...h.value,...w.value];return e.filter((e=>"已支付"===e.paymentStatus)).reduce(((e,l)=>e+Number(l.amount)),0).toFixed(2)})),x=(0,t.EW)((()=>{const e=[...k.value,...f.value,...v.value,...h.value,...w.value];return e.filter((e=>"未支付"===e.paymentStatus)).reduce(((e,l)=>e+Number(l.amount)),0).toFixed(2)})),C=e=>{const l={待登记:"info",已登记:"primary",装车中:"warning",装车完成:"success",已发货:"success",已签收:"success",已取消:"danger"};return l[e]||"info"},W=e=>{const l={待装车:"info",装车中:"warning",已装车:"success",已发货:"success",已签收:"success",异常:"danger"};return l[e]||"info"},U=e=>"abnormal"===e?"danger":"primary",P=e=>"abnormal"===e?"异常文件":"留底文件",E=()=>{e.go(-1)},R=()=>{T.nk.info("编辑运单功能待实现")},S=()=>{T.nk.info("导出运单功能待实现")},L=()=>{T.nk.info("添加PC功能待实现")},z=()=>{T.nk.info("导出PC明细功能待实现")},D=e=>{T.nk.info(`查看PC明细：${e.pcNumber}`)},N=e=>{T.nk.info(`编辑PC明细：${e.pcNumber}`)},I=(e,l)=>{switch(e){case"uploadPod":me(l);break;case"followUp":T.nk.info(`跟进记录：${l.pcNumber}`);break;case"memo":T.nk.info(`MEMO：${l.pcNumber}`);break;case"exception":T.nk.info(`标记异常：${l.pcNumber}`);break;case"delete":V.s.confirm(`确定要删除PC ${l.pcNumber} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{T.nk.success(`已删除PC ${l.pcNumber}`)})).catch((()=>{}));break;default:break}},A=()=>{n.value=!0},K=e=>{const l={id:String(u.value.length+1),fileName:e.files[0].name,fileType:e.fileTag,fileSize:`${(e.files[0].size/1048576).toFixed(1)}MB`,uploadTime:(new Date).toLocaleString(),uploadBy:"当前用户",remark:e.remark||""};u.value.unshift(l),T.nk.success("文件上传成功"),n.value=!1},B=()=>{n.value=!1},X=e=>{T.nk.info(`预览文件：${e.fileName}`)},O=e=>{T.nk.success(`文件 ${e.fileName} 开始下载`)},j=e=>{V.s.confirm(`确定要删除文件 ${e.fileName} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{u.value=u.value.filter((l=>l.id!==e.id)),T.nk.success(`已删除文件 ${e.fileName}`)})).catch((()=>{}))},$=e=>"已支付"===e?"success":"warning",M=()=>{d.value=null,i.value=!0},Y=()=>{T.nk.info("导出费用功能待实现")},Q=e=>{d.value={...e},i.value=!0},q=e=>{V.s.confirm(`确定要删除费用 ${e.expenseType} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const l={delivery:k,abnormal:f,waiting:v,loading:h,other:w},a=l[b.value];if(a){const l=a.value.findIndex((l=>l.id===e.id));-1!==l&&(a.value.splice(l,1),T.nk.success("删除成功"))}})).catch((()=>{}))},H=e=>{const l={delivery:k,abnormal:f,waiting:v,loading:h,other:w},a=l[b.value];if(a){if(d.value){const l=a.value.findIndex((e=>e.id===d.value.id));-1!==l&&(a.value[l]={...d.value,...e})}else{const l={id:String(a.value.length+1),...e};a.value.push(l)}T.nk.success(d.value?"费用更新成功":"费用添加成功")}i.value=!1},G=()=>{i.value=!1},J=e=>{const l={已付款:"success",已审核:"warning",已锁单:"info"};return l[e]||"info"},Z=(e,l)=>{switch(e){case"push":V.s.confirm(`确定要推送费用 ${l.expenseType} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{T.nk.success("费用推送成功")})).catch((()=>{}));break;case"delete":q(l);break}},ee=(0,g.KR)([]),le=e=>{ee.value=e},ae=()=>{0!==ee.value.length?V.s.confirm(`确定要批量推送 ${ee.value.length} 条费用记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{T.nk.success("批量推送成功")})).catch((()=>{})):T.nk.warning("请选择要推送的费用")};(0,t.sV)((()=>{console.log("加载运单详情：",a)}));const te=(0,g.KR)([{value:"delivery",label:"派送费",type:"success"},{value:"loading",label:"装车费",type:"primary"},{value:"waiting",label:"等时费",type:"warning"},{value:"exception",label:"异常费",type:"danger"},{value:"storage",label:"仓储费",type:"warning"},{value:"other",label:"其他费用",type:"info"}]),oe=e=>{const l=te.value.find((l=>l.value===e));return l?l.label:e},ne=e=>{const l=te.value.find((l=>l.value===e));return l?l.type:"info"},ie=e=>{const l={pending:"warning",approved:"success",rejected:"danger"};return l[e]||"info"},de=e=>{const l={pending:"待审核",approved:"已通过",rejected:"已拒绝"};return l[e]||e},pe=(e,l)=>{switch(e){case"preview":X(l);break;case"download":O(l);break;case"view":X(l);break;case"approve":V.s.confirm("确定要通过该POD文件的审核吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.podStatus="approved",T.nk.success("POD审核通过")})).catch((()=>{}));break;case"reject":V.s.confirm("确定要拒绝该POD文件的审核吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.podStatus="rejected",T.nk.success("POD审核已拒绝")})).catch((()=>{}));break;case"delete":j(l);break}},se=(0,g.KR)([{label:"美西一号仓",value:"warehouse1"},{label:"美西二号仓",value:"warehouse2"},{label:"美西三号仓",value:"warehouse3"},{label:"美东一号仓",value:"warehouse4"},{label:"美东二号仓",value:"warehouse5"}]),ue=(0,g.KR)([{label:"洛杉矶",value:"LA"},{label:"旧金山",value:"SF"},{label:"纽约",value:"NY"},{label:"西雅图",value:"SEA"},{label:"芝加哥",value:"CHI"}]),re=(0,g.KR)([{label:"物流供应商A",value:"supplierA"},{label:"物流供应商B",value:"supplierB"},{label:"物流供应商C",value:"supplierC"},{label:"物流供应商D",value:"supplierD"}]),me=e=>{s.value=e,p.value=!0},be=async e=>{try{if(console.log("提交POD数据:",e),s.value){s.value.podStatus="已上传",s.value.podUploadTime=e.receiptTime;const l=u.value.findIndex((e=>e.id===s.value.id));-1!==l&&(u.value[l]={...s.value})}T.nk.success("POD上传成功"),p.value=!1}catch(l){console.error("POD上传失败:",l),T.nk.error("POD上传失败")}},ce=()=>{p.value=!1,s.value=null},ke=(0,g.KR)(!1),fe=(0,g.KR)(null),ve=e=>{fe.value=e,ke.value=!0},he=async e=>{try{if(console.log("提交文件数据:",e),fe.value){fe.value.fileTag=e.fileTag,fe.value.fileRemark=e.remark;const l=u.value.findIndex((e=>e.id===fe.value.id));-1!==l&&(u.value[l]={...fe.value})}T.nk.success("文件上传成功"),ke.value=!1}catch(l){console.error("文件上传失败:",l),T.nk.error("文件上传失败")}},we=()=>{ke.value=!1,fe.value=null};return{activeTab:o,basicInfo:r,pcDetailData:m,fileList:u,fileUploadDialogVisible:n,expenseActiveTab:b,allExpenses:c,deliveryExpenses:k,abnormalExpenses:f,waitingExpenses:v,loadingExpenses:h,otherExpenses:w,totalExpense:y,paidExpense:F,unpaidExpense:x,getStatusTagType:C,getPCStatusTagType:W,getFileTypeTagType:U,getFileTypeLabel:P,goBack:E,handleEdit:R,handleExport:S,handleAddPC:L,handleExportPC:z,handleViewPC:D,handleEditPC:N,handlePCCommand:I,showFileUploadDialog:A,handleFileUploadSubmit:K,handleFileUploadCancel:B,handlePreviewFile:X,handleDownloadFile:O,handleDeleteFile:j,getPaymentStatusTagType:$,handleAddExpense:M,handleExportExpense:Y,handleEditExpense:Q,handleDeleteExpense:q,expenseDialogVisible:i,currentExpense:d,handleExpenseSubmit:H,handleExpenseCancel:G,getExpenseStatusTagType:J,handleExpenseCommand:Z,handleBatchPushExpense:ae,selectedExpenses:ee,handleSelectionChange:le,expenseTypes:te,getExpenseTypeLabel:oe,getExpenseTypeTag:ne,getPodStatusTagType:ie,getPodStatusLabel:de,handleFileCommand:pe,warehouseOptions:se,destinationOptions:ue,supplierOptions:re,podDialogVisible:p,currentPodRow:s,handleUploadPod:me,handlePodSubmit:be,handlePodCancel:ce,fileUploadWithTagVisible:ke,currentFileRow:fe,handleFileUploadWithTag:ve,handleFileUploadWithTagSubmit:he,handleFileUploadWithTagCancel:we}}};var R=a(6262);const S=(0,R.A)(E,[["render",x],["__scopeId","data-v-020be87e"]]),L=S}}]);
//# sourceMappingURL=599.9e0ec81e.js.map