"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[8673],{8673:(e,a,t)=>{t.r(a),t.d(a,{default:()=>W});var l=t(641),r=t(3751),o=t(953),d=t(33),i=t(5220),n=t(8548),s=t(163),u=t(7918);const c={class:"work-order-list-container"},p={class:"page-header"},g={class:"page-actions"},b={class:"search-bar"},k={class:"filter-section"},v={key:0,class:"table-operations"},m={class:"selected-count"},_={class:"subject-cell"},f={class:"subject-text"},w={key:1},h={class:"pagination-container"},y={__name:"ValueAddedWorkOrderList",setup(e){const a=(0,i.rd)(),t=(0,o.KR)([{id:1,name:"张三"},{id:2,name:"李四"},{id:3,name:"客服团队"},{id:7,name:"增值服务组"}]),y=(0,o.KR)(!1),F=(0,o.KR)(""),C=(0,o.Kh)({status:"",type:"value_added",serviceItem:"",priority:"",assignee:null,createdAtRange:[]}),W=(0,o.KR)([{id:"WO202307250002",subject:"请求特殊配送服务",type:"value_added",status:"processing",priority:"medium",serviceItem:"特殊配送",orderNo:"ORD202307250124",creator:"李四",assignee:"增值服务组",createdAt:new Date(Date.now()-792e5),updatedAt:new Date(Date.now()-432e5)},{id:"WO202307250009",subject:"订单礼品包装请求",type:"value_added",status:"pending",priority:"low",serviceItem:"礼品包装",orderNo:"ORD202307250128",creator:"张三",assignee:"",createdAt:new Date(Date.now()-18e6),updatedAt:new Date(Date.now()-18e6)}]),A=(0,o.Kh)({current:1,pageSize:10,total:0}),V=(0,o.KR)([]),z=e=>{if(!e)return"-";const a=new Date(e);return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`},S=e=>{const a={pending:"待处理",processing:"处理中",pending_confirmation:"待确认",resolved:"已解决",closed:"已关闭"};return a[e]||e},I=e=>{const a={pending:"warning",processing:"primary",pending_confirmation:"info",resolved:"success",closed:"info"};return a[e]||"info"},R=e=>{const a={exception:"异常订单处理",command:"指令执行",warning:"订单预警响应",value_added:"增值服务请求",other:"其他问题"};return a[e]||e},D=e=>{const a={urgent:"紧急",high:"高",medium:"中",low:"低"};return a[e]||e},L=e=>{const a={urgent:"danger",high:"warning",medium:"info",low:"success"};return a[e]||"info"},j=e=>["pending","processing"].includes(e.status),K=()=>{A.current=1,T()},X=()=>{C.status="",C.serviceItem="",C.priority="",C.assignee=null,C.createdAtRange=[],F.value="",K()},U=e=>{V.value=e},$=()=>{V.value=[]},N=e=>{A.pageSize=e,T()},O=e=>{A.current=e,T()},E=()=>{a.push({path:"/work-order/create",query:{defaultType:"value_added"}})},Y=e=>{a.push(`/work-order/detail/${e}`)},x=e=>{e&&s.nk.info(`跳转到订单 ${e} 的详情页 (功能待实现)`)},M=e=>{u.s.confirm().then((()=>{a.push(`/work-order/detail/${e.id}`)})).catch((()=>{}))},Q=()=>{},T=async()=>{y.value=!0;try{const e={page:A.current,pageSize:A.pageSize,search:F.value,type:C.type,status:C.status,serviceItem:C.serviceItem,priority:C.priority,assigneeId:C.assignee,createdAtStart:C.createdAtRange?C.createdAtRange[0]:null,createdAtEnd:C.createdAtRange?C.createdAtRange[1]:null};console.log("Fetching Value Added Work Orders with params:",e),setTimeout((()=>{let a=[...W.value];e.search,e.status,e.serviceItem&&(a=a.filter((a=>a.serviceItem&&a.serviceItem.toLowerCase().includes(e.serviceItem.toLowerCase())))),e.priority,e.assigneeId;const t=(e.page-1)*e.pageSize,l=t+e.pageSize,r=a.slice(t,l);W.value=r,A.total=a.length,y.value=!1}),500)}catch(e){console.error("Failed to fetch value added work orders:",e),s.nk.error("获取增值服务工单列表失败"),y.value=!1}};return(0,l.sV)((()=>{T()})),(e,a)=>{const i=(0,l.g2)("el-button"),s=(0,l.g2)("el-input"),u=(0,l.g2)("el-option"),T=(0,l.g2)("el-select"),q=(0,l.g2)("el-form-item"),H=(0,l.g2)("el-date-picker"),P=(0,l.g2)("el-form"),B=(0,l.g2)("el-card"),G=(0,l.g2)("el-table-column"),J=(0,l.g2)("el-link"),Z=(0,l.g2)("el-tag"),ee=(0,l.g2)("el-table"),ae=(0,l.g2)("el-pagination"),te=(0,l.gN)("loading");return(0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",p,[a[9]||(a[9]=(0,l.Lk)("h2",{class:"page-title"},"增值服务工单",-1)),(0,l.Lk)("div",g,[(0,l.bF)(i,{type:"primary",onClick:E},{default:(0,l.k6)((()=>a[8]||(a[8]=[(0,l.eW)("请求增值服务")]))),_:1})])]),(0,l.bF)(B,{shadow:"never",class:"filter-card"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",b,[(0,l.bF)(s,{modelValue:F.value,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value=e),placeholder:"搜索增值服务工单 (工单号、主题、订单号、服务项目...)",class:"search-input",onKeyup:(0,r.jR)(K,["enter"])},{append:(0,l.k6)((()=>[(0,l.bF)(i,{icon:(0,o.R1)(n.vji),onClick:K},null,8,["icon"])])),_:1},8,["modelValue"])]),(0,l.Lk)("div",k,[(0,l.bF)(P,{inline:!0,model:C,size:"small"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{label:"状态"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{modelValue:C.status,"onUpdate:modelValue":a[1]||(a[1]=e=>C.status=e),placeholder:"按状态筛选",clearable:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"待处理",value:"pending"}),(0,l.bF)(u,{label:"处理中",value:"processing"}),(0,l.bF)(u,{label:"待确认",value:"pending_confirmation"}),(0,l.bF)(u,{label:"已解决",value:"resolved"}),(0,l.bF)(u,{label:"已关闭",value:"closed"})])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(q,{label:"服务项目"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:C.serviceItem,"onUpdate:modelValue":a[2]||(a[2]=e=>C.serviceItem=e),placeholder:"按服务项目筛选",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.bF)(q,{label:"优先级"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{modelValue:C.priority,"onUpdate:modelValue":a[3]||(a[3]=e=>C.priority=e),placeholder:"按优先级筛选",clearable:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"紧急",value:"urgent"}),(0,l.bF)(u,{label:"高",value:"high"}),(0,l.bF)(u,{label:"中",value:"medium"}),(0,l.bF)(u,{label:"低",value:"low"})])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(q,{label:"处理人"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{modelValue:C.assignee,"onUpdate:modelValue":a[4]||(a[4]=e=>C.assignee=e),placeholder:"按处理人筛选",clearable:"",filterable:""},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.value,(e=>((0,l.uX)(),(0,l.Wv)(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(q,{label:"创建时间"},{default:(0,l.k6)((()=>[(0,l.bF)(H,{modelValue:C.createdAtRange,"onUpdate:modelValue":a[5]||(a[5]=e=>C.createdAtRange=e),type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","range-separator":"至","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(i,{type:"primary",onClick:K},{default:(0,l.k6)((()=>a[10]||(a[10]=[(0,l.eW)("查询")]))),_:1}),(0,l.bF)(i,{onClick:X},{default:(0,l.k6)((()=>a[11]||(a[11]=[(0,l.eW)("重置")]))),_:1})])),_:1})])),_:1},8,["model"])])])),_:1}),(0,l.bF)(B,{shadow:"never",class:"list-card"},{default:(0,l.k6)((()=>[V.value.length>0?((0,l.uX)(),(0,l.CE)("div",v,[(0,l.Lk)("span",m,"已选择 "+(0,d.v_)(V.value.length)+" 项",1),(0,l.bF)(i,{size:"small",onClick:Q},{default:(0,l.k6)((()=>a[12]||(a[12]=[(0,l.eW)("批量处理")]))),_:1}),(0,l.bF)(i,{size:"small",onClick:$},{default:(0,l.k6)((()=>a[13]||(a[13]=[(0,l.eW)("清除选择")]))),_:1})])):(0,l.Q3)("",!0),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(ee,{data:W.value,onSelectionChange:U,style:{width:"100%"}},{default:(0,l.k6)((()=>[(0,l.bF)(G,{type:"selection",width:"55"}),(0,l.bF)(G,{label:"工单号",prop:"id",width:"150"},{default:(0,l.k6)((e=>[(0,l.bF)(J,{type:"primary",onClick:a=>Y(e.row.id)},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(e.row.id),1)])),_:2},1032,["onClick"])])),_:1}),(0,l.bF)(G,{label:"主题",prop:"subject","min-width":"200"},{default:(0,l.k6)((e=>[(0,l.Lk)("div",_,[(0,l.Lk)("span",f,(0,d.v_)(e.row.subject),1),"urgent"===e.row.priority?((0,l.uX)(),(0,l.Wv)(Z,{key:0,type:"danger",size:"small",effect:"dark"},{default:(0,l.k6)((()=>a[14]||(a[14]=[(0,l.eW)("紧急")]))),_:1})):(0,l.Q3)("",!0)])])),_:1}),(0,l.bF)(G,{label:"类型",prop:"type",width:"120"},{default:(0,l.k6)((e=>[(0,l.eW)((0,d.v_)(R(e.row.type)),1)])),_:1}),(0,l.bF)(G,{label:"服务项目",prop:"serviceItem",width:"150"},{default:(0,l.k6)((e=>[(0,l.eW)((0,d.v_)(e.row.serviceItem||"-"),1)])),_:1}),(0,l.bF)(G,{label:"状态",prop:"status",width:"100"},{default:(0,l.k6)((e=>[(0,l.bF)(Z,{type:I(e.row.status),size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(S(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,l.bF)(G,{label:"优先级",prop:"priority",width:"80"},{default:(0,l.k6)((e=>[(0,l.bF)(Z,{type:L(e.row.priority),size:"small"},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(D(e.row.priority)),1)])),_:2},1032,["type"])])),_:1}),(0,l.bF)(G,{label:"关联订单",prop:"orderNo",width:"150"},{default:(0,l.k6)((e=>[e.row.orderNo?((0,l.uX)(),(0,l.Wv)(J,{key:0,type:"info",onClick:a=>x(e.row.orderNo)},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(e.row.orderNo),1)])),_:2},1032,["onClick"])):((0,l.uX)(),(0,l.CE)("span",w,"-"))])),_:1}),(0,l.bF)(G,{label:"创建人",prop:"creator",width:"100"}),(0,l.bF)(G,{label:"当前处理人",prop:"assignee",width:"100"},{default:(0,l.k6)((e=>[(0,l.eW)((0,d.v_)(e.row.assignee||"未指派"),1)])),_:1}),(0,l.bF)(G,{label:"创建时间",prop:"createdAt",width:"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,d.v_)(z(e.row.createdAt)),1)])),_:1}),(0,l.bF)(G,{label:"更新时间",prop:"updatedAt",width:"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,d.v_)(z(e.row.updatedAt)),1)])),_:1}),(0,l.bF)(G,{label:"操作",width:"150",fixed:"right"},{default:(0,l.k6)((e=>[(0,l.bF)(i,{link:"",type:"primary",onClick:a=>Y(e.row.id)},{default:(0,l.k6)((()=>a[15]||(a[15]=[(0,l.eW)("查看")]))),_:2},1032,["onClick"]),j(e.row)?((0,l.uX)(),(0,l.Wv)(i,{key:0,link:"",type:"primary",onClick:a=>M(e.row)},{default:(0,l.k6)((()=>a[16]||(a[16]=[(0,l.eW)("处理")]))),_:2},1032,["onClick"])):(0,l.Q3)("",!0)])),_:1})])),_:1},8,["data"])),[[te,y.value]]),(0,l.Lk)("div",h,[(0,l.bF)(ae,{"current-page":A.current,"onUpdate:currentPage":a[6]||(a[6]=e=>A.current=e),"page-size":A.pageSize,"onUpdate:pageSize":a[7]||(a[7]=e=>A.pageSize=e),total:A.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:O},null,8,["current-page","page-size","total"])])])),_:1})])}}};var F=t(6262);const C=(0,F.A)(y,[["__scopeId","data-v-c68caee6"]]),W=C}}]);
//# sourceMappingURL=8673.974efad3.js.map