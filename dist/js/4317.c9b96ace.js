"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[4317],{1812:(e,l,a)=>{a.r(l),a.d(l,{default:()=>de});var t=a(641),i=a(3751),o=a(33);const n={class:"delivery-trains-container"},r={class:"filter-bar"},u={class:"filter-row"},s={class:"date-buttons"},d={class:"action-buttons"},p={class:"view-management"},c={class:"table-container"},m={key:0,class:"group-name"},v={key:1},g={key:0,class:"cell-editor"},b=["onClick"],h={key:2},k={class:"tag-cell"},f={class:"view-options-menu"},w={class:"group-settings"},y={class:"group-level"},C={class:"group-level"},V={class:"group-level"},F={class:"dialog-footer"},T={class:"sort-settings"},S={class:"sort-actions"},_={class:"dialog-footer"},P={class:"column-settings"},R={class:"column-settings-header"},W={class:"column-list"},x={class:"column-item"},D={class:"dialog-footer"},L={class:"dialog-footer"},U={class:"follow-up-container"},K={class:"follow-up-history"},A={class:"follow-up-item"},E={class:"follow-up-content"},N={class:"follow-up-operator"},X={class:"dialog-footer"};function z(e,l,a,z,M,I){const O=(0,t.g2)("el-option"),q=(0,t.g2)("el-select"),G=(0,t.g2)("el-date-picker"),B=(0,t.g2)("el-input"),$=(0,t.g2)("el-button"),j=(0,t.g2)("el-dropdown-item"),J=(0,t.g2)("el-dropdown-menu"),H=(0,t.g2)("el-dropdown"),Q=(0,t.g2)("el-radio-button"),Y=(0,t.g2)("el-radio-group"),Z=(0,t.g2)("el-tag"),ee=(0,t.g2)("el-table-column"),le=(0,t.g2)("groupable-table"),ae=(0,t.g2)("filter-panel"),te=(0,t.g2)("el-form-item"),ie=(0,t.g2)("el-checkbox"),oe=(0,t.g2)("el-checkbox-group"),ne=(0,t.g2)("el-form"),re=(0,t.g2)("el-dialog"),ue=(0,t.g2)("d-arrow-left"),se=(0,t.g2)("el-icon"),de=(0,t.g2)("draggable"),pe=(0,t.g2)("expense-detail-dialog"),ce=(0,t.g2)("el-timeline-item"),me=(0,t.g2)("el-timeline"),ve=(0,t.g2)("history-record-dialog"),ge=(0,t.g2)("gps-track-dialog"),be=(0,t.g2)("VehicleAssignmentDialog"),he=(0,t.g2)("UploadPodDialog"),ke=(0,t.g2)("FileUploadWithTagDialog"),fe=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",r,[(0,t.Lk)("div",u,[(0,t.bF)(q,{modelValue:z.warehouse,"onUpdate:modelValue":l[0]||(l[0]=e=>z.warehouse=e),placeholder:"美西二号仓",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"美西二号仓",value:"west2"}),(0,t.bF)(O,{label:"美西一号仓",value:"west1"}),(0,t.bF)(O,{label:"新泽西一号仓",value:"east1"}),(0,t.bF)(O,{label:"萨凡纳二号仓",value:"east2"}),(0,t.bF)(O,{label:"达拉斯三号仓",value:"east3"})])),_:1},8,["modelValue"]),(0,t.bF)(q,{modelValue:z.createDateType,"onUpdate:modelValue":l[1]||(l[1]=e=>z.createDateType=e),placeholder:"ETA",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"ETA",value:"eta"}),(0,t.bF)(O,{label:"提柜时间",value:"issue"}),(0,t.bF)(O,{label:"抵仓时间",value:"appointment"}),(0,t.bF)(O,{label:"预计拆柜时间",value:"expectedUnloading"}),(0,t.bF)(O,{label:"拆柜完成时间",value:"unloading"})])),_:1},8,["modelValue"]),(0,t.Lk)("div",s,[(0,t.bF)(G,{modelValue:z.dateRange,"onUpdate:modelValue":l[2]||(l[2]=e=>z.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small",class:"date-range-picker",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,t.bF)(q,{modelValue:z.searchType,"onUpdate:modelValue":l[3]||(l[3]=e=>z.searchType=e),placeholder:"搜索类型",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"柜号",value:"containerNo"})])),_:1},8,["modelValue"]),(0,t.bF)(B,{placeholder:"请输入",modelValue:z.searchText,"onUpdate:modelValue":l[4]||(l[4]=e=>z.searchText=e),size:"small",class:"search-input","prefix-icon":"el-icon-search"},null,8,["modelValue"]),(0,t.Lk)("div",d,[(0,t.bF)($,{type:"primary",size:"small",onClick:z.handleSearch},{default:(0,t.k6)((()=>l[52]||(l[52]=[(0,t.eW)("查询")]))),_:1},8,["onClick"]),(0,t.bF)(H,{trigger:"click",onCommand:e.handleBatchCommand},{dropdown:(0,t.k6)((()=>[(0,t.bF)(J,null,{default:(0,t.k6)((()=>[(0,t.bF)(j,{command:"extractFees"},{default:(0,t.k6)((()=>l[54]||(l[54]=[(0,t.eW)("批量提取费用")]))),_:1}),(0,t.bF)(j,{command:"memo"},{default:(0,t.k6)((()=>l[55]||(l[55]=[(0,t.eW)("批量Memo")]))),_:1}),(0,t.bF)(j,{command:"followUp"},{default:(0,t.k6)((()=>l[56]||(l[56]=[(0,t.eW)("批量跟进记录")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)($,{type:"warning",size:"small"},{default:(0,t.k6)((()=>l[53]||(l[53]=[(0,t.eW)(" 批量操作"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:1},8,["onCommand"]),(0,t.bF)($,{size:"small"},{default:(0,t.k6)((()=>l[57]||(l[57]=[(0,t.eW)("导出列表")]))),_:1}),(0,t.bF)($,{size:"small"},{default:(0,t.k6)((()=>l[58]||(l[58]=[(0,t.eW)("导出")]))),_:1})])])]),(0,t.Lk)("div",p,[l[72]||(l[72]=(0,t.Lk)("span",{class:"view-label"},null,-1)),(0,t.bF)(Y,{modelValue:z.currentView,"onUpdate:modelValue":l[5]||(l[5]=e=>z.currentView=e),size:"small",class:"status-view-group"},{default:(0,t.k6)((()=>[(0,t.bF)(Q,{value:"all"},{default:(0,t.k6)((()=>l[59]||(l[59]=[(0,t.eW)("全部(21794)")]))),_:1}),(0,t.bF)(Q,{value:"waitRegister"},{default:(0,t.k6)((()=>l[60]||(l[60]=[(0,t.eW)("已卸船(107)")]))),_:1}),(0,t.bF)(Q,{value:"registered"},{default:(0,t.k6)((()=>l[61]||(l[61]=[(0,t.eW)("已可提(152)")]))),_:1}),(0,t.bF)(Q,{value:"loading"},{default:(0,t.k6)((()=>l[62]||(l[62]=[(0,t.eW)("已做约(0)")]))),_:1}),(0,t.bF)(Q,{value:"loaded"},{default:(0,t.k6)((()=>l[63]||(l[63]=[(0,t.eW)("已提柜(3)")]))),_:1}),(0,t.bF)(Q,{value:"shipped"},{default:(0,t.k6)((()=>l[64]||(l[64]=[(0,t.eW)("已到仓(1585)")]))),_:1}),(0,t.bF)(Q,{value:"delivered"},{default:(0,t.k6)((()=>l[65]||(l[65]=[(0,t.eW)("拆柜中(16351)")]))),_:1}),(0,t.bF)(Q,{value:"pod"},{default:(0,t.k6)((()=>l[66]||(l[66]=[(0,t.eW)("已提空(3585)")]))),_:1}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.customViews,(e=>((0,t.uX)(),(0,t.Wv)(Q,{key:e.id,label:e.id,onContextmenu:(0,i.D$)((l=>z.handleContextMenu(l,e)),["prevent"])},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.name),1)])),_:2},1032,["label","onContextmenu"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)($,{type:"text",size:"small",onClick:z.handleSaveView},{default:(0,t.k6)((()=>l[67]||(l[67]=[(0,t.eW)("新增视图")]))),_:1},8,["onClick"]),(0,t.bF)($,{type:"text",size:"small",onClick:z.showGroupModal},{default:(0,t.k6)((()=>l[68]||(l[68]=[(0,t.eW)("高级分组")]))),_:1},8,["onClick"]),(0,t.bF)($,{type:"text",size:"small",onClick:z.showSortModal},{default:(0,t.k6)((()=>l[69]||(l[69]=[(0,t.eW)("高级排序")]))),_:1},8,["onClick"]),(0,t.bF)($,{type:"text",size:"small",onClick:z.showFilterPanel},{default:(0,t.k6)((()=>l[70]||(l[70]=[(0,t.eW)("筛选")]))),_:1},8,["onClick"]),(0,t.bF)($,{type:"text",size:"small",onClick:z.showColumnSettings},{default:(0,t.k6)((()=>l[71]||(l[71]=[(0,t.eW)("字段配置")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",c,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(le,{ref:"mainTable",data:z.displayData,"row-key":"id","group-fields":z.groupField?[z.groupField]:[],"show-selection":!0,"show-group-column":!!z.groupField,"group-column-label":z.groupField?z.getGroupColumnLabel(z.groupField):"分组","default-expand-all":!1,"show-pagination":!0,"current-page":z.currentPage,"page-size":z.pageSize,"page-sizes":[10,20,50,100],total:z.total,onSelectionChange:z.handleSelectionChange,onSizeChange:z.handleSizeChange,onCurrentChange:z.handleCurrentChange,onCellClick:z.handleCellClick,onCellDblclick:z.handleCellDbClick,style:{width:"100%"}},{default:(0,t.k6)((()=>[z.hasGroupedData?((0,t.uX)(),(0,t.Wv)(ee,{key:0,label:"分组信息",width:"200"},{default:(0,t.k6)((e=>[e.row.isGroup?((0,t.uX)(),(0,t.CE)("span",m,[(0,t.bF)(Z,{type:z.getGroupTagType(e.row.groupLevel)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.groupName)+" ("+(0,o.v_)(e.row.count||0)+") ",1)])),_:2},1032,["type"])])):((0,t.uX)(),(0,t.CE)("span",v,"-"))])),_:1})):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.tableColumns,(e=>((0,t.uX)(),(0,t.CE)(t.FK,{key:e.prop},[!1!==e.visible&&"orderStatus"===e.prop?((0,t.uX)(),(0,t.Wv)(ee,{key:0,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,t.k6)((e=>[(0,t.bF)(Z,{type:z.getStatusTagType(e.row.orderStatus),effect:"plain",size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.orderStatus),1)])),_:2},1032,["type"])])),_:2},1032,["prop","label","width","sortable"])):!1!==e.visible&&"operation"===e.prop?((0,t.uX)(),(0,t.Wv)(ee,{key:1,label:e.label,width:e.width,fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)($,{type:"text",size:"small",onClick:l=>z.handleDetail(e.row)},{default:(0,t.k6)((()=>l[73]||(l[73]=[(0,t.eW)("详情")]))),_:2},1032,["onClick"]),(0,t.bF)(H,{size:"small",onCommand:l=>z.handleCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(J,null,{default:(0,t.k6)((()=>[(0,t.bF)(j,{command:"vehicleAssignment"},{default:(0,t.k6)((()=>l[75]||(l[75]=[(0,t.eW)("车辆分配")]))),_:1}),(0,t.bF)(j,{command:"memo"},{default:(0,t.k6)((()=>l[76]||(l[76]=[(0,t.eW)("Memo")]))),_:1}),(0,t.bF)(j,{command:"followUp"},{default:(0,t.k6)((()=>l[77]||(l[77]=[(0,t.eW)("跟进记录")]))),_:1}),(0,t.bF)(j,{command:"history"},{default:(0,t.k6)((()=>l[78]||(l[78]=[(0,t.eW)("历史记录")]))),_:1}),(0,t.bF)(j,{command:"podUpload"},{default:(0,t.k6)((()=>l[79]||(l[79]=[(0,t.eW)("POD上传")]))),_:1}),(0,t.bF)(j,{command:"expenseDetail"},{default:(0,t.k6)((()=>l[80]||(l[80]=[(0,t.eW)("费用明细")]))),_:1}),(0,t.bF)(j,{command:"expensePull"},{default:(0,t.k6)((()=>l[81]||(l[81]=[(0,t.eW)("费用拉取")]))),_:1}),(0,t.bF)(j,{command:"gpsTrack"},{default:(0,t.k6)((()=>l[82]||(l[82]=[(0,t.eW)("GPS轨迹")]))),_:1}),(0,t.bF)(j,{command:"markException"},{default:(0,t.k6)((()=>l[83]||(l[83]=[(0,t.eW)("标记异常")]))),_:1}),(0,t.bF)(j,{command:"fileUploadWithTag"},{default:(0,t.k6)((()=>l[84]||(l[84]=[(0,t.eW)("文件上传")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)($,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[74]||(l[74]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:2},1032,["label","width"])):!1!==e.visible?((0,t.uX)(),(0,t.Wv)(ee,{key:2,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,t.k6)((a=>[z.isEditableField(e.prop)&&z.editingCell.rowIndex===a.$index&&z.editingCell.prop===e.prop?((0,t.uX)(),(0,t.CE)("div",g,["datetime"===z.getEditControlType(e.prop)?((0,t.uX)(),(0,t.Wv)(G,{key:0,modelValue:z.editingCell.value,"onUpdate:modelValue":l[6]||(l[6]=e=>z.editingCell.value=e),type:"datetime",size:"small",onBlur:l=>z.saveEdit(a.row,e.prop),onKeyup:(0,i.jR)((l=>z.saveEdit(a.row,e.prop)),["enter"]),style:{width:"100%"}},null,8,["modelValue","onBlur","onKeyup"])):"select"===z.getEditControlType(e.prop)?((0,t.uX)(),(0,t.Wv)(q,{key:1,modelValue:z.editingCell.value,"onUpdate:modelValue":l[7]||(l[7]=e=>z.editingCell.value=e),size:"small",onBlur:l=>z.saveEdit(a.row,e.prop),onKeyup:(0,i.jR)((l=>z.saveEdit(a.row,e.prop)),["enter"]),style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.getEditControlOptions(e.prop),(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onBlur","onKeyup"])):((0,t.uX)(),(0,t.Wv)(B,{key:2,modelValue:z.editingCell.value,"onUpdate:modelValue":l[8]||(l[8]=e=>z.editingCell.value=e),size:"small",onBlur:l=>z.saveEdit(a.row,e.prop),onKeyup:(0,i.jR)((l=>z.saveEdit(a.row,e.prop)),["enter"])},null,8,["modelValue","onBlur","onKeyup"]))])):z.isEditableField(e.prop)?((0,t.uX)(),(0,t.CE)("div",{key:1,class:"editable-cell",onClick:l=>z.handleCellClick(a.row,e,a.$el)},(0,o.v_)(a.row[e.prop]||"-"),9,b)):((0,t.uX)(),(0,t.CE)("span",h,(0,o.v_)(a.row[e.prop]||"-"),1))])),_:2},1032,["prop","label","width","sortable"])):(0,t.Q3)("",!0)],64)))),128)),(0,t.bF)(ee,{prop:"tags",label:"标签",width:"200"},{default:(0,t.k6)((e=>[(0,t.Lk)("div",k,[Array.isArray(e.row.tags)&&e.row.tags.length?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)(e.row.tags,(l=>((0,t.uX)(),(0,t.Wv)(Z,{key:l,type:z.getTagType(l),closable:"",onClose:a=>z.handleTagClose(e.row,"tags",l)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(l),1)])),_:2},1032,["type","onClose"])))),128)):"string"===typeof e.row.tags&&e.row.tags?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:1},(0,t.pI)(e.row.tags.split(","),(l=>((0,t.uX)(),(0,t.Wv)(Z,{key:l,type:z.getTagType(l),closable:"",onClose:a=>z.handleTagClose(e.row,"tags",l)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(l.trim()),1)])),_:2},1032,["type","onClose"])))),128)):((0,t.uX)(),(0,t.Wv)(Z,{key:2,type:"info"},{default:(0,t.k6)((()=>l[85]||(l[85]=[(0,t.eW)("未设置")]))),_:1}))])])),_:1})])),_:1},8,["data","group-fields","show-group-column","group-column-label","current-page","page-size","total","onSelectionChange","onSizeChange","onCurrentChange","onCellClick","onCellDblclick"])),[[fe,z.loading]])]),(0,t.bF)(ae,{visible:z.filterPanelVisible,"onUpdate:visible":l[9]||(l[9]=e=>z.filterPanelVisible=e),columns:z.tableColumns,"existing-filters":z.activeFilters,"existing-logic":z.filterLogic,onApplyFilters:z.applyFilters,onCancel:z.cancelFilters},null,8,["visible","columns","existing-filters","existing-logic","onApplyFilters","onCancel"]),(0,t.bF)(re,{title:"保存视图",modelValue:z.saveViewDialogVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>z.saveViewDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)($,{onClick:l[12]||(l[12]=e=>z.saveViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[86]||(l[86]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"primary",onClick:z.saveView},{default:(0,t.k6)((()=>l[87]||(l[87]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:z.viewForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(te,{label:"视图名称",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(B,{modelValue:z.viewForm.name,"onUpdate:modelValue":l[10]||(l[10]=e=>z.viewForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(te,{label:"显示字段"},{default:(0,t.k6)((()=>[(0,t.bF)(oe,{modelValue:z.viewForm.columns,"onUpdate:modelValue":l[11]||(l[11]=e=>z.viewForm.columns=e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.tableColumns,(e=>((0,t.uX)(),(0,t.Wv)(ie,{key:e.prop,label:e.prop},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(re,{title:"视图操作",modelValue:z.viewOptionsDialogVisible,"onUpdate:modelValue":l[17]||(l[17]=e=>z.viewOptionsDialogVisible=e),width:"300px"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",f,[(0,t.Lk)("div",{class:"view-option-item",onClick:l[14]||(l[14]=(...e)=>z.handleRenameView&&z.handleRenameView(...e))},l[88]||(l[88]=[(0,t.Lk)("i",{class:"el-icon-edit"},null,-1),(0,t.Lk)("span",null,"重命名视图",-1)])),(0,t.Lk)("div",{class:"view-option-item",onClick:l[15]||(l[15]=(...e)=>z.handleCopyView&&z.handleCopyView(...e))},l[89]||(l[89]=[(0,t.Lk)("i",{class:"el-icon-document-copy"},null,-1),(0,t.Lk)("span",null,"复制视图",-1)])),(0,t.Lk)("div",{class:"view-option-item",onClick:l[16]||(l[16]=(...e)=>z.handleDeleteView&&z.handleDeleteView(...e))},l[90]||(l[90]=[(0,t.Lk)("i",{class:"el-icon-delete"},null,-1),(0,t.Lk)("span",null,"删除视图",-1)]))])])),_:1},8,["modelValue"]),(0,t.bF)(re,{title:"重命名视图",modelValue:z.renameViewDialogVisible,"onUpdate:modelValue":l[20]||(l[20]=e=>z.renameViewDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)($,{onClick:l[19]||(l[19]=e=>z.renameViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[91]||(l[91]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"primary",onClick:z.saveRenameView},{default:(0,t.k6)((()=>l[92]||(l[92]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:z.renameForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(te,{label:"视图名称",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(B,{modelValue:z.renameForm.name,"onUpdate:modelValue":l[18]||(l[18]=e=>z.renameForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(re,{title:"编辑信息",modelValue:z.editDialogVisible,"onUpdate:modelValue":l[24]||(l[24]=e=>z.editDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)($,{onClick:l[23]||(l[23]=e=>z.editDialogVisible=!1)},{default:(0,t.k6)((()=>l[93]||(l[93]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"primary",onClick:z.saveDialogEdit},{default:(0,t.k6)((()=>l[94]||(l[94]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:z.editingForm,"label-width":"120px"},{default:(0,t.k6)((()=>[z.editingColumn.prop?((0,t.uX)(),(0,t.Wv)(te,{key:0,label:z.editingColumn.label},{default:(0,t.k6)((()=>[["loadingType","deliveryType","loader","dockNumber","driverLicense","licensePlate","driverPhone","supplier"].includes(z.editingColumn.prop)?((0,t.uX)(),(0,t.Wv)(q,{key:0,modelValue:z.editingForm.value,"onUpdate:modelValue":l[21]||(l[21]=e=>z.editingForm.value=e),style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.getOptionsForColumn(z.editingColumn.prop),(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):((0,t.uX)(),(0,t.Wv)(B,{key:1,modelValue:z.editingForm.value,"onUpdate:modelValue":l[22]||(l[22]=e=>z.editingForm.value=e),type:["actualPallets","palletsMerged","deliveryCost"].includes(z.editingColumn.prop)?"number":"text"},null,8,["modelValue","type"]))])),_:1},8,["label"])):(0,t.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bo)((0,t.Lk)("div",{class:"context-menu",style:(0,o.Tr)({left:z.contextMenuX+"px",top:z.contextMenuY+"px"})},[(0,t.Lk)("div",{class:"context-menu-item",onClick:l[25]||(l[25]=(...e)=>z.handleCopyView&&z.handleCopyView(...e))},l[95]||(l[95]=[(0,t.Lk)("span",null,"复制视图",-1)])),(0,t.Lk)("div",{class:"context-menu-item",onClick:l[26]||(l[26]=(...e)=>z.handleRenameView&&z.handleRenameView(...e))},l[96]||(l[96]=[(0,t.Lk)("span",null,"重命名",-1)])),(0,t.Lk)("div",{class:"context-menu-item",onClick:l[27]||(l[27]=(...e)=>z.handleDeleteView&&z.handleDeleteView(...e))},l[97]||(l[97]=[(0,t.Lk)("span",null,"删除",-1)]))],4),[[i.aG,z.contextMenuVisible]]),(0,t.bF)(re,{title:"分组设置",modelValue:z.groupModalVisible,"onUpdate:modelValue":l[32]||(l[32]=e=>z.groupModalVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",F,[(0,t.bF)($,{onClick:l[31]||(l[31]=e=>z.groupModalVisible=!1)},{default:(0,t.k6)((()=>l[101]||(l[101]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"danger",onClick:z.clearGroupSettings},{default:(0,t.k6)((()=>l[102]||(l[102]=[(0,t.eW)("清除分组")]))),_:1},8,["onClick"]),(0,t.bF)($,{type:"primary",onClick:z.applyGroupSettings},{default:(0,t.k6)((()=>l[103]||(l[103]=[(0,t.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",w,[(0,t.Lk)("div",y,[l[98]||(l[98]=(0,t.Lk)("span",{class:"group-level-label"},"一级分组：",-1)),(0,t.bF)(q,{modelValue:z.groupSettings.level1,"onUpdate:modelValue":l[28]||(l[28]=e=>z.groupSettings.level1=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t.Lk)("div",C,[l[99]||(l[99]=(0,t.Lk)("span",{class:"group-level-label"},"二级分组：",-1)),(0,t.bF)(q,{modelValue:z.groupSettings.level2,"onUpdate:modelValue":l[29]||(l[29]=e=>z.groupSettings.level2=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t.Lk)("div",V,[l[100]||(l[100]=(0,t.Lk)("span",{class:"group-level-label"},"三级分组：",-1)),(0,t.bF)(q,{modelValue:z.groupSettings.level3,"onUpdate:modelValue":l[30]||(l[30]=e=>z.groupSettings.level3=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue"]),(0,t.bF)(re,{title:"排序设置",modelValue:z.sortModalVisible,"onUpdate:modelValue":l[34]||(l[34]=e=>z.sortModalVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",_,[(0,t.bF)($,{onClick:l[33]||(l[33]=e=>z.sortModalVisible=!1)},{default:(0,t.k6)((()=>l[106]||(l[106]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"danger",onClick:z.clearSortSettings},{default:(0,t.k6)((()=>l[107]||(l[107]=[(0,t.eW)("清除排序")]))),_:1},8,["onClick"]),(0,t.bF)($,{type:"primary",onClick:z.applySortSettings},{default:(0,t.k6)((()=>l[108]||(l[108]=[(0,t.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",T,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.sortSettings,((e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"sort-item"},[(0,t.bF)(q,{modelValue:e.field,"onUpdate:modelValue":l=>e.field=l,placeholder:"选择字段",style:{width:"200px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.sortableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(q,{modelValue:e.direction,"onUpdate:modelValue":l=>e.direction=l,placeholder:"排序方向",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"升序",value:"asc"}),(0,t.bF)(O,{label:"降序",value:"desc"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)($,{type:"danger",size:"small",onClick:e=>z.removeSortField(a)},{default:(0,t.k6)((()=>l[104]||(l[104]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])))),128)),(0,t.Lk)("div",S,[(0,t.bF)($,{type:"primary",plain:"",onClick:z.addSortField},{default:(0,t.k6)((()=>l[105]||(l[105]=[(0,t.eW)("添加排序字段")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),(0,t.bF)(re,{title:"字段配置",modelValue:z.columnSettingsVisible,"onUpdate:modelValue":l[38]||(l[38]=e=>z.columnSettingsVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",D,[(0,t.bF)($,{onClick:l[37]||(l[37]=e=>z.columnSettingsVisible=!1)},{default:(0,t.k6)((()=>l[111]||(l[111]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"primary",onClick:z.applyColumnSettings},{default:(0,t.k6)((()=>l[112]||(l[112]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",P,[(0,t.Lk)("div",R,[(0,t.bF)(ie,{modelValue:z.allColumnsSelected,"onUpdate:modelValue":l[35]||(l[35]=e=>z.allColumnsSelected=e),onChange:z.handleSelectAllColumns},{default:(0,t.k6)((()=>l[109]||(l[109]=[(0,t.eW)("全选")]))),_:1},8,["modelValue","onChange"]),(0,t.bF)($,{type:"primary",size:"small",onClick:z.resetColumnSettings},{default:(0,t.k6)((()=>l[110]||(l[110]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",W,[(0,t.bF)(de,{modelValue:z.columnSettingsList,"onUpdate:modelValue":l[36]||(l[36]=e=>z.columnSettingsList=e),"item-key":"prop",handle:".drag-handle",onEnd:z.handleDragEnd},{item:(0,t.k6)((({element:e})=>[(0,t.Lk)("div",x,[(0,t.bF)(se,{class:"drag-handle"},{default:(0,t.k6)((()=>[(0,t.bF)(ue)])),_:1}),(0,t.bF)(ie,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:1},8,["modelValue","onEnd"])])])])),_:1},8,["modelValue"]),(0,t.bF)(pe,{visible:z.expenseDialogVisible,"onUpdate:visible":l[39]||(l[39]=e=>z.expenseDialogVisible=e),"train-data":z.currentTrainData,onExpensePushed:z.handleExpensePushed,onPushCancelled:z.handlePushCancelled},null,8,["visible","train-data","onExpensePushed","onPushCancelled"]),(0,t.bF)(re,{title:"MEMO",modelValue:z.memoDialogVisible,"onUpdate:modelValue":l[42]||(l[42]=e=>z.memoDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",L,[(0,t.bF)($,{onClick:l[41]||(l[41]=e=>z.memoDialogVisible=!1)},{default:(0,t.k6)((()=>l[113]||(l[113]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"primary",onClick:z.saveMemo},{default:(0,t.k6)((()=>l[114]||(l[114]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:z.memoForm,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(te,{label:"备注"},{default:(0,t.k6)((()=>[(0,t.bF)(B,{modelValue:z.memoForm.memo,"onUpdate:modelValue":l[40]||(l[40]=e=>z.memoForm.memo=e),type:"textarea",rows:4,placeholder:"请输入备注信息"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(re,{title:"跟进记录",modelValue:z.followUpDialogVisible,"onUpdate:modelValue":l[46]||(l[46]=e=>z.followUpDialogVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",X,[(0,t.bF)($,{onClick:l[45]||(l[45]=e=>z.followUpDialogVisible=!1)},{default:(0,t.k6)((()=>l[116]||(l[116]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)($,{type:"primary",onClick:z.saveFollowUp},{default:(0,t.k6)((()=>l[117]||(l[117]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",U,[(0,t.Lk)("div",K,[l[115]||(l[115]=(0,t.Lk)("h4",null,"历史记录",-1)),(0,t.bF)(me,null,{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(z.followUpHistory,((e,l)=>((0,t.uX)(),(0,t.Wv)(ce,{key:l,timestamp:e.time,type:e.type},{default:(0,t.k6)((()=>[(0,t.Lk)("div",A,[(0,t.Lk)("div",E,(0,o.v_)(e.content),1),(0,t.Lk)("div",N,"操作人："+(0,o.v_)(e.operator),1)])])),_:2},1032,["timestamp","type"])))),128))])),_:1})]),(0,t.bF)(ne,{model:z.followUpForm,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(te,{label:"跟进内容"},{default:(0,t.k6)((()=>[(0,t.bF)(B,{modelValue:z.followUpForm.content,"onUpdate:modelValue":l[43]||(l[43]=e=>z.followUpForm.content=e),type:"textarea",rows:4,placeholder:"请输入跟进内容"},null,8,["modelValue"])])),_:1}),(0,t.bF)(te,{label:"跟进类型"},{default:(0,t.k6)((()=>[(0,t.bF)(q,{modelValue:z.followUpForm.type,"onUpdate:modelValue":l[44]||(l[44]=e=>z.followUpForm.type=e),placeholder:"请选择跟进类型",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"常规跟进",value:"primary"}),(0,t.bF)(O,{label:"重要跟进",value:"warning"}),(0,t.bF)(O,{label:"紧急跟进",value:"danger"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),(0,t.bF)(ve,{visible:z.historyDialogVisible,"onUpdate:visible":l[47]||(l[47]=e=>z.historyDialogVisible=e),"train-data":z.currentTrainData},null,8,["visible","train-data"]),(0,t.bF)(ge,{visible:z.gpsTrackDialogVisible,"onUpdate:visible":l[48]||(l[48]=e=>z.gpsTrackDialogVisible=e),"train-data":z.currentGpsTrainData},null,8,["visible","train-data"]),(0,t.bF)(be,{modelValue:z.vehicleAssignmentVisible,"onUpdate:modelValue":l[49]||(l[49]=e=>z.vehicleAssignmentVisible=e),onAssign:z.handleVehicleAssign,onCancelAssign:z.handleVehicleCancelAssign},null,8,["modelValue","onAssign","onCancelAssign"]),(0,t.bF)(he,{modelValue:z.podDialogVisible,"onUpdate:modelValue":l[50]||(l[50]=e=>z.podDialogVisible=e),"current-pod-row":z.currentPodRow,onSubmit:z.handlePodSubmit,onCancel:z.handlePodCancel},null,8,["modelValue","current-pod-row","onSubmit","onCancel"]),(0,t.bF)(ke,{modelValue:z.fileUploadWithTagVisible,"onUpdate:modelValue":l[51]||(l[51]=e=>z.fileUploadWithTagVisible=e),"current-row":z.currentFileRow,onSubmit:z.handleFileUploadWithTagSubmit,onCancel:z.handleFileUploadWithTagCancel},null,8,["modelValue","current-row","onSubmit","onCancel"])])}var M=a(953),I=a(163),O=a(7918),q=a(3344),G=a(2998),B=a(5493),$=a(1018),j=a(6629),J=a(2895),H=a(616),Q=a(3473);const Y=JSON.parse('[{"prop":"orderNumber","label":"订单号","width":"150","sortable":true},{"prop":"orderStatus","label":"订单状态","width":"120","sortable":true,"filterOptions":[{"value":"已受理","label":"已受理"},{"value":"已卸船","label":"已卸船"},{"value":"已可提","label":"已可提"},{"value":"已做提柜预约","label":"已做提柜预约"},{"value":"已提","label":"已提"},{"value":"已到仓","label":"已到仓"},{"value":"已拆柜","label":"已拆柜"},{"value":"已还柜","label":"已还柜"}]},{"prop":"unloadingTime","label":"卸船时间","width":"160","sortable":true},{"prop":"availableTime","label":"available时间","width":"160","sortable":true},{"prop":"pickupAppointmentTime","label":"提柜预约时间","width":"160","sortable":true,"editable":true,"type":"datetime"},{"prop":"requiredPickupTime","label":"计划回仓时间","width":"160","sortable":true},{"prop":"requiredReturnTime","label":"要求回仓时间","width":"160","sortable":true},{"prop":"pickupTime","label":"提柜时间","width":"160","sortable":true,"editable":true,"type":"datetime"},{"prop":"arrivalTime","label":"到仓时间","width":"160","sortable":true},{"prop":"unpackingTime","label":"拆柜时间","width":"160","sortable":true},{"prop":"unpackingProgress","label":"拆柜进度","width":"120","sortable":true},{"prop":"emptyPickupTime","label":"提空时间","width":"160","sortable":true,"editable":true,"type":"datetime"},{"prop":"emptyReturnTime","label":"还空时间","width":"160","sortable":true,"editable":true,"type":"datetime"},{"prop":"remarks","label":"供应商备注","width":"150","sortable":true},{"prop":"vehicleAssignment","label":"派送车牌","width":"120","sortable":true,"editable":true},{"prop":"driver","label":"司机","width":"100","sortable":true,"editable":true,"type":"select","options":[{"value":"张三","label":"张三"},{"value":"李四","label":"李四"},{"value":"王五","label":"王五"},{"value":"赵六","label":"赵六"}]},{"prop":"deliveryLevel","label":"派送等级","width":"150","sortable":true,"editable":true,"type":"select","options":[{"value":"T1","label":"T1"},{"value":"T2","label":"T2"},{"value":"T3","label":"T3"},{"value":"T4","label":"T4"}]},{"prop":"driverPhone","label":"司机电话","width":"120","sortable":true,"editable":true,"type":"input"},{"prop":"containerType","label":"海柜类型","width":"120","sortable":true,"editable":false},{"prop":"podPhoto","label":"POD照片","width":"120","sortable":true},{"prop":"operation","label":"操作","width":"120","fixed":"right"}]');var Z=a(9405);const ee=JSON.parse('{"X":100,"l":[{"id":3,"orderNumber":"CP20240320003","orderStatus":"已派车","unloadingTime":"2024-03-21 09:15:00","availableTime":"2024-03-22 13:30:00","pickupAppointmentTime":"2024-03-23 08:30:00","requiredPickupTime":"2024-03-23 09:30:00","requiredReturnTime":"2024-03-24 15:00:00","pickupTime":"2024-03-23 09:15:00","arrivalTime":"2024-03-23 11:20:00","containerType":"直送私仓","unpackingTime":"2024-03-23 12:00:00","unpackingProgress":"45%","emptyPickupTime":null,"emptyReturnTime":null,"deliveryLevel":"T1","tags":["准时"],"remarks":"客户要求提前通知到达","followUpRecord":"已通知客户到达时间","history":"订单创建,派车,提柜","vehicleAssignment":"CA75632","driver":"李四","driverPhone":"13911112222","podPhoto":null},{"id":4,"orderNumber":"CP20240320004","orderStatus":"运输中","unloadingTime":"2024-03-21 10:45:00","availableTime":"2024-03-22 16:00:00","pickupAppointmentTime":"2024-03-23 10:00:00","requiredPickupTime":"2024-03-23 11:00:00","requiredReturnTime":"2024-03-24 16:30:00","pickupTime":"2024-03-23 10:30:00","arrivalTime":null,"containerType":"直送FBA","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"deliveryLevel":"T2","tags":["加急","特殊"],"remarks":"货物需要特殊处理","followUpRecord":"已与仓库确认接收时间","history":"订单创建,派车,提柜","vehicleAssignment":"CA38291","driver":"王五","driverPhone":"13922223333","podPhoto":null},{"id":5,"orderNumber":"CP20240321001","orderStatus":"已签收","unloadingTime":"2024-03-22 08:30:00","availableTime":"2024-03-23 12:00:00","pickupAppointmentTime":"2024-03-24 09:30:00","requiredPickupTime":"2024-03-24 10:30:00","requiredReturnTime":"2024-03-25 17:00:00","pickupTime":"2024-03-24 09:45:00","arrivalTime":"2024-03-24 11:50:00","deliveryLevel":"T3","containerType":"拆柜入库","unpackingTime":"2024-03-24 13:00:00","unpackingProgress":"100%","emptyPickupTime":"2024-03-25 09:00:00","emptyReturnTime":"2024-03-25 14:30:00","tags":["完成"],"remarks":"货物已全部入库","followUpRecord":"已完成签收确认","history":"订单创建,派车,提柜,送达,签收,返空","vehicleAssignment":"CA64578","driver":"赵六","driverPhone":"13833334444","podPhoto":"pod_photo_002.jpg"},{"id":6,"orderNumber":"CP20240321002","orderStatus":"已受理","unloadingTime":"2024-03-22 09:45:00","availableTime":"2024-03-23 14:15:00","pickupAppointmentTime":"2024-03-24 11:00:00","requiredPickupTime":"2024-03-24 12:00:00","requiredReturnTime":"2024-03-25 18:00:00","deliveryLevel":"T4","pickupTime":null,"arrivalTime":null,"containerType":"直送私仓","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"tags":["普通"],"remarks":"标准操作流程","followUpRecord":"等待卸船","history":"订单创建","vehicleAssignment":"未分配","driver":null,"driverPhone":null,"podPhoto":null},{"id":7,"orderNumber":"CP20240321003","orderStatus":"已卸船","unloadingTime":"2024-03-22 11:00:00","availableTime":"2024-03-23 15:30:00","pickupAppointmentTime":"2024-03-24 13:00:00","requiredPickupTime":"2024-03-24 14:00:00","requiredReturnTime":"2024-03-25 19:30:00","pickupTime":null,"arrivalTime":null,"containerType":"拆柜入库","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"tags":["待分配"],"remarks":"需要专业装卸设备","followUpRecord":"已通知客户货物到港","history":"订单创建,卸船","vehicleAssignment":"未分配","driver":null,"driverPhone":null,"podPhoto":null},{"id":8,"orderNumber":"CP20240322001","orderStatus":"已派车","unloadingTime":"2024-03-23 08:00:00","availableTime":"2024-03-24 12:30:00","pickupAppointmentTime":"2024-03-25 09:00:00","requiredPickupTime":"2024-03-25 10:00:00","requiredReturnTime":"2024-03-26 16:00:00","pickupTime":null,"arrivalTime":null,"containerType":"直送FBA","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"tags":["加急"],"remarks":"亚马逊库存紧急补货","followUpRecord":"已安排车辆","history":"订单创建,派车","vehicleAssignment":"CA92371","driver":"孙七","driverPhone":"13744445555","podPhoto":null},{"id":9,"orderNumber":"CP20240322002","orderStatus":"已签收","unloadingTime":"2024-03-23 09:30:00","availableTime":"2024-03-24 13:45:00","pickupAppointmentTime":"2024-03-25 10:30:00","requiredPickupTime":"2024-03-25 11:30:00","requiredReturnTime":"2024-03-26 17:30:00","pickupTime":"2024-03-25 10:45:00","arrivalTime":"2024-03-25 13:20:00","containerType":"直送私仓","unpackingTime":"2024-03-25 14:00:00","unpackingProgress":"100%","emptyPickupTime":"2024-03-26 08:30:00","emptyReturnTime":"2024-03-26 15:15:00","tags":["完成","准时"],"remarks":"顺利完成","followUpRecord":"客户已确认全部货物","history":"订单创建,派车,提柜,送达,签收,返空","vehicleAssignment":"CA10459","driver":"周八","driverPhone":"13655556666","podPhoto":"pod_photo_003.jpg"},{"id":10,"orderNumber":"CP20240322003","orderStatus":"运输中","unloadingTime":"2024-03-23 10:45:00","availableTime":"2024-03-24 15:00:00","pickupAppointmentTime":"2024-03-25 13:00:00","requiredPickupTime":"2024-03-25 14:00:00","requiredReturnTime":"2024-03-26 19:00:00","pickupTime":"2024-03-25 13:15:00","arrivalTime":null,"containerType":"拆柜入库","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"tags":["特殊"],"remarks":"货物需要温控","followUpRecord":"司机已出发前往目的地","history":"订单创建,派车,提柜","vehicleAssignment":"CA87263","driver":"吴九","driverPhone":"13966667777","podPhoto":null},{"id":11,"orderNumber":"CP20240323001","orderStatus":"已受理","unloadingTime":"2024-03-24 09:00:00","availableTime":"2024-03-25 13:30:00","pickupAppointmentTime":"2024-03-26 08:30:00","requiredPickupTime":"2024-03-26 09:30:00","requiredReturnTime":"2024-03-27 15:30:00","pickupTime":null,"arrivalTime":null,"containerType":"直送FBA","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"tags":["普通"],"remarks":"常规FBA发货","followUpRecord":"等待卸船","history":"订单创建","vehicleAssignment":"未分配","driver":null,"driverPhone":null,"podPhoto":null},{"id":12,"orderNumber":"CP20240323002","orderStatus":"已卸船","unloadingTime":"2024-03-24 10:30:00","availableTime":"2024-03-25 14:45:00","pickupAppointmentTime":"2024-03-26 10:00:00","requiredPickupTime":"2024-03-26 11:00:00","requiredReturnTime":"2024-03-27 17:00:00","pickupTime":null,"arrivalTime":null,"containerType":"直送私仓","unpackingTime":null,"unpackingProgress":"0%","emptyPickupTime":null,"emptyReturnTime":null,"tags":["待分配","异常"],"remarks":"清关文件需要补充","followUpRecord":"正在处理清关异常","history":"订单创建,卸船,清关异常","vehicleAssignment":"未分配","driver":null,"driverPhone":null,"podPhoto":null}]}');var le=a(8548),ae=a(432),te=a.n(ae);const ie=Y,oe=Z,ne=ee.l,re={name:"SuppilerSeasOrder",components:{FilterPanel:q.A,GroupableTable:G.A,ExpenseDetailDialog:B.A,HistoryRecordDialog:$.A,GpsTrackDialog:j.A,draggable:te(),DArrowLeft:le.V6m,VehicleAssignmentDialog:J.A,UploadPodDialog:H.A,FileUploadWithTagDialog:Q.A},setup(){const e=(0,M.KR)(ie),l=(0,M.KR)(oe),a=(0,M.KR)(ne),i=(0,M.KR)([]),o=(0,M.KR)(!1),n=(0,M.KR)([...ie]),r=(0,M.KR)([]),u=(0,M.KR)("west2"),s=(0,M.KR)("卸船时间"),d=(0,M.KR)([]),p=(0,M.KR)("订单号"),c=(0,M.KR)(""),m=(0,M.KR)("no"),v=(0,M.KR)("all"),g=(0,M.KR)(!1),b=(0,M.KR)([]),h=(0,M.KR)("and"),k=(0,M.KR)(1),f=(0,M.KR)(20),w=(0,M.KR)(ee.X),y=(0,t.EW)((()=>w.value)),C=(0,M.KR)("all"),V=(0,M.KR)(""),F=(0,M.KR)([]),T=(0,M.KR)(!1),S=(0,M.KR)(!1),_=(0,M.KR)(!1),P=(0,M.KR)(""),R=(0,M.KR)({name:"",columns:[]}),W=(0,M.KR)(null),x=(0,M.KR)({name:""}),D=(0,M.KR)(!1),L=(0,M.KR)({level1:"",level2:"",level3:""}),U=(0,t.EW)((()=>i.value.some((e=>e.isGroup)))),K=e=>{const l=["","primary","success","warning"];return l[e]||""},A=(0,t.EW)((()=>e.value.filter((e=>["trainNumber","loadingType","loadingStatus","loadingStartTime","loadingEndTime","loader","dockNumber","actualPallets"].includes(e.prop))))),E=(0,t.EW)((()=>e.value.filter((e=>["trainNumber","deliveryType","supplier","driverPhone","licensePlate","destination","deliveryCost"].includes(e.prop))))),N=(0,t.EW)((()=>e.value.filter((e=>["trainNumber","driverLicense","licensePlate","driverPhone","loadingStatus","loadingAppointmentTime"].includes(e.prop))))),X=(0,t.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop))));(0,t.wB)(C,(l=>{if(["all","waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(l))V.value="",e.value.forEach((e=>e.visible=!0)),b.value=[],h.value="and",L.value={level1:"",level2:"",level3:""},P.value="",Xe.value=[{field:"",direction:"asc"}];else if(["loadingView","dispatchView","driverView"].includes(l))V.value="","loadingView"===l?n.value=A.value:"dispatchView"===l?n.value=E.value:"driverView"===l&&(n.value=N.value);else{const e=F.value.find((e=>e.id===l));e&&(V.value=l,tl(l))}q()})),(0,t.wB)(V,(e=>{e&&(C.value=e)})),(0,t.sV)((()=>{n.value=e.value,Q(),z()}));const z=()=>{o.value=!0;try{a.value=ee.l,w.value=ee.X,q()}catch(e){console.error("加载数据失败:",e),I.nk.error("加载数据失败")}finally{o.value=!1}},q=()=>{let e=[...a.value];if(["waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(C.value)){const l={waitRegister:"未装车",registered:"已登记",loading:"装车中",loaded:"装车完成",shipped:"已发货",delivered:"已签收",pod:"已签收POD"},a=l[C.value];a&&(e=e.filter((e=>e.loadingStatus===a)))}if(c.value&&(e=e.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const l={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},a=l[s.value],[t,i]=d.value;e=e.filter((e=>{const l=e[a];if(!l)return!1;const o=l.split(" ")[0];return o>=t&&o<=i}))}b.value.length>0&&(e=e.filter((e=>{const l=b.value.map((l=>{const{field:a,operator:t,value:i}=l,o=e[a];if(null==o)return!1;switch(t){case"eq":return o==i;case"neq":return o!=i;case"contains":return o.toString().toLowerCase().includes(i.toString().toLowerCase());case"notContains":return!o.toString().toLowerCase().includes(i.toString().toLowerCase());case"startsWith":return o.toString().toLowerCase().startsWith(i.toString().toLowerCase());case"endsWith":return o.toString().toLowerCase().endsWith(i.toString().toLowerCase());case"gt":return Number(o)>Number(i);case"gte":return Number(o)>=Number(i);case"lt":return Number(o)<Number(i);case"lte":return Number(o)<=Number(i);default:return!0}}));return"and"===h.value?l.every((e=>e)):l.some((e=>e))}))),P.value&&(e=G(e,P.value)),w.value=e.length;const l=(k.value-1)*f.value,t=l+f.value;i.value=e.slice(l,t)},G=(e,l)=>{const a={};e.forEach((e=>{const t=e[l]||"未分类";a[t]||(a[t]=[]),a[t].push({...e})}));const t=[];for(const[i,o]of Object.entries(a))t.push({id:`group-${i}`,groupName:i,count:o.length,isGroup:!0,groupLevel:0,children:o});return t},B=e=>{r.value=e},$=e=>{const l={未装车:"info",已登记:"warning",装车中:"warning",装车完成:"success",已发货:"success",已签收:"success",已签收POD:"success",退件:"danger",待审批:"info",应付未完成:"info"};return l[e]||"info"},j=()=>{R.value={name:"",columns:e.value.filter((e=>!1!==e.visible)).map((e=>e.prop))},T.value=!0},J=()=>{if(!R.value.name.trim())return void I.nk.warning("请输入视图名称");const l={id:Date.now().toString(),name:R.value.name,columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:b.value,filterLogic:h.value,groupSettings:L.value,sortSettings:Xe.value};F.value.push(l),V.value=l.id,T.value=!1,ll(),I.nk.success("保存成功")},H=()=>{W.value&&O.s.confirm("确定要删除该视图吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=F.value.findIndex((e=>e.id===W.value.id));-1!==e&&(F.value.splice(e,1),C.value===W.value.id&&(C.value="all",V.value=""),ll(),I.nk.success("删除成功")),S.value=!1})).catch((()=>{S.value=!1}))},Q=()=>{const e=localStorage.getItem("deliveryTrainsViews");if(e)try{F.value=JSON.parse(e)}catch(l){console.error("加载保存的视图失败:",l)}},Y=e=>{console.log("查看详情",e)},Z=(e,l)=>{switch(e){case"vehicleAssignment":Kl(l);break;case"memo":bl(l);break;case"followUp":kl(l);break;case"history":Cl(l);break;case"gpsTrack":_l(l);break;case"fileUpload":Pl(l);break;case"podUpload":Rl(l);break;case"markException":wl(l);break;case"fileUploadWithTag":Il(l);break}},le=()=>{g.value=!0},ae=()=>{console.log("showAddTrainDialog")},te=(e,l)=>{console.log("展开/折叠行:",e.id,l?"展开":"折叠")},re=({prop:e,order:l})=>{if(!e||!l)return void q();const a=[...i.value];a.sort(((a,t)=>{let i=a[e],o=t[e];return isNaN(i)||isNaN(o)||(i=Number(i),o=Number(o)),"string"===typeof i&&"string"===typeof o?"ascending"===l?i.localeCompare(o):o.localeCompare(i):"ascending"===l?i>o?1:-1:i<o?1:-1})),i.value=a},ue=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:"分组"},se=e=>{f.value=e,z()},de=e=>{k.value=e,z()},pe=()=>{k.value=1,q()},ce=({filters:e,logic:l})=>{b.value=e,h.value=l,k.value=1,V.value&&al(V.value),q()},me=()=>{},ve=e=>{W.value=e,S.value=!0},ge=()=>{W.value&&(x.value.name=W.value.name,S.value=!1,_.value=!0)},be=()=>{if(!W.value)return;if(!x.value.name.trim())return void I.nk.warning("请输入视图名称");const e=F.value.findIndex((e=>e.id===W.value.id));-1!==e&&(F.value[e].name=x.value.name,ll(),I.nk.success("重命名成功"),_.value=!1)},he=()=>{if(!W.value)return;const e={...W.value,id:Date.now().toString(),name:`${W.value.name} 副本`};F.value.push(e),ll(),I.nk.success("复制成功"),S.value=!1},ke=(0,M.KR)(!1),fe=(0,M.KR)(0),we=(0,M.KR)(0),ye=(e,l)=>{e.preventDefault(),W.value=l,ke.value=!0,fe.value=e.clientX,we.value=e.clientY,setTimeout((()=>{document.addEventListener("click",Ce)}),0)},Ce=()=>{ke.value=!1,document.removeEventListener("click",Ce)},Ve=(0,M.KR)({rowIndex:-1,prop:"",value:""}),Fe=(0,M.KR)(!1),Te=(0,M.KR)(null),Se=(0,M.KR)({}),_e=(0,M.KR)({value:""}),Pe=(e,l,a)=>{const t=l.property;if(Dl(t)){const l=a?a.closest("tr"):null,i=l?Array.from(l.parentNode.children).indexOf(l):-1;Ve.value={rowIndex:i,prop:t,value:e[t]||""},setTimeout((()=>{const e=document.querySelector(".cell-editor input, .cell-editor select");e&&e.focus()}),50)}},Re=l=>{const a=e.value.find((e=>e.prop===l));return a?.type||"input"},We=l=>{const a=e.value.find((e=>e.prop===l));return a?.options||[]},xe=(l,a)=>{const t=a.property;Dl(t)&&(Ve.value={rowIndex:-1,prop:"",value:""},Te.value=l,Se.value=e.value.find((e=>e.prop===t))||{prop:t,label:t},_e.value.value=l[t]||"",Fe.value=!0)},De=(e,l)=>{Ve.value.prop===l&&(e[l]=Ve.value.value,setTimeout((()=>{const l=a.value.findIndex((l=>l.id===e.id));-1!==l&&(a.value[l]={...e}),Ve.value={rowIndex:-1,prop:"",value:""},I.nk.success("保存成功")}),200))},Le=()=>{if(Te.value&&Se.value.prop){Te.value[Se.value.prop]=_e.value.value;const e=a.value.findIndex((e=>e.id===Te.value.id));-1!==e&&(a.value[e]={...Te.value}),Fe.value=!1,I.nk.success("保存成功")}},Ue=l=>{const t=e.value.find((e=>e.prop===l));if(t&&t.filterOptions)return t.filterOptions;switch(l){case"loader":return[{value:"张三",label:"张三"},{value:"李四",label:"李四"},{value:"王五",label:"王五"},{value:"赵六",label:"赵六"},{value:"钱七",label:"钱七"}];case"dockNumber":return Array.from({length:10},((e,l)=>{const a=l+1,t=`DOCK-${a<10?"0"+a:a}`;return{value:t,label:t}}));case"supplier":return[{value:"广州物流",label:"广州物流"},{value:"深圳物流",label:"深圳物流"},{value:"东莞物流",label:"东莞物流"},{value:"佛山物流",label:"佛山物流"},{value:"中山物流",label:"中山物流"}];case"driverLicense":case"licensePlate":case"driverPhone":return a.value.map((e=>({value:e[l],label:e[l]}))).filter(((e,l,a)=>e.value&&a.findIndex((l=>l.value===e.value))===l));default:return[]}},Ke=()=>{D.value=!0},Ae=()=>{const e=[];L.value.level1&&e.push(L.value.level1),L.value.level2&&e.push(L.value.level2),L.value.level3&&e.push(L.value.level3),P.value="",Ee(e),V.value&&al(V.value),D.value=!1,I.nk.success("分组已应用")},Ee=l=>{if(!l||0===l.length)return void q();const t=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:l};let o=[...a.value];if(["waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(C.value)){const e={waitRegister:"未装车",registered:"已登记",loading:"装车中",loaded:"装车完成",shipped:"已发货",delivered:"已签收",pod:"已签收POD"},l=e[C.value];l&&(o=o.filter((e=>e.loadingStatus===l)))}if(c.value&&(o=o.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const e={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},l=e[s.value],[a,t]=d.value;o=o.filter((e=>{const i=e[l];if(!i)return!1;const o=i.split(" ")[0];return o>=a&&o<=t}))}b.value.length>0&&(o=o.filter((e=>{const l=b.value.map((l=>{const{field:a,operator:t,value:i}=l,o=e[a];if(null==o)return!1;switch(t){case"eq":return o==i;case"neq":return o!=i;case"contains":return o.toString().toLowerCase().includes(i.toString().toLowerCase());case"notContains":return!o.toString().toLowerCase().includes(i.toString().toLowerCase());case"startsWith":return o.toString().toLowerCase().startsWith(i.toString().toLowerCase());case"endsWith":return o.toString().toLowerCase().endsWith(i.toString().toLowerCase());case"gt":return Number(o)>Number(i);case"gte":return Number(o)>=Number(i);case"lt":return Number(o)<Number(i);case"lte":return Number(o)<=Number(i);default:return!0}}));return"and"===h.value?l.every((e=>e)):l.some((e=>e))})));const n=[],r=new Map;o.forEach((e=>{let a=n,i="",o=null;for(let n=0;n<l.length;n++){const u=l[n],s=e[u]||"未分类",d=t(u),p=`${i}/${u}:${s}`;let c=a.find((e=>e.groupKey===p));c||(c={id:`group-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,groupKey:p,groupName:`${d}: ${s}`,isGroup:!0,groupLevel:n,children:[],items:[],count:0},c.groupClass=0===n?"level-1-group":1===n?"level-2-group":"level-3-group",a.push(c),r.set(p,c)),c.items.push(e),c.count=c.items.length,i=p,a=c.children,o=c}if(o){const l={...e,parentGroupKey:o.groupKey};o.children.push(l)}}));const u=[];function m(e,l=0){e.forEach((e=>{u.push(e);const a=e.children.filter((e=>e.isGroup));a.length>0?m(a,l+1):e.children.forEach((e=>{u.push(e)}))}))}m(n),w.value=u.length;const v=(k.value-1)*f.value,g=v+f.value;i.value=u.slice(v,g)},Ne=(0,M.KR)(!1),Xe=(0,M.KR)([{field:"",direction:"asc"}]),ze=(0,t.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop)))),Me=()=>{Ne.value=!0},Ie=()=>{Xe.value.push({field:"",direction:"asc"})},Oe=e=>{Xe.value.splice(e,1),0===Xe.value.length&&Xe.value.push({field:"",direction:"asc"})},qe=()=>{if(Xe.value.some((e=>!e.field)))return void I.nk.warning("请选择所有排序字段");let e=[...i.value];Xe.value.forEach((({field:l,direction:a})=>{e.sort(((e,t)=>{let i=e[l],o=t[l];return isNaN(i)||isNaN(o)||(i=Number(i),o=Number(o)),"string"===typeof i&&"string"===typeof o?"asc"===a?i.localeCompare(o):o.localeCompare(i):"asc"===a?i>o?1:-1:i<o?1:-1}))})),i.value=e,Ne.value=!1,V.value&&al(V.value),I.nk.success("排序已应用")},Ge=()=>{L.value={level1:"",level2:"",level3:""},P.value="",V.value&&al(V.value),q(),D.value=!1,I.nk.success("已清除分组设置")},Be=()=>{Xe.value=[{field:"",direction:"asc"}],V.value&&al(V.value),q(),Ne.value=!1,I.nk.success("已清除排序设置")},$e=(0,M.KR)(!1),je=(0,M.KR)([]),Je=(0,t.EW)({get:()=>je.value.every((e=>e.visible)),set:e=>{je.value.forEach((l=>l.visible=e))}}),He=()=>{je.value=e.value.map((e=>({...e,visible:!1!==e.visible}))),$e.value=!0},Qe=e=>{je.value.forEach((l=>l.visible=e))},Ye=()=>{je.value=e.value.map((e=>({...e,visible:!0})))},Ze=()=>{},el=()=>{e.value=e.value.map((e=>{const l=je.value.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}})),V.value&&al(V.value),$e.value=!1,I.nk.success("字段配置已更新")},ll=()=>{localStorage.setItem("deliveryTrainsViews",JSON.stringify(F.value))},al=l=>{const a=F.value.findIndex((e=>e.id===l));a>-1&&(F.value[a]={...F.value[a],columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:b.value,filterLogic:h.value,groupSettings:L.value,sortSettings:Xe.value},ll())},tl=l=>{const a=F.value.find((e=>e.id===l));a&&(a.columns&&(e.value=e.value.map((e=>{const l=a.columns.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}}))),a.filters&&(b.value=[...a.filters],h.value=a.filterLogic||"and"),a.groupSettings&&(L.value={...a.groupSettings}),a.sortSettings&&(Xe.value=[...a.sortSettings]),q())},il=(0,M.KR)(!1),ol=(0,M.KR)(null),nl=e=>{console.log("费用已推送:",e),I.nk.success("费用推送成功")},rl=e=>{console.log("取消推送:",e),I.nk.success("已取消推送")},ul=e=>{switch(e.trim()){case"异常":return"danger";case"紧急":return"warning";default:return""}},sl=(e,l,a)=>{if(e[l]){if(Array.isArray(e[l])){const t=e[l].indexOf(a);if(t>-1){const a=[...e[l]];a.splice(t,1),e[l]=a}}else if("string"===typeof e[l]){const t=e[l].split(",").map((e=>e.trim())),i=t.indexOf(a);i>-1&&(t.splice(i,1),e[l]=t.join(","))}I.nk.success("标签已移除")}},dl=(0,M.KR)(!1),pl=(0,M.KR)(!1),cl=(0,M.KR)({memo:""}),ml=(0,M.KR)({content:"",type:"primary"}),vl=(0,M.KR)([{time:"2024-03-20 10:00:00",content:"已联系司机，预计下午到达",operator:"张三",type:"primary"},{time:"2024-03-20 15:30:00",content:"司机到达装货点，开始装货",operator:"李四",type:"warning"}]),gl=(0,M.KR)(null),bl=e=>{gl.value=e,cl.value.memo=e.memo||"",dl.value=!0},hl=()=>{gl.value&&(gl.value.memo=cl.value.memo,I.nk.success("保存成功"),dl.value=!1)},kl=e=>{gl.value=e,ml.value={content:"",type:"primary"},pl.value=!0},fl=()=>{if(ml.value.content){if(vl.value.unshift({time:(new Date).toLocaleString(),content:ml.value.content,operator:"当前用户",type:ml.value.type}),gl.value&&"danger"===ml.value.type){let e=[];if(Array.isArray(gl.value.tags)?e=[...gl.value.tags]:"string"===typeof gl.value.tags&&gl.value.tags&&(e=gl.value.tags.split(",").map((e=>e.trim()))),!e.includes("异常")){e.push("异常"),gl.value.tags=e;const l=a.value.findIndex((e=>e.id===gl.value.id));-1!==l&&(a.value[l]={...gl.value});const t=i.value.findIndex((e=>e.id===gl.value.id));-1!==t&&(i.value[t]={...gl.value})}}pl.value=!1,I.nk.success("保存成功")}else I.nk.warning("请输入跟进内容")},wl=e=>{gl.value=e,ml.value={content:"",type:"danger"},pl.value=!0},yl=(0,M.KR)(!1),Cl=e=>{ol.value=e,yl.value=!0},Vl=(0,M.KR)(!1),Fl=(0,M.KR)(null),Tl=(e,l)=>{switch(e){case"lastPod":I.nk.info("查看上传POD记录："+l.pcNumber);break;case"deletePc":O.s.confirm("确认要删除该PC记录吗？","删除PC",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{I.nk.success("删除成功")})).catch((()=>{}));break}},Sl=e=>{console.log("处理车辆分配",e)},_l=e=>{Fl.value=e,Vl.value=!0},Pl=e=>{console.log("处理文件上传",e)},Rl=e=>{Xl.value=e,Nl.value=!0},Wl=()=>{Nl.value=!1,Xl.value=null},xl=async e=>{try{if(console.log("提交POD数据:",e),Xl.value){Xl.value.podStatus="已上传",Xl.value.podUploadTime=e.receiptTime;const l=a.value.findIndex((e=>e.id===Xl.value.id));-1!==l&&(a.value[l]={...Xl.value});const t=i.value.findIndex((e=>e.id===Xl.value.id));-1!==t&&(i.value[t]={...Xl.value})}I.nk.success("POD上传成功"),Nl.value=!1}catch(l){console.error("POD上传失败:",l),I.nk.error("POD上传失败")}},Dl=l=>{const a=e.value.find((e=>e.prop===l));return a?.editable||!1},Ll=(0,M.KR)(!1),Ul=(0,M.KR)(null),Kl=e=>{Ul.value=e,Ll.value=!0},Al=e=>{if(!Ul.value)return;Ul.value.licensePlate=e.plateNumber,Ul.value.driver=e.driver,Ul.value.driverPhone=e.driverPhone,Ul.value.gpsNumber=e.gpsNumber,Ul.value.vehicleAssignment=e.plateNumber;const l=a.value.findIndex((e=>e.id===Ul.value.id));-1!==l&&(a.value[l]={...Ul.value});const t=i.value.findIndex((e=>e.id===Ul.value.id));-1!==t&&(i.value[t]={...Ul.value}),Ll.value=!1,I.nk.success("车辆分配成功")},El=()=>{if(!Ul.value)return;Ul.value.licensePlate="",Ul.value.driver="",Ul.value.driverPhone="",Ul.value.gpsNumber="";const e=a.value.findIndex((e=>e.id===Ul.value.id));-1!==e&&(a.value[e]={...Ul.value});const l=i.value.findIndex((e=>e.id===Ul.value.id));-1!==l&&(i.value[l]={...Ul.value}),Ll.value=!1,I.nk.success("已取消车辆分配")},Nl=(0,M.KR)(!1),Xl=(0,M.KR)(null),zl=(0,M.KR)(!1),Ml=(0,M.KR)(null),Il=e=>{Ml.value=e,zl.value=!0},Ol=async e=>{try{if(console.log("提交文件数据:",e),Ml.value){Ml.value.fileTag=e.fileTag,Ml.value.fileRemark=e.remark;const l=a.value.findIndex((e=>e.id===Ml.value.id));-1!==l&&(a.value[l]={...Ml.value});const t=i.value.findIndex((e=>e.id===Ml.value.id));-1!==t&&(i.value[t]={...Ml.value})}I.nk.success("文件上传成功"),zl.value=!1}catch(l){console.error("文件上传失败:",l),I.nk.error("文件上传失败")}},ql=()=>{zl.value=!1,Ml.value=null};return{tableColumns:e,childColumns:l,tableData:a,displayData:i,loading:o,visibleColumns:n,selectedRows:r,warehouse:u,createDateType:s,dateRange:d,searchType:p,searchText:c,sendOrder:m,currentStatus:v,filterPanelVisible:g,activeFilters:b,filterLogic:h,currentPage:k,pageSize:f,totalItems:w,total:y,currentView:C,selectedCustomView:V,customViews:F,saveViewDialogVisible:T,viewOptionsDialogVisible:S,renameViewDialogVisible:_,groupField:P,viewForm:R,currentEditingView:W,renameForm:x,groupableFields:X,groupModalVisible:D,groupSettings:L,hasGroupedData:U,getGroupTagType:K,showGroupModal:Ke,applyGroupSettings:Ae,handleSaveView:j,saveView:J,handleDeleteView:H,loadSavedViews:Q,getStatusTagType:$,handleDetail:Y,handleCommand:Z,showFilterPanel:le,showAddTrainDialog:ae,handleExpandChange:te,handleSelectionChange:B,handleSortChange:re,handleSizeChange:se,handleCurrentChange:de,handleSearch:pe,applyFilters:ce,cancelFilters:me,fetchData:z,applyFiltersAndPagination:q,groupData:G,handleViewOptions:ve,handleRenameView:ge,saveRenameView:be,handleCopyView:he,contextMenuVisible:ke,contextMenuX:fe,contextMenuY:we,handleContextMenu:ye,closeContextMenu:Ce,editingCell:Ve,editDialogVisible:Fe,editingRow:Te,editingColumn:Se,editingForm:_e,handleCellClick:Pe,handleCellDbClick:xe,saveEdit:De,saveDialogEdit:Le,getOptionsForColumn:Ue,getGroupColumnLabel:ue,sortModalVisible:Ne,sortSettings:Xe,sortableFields:ze,showSortModal:Me,addSortField:Ie,removeSortField:Oe,applySortSettings:qe,clearGroupSettings:Ge,clearSortSettings:Be,columnSettingsVisible:$e,columnSettingsList:je,allColumnsSelected:Je,showColumnSettings:He,handleSelectAllColumns:Qe,resetColumnSettings:Ye,handleDragEnd:Ze,applyColumnSettings:el,saveViewsToStorage:ll,updateViewConfig:al,applyViewConfig:tl,expenseDialogVisible:il,currentTrainData:ol,handleExpensePushed:nl,handlePushCancelled:rl,getTagType:ul,handleTagClose:sl,memoDialogVisible:dl,followUpDialogVisible:pl,memoForm:cl,followUpForm:ml,followUpHistory:vl,currentEditingTrain:gl,handleMemo:bl,saveMemo:hl,handleFollowUp:kl,saveFollowUp:fl,handleMarkException:wl,historyDialogVisible:yl,handleHistory:Cl,gpsTrackDialogVisible:Vl,currentGpsTrainData:Fl,handleChildCommand:Tl,handleVehicleAssignment:Sl,handleGpsTrack:_l,handleFileUpload:Pl,handlePodUpload:Rl,getEditControlType:Re,getEditControlOptions:We,isEditableField:Dl,vehicleAssignmentVisible:Ll,openVehicleAssignment:Kl,handleVehicleAssign:Al,handleVehicleCancelAssign:El,podDialogVisible:Nl,currentPodRow:Xl,handlePodSubmit:xl,handlePodCancel:Wl,fileUploadWithTagVisible:zl,currentFileRow:Ml,handleFileUploadWithTag:Il,handleFileUploadWithTagSubmit:Ol,handleFileUploadWithTagCancel:ql}}};var ue=a(6262);const se=(0,ue.A)(re,[["render",z],["__scopeId","data-v-ff5e7a3c"]]),de=se},2895:(e,l,a)=>{a.d(l,{A:()=>v});var t=a(641),i=a(3751),o=a(33);const n={class:"search-area"},r={class:"pagination-container"};function u(e,l,a,u,s,d){const p=(0,t.g2)("el-input"),c=(0,t.g2)("el-form-item"),m=(0,t.g2)("el-option"),v=(0,t.g2)("el-select"),g=(0,t.g2)("el-button"),b=(0,t.g2)("el-form"),h=(0,t.g2)("el-table-column"),k=(0,t.g2)("el-tag"),f=(0,t.g2)("el-table"),w=(0,t.g2)("el-pagination"),y=(0,t.g2)("el-dialog"),C=(0,t.gN)("loading");return(0,t.uX)(),(0,t.Wv)(y,{title:"车辆分配",modelValue:u.dialogVisible,"onUpdate:modelValue":l[4]||(l[4]=e=>u.dialogVisible=e),width:"900px","close-on-click-modal":!1},{default:(0,t.k6)((()=>[(0,t.Lk)("div",n,[(0,t.bF)(b,{inline:!0,model:u.searchForm,class:"search-form"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"搜索车辆"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:u.searchForm.plateNumber,"onUpdate:modelValue":l[0]||(l[0]=e=>u.searchForm.plateNumber=e),placeholder:"请输入车牌号",clearable:"",onKeyup:(0,i.jR)(u.handleSearch,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,t.bF)(c,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(v,{modelValue:u.searchForm.status,"onUpdate:modelValue":l[1]||(l[1]=e=>u.searchForm.status=e),placeholder:"请选择状态",clearable:""},{default:(0,t.k6)((()=>[(0,t.bF)(m,{label:"忙碌中",value:"busy"}),(0,t.bF)(m,{label:"空闲",value:"idle"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(g,{type:"primary",onClick:u.handleSearch},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("搜索")]))),_:1},8,["onClick"]),(0,t.bF)(g,{onClick:u.resetSearch},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])]),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(f,{data:u.tableData,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(h,{prop:"plateNumber",label:"车牌号",width:"120"}),(0,t.bF)(h,{prop:"driver",label:"司机",width:"100"}),(0,t.bF)(h,{prop:"driverPhone",label:"司机电话",width:"120"}),(0,t.bF)(h,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(k,{type:"busy"===e.row.status?"danger":"success"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)("busy"===e.row.status?"忙碌中":"空闲"),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(h,{prop:"gpsNumber",label:"GPS绑定号码",width:"120"}),(0,t.bF)(h,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>["idle"===e.row.status?((0,t.uX)(),(0,t.Wv)(g,{key:0,type:"primary",size:"small",onClick:l=>u.handleAssign(e.row)},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)(" 分配 ")]))),_:2},1032,["onClick"])):((0,t.uX)(),(0,t.Wv)(g,{key:1,type:"danger",size:"small",onClick:l=>u.handleCancelAssign(e.row)},{default:(0,t.k6)((()=>l[8]||(l[8]=[(0,t.eW)(" 取消分配 ")]))),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"])),[[C,u.loading]]),(0,t.Lk)("div",r,[(0,t.bF)(w,{"current-page":u.currentPage,"onUpdate:currentPage":l[2]||(l[2]=e=>u.currentPage=e),"page-size":u.pageSize,"onUpdate:pageSize":l[3]||(l[3]=e=>u.pageSize=e),"page-sizes":[10,20,50,100],total:u.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])),_:1},8,["modelValue"])}var s=a(953),d=a(7918);const p={name:"VehicleAssignmentDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","assign","cancel-assign"],setup(e,{emit:l}){const a=(0,s.KR)(e.modelValue),i=(0,s.KR)(!1),o=(0,s.KR)(1),n=(0,s.KR)(10),r=(0,s.KR)(100),u=(0,s.Kh)({plateNumber:"",status:""}),p=Array.from({length:100},((e,l)=>({id:l+1,plateNumber:`粤B${String(Math.floor(1e4*Math.random())).padStart(5,"0")}`,driver:["张三","李四","王五","赵六"][Math.floor(4*Math.random())],driverPhone:`138${String(Math.floor(1e8*Math.random())).padStart(8,"0")}`,status:Math.random()>.5?"busy":"idle",gpsNumber:`GPS${String(Math.floor(1e3*Math.random())).padStart(3,"0")}`}))),c=(0,s.KR)(p);(0,t.wB)((()=>e.modelValue),(e=>{a.value=e})),(0,t.wB)((()=>a.value),(e=>{l("update:modelValue",e)}));const m=()=>{i.value=!0,setTimeout((()=>{const e=p.filter((e=>{const l=!u.plateNumber||e.plateNumber.includes(u.plateNumber),a=!u.status||e.status===u.status;return l&&a}));c.value=e,r.value=e.length,i.value=!1}),500)},v=()=>{u.plateNumber="",u.status="",m()},g=e=>{d.s.confirm("确认要分配该车辆吗？","分配车辆",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.status="忙碌中",l("assign",e)})).catch((()=>{}))},b=e=>{d.s.confirm("确认要取消分配该车辆吗？","取消分配",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.status="空闲",l("cancel-assign",e)})).catch((()=>{}))},h=e=>{n.value=e,m()},k=e=>{o.value=e,m()};return{dialogVisible:a,loading:i,searchForm:u,tableData:c,currentPage:o,pageSize:n,total:r,handleSearch:m,resetSearch:v,handleAssign:g,handleCancelAssign:b,handleSizeChange:h,handleCurrentChange:k}}};var c=a(6262);const m=(0,c.A)(p,[["render",u],["__scopeId","data-v-6acbac67"]]),v=m},9405:e=>{e.exports=JSON.parse('[{"prop":"pcNumber","label":"PC号","width":120,"sortable":true},{"prop":"bookingParty","label":"预约方","width":120,"sortable":true},{"prop":"bookingTime","label":"预约时间","width":160,"sortable":true},{"prop":"bookingNumber","label":"预约号","width":120,"sortable":true},{"prop":"startWarehouse","label":"起始仓库","width":120,"sortable":true},{"prop":"destination","label":"目的地","width":150,"sortable":true},{"prop":"palletCount","label":"板数","width":100,"sortable":true},{"prop":"weight","label":"重量","width":100,"sortable":true},{"prop":"loadingType","label":"装车类型","width":100,"sortable":true},{"prop":"BoxCount","label":"箱数","width":160,"sortable":true},{"prop":"rank","label":"优先级","width":100,"sortable":true},{"prop":"volume","label":"方数","width":100,"sortable":true},{"prop":"DriverStartTime","label":"司机出发时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"DriverEndTime","label":"司机到达时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"Arrived","label":"交仓完成时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"podImage","label":"POD图片","width":150,"sortable":false,"filterType":"image","type":"image"},{"prop":"operation","label":"操作","width":150,"fixed":"right","sortable":false,"type":"operation"}]')}}]);
//# sourceMappingURL=4317.c9b96ace.js.map