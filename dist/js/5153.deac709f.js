"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[5153],{5153:(e,i,l)=>{l.r(i),l.d(i,{default:()=>j});var n=l(641),o=l(33);const t={class:"driver-app-container"},a={class:"phone-mockup"},r={class:"phone-screen"},s={class:"app-header"},p={class:"header-title"},c={key:0},u={key:1},d={key:2},m={class:"language-switch"},k={class:"app-content"},g={key:0,class:"home-view"},h={key:1,class:"scan-view"},v={key:2,class:"details-view"},f={class:"details-list-container"},y={class:"dispatch-header-info"},C={key:0},b={class:"batch-actions"},_={class:"dispatch-list"},T={class:"item-info"},D={class:"pc-info-line"},P={class:"pc-tags"},L={class:"address-info"},w={class:"address-info"},W={key:0},U={key:1},x={key:2,class:"pickup-time"},F={key:3,class:"departure-time"},N={class:"item-actions"},A={class:"details-footer"},E={class:"el-upload__tip"},S={class:"dialog-footer"},z={class:"el-upload__tip"},X={class:"dialog-footer"},B={key:0,class:"pickup-confirm-dialog-content"},Q={style:{"margin-top":"20px"}},O={class:"dialog-footer"};function R(e,i,l,R,V,M){const I=(0,n.g2)("el-button"),$=(0,n.g2)("el-tag"),K=(0,n.g2)("el-upload"),q=(0,n.g2)("el-dialog"),j=(0,n.g2)("el-input"),H=(0,n.g2)("el-form-item"),G=(0,n.g2)("el-radio"),J=(0,n.g2)("el-radio-group"),Y=(0,n.g2)("el-form");return(0,n.uX)(),(0,n.CE)("div",t,[(0,n.Lk)("div",a,[(0,n.Lk)("div",r,[(0,n.Lk)("div",s,[R.showScan||R.showDetails?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:i[0]||(i[0]=(...e)=>R.goBack&&R.goBack(...e)),class:"back-button"},"< "+(0,o.v_)(R.i18n.back),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",p,[R.showScan||R.showDetails?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("span",c,(0,o.v_)(R.i18n.headerTitle),1)),R.showScan?((0,n.uX)(),(0,n.CE)("span",u,(0,o.v_)(R.i18n.scanTitle),1)):(0,n.Q3)("",!0),R.showDetails?((0,n.uX)(),(0,n.CE)("span",d,(0,o.v_)(R.i18n.detailsTitle)+" - "+(0,o.v_)(R.currentDispatch.trainNumber),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",m,[(0,n.bF)(I,{type:"text",size:"small",onClick:R.toggleLanguage},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)("zh"===R.currentLanguage?"EN":"中"),1)])),_:1},8,["onClick"])])]),(0,n.Lk)("div",k,[R.showScan||R.showDetails?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",g,[(0,n.Lk)("h2",null,(0,o.v_)(R.i18n.welcome),1),(0,n.bF)(I,{type:"primary",size:"large",onClick:R.goToScan,class:"dispatch-button"},{default:(0,n.k6)((()=>[i[9]||(i[9]=(0,n.Lk)("i",{class:"el-icon-camera",style:{"margin-right":"8px"}},null,-1)),(0,n.eW)(" "+(0,o.v_)(R.i18n.vehicleDispatch),1)])),_:1},8,["onClick"])])),R.showScan?((0,n.uX)(),(0,n.CE)("div",h,[(0,n.Lk)("p",null,(0,o.v_)(R.i18n.scanQrCodeTip),1),i[10]||(i[10]=(0,n.Lk)("div",{class:"scanner-placeholder"},[(0,n.Lk)("i",{class:"el-icon-camera-solid scanner-icon"}),(0,n.Lk)("div",{class:"scan-line"})],-1)),(0,n.bF)(I,{type:"success",onClick:R.simulateScan,style:{"margin-top":"20px"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.simulateScanSuccess),1)])),_:1},8,["onClick"])])):(0,n.Q3)("",!0),R.showDetails?((0,n.uX)(),(0,n.CE)("div",v,[(0,n.Lk)("div",f,[(0,n.Lk)("div",y,[(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.dispatchNumber)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentDispatch.trainNumber),1)]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.supplier)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentDispatch.supplier||"-"),1)]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.loadingCompletion)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentDispatch.loadingCompletionTime||"-"),1)]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.loadingType)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentDispatch.dispatchLoadingType||"-"),1)]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.deliveryType)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentDispatch.dispatchDeliveryType||"-"),1)]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.pickupStatus)+":",1),(0,n.bF)($,{type:R.dispatchPickupStatus===R.i18n.pickedUp?"success":"warning",size:"small"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.dispatchPickupStatus),1)])),_:1},8,["type"])]),R.firstPickupTime?((0,n.uX)(),(0,n.CE)("p",C,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.firstPickup)+":",1),(0,n.eW)(" "+(0,o.v_)(R.firstPickupTime),1)])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",b,[R.batchableOrdersInfo?((0,n.uX)(),(0,n.Wv)(I,{key:0,type:"warning",plain:"",size:"small",onClick:R.handleBatchConfirmPickup,style:{"margin-left":"10px"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.batchConfirmPickup),1)])),_:1},8,["onClick"])):(0,n.Q3)("",!0),R.batchableDepartureInfo?((0,n.uX)(),(0,n.Wv)(I,{key:1,type:"primary",plain:"",size:"small",onClick:R.handleBatchDepart,style:{"margin-left":"10px"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.batchMarkDepart),1)])),_:1},8,["onClick"])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",_,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(R.currentDispatch.orders,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.pcNumber,class:(0,o.C4)(["dispatch-item",{"has-exception":e.hasException}])},[(0,n.Lk)("div",T,[(0,n.Lk)("p",D,[(0,n.Lk)("span",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.pcNumber)+":",1),(0,n.eW)(" "+(0,o.v_)(e.pcNumber),1)]),(0,n.Lk)("span",P,[(0,n.bF)($,{size:"mini",type:"info",effect:"light"},{default:(0,n.k6)((()=>[(0,n.eW)("P"+(0,o.v_)(e.priority),1)])),_:2},1024),(0,n.bF)($,{size:"mini",type:"卡板"===e.pcLoadingType?"primary":"success",effect:"light"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)("卡板"===e.pcLoadingType?"zh"===R.currentLanguage?"卡板":"Pallet":"地板"===e.pcLoadingType?"zh"===R.currentLanguage?"地板":"Floor Loading":e.pcLoadingType),1)])),_:2},1032,["type"])])]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.originWarehouse)+":",1),(0,n.eW)(" "+(0,o.v_)(e.originWarehouse),1)]),(0,n.Lk)("p",L,(0,o.v_)(R.i18n.address)+": "+(0,o.v_)(e.originAddress||R.i18n.noAddress),1),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.destination)+":",1),(0,n.eW)(" "+(0,o.v_)(e.destination),1)]),(0,n.Lk)("p",w,(0,o.v_)(R.i18n.address)+": "+(0,o.v_)(e.destinationAddress||R.i18n.noAddress),1),e.pcLoadingType===R.i18n.palletType?((0,n.uX)(),(0,n.CE)("p",W,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.palletCount)+":",1),(0,n.eW)(" "+(0,o.v_)(e.quantity),1)])):(0,n.Q3)("",!0),e.pcLoadingType===R.i18n.floorType?((0,n.uX)(),(0,n.CE)("p",U,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.boxCount)+":",1),(0,n.eW)(" "+(0,o.v_)(e.quantity),1)])):(0,n.Q3)("",!0),e.pickupTime?((0,n.uX)(),(0,n.CE)("p",x,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.pickup)+":",1),(0,n.eW)(" "+(0,o.v_)(e.pickupTime),1)])):(0,n.Q3)("",!0),e.departureTime?((0,n.uX)(),(0,n.CE)("p",F,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.departure)+":",1),(0,n.eW)(" "+(0,o.v_)(e.departureTime),1)])):(0,n.Q3)("",!0),e.hasException?((0,n.uX)(),(0,n.Wv)($,{key:4,type:"danger",size:"small",effect:"dark",style:{"margin-top":"5px"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.exception),1)])),_:1})):(0,n.Q3)("",!0)]),(0,n.Lk)("div",N,["pending"===e.status?((0,n.uX)(),(0,n.Wv)(I,{key:0,type:"warning",plain:"",size:"small",onClick:i=>R.showPickupConfirmationDialog(e)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.confirmPickup),1)])),_:2},1032,["onClick"])):(0,n.Q3)("",!0),"pickup_confirmed"===e.status?((0,n.uX)(),(0,n.Wv)(I,{key:1,type:"info",size:"small",onClick:i=>R.markDeparted(e)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.markDepart),1)])),_:2},1032,["onClick"])):(0,n.Q3)("",!0),"picked_up"===e.status?((0,n.uX)(),(0,n.Wv)(I,{key:2,type:"primary",size:"small",onClick:i=>R.markDelivered(e)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.delivered),1)])),_:2},1032,["onClick"])):(0,n.Q3)("",!0),"delivered"===e.status?((0,n.uX)(),(0,n.Wv)(I,{key:3,type:"warning",size:"small",onClick:i=>R.uploadPOD(e)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.uploadPOD),1)])),_:2},1032,["onClick"])):(0,n.Q3)("",!0),"pod_uploaded"===e.status?((0,n.uX)(),(0,n.Wv)($,{key:4,type:"success",size:"small"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.podUploaded),1)])),_:1})):(0,n.Q3)("",!0),"pod_uploaded"!==e.status?((0,n.uX)(),(0,n.Wv)(I,{key:5,type:"danger",plain:"",size:"small",onClick:i=>R.handleMarkException(e),style:{"margin-top":"5px"}},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.markException),1)])),_:2},1032,["onClick"])):(0,n.Q3)("",!0)])],2)))),128))])]),(0,n.Lk)("div",A,[(0,n.bF)(I,{type:"success",size:"large",disabled:!R.allTasksCompleted,onClick:R.completeCurrentDispatch,class:"complete-dispatch-button"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.allTasksCompleted),1)])),_:1},8,["disabled","onClick"])])])):(0,n.Q3)("",!0)])])]),(0,n.bF)(q,{title:R.i18n.uploadPODTitle,modelValue:R.podDialogVisible,"onUpdate:modelValue":i[2]||(i[2]=e=>R.podDialogVisible=e),width:"90%"},{footer:(0,n.k6)((()=>[(0,n.Lk)("span",S,[(0,n.bF)(I,{onClick:i[1]||(i[1]=e=>R.podDialogVisible=!1)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.cancel),1)])),_:1}),(0,n.bF)(I,{type:"primary",onClick:R.confirmPodUpload},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.confirmUpload),1)])),_:1},8,["onClick"])])])),default:(0,n.k6)((()=>[(0,n.Lk)("p",null,[(0,n.eW)((0,o.v_)(R.i18n.uploadPODDesc)+" ",1),(0,n.Lk)("strong",null,(0,o.v_)(R.currentPodItem?.pcNumber),1),(0,n.eW)(" "+(0,o.v_)(R.i18n.uploadPODDesc2),1)]),(0,n.bF)(K,{class:"upload-demo",action:"#","http-request":R.handleDummyUpload,"on-success":R.handlePodUploadSuccess,"before-upload":R.beforePodUpload,multiple:"",limit:1,"on-exceed":R.handleExceed},{tip:(0,n.k6)((()=>[(0,n.Lk)("div",E,(0,o.v_)(R.i18n.uploadTip),1)])),default:(0,n.k6)((()=>[(0,n.bF)(I,{type:"primary"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.clickUpload),1)])),_:1})])),_:1},8,["http-request","on-success","before-upload","on-exceed"])])),_:1},8,["title","modelValue"]),(0,n.bF)(q,{title:R.i18n.followUpTitle,modelValue:R.followUpDialogVisible,"onUpdate:modelValue":i[6]||(i[6]=e=>R.followUpDialogVisible=e),width:"90%"},{footer:(0,n.k6)((()=>[(0,n.Lk)("span",X,[(0,n.bF)(I,{onClick:i[5]||(i[5]=e=>R.followUpDialogVisible=!1)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.cancel),1)])),_:1}),(0,n.bF)(I,{type:"primary",onClick:R.saveFollowUp},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.confirmSave),1)])),_:1},8,["onClick"])])])),default:(0,n.k6)((()=>[(0,n.bF)(Y,{model:R.followUpForm,"label-position":"top"},{default:(0,n.k6)((()=>[(0,n.bF)(H,{label:R.i18n.followUpDesc},{default:(0,n.k6)((()=>[(0,n.bF)(j,{modelValue:R.followUpForm.content,"onUpdate:modelValue":i[3]||(i[3]=e=>R.followUpForm.content=e),type:"textarea",rows:4,placeholder:R.i18n.enterDetailDesc},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,n.bF)(H,{label:R.i18n.type},{default:(0,n.k6)((()=>[(0,n.bF)(J,{modelValue:R.followUpForm.type,"onUpdate:modelValue":i[4]||(i[4]=e=>R.followUpForm.type=e)},{default:(0,n.k6)((()=>[(0,n.bF)(G,{label:"primary"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.regularFollowUp),1)])),_:1}),(0,n.bF)(G,{label:"warning"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.importantReminder),1)])),_:1}),(0,n.bF)(G,{label:"danger"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.exceptionReport),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,n.bF)(H,{label:R.i18n.uploadAttachment},{default:(0,n.k6)((()=>[(0,n.bF)(K,{class:"upload-demo",action:"#","http-request":R.handleFollowUpUpload,"before-upload":R.beforeFollowUpUpload,"on-remove":R.handleFollowUpRemove,"file-list":R.followUpForm.files,multiple:"",limit:3},{tip:(0,n.k6)((()=>[(0,n.Lk)("div",z,(0,o.v_)(R.i18n.maxThreeFiles),1)])),default:(0,n.k6)((()=>[(0,n.bF)(I,{type:"primary"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.clickUpload),1)])),_:1})])),_:1},8,["http-request","before-upload","on-remove","file-list"])])),_:1},8,["label"])])),_:1},8,["model"])])),_:1},8,["title","modelValue"]),(0,n.bF)(q,{title:R.i18n.pickupConfirmTitle,modelValue:R.pickupConfirmationDialogVisible,"onUpdate:modelValue":i[8]||(i[8]=e=>R.pickupConfirmationDialogVisible=e),width:"90%","close-on-click-modal":!1},{footer:(0,n.k6)((()=>[(0,n.Lk)("span",O,[(0,n.bF)(I,{onClick:i[7]||(i[7]=e=>R.pickupConfirmationDialogVisible=!1)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.no),1)])),_:1}),(0,n.bF)(I,{type:"primary",onClick:R.confirmActualPickup},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(R.i18n.yes),1)])),_:1},8,["onClick"])])])),default:(0,n.k6)((()=>[R.currentItemForPickup?((0,n.uX)(),(0,n.CE)("div",B,[(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.pcNumber)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentItemForPickup.pcNumber),1)]),(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,o.v_)(R.i18n.pickupWarehouse)+":",1),(0,n.eW)(" "+(0,o.v_)(R.currentItemForPickup.originWarehouse),1)]),(0,n.Lk)("p",Q,(0,o.v_)(R.i18n.confirmPickupQuestion),1)])):(0,n.Q3)("",!0)])),_:1},8,["title","modelValue"])])}var V=l(953),M=l(163),I=l(7918);const $={name:"DriverDispatch",setup(){const e=(0,V.KR)(!1),i=(0,V.KR)(!1),l=(0,V.KR)(!1),o=(0,V.KR)(null),t=(0,V.KR)(null),a=(0,V.KR)(!1),r=(0,V.KR)(null),s=(0,V.KR)(!1),p=(0,V.KR)(null),c=(0,V.Kh)({content:"",type:"primary",files:[]}),u=(0,V.KR)("zh"),d=(0,n.EW)((()=>"zh"===u.value?{headerTitle:"司机助手",scanTitle:"扫描派送单",detailsTitle:"派送详情",back:"返回",welcome:"欢迎，司机师傅！",vehicleDispatch:"车辆派送",scanQrCodeTip:"请扫描派送单上的二维码",simulateScanSuccess:"模拟扫码成功",dispatchNumber:"派送号",supplier:"供应商",loadingCompletion:"装货完成",loadingType:"装车类型",deliveryType:"派送类型",pickupStatus:"提货状态",pickedUp:"已提货",notPickedUp:"未提货",firstPickup:"首单提货",batchConfirmPickup:"批量确认提货",batchMarkDepart:"批量标记出发",pcNumber:"PC号",palletType:"卡板",floorType:"地板",originWarehouse:"起运仓",address:"地址",noAddress:"暂无地址",destination:"目的地",palletCount:"板数",boxCount:"箱数",pickup:"提货",departure:"出发",exception:"异常",confirmPickup:"确认提货",markDepart:"标记出发",delivered:"已送达",uploadPOD:"上传POD",podUploaded:"POD已上传",markException:"标记异常",allTasksCompleted:"全部派送完成",uploadPODTitle:"上传 POD",uploadPODDesc:"请为 PC号",uploadPODDesc2:"上传签收凭证。",clickUpload:"点击上传",uploadTip:"请上传图片文件 (jpg/png)，大小不超过 5MB",cancel:"取消",confirmUpload:"确认上传",followUpTitle:"跟进/异常记录",followUpDesc:"跟进内容/异常描述",enterDetailDesc:"请输入详细描述",type:"类型",regularFollowUp:"常规跟进",importantReminder:"重要提醒",exceptionReport:"异常上报",uploadAttachment:"上传附件 (图片/文件)",maxThreeFiles:"最多上传3个文件, 单个不超过 10MB",confirmSave:"确定保存",pickupConfirmTitle:"提货确认",pickupWarehouse:"提货仓库",confirmPickupQuestion:"是否确认已完成提货？",yes:"是",no:"否"}:{headerTitle:"Driver Assistant",scanTitle:"Scan Dispatch Order",detailsTitle:"Dispatch Details",back:"Back",welcome:"Welcome, Driver!",vehicleDispatch:"Vehicle Dispatch",scanQrCodeTip:"Please scan the QR code on the dispatch order",simulateScanSuccess:"Simulate Scan Success",dispatchNumber:"Dispatch No",supplier:"Supplier",loadingCompletion:"Loading Completed",loadingType:"Loading Type",deliveryType:"Delivery Type",pickupStatus:"Pickup Status",pickedUp:"Picked Up",notPickedUp:"Not Picked Up",firstPickup:"First Pickup",batchConfirmPickup:"Batch Confirm Pickup",batchMarkDepart:"Batch Mark Departure",pcNumber:"PC No",palletType:"Pallet",floorType:"Floor Loading",originWarehouse:"Origin Warehouse",address:"Address",noAddress:"No Address",destination:"Destination",palletCount:"Pallet Count",boxCount:"Box Count",pickup:"Pickup",departure:"Departure",exception:"Exception",confirmPickup:"Confirm Pickup",markDepart:"Mark Departure",delivered:"Delivered",uploadPOD:"Upload POD",podUploaded:"POD Uploaded",markException:"Mark Exception",allTasksCompleted:"All Tasks Completed",uploadPODTitle:"Upload POD",uploadPODDesc:"Please upload the receipt for PC No",uploadPODDesc2:".",clickUpload:"Click to Upload",uploadTip:"Please upload image files (jpg/png), size < 5MB",cancel:"Cancel",confirmUpload:"Confirm Upload",followUpTitle:"Follow-up/Exception Record",followUpDesc:"Follow-up Content/Exception Description",enterDetailDesc:"Please enter detailed description",type:"Type",regularFollowUp:"Regular Follow-up",importantReminder:"Important Reminder",exceptionReport:"Exception Report",uploadAttachment:"Upload Attachments (Images/Files)",maxThreeFiles:"Maximum 3 files, each less than 10MB",confirmSave:"Confirm Save",pickupConfirmTitle:"Pickup Confirmation",pickupWarehouse:"Pickup Warehouse",confirmPickupQuestion:"Confirm that pickup has been completed?",yes:"Yes",no:"No"})),m=()=>{u.value="zh"===u.value?"en":"zh"},k=(0,V.Kh)({trainNumber:"",dispatchLoadingType:"",dispatchDeliveryType:"",supplier:"",loadingCompletionTime:"",orders:[]}),g={SCAN_RESULT_123:{trainNumber:"TRK-SH-LA-001",dispatchLoadingType:"混装",dispatchDeliveryType:"一提多卸",supplier:"ABC 物流公司",loadingCompletionTime:"2024-07-27 10:00 AM",orders:[{pcNumber:"PC20240726001",originWarehouse:"上海仓",originAddress:"上海市浦东新区XXX路100号",destination:"洛杉矶客户A",destinationAddress:"123 Main St, Los Angeles, CA 90001",pcLoadingType:"卡板",quantity:5,status:"pending",hasException:!1,priority:2,pickupTime:null,departureTime:null},{pcNumber:"PC20240726002",originWarehouse:"上海仓",originAddress:"上海市浦东新区XXX路100号",destination:"洛杉矶客户B",destinationAddress:"456 Industrial Ave, Los Angeles, CA 90021",pcLoadingType:"地板",quantity:30,status:"picked_up",hasException:!1,priority:1,pickupTime:"2024-07-27 11:00 AM",departureTime:"2024-07-27 11:05 AM"},{pcNumber:"PC20240726003",originWarehouse:"洛杉矶仓",originAddress:"789 Port Rd, Long Beach, CA 90802",destination:"洛杉矶客户C",destinationAddress:"101 Commerce Dr, City of Industry, CA 91744",pcLoadingType:"卡板",quantity:8,status:"pending",hasException:!1,priority:3,pickupTime:null,departureTime:null},{pcNumber:"PC20240726004",originWarehouse:"上海仓",originAddress:"上海市浦东新区XXX路100号",destination:"洛杉矶客户D",destinationAddress:"789 Sunset Blvd, Los Angeles, CA 90046",pcLoadingType:"卡板",quantity:3,status:"pickup_confirmed",hasException:!1,priority:4,pickupTime:"2024-07-27 11:15 AM",departureTime:null},{pcNumber:"PC20240726005",originWarehouse:"上海仓",originAddress:"上海市浦东新区XXX路100号",destination:"洛杉矶客户E",destinationAddress:"111 Beverly Hills Dr, CA 90210",pcLoadingType:"地板",quantity:15,status:"pending",hasException:!1,priority:5,pickupTime:null,departureTime:null},{pcNumber:"PC20240726006",originWarehouse:"上海仓",originAddress:"上海市浦东新区XXX路100号",destination:"洛杉矶客户F",destinationAddress:"222 Hollywood Blvd, CA 90028",pcLoadingType:"卡板",quantity:7,status:"pickup_confirmed",hasException:!1,priority:6,pickupTime:"2024-07-27 11:20 AM",departureTime:null}]}},h=()=>{e.value=!0,i.value=!1,k.trainNumber="",k.dispatchLoadingType="",k.dispatchDeliveryType="",k.supplier="",k.loadingCompletionTime="",k.orders=[]},v=()=>{i.value?(i.value=!1,e.value=!0,k.trainNumber="",k.dispatchLoadingType="",k.dispatchDeliveryType="",k.supplier="",k.loadingCompletionTime="",k.orders=[]):e.value&&(e.value=!1)},f=()=>{const l="SCAN_RESULT_123",n=g[l];n?(k.trainNumber=n.trainNumber,k.dispatchLoadingType=n.dispatchLoadingType,k.dispatchDeliveryType=n.dispatchDeliveryType,k.supplier=n.supplier,k.loadingCompletionTime=n.loadingCompletionTime,k.orders=n.orders.map((e=>({...e,hasException:e.hasException||!1,pickupTime:e.pickupTime||null,departureTime:e.departureTime||null,originAddress:e.originAddress||"",destinationAddress:e.destinationAddress||""}))).sort(((e,i)=>e.priority-i.priority)),e.value=!1,i.value=!0):M.nk.error("无效的派送单")},y=e=>{p.value=e,s.value=!0},C=()=>{if(!p.value)return;const e=p.value.pcNumber,i=k.orders.findIndex((i=>i.pcNumber===e));if(-1!==i&&"pending"===k.orders[i].status){const l=(new Date).toLocaleString(),n={...k.orders[i],status:"pickup_confirmed",pickupTime:l};k.orders.splice(i,1,n),M.nk.success("zh"===u.value?`PC ${e} 已确认提货`:`PC ${e} pickup confirmed`)}else M.nk.warning("zh"===u.value?"无法确认提货，订单状态不正确或未找到":"Unable to confirm pickup, order status incorrect or not found");s.value=!1,p.value=null},b=e=>{const i="zh"===u.value?`确认 PC ${e.pcNumber} 已出发吗？`:`Confirm PC ${e.pcNumber} has departed?`,l="zh"===u.value?"标记出发":"Mark Departure",n="zh"===u.value?"确定已出发":"Confirm Departure",o="zh"===u.value?"取消":"Cancel";I.s.confirm(i,l,{confirmButtonText:n,cancelButtonText:o,type:"info"}).then((()=>{const i=k.orders.findIndex((i=>i.pcNumber===e.pcNumber));if(-1!==i&&"pickup_confirmed"===k.orders[i].status){const l={...k.orders[i],status:"picked_up",departureTime:(new Date).toLocaleString()};k.orders.splice(i,1,l);const n="zh"===u.value?`PC ${e.pcNumber} 已标记为出发`:`PC ${e.pcNumber} marked as departed`;M.nk.success(n)}})).catch((()=>{console.log("zh"===u.value?"标记出发操作已取消。":"Mark departure operation canceled.")}))},_=e=>{const i="zh"===u.value?`确认将 PC ${e.pcNumber} 标记为已送达吗？`:`Confirm marking PC ${e.pcNumber} as delivered?`,l="zh"===u.value?"提示":"Confirm",n="zh"===u.value?"确定":"Confirm",o="zh"===u.value?"取消":"Cancel";I.s.confirm(i,l,{confirmButtonText:n,cancelButtonText:o,type:"warning"}).then((()=>{const i=k.orders.findIndex((i=>i.pcNumber===e.pcNumber));if(-1!==i&&"picked_up"===k.orders[i].status){const l={...k.orders[i],status:"delivered"};k.orders.splice(i,1,l);const n="zh"===u.value?`PC ${e.pcNumber} 已标记为送达`:`PC ${e.pcNumber} marked as delivered`;M.nk.success(n)}})).catch((()=>{console.log("zh"===u.value?"标记送达操作已取消。":"Mark delivered operation canceled.")}))},T=e=>{o.value=e,t.value=null,l.value=!0},D=e=>{const{file:i}=e;w(i)?(t.value=i,M.nk.info(`已选择文件: ${i.name}，请点击确认上传`),e.onSuccess(i)):e.onError(new Error("文件验证失败"))},P=()=>{t.value?o.value&&(console.log("开始上传文件:",t.value.name,"给PC:",o.value.pcNumber),new Promise((e=>setTimeout(e,1500))).then((()=>{console.log("模拟上传成功");const e=k.orders.findIndex((e=>e.pcNumber===o.value.pcNumber));if(-1!==e&&"delivered"===k.orders[e].status){const i={...k.orders[e],status:"pod_uploaded"};k.orders.splice(e,1,i),M.nk.success("POD 上传成功！")}else M.nk.warning("无法上传POD，订单状态不正确或未找到");l.value=!1,o.value=null,t.value=null})).catch((e=>{console.error("模拟POD上传时出错:",e),M.nk.error("POD 上传过程中出现错误")}))):M.nk.warning("请先选择要上传的文件")},L=(e,i,l)=>{console.log("File selected/dummy success:",i.name,l)},w=e=>{const i="image/jpeg"===e.type||"image/png"===e.type,l=e.size/1024/1024<5;return i||M.nk.error("上传文件只能是 JPG/PNG 格式!"),l||M.nk.error("上传文件大小不能超过 5MB!"),i&&l},W=(e,i)=>{M.nk.warning(`当前限制选择 1 个文件。您选择了 ${e.length+i.length} 个。`)},U=e=>{r.value=e,c.content="",c.type="danger",c.files=[],a.value=!0},x=e=>{const{file:i}=e;F(i)?M.nk.success(`${i.name} 文件已选择`):console.log("文件验证未通过:",i.name)},F=e=>{const i=e.size/1024/1024<10;return!!i||(M.nk.error("上传文件大小不能超过 10MB!"),!1)},N=(e,i)=>{c.files=i,console.log("Removed file:",e.name)},A=()=>{if(c.content){if(r.value){if(console.log("Saving follow-up for:",r.value.pcNumber),console.log("Content:",c.content),console.log("Type:",c.type),console.log("Files:",c.files.map((e=>e.name))),"danger"===c.type){const e=k.orders.findIndex((e=>e.pcNumber===r.value.pcNumber));if(-1!==e){const i={...k.orders[e],hasException:!0};k.orders.splice(e,1,i),M.nk.success("异常已上报并记录")}else M.nk.warning("无法标记异常，未找到订单")}else M.nk.success("跟进记录已保存");a.value=!1,r.value=null}}else M.nk.warning("请输入跟进内容或异常描述")},E=(0,n.EW)((()=>!(!k.orders||0===k.orders.length)&&k.orders.every((e=>"delivered"===e.status||"pod_uploaded"===e.status)))),S=()=>{if(!E.value)return void M.nk.warning("zh"===u.value?"还有未完成的派送任务！":"There are still uncompleted dispatch tasks!");const l="zh"===u.value?`确认完成车次 ${k.trainNumber} 的所有派送任务吗？`:`Confirm completing all dispatch tasks for ${k.trainNumber}?`,n="zh"===u.value?"提示":"Confirm",o="zh"===u.value?"确定完成":"Complete",t="zh"===u.value?"取消":"Cancel";I.s.confirm(l,n,{confirmButtonText:o,cancelButtonText:t,type:"success"}).then((()=>{console.log("Dispatch completed:",k.trainNumber),M.nk.success("zh"===u.value?"车次派送已全部完成！":"All dispatch tasks completed!"),i.value=!1,e.value=!0,k.trainNumber="",k.dispatchLoadingType="",k.dispatchDeliveryType="",k.supplier="",k.loadingCompletionTime="",k.orders=[]})).catch((()=>{console.log("zh"===u.value?"全部派送完成操作已取消。":"Complete all dispatches operation canceled.")}))},z=(0,n.EW)((()=>{const e=k.orders.filter((e=>"pending"===e.status));if(e.length<2)return null;const i=e.reduce(((e,i)=>{const l=i.originWarehouse;return e[l]||(e[l]=[]),e[l].push(i),e}),{});let l=null,n=1;for(const o in i)i[o].length>n&&(n=i[o].length,l={warehouse:o,orders:i[o]});return l})),X=(0,n.EW)((()=>{const e=k.orders.filter((e=>"pickup_confirmed"===e.status));if(e.length<2)return null;const i=e.reduce(((e,i)=>{const l=i.originWarehouse;return e[l]||(e[l]=[]),e[l].push(i),e}),{});let l=null,n=1;for(const o in i)i[o].length>n&&(n=i[o].length,l={warehouse:o,orders:i[o]});return l})),B=(0,n.EW)((()=>{if(!k.orders||0===k.orders.length)return"zh"===u.value?"未知":"Unknown";const e=k.orders.some((e=>"pickup_confirmed"===e.status||"picked_up"===e.status||"delivered"===e.status||"pod_uploaded"===e.status));return e?d.value.pickedUp:d.value.notPickedUp})),Q=(0,n.EW)((()=>{if(!k.orders)return null;const e=k.orders.filter((e=>e.pickupTime)).map((e=>e.pickupTime));return 0===e.length?null:e.sort()[0]})),O=()=>{const e=z.value;if(!e)return void M.nk.warning("没有足够的可批量确认提货的同仓库订单");const i=e.orders,l=i.map((e=>e.pcNumber)).join(", "),n=e.warehouse,o=`\n          <div>确认批量确认以下PC号已提货吗？</div>\n          <div style="margin-top: 15px; line-height: 1.6;">\n            <strong style="margin-right: 5px;">PC 号:</strong> ${l}\n          </div>\n          <div style="line-height: 1.6;">\n            <strong style="margin-right: 5px;">提货仓库:</strong> ${n}\n          </div>\n        `;I.s.confirm(o,"批量确认提货",{confirmButtonText:"确认提货",cancelButtonText:"取消",type:"info",dangerouslyUseHTMLString:!0}).then((()=>{const e=(new Date).toLocaleString(),l=new Set(i.map((e=>e.pcNumber))),n=k.orders.map((i=>l.has(i.pcNumber)&&"pending"===i.status?{...i,status:"pickup_confirmed",pickupTime:e}:i));k.orders=n,M.nk.success(`已批量确认 ${i.length} 个PC已提货`)})).catch((()=>{console.log("批量确认提货已取消")}))},R=()=>{const e=X.value;if(!e)return void M.nk.warning("没有足够的可批量标记出发的同仓库订单");const i=e.orders,l=i.map((e=>e.pcNumber)).join(", "),n=e.warehouse,o=`\n          <div>确认批量标记以下PC号为已出发吗？</div>\n          <div style="margin-top: 15px; line-height: 1.6;">\n            <strong style="margin-right: 5px;">PC 号:</strong> ${l}\n          </div>\n          <div style="line-height: 1.6;">\n            <strong style="margin-right: 5px;">出发仓库:</strong> ${n}\n          </div>\n        `;I.s.confirm(o,"批量标记出发",{confirmButtonText:"确认出发",cancelButtonText:"取消",type:"info",dangerouslyUseHTMLString:!0}).then((()=>{const e=(new Date).toLocaleString(),l=new Set(i.map((e=>e.pcNumber))),n=k.orders.map((i=>l.has(i.pcNumber)&&"pickup_confirmed"===i.status?{...i,status:"picked_up",departureTime:e}:i));k.orders=n,M.nk.success(`已批量标记 ${i.length} 个PC为已出发`)})).catch((()=>{console.log("批量标记出发已取消")}))};return{showScan:e,showDetails:i,goToScan:h,goBack:v,simulateScan:f,currentDispatch:k,showPickupConfirmationDialog:y,confirmActualPickup:C,markDeparted:b,markDelivered:_,uploadPOD:T,podDialogVisible:l,currentPodItem:o,handleDummyUpload:D,handlePodUploadSuccess:L,beforePodUpload:w,handleExceed:W,confirmPodUpload:P,followUpDialogVisible:a,currentFollowUpItem:r,followUpForm:c,handleMarkException:U,handleFollowUpUpload:x,beforeFollowUpUpload:F,handleFollowUpRemove:N,saveFollowUp:A,allTasksCompleted:E,completeCurrentDispatch:S,batchableOrdersInfo:z,handleBatchConfirmPickup:O,batchableDepartureInfo:X,handleBatchDepart:R,pickupConfirmationDialogVisible:s,currentItemForPickup:p,dispatchPickupStatus:B,firstPickupTime:Q,currentLanguage:u,i18n:d,toggleLanguage:m}}};var K=l(6262);const q=(0,K.A)($,[["render",R],["__scopeId","data-v-5fe5dd78"]]),j=q}}]);
//# sourceMappingURL=5153.deac709f.js.map