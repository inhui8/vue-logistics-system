"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[42],{42:(e,l,a)=>{a.r(l),a.d(l,{default:()=>V});var t=a(641),s=a(33),i=a(953),r=a(163);const u={class:"map-monitor-container"},o={class:"card-header"},n={class:"svg-map-wrapper"},d=["viewBox"],p=["width","height"],v=["transform"],c=["fill"],m=["fill","onClick"],h={x:"0",y:"-14","text-anchor":"middle","font-size":"9",fill:"#000000",stroke:"#ffffff","stroke-width":"0.3","paint-order":"stroke",style:{"pointer-events":"none"}},f={x:"0",y:"-4","text-anchor":"middle","font-size":"7",fill:"#333333",stroke:"#ffffff","stroke-width":"0.2","paint-order":"stroke",style:{"pointer-events":"none"}},k={class:"vehicle-scroll-list"},_={key:0,class:"no-data"},b={class:"vehicle-info"},y={class:"plate-number"},g={class:"supplier-name"},C={class:"location-info",style:{"font-size":"12px",color:"#606266"}},F={class:"details"},M={class:"coords",style:{"font-size":"11px",color:"#909399"}},N={key:0,class:"task"},w={class:"time"},L={class:"actions"},x=50,E=33.94,A=33.99,I=-117.6,T=-117.53,X={__name:"MapMonitor",setup(e){const l=(0,i.KR)(800),a=(0,i.KR)(600),X=(e,t)=>{if(void 0===e||void 0===t||null===e||null===t)return null;const s=Math.max(E,Math.min(A,e)),i=Math.max(I,Math.min(T,t)),r=(i-I)/(T-I),u=x+r*(l.value-2*x),o=(s-E)/(A-E),n=x+(1-o)*(a.value-2*x);return{x:Math.round(u),y:Math.round(n)}},K=(0,i.KR)([{id:"supplier_1",name:"测试供应商A - 专做提框服务"},{id:"supplier_2",name:"测试供应商B - FBA派送专家"},{id:"supplier_3",name:"测试供应商C - 全能型选手"}]),S=(0,i.KR)([{id:"vehicle_1",plateNumber:"CA12345",supplierId:"supplier_1",supplierName:"测试供应商A - 专做提框服务",serviceType:"port_to_warehouse",city:"Eastvale",state:"CA"},{id:"vehicle_2",plateNumber:"NY98765",supplierId:"supplier_2",supplierName:"测试供应商B - FBA派送专家",serviceType:"warehouse_to_destination",city:"Corona",state:"CA"},{id:"vehicle_3",plateNumber:"TX54321",supplierId:"supplier_3",supplierName:"测试供应商C - 全能型选手",serviceType:"general_purpose",city:"Chino",state:"CA"},{id:"vehicle_4",plateNumber:"FL11223",supplierId:"supplier_1",supplierName:"测试供应商A - 专做提框服务",serviceType:"port_to_warehouse",city:"Eastvale",state:"CA"},{id:"vehicle_5",plateNumber:"AZ55667",supplierId:"supplier_2",supplierName:"测试供应商B - FBA派送专家",serviceType:"warehouse_to_destination",city:"Ontario",state:"CA"}]),V=(0,i.KR)([]),R=(0,i.KR)(null),z=(0,i.KR)(!0),O=(0,i.KR)(null),B=()=>{const e=["idle","loaded","stopped","moving"],l=["PO","DO","SO"],a=(new Date).toLocaleTimeString("sv-SE");V.value=S.value.map((t=>{const s=V.value.find((e=>e.id===t.id));let i=s?.lat??E+Math.random()*(A-E),r=s?.lng??I+Math.random()*(T-I),u=0,o=e[Math.floor(Math.random()*e.length)],n=Math.floor(360*Math.random()),d=null;if(s&&"stopped"!==o&&"idle"!==o){const e=.001*(Math.random()-.5),l=.001*(Math.random()-.5);i=Math.max(E,Math.min(A,s.lat+e)),r=Math.max(I,Math.min(T,s.lng+l)),u=Math.floor(80*Math.random())+10,n=(s.direction+Math.floor(20*(Math.random()-.5))+360)%360,o="moving"}else"stopped"===o||"idle"===o?(u=0,i=s?.lat??i,r=s?.lng??r):u=Math.floor(80*Math.random())+10;return("loaded"===o||"moving"===o||s&&s.taskOrderNo)&&(d=s?.taskOrderNo||`${l[Math.floor(Math.random()*l.length)]}${String(Math.random()).slice(2,8)}`),"idle"===o&&(d=null),{...t,lat:parseFloat(i.toFixed(6)),lng:parseFloat(r.toFixed(6)),speed:u,direction:n,status:o,taskOrderNo:d,lastUpdateTime:a}}))},$=[{value:"port_to_warehouse",label:"码头到仓库"},{value:"warehouse_to_destination",label:"仓库到目的地"},{value:"general_purpose",label:"通用型"}],W=[{value:"idle",label:"空驶"},{value:"loaded",label:"载货"},{value:"stopped",label:"停留"},{value:"moving",label:"行驶中"}],U=(0,i.Kh)({supplierId:"",serviceType:"",vehicleStatus:""}),Q=(0,t.EW)((()=>V.value.filter((e=>{const l=!U.supplierId||e.supplierId===U.supplierId,a=!U.serviceType||e.serviceType===U.serviceType,t=!U.vehicleStatus||e.status===U.vehicleStatus;return l&&a&&t})))),Y=e=>W.find((l=>l.value===e))?.label||e,D=e=>{switch(e){case"moving":case"loaded":return"success";case"stopped":return"warning";case"idle":return"info";default:return"info"}},Z=(e,l=!1)=>{switch(e){case"moving":return l?"#67c23a":"#4CAF50";case"loaded":return l?"#67c23a":"#4CAF50";case"stopped":return l?"#e6a23c":"#FF9800";case"idle":return l?"#909399":"#9E9E9E";default:return l?"#909399":"#9E9E9E"}},j=e=>{console.log("Simulating focus on vehicle:",e.plateNumber),O.value=e.id},G=e=>{console.log("查看历史轨迹 for:",e.plateNumber),r.nk.info(`跳转或弹窗显示 ${e.plateNumber} 的历史轨迹查询 (待实现)`)},P=()=>{R.value&&clearInterval(R.value),B(),R.value=setInterval(B,1e4),z.value=!0},q=()=>{R.value&&clearInterval(R.value),R.value=null,z.value=!1},H=()=>{z.value?q():P()};return(0,t.sV)((()=>{P()})),(0,t.hi)((()=>{q()})),(e,i)=>{const r=(0,t.g2)("el-button"),x=(0,t.g2)("el-card"),E=(0,t.g2)("el-col"),A=(0,t.g2)("el-option"),I=(0,t.g2)("el-select"),T=(0,t.g2)("el-form-item"),S=(0,t.g2)("el-form"),V=(0,t.g2)("el-divider"),R=(0,t.g2)("el-tag"),B=(0,t.g2)("el-row");return(0,t.uX)(),(0,t.CE)("div",u,[(0,t.bF)(B,{gutter:20},{default:(0,t.k6)((()=>[(0,t.bF)(E,{span:18},{default:(0,t.k6)((()=>[(0,t.bF)(x,{shadow:"never",class:"map-card"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",o,[i[3]||(i[3]=(0,t.Lk)("span",null,"车辆实时位置监控 (模拟 SVG)",-1)),(0,t.bF)(r,{onClick:H,type:z.value?"danger":"primary",size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(z.value?"停止刷新":"自动刷新 (10s)"),1)])),_:1},8,["type"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",n,[((0,t.uX)(),(0,t.CE)("svg",{viewBox:`0 0 ${l.value} ${a.value}`,preserveAspectRatio:"xMidYMid meet",class:"svg-map"},[(0,t.Lk)("image",{href:"/images/map.jpeg",x:"0",y:"0",width:l.value,height:a.value,preserveAspectRatio:"xMidYMid slice"},null,8,p),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Q.value,(e=>((0,t.uX)(),(0,t.CE)("g",{key:e.id},[X(e.lat,e.lng)?((0,t.uX)(),(0,t.CE)("g",{key:0,transform:`translate(${X(e.lat,e.lng).x}, ${X(e.lat,e.lng).y})`},[e.id===O.value?((0,t.uX)(),(0,t.CE)("circle",{key:0,cx:"0",cy:"0",r:"15",fill:Z(e.status,!0),opacity:"0.5"},i[4]||(i[4]=[(0,t.Lk)("animate",{attributeName:"r",values:"12;18;12",dur:"1.5s",repeatCount:"indefinite"},null,-1),(0,t.Lk)("animate",{attributeName:"opacity",values:"0.5;0;0.5",dur:"1.5s",repeatCount:"indefinite"},null,-1)]),8,c)):(0,t.Q3)("",!0),(0,t.Lk)("path",{d:"M 0 -9 L 6 0 L 0 9 L -6 0 Z",fill:Z(e.status),stroke:"#ffffff","stroke-width":"1",transform:"scale(1.2)",onClick:l=>j(e),style:{cursor:"pointer"}},[(0,t.Lk)("title",null,(0,s.v_)(e.plateNumber)+" ("+(0,s.v_)(Y(e.status))+")",1)],8,m),(0,t.Lk)("text",h,(0,s.v_)(e.plateNumber),1),(0,t.Lk)("text",f,(0,s.v_)(e.city||"")+(0,s.v_)(e.city&&e.state?", ":"")+(0,s.v_)(e.state||""),1)],8,v)):(0,t.Q3)("",!0)])))),128))],8,d))])])),_:1})])),_:1}),(0,t.bF)(E,{span:6},{default:(0,t.k6)((()=>[(0,t.bF)(x,{shadow:"never",class:"vehicle-list-card"},{header:(0,t.k6)((()=>i[5]||(i[5]=[(0,t.Lk)("span",null,"车辆列表 & 筛选",-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(S,{model:U,"label-position":"top",size:"small"},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"供应商"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{modelValue:U.supplierId,"onUpdate:modelValue":i[0]||(i[0]=e=>U.supplierId=e),placeholder:"所有供应商",clearable:"",filterable:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.value,(e=>((0,t.uX)(),(0,t.Wv)(A,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"服务类型"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{modelValue:U.serviceType,"onUpdate:modelValue":i[1]||(i[1]=e=>U.serviceType=e),placeholder:"所有服务类型",clearable:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)($,(e=>(0,t.bF)(A,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"车辆状态"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{modelValue:U.vehicleStatus,"onUpdate:modelValue":i[2]||(i[2]=e=>U.vehicleStatus=e),placeholder:"所有状态",clearable:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(W,(e=>(0,t.bF)(A,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,t.bF)(V),(0,t.Lk)("div",k,[0===Q.value.length?((0,t.uX)(),(0,t.CE)("div",_," 无匹配车辆 ")):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Q.value,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,s.C4)(["vehicle-item",{"is-selected":e.id===O.value}])},[(0,t.Lk)("div",b,[(0,t.Lk)("span",y,(0,s.v_)(e.plateNumber),1),(0,t.bF)(R,{type:D(e.status),size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(Y(e.status)),1)])),_:2},1032,["type"])]),(0,t.Lk)("div",g,(0,s.v_)(e.supplierName),1),(0,t.Lk)("div",C," 位置: "+(0,s.v_)(e.city||"N/A")+", "+(0,s.v_)(e.state||"N/A"),1),(0,t.Lk)("div",F," 速度: "+(0,s.v_)(e.speed)+" km/h | 方向: "+(0,s.v_)(e.direction)+"° ",1),(0,t.Lk)("div",M," 坐标: "+(0,s.v_)(e.lat)+", "+(0,s.v_)(e.lng),1),e.taskOrderNo?((0,t.uX)(),(0,t.CE)("div",N," 任务: "+(0,s.v_)(e.taskOrderNo),1)):(0,t.Q3)("",!0),(0,t.Lk)("div",w," 更新: "+(0,s.v_)(e.lastUpdateTime),1),(0,t.Lk)("div",L,[(0,t.bF)(r,{text:"",type:"primary",size:"small",onClick:l=>j(e)},{default:(0,t.k6)((()=>i[6]||(i[6]=[(0,t.eW)("模拟定位")]))),_:2},1032,["onClick"]),(0,t.bF)(r,{text:"",type:"info",size:"small",onClick:l=>G(e)},{default:(0,t.k6)((()=>i[7]||(i[7]=[(0,t.eW)("历史轨迹")]))),_:2},1032,["onClick"])])],2)))),128))])])),_:1})])),_:1})])),_:1})])}}};var K=a(6262);const S=(0,K.A)(X,[["__scopeId","data-v-0d14a899"]]),V=S}}]);
//# sourceMappingURL=42.ee840f58.js.map