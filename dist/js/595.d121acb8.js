"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[595],{8595:(e,a,l)=>{l.r(a),l.d(a,{default:()=>f});var t=l(641),r=l(33);const n={class:"message-manage"},s={class:"pagination"};function i(e,a,l,i,o,d){const u=(0,t.g2)("el-option"),m=(0,t.g2)("el-select"),c=(0,t.g2)("el-form-item"),p=(0,t.g2)("el-input"),g=(0,t.g2)("el-radio"),b=(0,t.g2)("el-radio-group"),f=(0,t.g2)("el-button"),v=(0,t.g2)("el-form"),k=(0,t.g2)("el-card"),y=(0,t.g2)("el-table-column"),F=(0,t.g2)("el-tag"),h=(0,t.g2)("el-table"),_=(0,t.g2)("el-pagination");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(k,{class:"send-message"},{header:(0,t.k6)((()=>a[7]||(a[7]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"发送消息")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(v,{ref:"formRef",model:i.form,rules:i.rules,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(c,{label:"消息类型",prop:"type"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:i.form.type,"onUpdate:modelValue":a[0]||(a[0]=e=>i.form.type=e),placeholder:"请选择消息类型"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{label:"指令工单",value:"command"}),(0,t.bF)(u,{label:"异常工单",value:"exception"}),(0,t.bF)(u,{label:"增值服务",value:"value-added"}),(0,t.bF)(u,{label:"系统公告",value:"announcement"}),(0,t.bF)(u,{label:"管理员信息",value:"admin"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(c,{label:"接收对象",prop:"receivers"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:i.form.receivers,"onUpdate:modelValue":a[1]||(a[1]=e=>i.form.receivers=e),multiple:"",placeholder:"请选择接收对象"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{label:"全体用户",value:"all"}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.users,(e=>((0,t.uX)(),(0,t.Wv)(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(c,{label:"消息标题",prop:"title"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:i.form.title,"onUpdate:modelValue":a[2]||(a[2]=e=>i.form.title=e),placeholder:"请输入消息标题"},null,8,["modelValue"])])),_:1}),(0,t.bF)(c,{label:"消息内容",prop:"content"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:i.form.content,"onUpdate:modelValue":a[3]||(a[3]=e=>i.form.content=e),type:"textarea",rows:6,placeholder:"请输入消息内容"},null,8,["modelValue"])])),_:1}),(0,t.bF)(c,{label:"发送方式",prop:"isSystem"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{modelValue:i.form.isSystem,"onUpdate:modelValue":a[4]||(a[4]=e=>i.form.isSystem=e)},{default:(0,t.k6)((()=>[(0,t.bF)(g,{label:!0},{default:(0,t.k6)((()=>a[8]||(a[8]=[(0,t.eW)("系统自动")]))),_:1}),(0,t.bF)(g,{label:!1},{default:(0,t.k6)((()=>a[9]||(a[9]=[(0,t.eW)("人工发送")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(f,{type:"primary",onClick:i.submitForm},{default:(0,t.k6)((()=>a[10]||(a[10]=[(0,t.eW)("发送")]))),_:1},8,["onClick"]),(0,t.bF)(f,{onClick:i.resetForm},{default:(0,t.k6)((()=>a[11]||(a[11]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1}),(0,t.bF)(k,{class:"message-history"},{header:(0,t.k6)((()=>a[12]||(a[12]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"发送历史")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(h,{data:i.messageHistory,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(y,{prop:"number",label:"单号",width:"180"}),(0,t.bF)(y,{prop:"type",label:"类型",width:"120"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(F,{type:i.getTagType(e.type)},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(i.getTypeText(e.type)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(y,{prop:"title",label:"标题"}),(0,t.bF)(y,{prop:"receivers",label:"接收对象",width:"150"},{default:(0,t.k6)((({row:e})=>[(0,t.eW)((0,r.v_)(i.formatReceivers(e.receivers)),1)])),_:1}),(0,t.bF)(y,{prop:"createTime",label:"发送时间",width:"180"},{default:(0,t.k6)((({row:e})=>[(0,t.eW)((0,r.v_)(i.formatTime(e.createTime)),1)])),_:1}),(0,t.bF)(y,{prop:"isSystem",label:"发送方式",width:"120"},{default:(0,t.k6)((({row:e})=>[(0,t.eW)((0,r.v_)(e.isSystem?"系统自动":"人工发送"),1)])),_:1}),(0,t.bF)(y,{label:"操作",width:"150"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(f,{type:"text",onClick:a=>i.viewDetail(e)},{default:(0,t.k6)((()=>a[13]||(a[13]=[(0,t.eW)("查看")]))),_:2},1032,["onClick"]),(0,t.bF)(f,{type:"text",class:"delete-btn",onClick:a=>i.deleteMessage(e)},{default:(0,t.k6)((()=>a[14]||(a[14]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t.Lk)("div",s,[(0,t.bF)(_,{"current-page":i.currentPage,"onUpdate:currentPage":a[5]||(a[5]=e=>i.currentPage=e),"page-size":i.pageSize,"onUpdate:pageSize":a[6]||(a[6]=e=>i.pageSize=e),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])),_:1})])}var o=l(953),d=l(163),u=l(7918),m=l(6340),c=l(5220);const p={name:"MessageManage",setup(){const e=(0,o.KR)(null),a=(0,o.KR)(1),l=(0,o.KR)(10),t=(0,o.KR)(100),r=(0,c.rd)(),n=(0,o.Kh)({type:"",receivers:[],title:"",content:"",isSystem:!1}),s={type:[{required:!0,message:"请选择消息类型",trigger:"change"}],receivers:[{required:!0,message:"请选择接收对象",trigger:"change"}],title:[{required:!0,message:"请输入消息标题",trigger:"blur"}],content:[{required:!0,message:"请输入消息内容",trigger:"blur"}]},i=(0,o.KR)([{id:1,name:"张三"},{id:2,name:"李四"},{id:3,name:"王五"}]),p=(0,o.KR)([{id:1,number:"CMD20240315001",type:"command",title:"新的指令工单",receivers:["all"],createTime:new Date,isSystem:!0},{id:2,number:"EXP20240315001",type:"exception",title:"异常工单提醒",receivers:[1,2],createTime:new Date(Date.now()-18e5),isSystem:!0},{id:3,number:"VAS20240315001",type:"value-added",title:"增值服务通知",receivers:[3],createTime:new Date(Date.now()-36e5),isSystem:!1}]),g=e=>{const a={command:"指令工单",exception:"异常工单","value-added":"增值服务",announcement:"系统公告",admin:"管理员信息"};return a[e]||"未知类型"},b=e=>{const a={command:"primary",exception:"danger","value-added":"success",announcement:"warning",admin:"info"};return a[e]||""},f=e=>e.includes("all")?"全体用户":e.length+"个用户",v=()=>{e.value.validate((e=>{e&&(d.nk.success("消息发送成功"),k())}))},k=()=>{e.value.resetFields()},y=e=>{r.push({path:"/messages/detail",query:{id:e.id}})},F=e=>{u.s.confirm("确定要删除这条消息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{p.value=p.value.filter((a=>a.id!==e.id)),d.nk.success("删除成功")}))},h=e=>{l.value=e},_=e=>{a.value=e};return{formRef:e,form:n,rules:s,users:i,messageHistory:p,currentPage:a,pageSize:l,total:t,formatTime:m.f,getTypeText:g,getTagType:b,formatReceivers:f,submitForm:v,resetForm:k,viewDetail:y,deleteMessage:F,handleSizeChange:h,handleCurrentChange:_}}};var g=l(6262);const b=(0,g.A)(p,[["render",i],["__scopeId","data-v-6e96cc35"]]),f=b}}]);
//# sourceMappingURL=595.d121acb8.js.map