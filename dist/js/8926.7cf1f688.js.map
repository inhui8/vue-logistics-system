{"version":3,"file":"js/8926.7cf1f688.js","mappings":"qVA0MA,MAAMA,GAAgBC,EAAAA,EAAAA,IAAI,CACxB,CAAEC,GAAI,aAAcC,KAAM,mBAC1B,CAAED,GAAI,aAAcC,KAAM,oBAC1B,CAAED,GAAI,aAAcC,KAAM,oBAGtBC,GAAaH,EAAAA,EAAAA,IAAI,IAEjBI,EAAsBA,CAACC,EAAQ,MACnC,MAAMC,EAAQ,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,KAAM,MAAO,QACzDC,EAAS,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAChFC,EAAW,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAChDC,EAAW,CAAC,OAAQ,UAAW,WAAY,eAC3CC,EAAW,GACXC,EAAM,IAAIC,KACVC,EAAiB,IAAID,KAAKD,EAAIG,cAAgB,EAAGH,EAAII,WAAYJ,EAAIK,WAE3E,IAAK,IAAIC,EAAI,EAAGA,EAAIZ,EAAOY,IAAK,CAC9B,MAAMC,EAAWnB,EAAcoB,MAAMC,KAAKC,MAAMD,KAAKE,SAAWvB,EAAcoB,MAAMI,SACpF,IAAIC,EAAaX,EACbO,KAAKE,SAAW,GAChBE,EAAa,IAAIZ,KAAKD,EAAIc,UAAYL,KAAKC,MAAsB,GAAhBD,KAAKE,SAAgB,GAAK,GAAK,GAAK,MAC9EF,KAAKE,SAAW,KACvBE,EAAa,IAAIZ,KAAKD,EAAIc,UAAYL,KAAKC,MAAsB,IAAhBD,KAAKE,SAAiB,GAAK,GAAK,GAAK,OAG1FZ,EAASgB,KAAK,CACZzB,GAAI,UAAUgB,EAAI,IAClBf,KAAMI,EAAMc,KAAKC,MAAMD,KAAKE,SAAWhB,EAAMiB,SAAWI,OAAOC,aAAa,GAAKX,EAAI,IACrFY,WAAYX,EAASjB,GACrB6B,aAAcZ,EAAShB,KACvB6B,MAAO,GAAGxB,EAAOa,KAAKC,MAAMD,KAAKE,SAAWf,EAAOgB,WAAWI,OAAOP,KAAKE,UAAUU,MAAM,EAAG,MAC7FC,cAAe,KAAKN,OAAOP,KAAKE,UAAUU,MAAM,EAAG,MACnDE,oBAAqB1B,EAASY,KAAKC,MAAMD,KAAKE,SAAWd,EAASe,SAClEY,kBAAmBX,EAAWY,cAAcC,MAAM,KAAK,GACvDC,OAAQ7B,EAASW,KAAKC,MAAMD,KAAKE,SAAWb,EAASc,UAEzD,CACA,OAAOb,CAAQ,EAIX6B,EAAgB,CACpB,CAAEpB,MAAO,OAAQqB,MAAO,MACxB,CAAErB,MAAO,UAAWqB,MAAO,SAC3B,CAAErB,MAAO,WAAYqB,MAAO,OAC5B,CAAErB,MAAO,cAAeqB,MAAO,OAI3BC,GAAaC,EAAAA,EAAAA,IAAS,CAC1Bb,WAAY,GACZ3B,KAAM,GACN6B,MAAO,GACPO,OAAQ,GACRK,qBAAqB,IAGjBC,GAAaF,EAAAA,EAAAA,IAAS,CAC1BG,YAAa,EACbC,SAAU,KAGNC,GAAeC,EAAAA,EAAAA,KAAS,IAAMC,EAAoB9B,MAAMI,SAGxD0B,GAAsBD,EAAAA,EAAAA,KAAS,IAC5B7C,EAAWgB,MAAM+B,QAAOC,IAC7B,MAAMC,GAAgBX,EAAWZ,YAAasB,EAAOtB,aAAeY,EAAWZ,WACzEwB,GAAYZ,EAAWvC,MAAOiD,EAAOjD,KAAKoD,SAASb,EAAWvC,MAC9DqD,GAAad,EAAWV,OAAQoB,EAAOpB,MAAMuB,SAASb,EAAWV,OACjEyB,GAAcf,EAAWH,QAASa,EAAOb,SAAWG,EAAWH,OAC/DmB,GAAchB,EAAWE,qBAAsBe,EAAsBP,EAAOhB,kBAAmB,IACrG,OAAOiB,GAAiBC,GAAaE,GAAcC,GAAeC,CAAW,MAK3EE,GAAqBX,EAAAA,EAAAA,KAAS,KAClC,MAAMY,GAAShB,EAAWC,YAAc,GAAKD,EAAWE,SAClDe,EAAMD,EAAQhB,EAAWE,SAC/B,OAAOG,EAAoB9B,MAAMa,MAAM4B,EAAOC,EAAI,IAI9CC,GAAgB9D,EAAAA,EAAAA,KAAI,GACpB+D,GAAc/D,EAAAA,EAAAA,IAAI,IAClBgE,GAAahE,EAAAA,EAAAA,KAAI,GACjBiE,GAAgBjE,EAAAA,EAAAA,IAAI,MAGpBkE,EAAmB,CACvBjE,GAAI,KACJC,KAAM,GACN2B,WAAY,GACZE,MAAO,GACPE,cAAe,GACfC,oBAAqB,GACrBC,kBAAmB,GACnBG,OAAQ,QAEJ6B,GAAazB,EAAAA,EAAAA,IAAS,IAAKwB,IAG3BE,GAAY1B,EAAAA,EAAAA,IAAS,CACzBb,WAAY,CAAC,CAAEwC,UAAU,EAAMC,QAAS,WAAYC,QAAS,WAC7DrE,KAAM,CAAC,CAAEmE,UAAU,EAAMC,QAAS,WAAYC,QAAS,SACvDxC,MAAO,CAAC,CAAEsC,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACvDtC,cAAe,CAAC,CAAEoC,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAC/DrC,oBAAqB,CAAC,CAAEmC,UAAU,EAAMC,QAAS,UAAWC,QAAS,SACrEpC,kBAAmB,CAAC,CAAEkC,UAAU,EAAMC,QAAS,YAAaC,QAAS,WACrEjC,OAAQ,CAAC,CAAE+B,UAAU,EAAMC,QAAS,QAASC,QAAS,aAKlDC,EAAgBlC,GAAWC,EAAckC,MAAKC,GAAOA,EAAIvD,QAAUmB,KAASE,OAASF,EACrFqC,EAAoBrC,IACxB,OAAQA,GACN,IAAK,OAAQ,MAAO,UACpB,IAAK,UAAW,MAAO,UACvB,IAAK,WAAY,MAAO,UACxB,IAAK,cAAe,MAAO,OAC3B,QAAS,MAAO,OAClB,EAIIoB,EAAwBA,CAAClC,EAAYoD,EAAgB,MACzD,IAAKpD,EAAY,OAAO,EACxB,MAAMqD,EAAQ,IAAIjE,KACZkE,EAAS,IAAIlE,KAAKY,GAClBuD,EAAWD,EAAOrD,UAAYoD,EAAMpD,UACpCuD,EAAW5D,KAAK6D,KAAKF,EAAW,OACtC,OAAOC,GAAY,GAAKA,GAAYJ,CAAa,EAI7CM,EAAeA,KACnBtC,EAAWC,YAAc,CAAC,EAItBsC,EAAoBC,IACxBxC,EAAWE,SAAWsC,EACtBxC,EAAWC,YAAc,CAAC,EAEtBwC,EAAuBC,IAC3B1C,EAAWC,YAAcyC,CAAO,EAI5BC,EAAYA,KAChBC,OAAOC,OAAOtB,EAAYD,IAC1BwB,EAAAA,EAAAA,KAAS,KACPzB,EAAc9C,OAAOwE,eAAe,GACpC,EAIEC,EAAkBA,KACtBL,IACAvB,EAAW7C,OAAQ,EACnB4C,EAAY5C,MAAQ,QACpB2C,EAAc3C,OAAQ,CAAI,EAItB0E,EAAoBC,IACxBP,IACAvB,EAAW7C,OAAQ,EACnB4C,EAAY5C,MAAQ,WACpBuE,EAAAA,EAAAA,KAAS,KACNF,OAAOC,OAAOtB,EAAY4B,KAAKC,MAAMD,KAAKE,UAAUH,IAAM,IAE7DhC,EAAc3C,OAAQ,CAAI,EAItB+E,EAAsBJ,IACzBK,EAAAA,EAAaC,QAAQ,YAAYN,EAAI5F,UAAW,KAAM,CAAEmG,KAAM,YAC3DC,MAAK,KACJC,QAAQC,IAAI,SAAUV,EAAI7F,IAC1B,MAAMwG,EAAQtG,EAAWgB,MAAMuF,WAAUC,GAAKA,EAAE1G,KAAO6F,EAAI7F,MAC5C,IAAXwG,GACFtG,EAAWgB,MAAMyF,OAAOH,EAAO,GAEjCI,EAAAA,GAAUC,QAAQ,OAAO,IAE1BC,OAAM,IAAMF,EAAAA,GAAUG,KAAK,SAAQ,EAInCC,EAAoBA,KACxB1B,IACAzB,EAAc3C,OAAQ,CAAK,EAIvB+F,EAAeC,UACnB,GAAKlD,EAAc9C,MACnB,UACQ8C,EAAc9C,MAAMiG,WAC1B,MAAMtF,EAAe/B,EAAcoB,MAAMsD,MAAK4C,GAAKA,EAAEpH,KAAOkE,EAAWtC,cAAa3B,MAAQ,GACtFoH,EAAa,IAAKnD,EAAYrC,gBAEpC,GAAIkC,EAAW7C,MAAO,CACpBoF,QAAQC,IAAI,SAAUc,GACtB,MAAMb,EAAQtG,EAAWgB,MAAMuF,WAAUC,GAAKA,EAAE1G,KAAOqH,EAAWrH,MACnD,IAAXwG,IACFtG,EAAWgB,MAAMsF,GAASa,GAE5BT,EAAAA,GAAUC,QAAQ,OACpB,KAAO,CACL,MAAMS,EAAY,IAAKD,EAAYrH,GAAI,UAAUW,KAAKD,SACtD4F,QAAQC,IAAI,SAAUe,GACtBpH,EAAWgB,MAAMqG,QAAQD,GACzBV,EAAAA,GAAUC,QAAQ,OACpB,CACAhD,EAAc3C,OAAQ,CACxB,CAAE,MAAOsG,GACPlB,QAAQC,IAAI,UAAWiB,GACvBZ,EAAAA,GAAUY,MAAM,cAClB,G,OAIFC,EAAAA,EAAAA,KAAU,KACRvH,EAAWgB,MAAQf,GAAqB,I,0yPCxa1C,MAAMuH,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,G","sources":["webpack://vue-logistics-system/./src/views/Admin/DriverManagement/DriverList.vue","webpack://vue-logistics-system/./src/views/Admin/DriverManagement/DriverList.vue?6c48"],"sourcesContent":["<template>\r\n  <div class=\"driver-list-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>驾驶员列表</span>\r\n           <el-button type=\"primary\" @click=\"handleAddDriver\">\r\n             <el-icon><Plus /></el-icon> 新增驾驶员\r\n           </el-button>\r\n        </div>\r\n      </template>\r\n\r\n       <!-- 筛选区域 -->\r\n      <el-form :inline=\"true\" :model=\"filterForm\" class=\"filter-form\">\r\n         <el-form-item label=\"供应商\">\r\n            <el-select v-model=\"filterForm.supplierId\" placeholder=\"选择供应商\" clearable filterable>\r\n             <el-option\r\n                v-for=\"supplier in mockSuppliers\" \r\n                :key=\"supplier.id\"\r\n                :label=\"supplier.name\"\r\n                :value=\"supplier.id\"\r\n              />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"驾驶员姓名\">\r\n           <el-input v-model=\"filterForm.name\" placeholder=\"输入姓名\" clearable />\r\n         </el-form-item>\r\n          <el-form-item label=\"联系方式\">\r\n           <el-input v-model=\"filterForm.phone\" placeholder=\"输入手机号\" clearable />\r\n         </el-form-item>\r\n         <el-form-item label=\"状态\">\r\n            <el-select v-model=\"filterForm.status\" placeholder=\"选择状态\" clearable>\r\n              <el-option\r\n                 v-for=\"item in statusOptions\"\r\n                 :key=\"item.value\"\r\n                 :label=\"item.label\"\r\n                 :value=\"item.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n          <el-form-item label=\"驾照到期预警\">\r\n             <el-checkbox v-model=\"filterForm.licenseExpiringSoon\">只看即将到期</el-checkbox>\r\n          </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleSearch\">查询</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 驾驶员列表 -->\r\n      <el-table :data=\"filteredDriverList\" style=\"width: 100%\" border>\r\n         <el-table-column prop=\"name\" label=\"姓名\" width=\"120\" fixed />\r\n         <el-table-column prop=\"supplierName\" label=\"所属供应商\" width=\"200\" show-overflow-tooltip />\r\n         <el-table-column prop=\"phone\" label=\"联系方式\" width=\"130\" />\r\n         <el-table-column prop=\"licenseNumber\" label=\"驾驶证号\" width=\"180\" />\r\n         <el-table-column prop=\"allowedVehicleTypes\" label=\"准驾车型\" width=\"120\" />\r\n          <el-table-column prop=\"licenseExpiryDate\" label=\"驾驶证有效期\" width=\"140\">\r\n             <template #default=\"scope\">\r\n                <span :class=\"{'expiring-soon': isLicenseExpiringSoon(scope.row.licenseExpiryDate)}\">\r\n                  {{ scope.row.licenseExpiryDate }}\r\n                  <el-tooltip v-if=\"isLicenseExpiringSoon(scope.row.licenseExpiryDate)\" content=\"驾照即将到期\" placement=\"top\">\r\n                     <el-icon color=\"#E6A23C\" style=\"margin-left: 5px;\"><Warning /></el-icon>\r\n                  </el-tooltip>\r\n                </span>\r\n             </template>\r\n          </el-table-column>\r\n         <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <el-tag :type=\"getStatusTagType(scope.row.status)\">\r\n                 {{ formatStatus(scope.row.status) }}\r\n               </el-tag>\r\n            </template>\r\n         </el-table-column>\r\n          <el-table-column label=\"操作\" fixed=\"right\" width=\"150\">\r\n           <template #default=\"scope\">\r\n              <el-button text type=\"primary\" size=\"small\" @click=\"handleEditDriver(scope.row)\">编辑</el-button>\r\n              <el-button text type=\"danger\" size=\"small\" @click=\"handleDeleteDriver(scope.row)\">删除</el-button>\r\n           </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n       <!-- 分页 -->\r\n       <el-pagination\r\n          style=\"margin-top: 20px; justify-content: flex-end;\"\r\n          background\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"totalDrivers\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"pagination.pageSize\"\r\n          :current-page=\"pagination.currentPage\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n\r\n       <!-- 新增/编辑驾驶员弹窗 -->\r\n        <el-dialog\r\n          v-model=\"dialogVisible\"\r\n          :title=\"dialogTitle\"\r\n          width=\"60%\"\r\n          @close=\"handleDialogClose\"\r\n          :close-on-click-modal=\"false\"\r\n        >\r\n          <el-form\r\n            ref=\"driverFormRef\"\r\n            :model=\"driverForm\"\r\n            :rules=\"formRules\"\r\n            label-width=\"120px\"\r\n          >\r\n             <el-row :gutter=\"20\">\r\n               <el-col :span=\"12\">\r\n                 <el-form-item label=\"所属供应商\" prop=\"supplierId\">\r\n                    <el-select v-model=\"driverForm.supplierId\" placeholder=\"选择供应商\" filterable style=\"width: 100%;\" :disabled=\"isEditMode\">\r\n                      <el-option\r\n                         v-for=\"supplier in mockSuppliers\" \r\n                         :key=\"supplier.id\"\r\n                         :label=\"supplier.name\"\r\n                         :value=\"supplier.id\"\r\n                       />\r\n                    </el-select>\r\n                 </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                 <el-form-item label=\"驾驶员姓名\" prop=\"name\">\r\n                   <el-input v-model=\"driverForm.name\" placeholder=\"请输入姓名\" />\r\n                 </el-form-item>\r\n               </el-col>\r\n             </el-row>\r\n              <el-row :gutter=\"20\">\r\n               <el-col :span=\"12\">\r\n                 <el-form-item label=\"联系方式\" prop=\"phone\">\r\n                   <el-input v-model=\"driverForm.phone\" placeholder=\"请输入手机号\" />\r\n                 </el-form-item>\r\n               </el-col>\r\n                <el-col :span=\"12\">\r\n                 <el-form-item label=\"状态\" prop=\"status\">\r\n                    <el-select v-model=\"driverForm.status\" placeholder=\"选择状态\" style=\"width: 100%;\">\r\n                      <el-option\r\n                         v-for=\"item in statusOptions\"\r\n                         :key=\"item.value\"\r\n                         :label=\"item.label\"\r\n                         :value=\"item.value\"\r\n                       />\r\n                    </el-select>\r\n                 </el-form-item>\r\n               </el-col>\r\n             </el-row>\r\n              <el-divider>证照信息</el-divider>\r\n              <el-row :gutter=\"20\">\r\n                <el-col :span=\"12\">\r\n                  <el-form-item label=\"驾驶证号\" prop=\"licenseNumber\">\r\n                    <el-input v-model=\"driverForm.licenseNumber\" placeholder=\"请输入驾驶证号\" />\r\n                  </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                  <el-form-item label=\"准驾车型\" prop=\"allowedVehicleTypes\">\r\n                    <el-input v-model=\"driverForm.allowedVehicleTypes\" placeholder=\"如：C1, A2\" />\r\n                  </el-form-item>\r\n                </el-col>\r\n              </el-row>\r\n               <el-row :gutter=\"20\">\r\n                <el-col :span=\"12\">\r\n                  <el-form-item label=\"驾驶证有效期\" prop=\"licenseExpiryDate\">\r\n                     <el-date-picker\r\n                       v-model=\"driverForm.licenseExpiryDate\"\r\n                       type=\"date\"\r\n                       placeholder=\"选择有效期至\"\r\n                       style=\"width: 100%;\"\r\n                       value-format=\"YYYY-MM-DD\"\r\n                      />\r\n                  </el-form-item>\r\n                </el-col>\r\n                 <el-col :span=\"12\">\r\n                  <el-form-item label=\"从业资格证 (占位)\">\r\n                     <el-input disabled placeholder=\"待实现\" />\r\n                  </el-form-item>\r\n                </el-col>\r\n              </el-row>\r\n              <el-row>\r\n                 <el-col :span=\"24\">\r\n                   <el-form-item label=\"相关证照上传\">\r\n                     <el-button link type=\"primary\" disabled>点击上传 (待实现)</el-button>\r\n                   </el-form-item>\r\n                 </el-col>\r\n              </el-row>\r\n          </el-form>\r\n          <template #footer>\r\n            <span class=\"dialog-footer\">\r\n              <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n              <el-button type=\"primary\" @click=\"handleSubmit\">确认</el-button>\r\n            </span>\r\n          </template>\r\n        </el-dialog>\r\n\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, nextTick, onMounted } from 'vue';\r\nimport { ElMessage, ElMessageBox } from 'element-plus';\r\nimport { Plus, Warning } from '@element-plus/icons-vue'; // Import Warning icon\r\n\r\n// --- 模拟数据 ---\r\nconst mockSuppliers = ref([\r\n  { id: 'supplier_1', name: '测试供应商A - 专做提框服务' },\r\n  { id: 'supplier_2', name: '测试供应商B - FBA派送专家' },\r\n  { id: 'supplier_3', name: '测试供应商C - 全能型选手' },\r\n]);\r\n\r\nconst allDrivers = ref([]);\r\n\r\nconst generateMockDrivers = (count = 30) => {\r\n  const names = ['张师傅', '李师傅', '王司机', '赵司机', '孙师傅', '周工', '吴经理', '郑技术员'];\r\n  const phones = ['131', '132', '133', '134', '135', '136', '137', '138', '139', '186', '158'];\r\n  const licenses = ['A1', 'A2', 'A3', 'B1', 'B2', 'C1', 'C2'];\r\n  const statuses = ['idle', 'on_trip', 'on_leave', 'deactivated'];\r\n  const mockData = [];\r\n  const now = new Date();\r\n  const fiveYearsLater = new Date(now.getFullYear() + 5, now.getMonth(), now.getDate());\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const supplier = mockSuppliers.value[Math.floor(Math.random() * mockSuppliers.value.length)];\r\n    let expiryDate = fiveYearsLater; // 默认5年后到期\r\n    if (Math.random() < 0.1) { // 10% 概率即将到期\r\n        expiryDate = new Date(now.getTime() + Math.floor(Math.random() * 40 * 24 * 60 * 60 * 1000)); // 未来40天内随机一天\r\n    } else if (Math.random() < 0.2) { // 20% 概率一年内到期\r\n        expiryDate = new Date(now.getTime() + Math.floor(Math.random() * 365 * 24 * 60 * 60 * 1000));\r\n    }\r\n\r\n    mockData.push({\r\n      id: `driver_${i + 1}`,\r\n      name: names[Math.floor(Math.random() * names.length)] + String.fromCharCode(65 + i % 26),\r\n      supplierId: supplier.id,\r\n      supplierName: supplier.name,\r\n      phone: `${phones[Math.floor(Math.random() * phones.length)]}${String(Math.random()).slice(2, 10)}`,\r\n      licenseNumber: `DL${String(Math.random()).slice(2, 14)}`,\r\n      allowedVehicleTypes: licenses[Math.floor(Math.random() * licenses.length)],\r\n      licenseExpiryDate: expiryDate.toISOString().split('T')[0],\r\n      status: statuses[Math.floor(Math.random() * statuses.length)],\r\n    });\r\n  }\r\n  return mockData;\r\n};\r\n\r\n// --- 选项数据 ---\r\nconst statusOptions = [\r\n  { value: 'idle', label: '空闲' },\r\n  { value: 'on_trip', label: '执行任务中' },\r\n  { value: 'on_leave', label: '休假中' },\r\n  { value: 'deactivated', label: '停用' },\r\n];\r\n\r\n// --- 筛选与分页 ---\r\nconst filterForm = reactive({\r\n  supplierId: '',\r\n  name: '',\r\n  phone: '',\r\n  status: '',\r\n  licenseExpiringSoon: false,\r\n});\r\n\r\nconst pagination = reactive({\r\n  currentPage: 1,\r\n  pageSize: 10,\r\n});\r\n\r\nconst totalDrivers = computed(() => filteredDriversData.value.length);\r\n\r\n// 过滤逻辑\r\nconst filteredDriversData = computed(() => {\r\n  return allDrivers.value.filter(driver => {\r\n    const supplierMatch = filterForm.supplierId ? driver.supplierId === filterForm.supplierId : true;\r\n    const nameMatch = filterForm.name ? driver.name.includes(filterForm.name) : true;\r\n    const phoneMatch = filterForm.phone ? driver.phone.includes(filterForm.phone) : true;\r\n    const statusMatch = filterForm.status ? driver.status === filterForm.status : true;\r\n    const expiryMatch = filterForm.licenseExpiringSoon ? isLicenseExpiringSoon(driver.licenseExpiryDate, 30) : true; // 默认30天内算即将到期\r\n    return supplierMatch && nameMatch && phoneMatch && statusMatch && expiryMatch;\r\n  });\r\n});\r\n\r\n// 分页逻辑\r\nconst filteredDriverList = computed(() => {\r\n  const start = (pagination.currentPage - 1) * pagination.pageSize;\r\n  const end = start + pagination.pageSize;\r\n  return filteredDriversData.value.slice(start, end);\r\n});\r\n\r\n// --- 弹窗与表单 ---\r\nconst dialogVisible = ref(false);\r\nconst dialogTitle = ref('');\r\nconst isEditMode = ref(false);\r\nconst driverFormRef = ref(null);\r\n\r\n// 表单数据模型\r\nconst initialFormState = {\r\n  id: null,\r\n  name: '',\r\n  supplierId: '',\r\n  phone: '',\r\n  licenseNumber: '',\r\n  allowedVehicleTypes: '',\r\n  licenseExpiryDate: '',\r\n  status: 'idle',\r\n};\r\nconst driverForm = reactive({ ...initialFormState });\r\n\r\n// 表单验证规则\r\nconst formRules = reactive({\r\n  supplierId: [{ required: true, message: '请选择所属供应商', trigger: 'change' }],\r\n  name: [{ required: true, message: '请输入驾驶员姓名', trigger: 'blur' }],\r\n  phone: [{ required: true, message: '请输入联系方式', trigger: 'blur' }], // 可加手机号格式验证\r\n  licenseNumber: [{ required: true, message: '请输入驾驶证号', trigger: 'blur' }],\r\n  allowedVehicleTypes: [{ required: true, message: '请输入准驾车型', trigger: 'blur' }],\r\n  licenseExpiryDate: [{ required: true, message: '请选择驾驶证有效期', trigger: 'change' }],\r\n  status: [{ required: true, message: '请选择状态', trigger: 'change' }],\r\n});\r\n\r\n// --- 方法 ---\r\n// 格式化\r\nconst formatStatus = (status) => statusOptions.find(opt => opt.value === status)?.label || status;\r\nconst getStatusTagType = (status) => {\r\n  switch (status) {\r\n    case 'idle': return 'success';\r\n    case 'on_trip': return 'primary';\r\n    case 'on_leave': return 'warning';\r\n    case 'deactivated': return 'info';\r\n    default: return 'info';\r\n  }\r\n};\r\n\r\n// 判断驾照是否即将到期 (默认提前 30 天预警)\r\nconst isLicenseExpiringSoon = (expiryDate, daysThreshold = 30) => {\r\n  if (!expiryDate) return false;\r\n  const today = new Date();\r\n  const expiry = new Date(expiryDate);\r\n  const diffTime = expiry.getTime() - today.getTime();\r\n  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n  return diffDays >= 0 && diffDays <= daysThreshold;\r\n};\r\n\r\n// 搜索\r\nconst handleSearch = () => {\r\n  pagination.currentPage = 1;\r\n};\r\n\r\n// 分页\r\nconst handleSizeChange = (newSize) => {\r\n  pagination.pageSize = newSize;\r\n  pagination.currentPage = 1;\r\n};\r\nconst handleCurrentChange = (newPage) => {\r\n  pagination.currentPage = newPage;\r\n};\r\n\r\n// 重置表单\r\nconst resetForm = () => {\r\n  Object.assign(driverForm, initialFormState);\r\n  nextTick(() => {\r\n    driverFormRef.value?.clearValidate();\r\n  });\r\n};\r\n\r\n// 新增\r\nconst handleAddDriver = () => {\r\n  resetForm();\r\n  isEditMode.value = false;\r\n  dialogTitle.value = '新增驾驶员';\r\n  dialogVisible.value = true;\r\n};\r\n\r\n// 编辑\r\nconst handleEditDriver = (row) => {\r\n  resetForm();\r\n  isEditMode.value = true;\r\n  dialogTitle.value = '编辑驾驶员信息';\r\n  nextTick(() => {\r\n     Object.assign(driverForm, JSON.parse(JSON.stringify(row)));\r\n  });\r\n  dialogVisible.value = true;\r\n};\r\n\r\n// 删除\r\nconst handleDeleteDriver = (row) => {\r\n   ElMessageBox.confirm(`确定要删除驾驶员 ${row.name} 吗?`, '警告', { type: 'warning' })\r\n     .then(() => {\r\n       console.log('删除驾驶员:', row.id);\r\n       const index = allDrivers.value.findIndex(d => d.id === row.id);\r\n       if (index !== -1) {\r\n         allDrivers.value.splice(index, 1);\r\n       }\r\n       ElMessage.success('删除成功');\r\n     })\r\n     .catch(() => ElMessage.info('取消删除'));\r\n};\r\n\r\n// 弹窗关闭\r\nconst handleDialogClose = () => {\r\n  resetForm();\r\n  dialogVisible.value = false;\r\n};\r\n\r\n// 提交\r\nconst handleSubmit = async () => {\r\n  if (!driverFormRef.value) return;\r\n  try {\r\n    await driverFormRef.value.validate();\r\n    const supplierName = mockSuppliers.value.find(s => s.id === driverForm.supplierId)?.name || '';\r\n    const driverData = { ...driverForm, supplierName };\r\n\r\n    if (isEditMode.value) {\r\n      console.log('更新驾驶员:', driverData);\r\n      const index = allDrivers.value.findIndex(d => d.id === driverData.id);\r\n      if (index !== -1) {\r\n        allDrivers.value[index] = driverData;\r\n      }\r\n      ElMessage.success('更新成功');\r\n    } else {\r\n      const newDriver = { ...driverData, id: `driver_${Date.now()}` };\r\n      console.log('新增驾驶员:', newDriver);\r\n      allDrivers.value.unshift(newDriver);\r\n      ElMessage.success('新增成功');\r\n    }\r\n    dialogVisible.value = false;\r\n  } catch (error) {\r\n    console.log('表单验证失败:', error);\r\n    ElMessage.error('请检查表单填写是否正确');\r\n  }\r\n};\r\n\r\n// --- 生命周期 ---\r\nonMounted(() => {\r\n  allDrivers.value = generateMockDrivers();\r\n});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.driver-list-container {\r\n  padding: 20px;\r\n}\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n.filter-form .el-form-item {\r\n  margin-bottom: 10px;\r\n}\r\n.el-table {\r\n  margin-top: 15px;\r\n}\r\n.dialog-footer button:first-child {\r\n  margin-right: 10px;\r\n}\r\n.el-button .el-icon {\r\n  margin-right: 5px;\r\n}\r\n.expiring-soon {\r\n  color: #E6A23C; /* 橙色警告 */\r\n  font-weight: bold;\r\n}\r\n</style> ","import script from \"./DriverList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./DriverList.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./DriverList.vue?vue&type=style&index=0&id=d93252e0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d93252e0\"]])\n\nexport default __exports__"],"names":["mockSuppliers","ref","id","name","allDrivers","generateMockDrivers","count","names","phones","licenses","statuses","mockData","now","Date","fiveYearsLater","getFullYear","getMonth","getDate","i","supplier","value","Math","floor","random","length","expiryDate","getTime","push","String","fromCharCode","supplierId","supplierName","phone","slice","licenseNumber","allowedVehicleTypes","licenseExpiryDate","toISOString","split","status","statusOptions","label","filterForm","reactive","licenseExpiringSoon","pagination","currentPage","pageSize","totalDrivers","computed","filteredDriversData","filter","driver","supplierMatch","nameMatch","includes","phoneMatch","statusMatch","expiryMatch","isLicenseExpiringSoon","filteredDriverList","start","end","dialogVisible","dialogTitle","isEditMode","driverFormRef","initialFormState","driverForm","formRules","required","message","trigger","formatStatus","find","opt","getStatusTagType","daysThreshold","today","expiry","diffTime","diffDays","ceil","handleSearch","handleSizeChange","newSize","handleCurrentChange","newPage","resetForm","Object","assign","nextTick","clearValidate","handleAddDriver","handleEditDriver","row","JSON","parse","stringify","handleDeleteDriver","ElMessageBox","confirm","type","then","console","log","index","findIndex","d","splice","ElMessage","success","catch","info","handleDialogClose","handleSubmit","async","validate","s","driverData","newDriver","unshift","error","onMounted","__exports__"],"sourceRoot":""}