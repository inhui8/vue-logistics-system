"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[3236],{3236:(e,l,n)=>{n.r(l),n.d(l,{default:()=>V});var i=n(641),s=n(33),o=n(953),t=n(163),a=n(8548);const d={class:"rating-rules-container"},u={class:"card-header"},c={key:0},r={class:"indicator-desc"},p={key:0,class:"rule-section"},m={key:0},h={key:1},k={key:1,class:"rule-section"},g={key:2,class:"rule-section"},y={class:"rule-section bonus-penalty"},v={key:1,style:{"text-align":"center",color:"#909399",padding:"20px"}},b={__name:"RatingRulesConfig",setup(e){const l=(0,o.Kh)({dimensions:[]}),n=(0,o.Kh)({}),b=(0,o.KR)(!1),_=(0,o.KR)(null),C=()=>{l.dimensions=[{id:"dim_mock_1",name:"时效性",weight:40,indicators:[{id:"ind_mock_1_1",name:"准时提货率",description:"按约定时间完成提货的比例",weight:50,type:"percentage"},{id:"ind_mock_1_2",name:"准时送达率",description:"按约定时间完成送达的比例",weight:50,type:"percentage"}]},{id:"dim_mock_2",name:"服务质量",weight:30,indicators:[{id:"ind_mock_2_1",name:"货损率",description:"运输过程中货物损坏的比例",weight:40,type:"percentage"},{id:"ind_mock_2_2",name:"客户投诉次数",description:"因服务问题导致客户投诉的次数",weight:30,type:"count"},{id:"ind_mock_2_3",name:"POD返回及时率",description:"签收单按时返回的比例",weight:30,type:"percentage"}]},{id:"dim_mock_4",name:"合规与配合度",weight:10,indicators:[{id:"ind_mock_4_1",name:"证照过期次数",description:"车辆、司机证照过期的次数",weight:50,type:"count"},{id:"ind_mock_4_2",name:"系统操作出错次数",description:"供应商门户系统操作错误的次数",weight:50,type:"count"}]}],l.dimensions.length>0&&(_.value=l.dimensions[0].id),l.dimensions.forEach((e=>{e.indicators.forEach((e=>{n[e.id]||(n[e.id]={levels:[],bonusPenalties:[]}),"percentage"===e.type?e.name.includes("率")&&!e.name.includes("货损")?n[e.id].levels=[{threshold:98,score:100},{threshold:95,score:90},{threshold:90,score:80},{threshold:80,score:60}]:n[e.id].levels=[{threshold:1,score:80},{threshold:3,score:60},{threshold:5,score:40}]:"count"===e.type&&(n[e.id].levels=[{threshold:0,score:100},{threshold:1,score:80},{threshold:3,score:60}]),x(e.id),e.name.includes("送达率")&&(n[e.id].bonusPenalties=[{condition:"连续3个周期达标",type:"bonus",value:5}]),e.name.includes("投诉")&&(n[e.id].bonusPenalties=[{condition:"发生重大投诉事件",type:"penalty",value:20}])}))}))},V=e=>"percentage"===e.type||e.name.includes("率"),F=e=>"count"===e.type||e.name.includes("次数"),f=e=>V(e)&&!e.name.includes("货损"),x=e=>{if(!n[e]||!n[e].levels)return;const l=L(e);l&&f(l)?n[e].levels.sort(((e,l)=>l.threshold-e.threshold)):n[e].levels.sort(((e,l)=>e.threshold-l.threshold))},w=e=>(n[e]||(n[e]={levels:[],bonusPenalties:[]}),x(e),n[e].levels),W=e=>(n[e]||(n[e]={levels:[],bonusPenalties:[]}),n[e].bonusPenalties),E=e=>{n[e]||(n[e]={levels:[],bonusPenalties:[]});const l=L(e);let i=0;l&&f(l)&&(i=70),n[e].levels.push({threshold:i,score:0}),x(e)},X=(e,l)=>{n[e]&&n[e].levels&&n[e].levels.splice(l,1)},U=e=>{n[e]||(n[e]={levels:[],bonusPenalties:[]}),n[e].bonusPenalties.push({condition:"",type:"bonus",value:0})},P=(e,l)=>{n[e]&&n[e].bonusPenalties&&n[e].bonusPenalties.splice(l,1)},L=e=>{for(const n of l.dimensions){const l=n.indicators.find((l=>l.id===e));if(l)return l}return null},z=()=>{b.value=!0,console.log("保存评分规则:",JSON.parse(JSON.stringify(n))),setTimeout((()=>{b.value=!1,t.nk.success("评分规则已保存")}),1e3)};return(0,i.sV)((()=>{C()})),(e,n)=>{const t=(0,i.g2)("el-button"),C=(0,i.g2)("el-alert"),x=(0,i.g2)("el-input-number"),L=(0,i.g2)("el-input"),R=(0,i.g2)("el-option"),K=(0,i.g2)("el-select"),I=(0,i.g2)("el-divider"),O=(0,i.g2)("el-tab-pane"),J=(0,i.g2)("el-tabs"),N=(0,i.g2)("el-card");return(0,i.uX)(),(0,i.CE)("div",d,[(0,i.bF)(N,null,{header:(0,i.k6)((()=>[(0,i.Lk)("div",u,[n[2]||(n[2]=(0,i.Lk)("span",null,"评分规则配置 (基于指标)",-1)),(0,i.bF)(t,{type:"primary",onClick:z,loading:b.value},{default:(0,i.k6)((()=>n[1]||(n[1]=[(0,i.eW)("保存规则")]))),_:1},8,["loading"])])])),default:(0,i.k6)((()=>[(0,i.bF)(C,{title:"配置说明",type:"info","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}},{default:(0,i.k6)((()=>n[3]||(n[3]=[(0,i.eW)(" 在此为评分指标设定具体的得分标准、奖励和惩罚规则。这些规则将用于计算每个供应商在每个评分周期的实际得分。 ")]))),_:1}),(0,i.bF)(J,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=e=>_.value=e),class:"dimension-tabs"},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.dimensions,(e=>((0,i.uX)(),(0,i.Wv)(O,{key:e.id,label:e.name||"未命名维度",name:e.id},{default:(0,i.k6)((()=>[e.indicators&&e.indicators.length>0?((0,i.uX)(),(0,i.CE)("div",c,[(0,i.Lk)("h4",null,'指标 "'+(0,s.v_)(e.name)+'" 的评分规则',1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.indicators,(l=>((0,i.uX)(),(0,i.CE)("div",{key:l.id,class:"indicator-rules-block"},[(0,i.Lk)("h5",null,(0,s.v_)(l.name)+" ("+(0,s.v_)(l.weight)+"%)",1),(0,i.Lk)("p",r,(0,s.v_)(l.description),1),V(l)?((0,i.uX)(),(0,i.CE)("div",p,[n[9]||(n[9]=(0,i.Lk)("h6",null,"评分标准 (百分比型)",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w(l.id),((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"rule-level"},[n[4]||(n[4]=(0,i.eW)(" 当指标值 ")),f(l)?((0,i.uX)(),(0,i.CE)("span",m,">=")):((0,i.uX)(),(0,i.CE)("span",h,"<=")),n[5]||(n[5]=(0,i.eW)()),(0,i.bF)(x,{modelValue:e.threshold,"onUpdate:modelValue":l=>e.threshold=l,size:"small",min:0,max:100,step:1,"controls-position":"right",style:{width:"100px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"]),n[6]||(n[6]=(0,i.eW)(" % 时，得 ")),(0,i.bF)(x,{modelValue:e.score,"onUpdate:modelValue":l=>e.score=l,size:"small",min:0,max:100,step:5,"controls-position":"right",style:{width:"100px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"]),n[7]||(n[7]=(0,i.eW)(" 分 ")),(0,i.bF)(t,{type:"danger",icon:(0,o.R1)(a.epd),plain:"",circle:"",size:"small",onClick:e=>X(l.id,s),style:{"margin-left":"10px"}},null,8,["icon","onClick"])])))),128)),(0,i.bF)(t,{type:"primary",link:"",icon:(0,o.R1)(a.FWt),onClick:e=>E(l.id)},{default:(0,i.k6)((()=>n[8]||(n[8]=[(0,i.eW)("添加评分档位")]))),_:2},1032,["icon","onClick"])])):F(l)?((0,i.uX)(),(0,i.CE)("div",k,[n[14]||(n[14]=(0,i.Lk)("h6",null,"评分标准 (计数型/频率型)",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w(l.id),((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"rule-level"},[n[10]||(n[10]=(0,i.eW)(" 当指标值 <= ")),(0,i.bF)(x,{modelValue:e.threshold,"onUpdate:modelValue":l=>e.threshold=l,size:"small",min:0,step:1,"controls-position":"right",style:{width:"100px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"]),n[11]||(n[11]=(0,i.eW)(" 次/个 时，得 ")),(0,i.bF)(x,{modelValue:e.score,"onUpdate:modelValue":l=>e.score=l,size:"small",min:0,max:100,step:5,"controls-position":"right",style:{width:"100px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"]),n[12]||(n[12]=(0,i.eW)(" 分 ")),(0,i.bF)(t,{type:"danger",icon:(0,o.R1)(a.epd),plain:"",circle:"",size:"small",onClick:e=>X(l.id,s),style:{"margin-left":"10px"}},null,8,["icon","onClick"])])))),128)),(0,i.bF)(t,{type:"primary",link:"",icon:(0,o.R1)(a.FWt),onClick:e=>E(l.id)},{default:(0,i.k6)((()=>n[13]||(n[13]=[(0,i.eW)("添加评分档位")]))),_:2},1032,["icon","onClick"])])):((0,i.uX)(),(0,i.CE)("div",g,n[15]||(n[15]=[(0,i.Lk)("h6",null,"评分标准 (其他类型 - 待实现具体配置方式)",-1),(0,i.Lk)("p",{style:{color:"#909399"}},"例如：布尔型 (是/否)，或需要更复杂逻辑的指标。",-1)]))),(0,i.Lk)("div",y,[n[20]||(n[20]=(0,i.Lk)("h6",null,"附加奖惩规则 (可选)",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(W(l.id),((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"bonus-penalty-rule"},[n[16]||(n[16]=(0,i.eW)(" 当 ")),(0,i.bF)(L,{modelValue:e.condition,"onUpdate:modelValue":l=>e.condition=l,placeholder:"触发条件描述",size:"small",style:{width:"250px","margin-right":"10px"}},null,8,["modelValue","onUpdate:modelValue"]),n[17]||(n[17]=(0,i.eW)(" 时， ")),(0,i.bF)(K,{modelValue:e.type,"onUpdate:modelValue":l=>e.type=l,placeholder:"类型",size:"small",style:{width:"100px",margin:"0 5px"}},{default:(0,i.k6)((()=>[(0,i.bF)(R,{label:"加分",value:"bonus"}),(0,i.bF)(R,{label:"扣分",value:"penalty"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,i.bF)(x,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,size:"small",min:0,step:1,"controls-position":"right",style:{width:"100px",margin:"0 5px"}},null,8,["modelValue","onUpdate:modelValue"]),n[18]||(n[18]=(0,i.eW)(" 分 ")),(0,i.bF)(t,{type:"danger",icon:(0,o.R1)(a.epd),plain:"",circle:"",size:"small",onClick:e=>P(l.id,s),style:{"margin-left":"10px"}},null,8,["icon","onClick"])])))),128)),(0,i.bF)(t,{type:"primary",link:"",icon:(0,o.R1)(a.FWt),onClick:e=>U(l.id)},{default:(0,i.k6)((()=>n[19]||(n[19]=[(0,i.eW)("添加奖惩规则")]))),_:2},1032,["icon","onClick"])]),l!==e.indicators[e.indicators.length-1]?((0,i.uX)(),(0,i.Wv)(I,{key:3})):(0,i.Q3)("",!0)])))),128))])):((0,i.uX)(),(0,i.CE)("div",v,' 请先在"指标配置"页面为该维度添加指标。 '))])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])])),_:1})])}}};var _=n(6262);const C=(0,_.A)(b,[["__scopeId","data-v-6eeedf07"]]),V=C}}]);
//# sourceMappingURL=3236.a797c19c.js.map