"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[89],{616:(e,l,a)=>{a.d(l,{A:()=>k});var t=a(641);const o={class:"upload-pod-container"},i={class:"form-item"},n={class:"upload-area"},r={class:"upload-boxes"},u={class:"upload-box"},s={class:"upload-box"},d={class:"dialog-footer"};function p(e,l,a,p,c,m){const v=(0,t.g2)("el-date-picker"),b=(0,t.g2)("el-button"),g=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(g,{title:"更新签收",modelValue:p.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>p.dialogVisible=e),width:"600px","close-on-click-modal":!1,onClose:p.handleClose},{footer:(0,t.k6)((()=>[(0,t.Lk)("div",d,[(0,t.bF)(b,{onClick:p.handleClose},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("取消")]))),_:1},8,["onClick"]),(0,t.bF)(b,{type:"primary",onClick:p.handleSubmit,loading:p.uploading},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("确定")]))),_:1},8,["onClick","loading"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",o,[(0,t.Lk)("div",i,[l[6]||(l[6]=(0,t.Lk)("label",{class:"label"},"签收时间：",-1)),(0,t.bF)(v,{modelValue:p.receiveTime,"onUpdate:modelValue":l[0]||(l[0]=e=>p.receiveTime=e),type:"datetime",placeholder:"请选择日期时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",class:"date-picker"},null,8,["modelValue"])]),(0,t.Lk)("div",n,[l[9]||(l[9]=(0,t.Lk)("label",{class:"label"},"POD文件：",-1)),(0,t.Lk)("div",r,[(0,t.Lk)("div",u,[(0,t.Lk)("div",{class:"upload-content",onClick:l[1]||(l[1]=(...e)=>p.handleIsaUpload&&p.handleIsaUpload(...e))},l[7]||(l[7]=[(0,t.Lk)("i",{class:"el-icon-upload"},null,-1),(0,t.Lk)("p",{class:"upload-text"},"将ISA文件拖到此处，或点击上传",-1)])),(0,t.Lk)("input",{ref:"isaFileInput",type:"file",style:{display:"none"},onChange:l[2]||(l[2]=(...e)=>p.handleIsaFileChange&&p.handleIsaFileChange(...e)),accept:".pdf,.jpg,.jpeg,.png"},null,544)]),(0,t.Lk)("div",s,[(0,t.Lk)("div",{class:"upload-content",onClick:l[3]||(l[3]=(...e)=>p.handleBolUpload&&p.handleBolUpload(...e))},l[8]||(l[8]=[(0,t.Lk)("i",{class:"el-icon-upload"},null,-1),(0,t.Lk)("p",{class:"upload-text"},"将BOL文件拖到此处，或点击上传",-1)])),(0,t.Lk)("input",{ref:"bolFileInput",type:"file",style:{display:"none"},onChange:l[4]||(l[4]=(...e)=>p.handleBolFileChange&&p.handleBolFileChange(...e)),accept:".pdf,.jpg,.jpeg,.png"},null,544)])])])])])),_:1},8,["modelValue","onClose"])}var c=a(953),m=a(163);const v={name:"UploadPodDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","submit","cancel"],setup(e,{emit:l}){const a=(0,c.KR)(e.visible),o=(0,c.KR)(""),i=(0,c.KR)(null),n=(0,c.KR)(null),r=(0,c.KR)(null),u=(0,c.KR)(null),s=(0,c.KR)(!1);(0,t.wB)((()=>e.visible),(e=>{a.value=e}));const d=()=>{i.value.click()},p=()=>{n.value.click()},v=e=>{const l=e.target.files[0];l&&(r.value=l,m.nk.success(`已选择ISA文件: ${l.name}`))},b=e=>{const l=e.target.files[0];l&&(u.value=l,m.nk.success(`已选择BOL文件: ${l.name}`))},g=()=>{a.value=!1,l("update:visible",!1),l("cancel"),o.value="",r.value=null,u.value=null,i.value&&(i.value.value=""),n.value&&(n.value.value="")},k=async()=>{if(o.value)if(r.value||u.value){s.value=!0;try{const e=new FormData;e.append("receiveTime",o.value),r.value&&e.append("isaFile",r.value),u.value&&e.append("bolFile",u.value),l("submit",e),g()}catch(e){console.error("上传失败:",e),m.nk.error("上传失败，请重试")}finally{s.value=!1}}else m.nk.warning("请至少上传一个POD文件");else m.nk.warning("请选择签收时间")};return{dialogVisible:a,receiveTime:o,isaFileInput:i,bolFileInput:n,uploading:s,handleIsaUpload:d,handleBolUpload:p,handleIsaFileChange:v,handleBolFileChange:b,handleClose:g,handleSubmit:k}}};var b=a(6262);const g=(0,b.A)(v,[["render",p],["__scopeId","data-v-37de2916"]]),k=g},4089:(e,l,a)=>{a.r(l),a.d(l,{default:()=>ge});var t=a(641),o=a(3751),i=a(33);const n={class:"delivery-trains-container"},r={class:"filter-bar"},u={class:"filter-row"},s={class:"date-buttons"},d={class:"action-buttons"},p={class:"view-management"},c={class:"table-container"},m={class:"sub-table-container"},v={key:0,class:"group-name"},b={key:1},g={key:0,class:"cell-editor"},k=["onClick"],h=["onClick"],f={key:1},y=["onClick"],w={key:1},C={key:4},F={class:"view-options-menu"},V={class:"group-settings"},S={class:"group-level"},_={class:"group-level"},T={class:"group-level"},x={class:"dialog-footer"},L={class:"sort-settings"},W={class:"sort-actions"},R={class:"dialog-footer"},U={class:"column-settings"},D={class:"column-settings-header"},K={class:"column-list"},N={class:"column-item"},$={class:"dialog-footer"},A={key:0},E={key:1},P={key:2},M={class:"dialog-footer"},O={class:"dialog-footer"},X={class:"follow-up-container"},I={class:"follow-up-history"},z={class:"follow-up-item"},q={class:"follow-up-content"},B={class:"follow-up-operator"},G={class:"dialog-footer"},H={class:"history-item"},Q={class:"history-content"},Y={class:"history-operator"};function j(e,l,a,j,J,Z){const ee=(0,t.g2)("el-option"),le=(0,t.g2)("el-select"),ae=(0,t.g2)("el-date-picker"),te=(0,t.g2)("el-input"),oe=(0,t.g2)("el-button"),ie=(0,t.g2)("el-radio-button"),ne=(0,t.g2)("el-radio-group"),re=(0,t.g2)("el-table-column"),ue=(0,t.g2)("el-table"),se=(0,t.g2)("el-tag"),de=(0,t.g2)("el-dropdown-item"),pe=(0,t.g2)("el-dropdown-menu"),ce=(0,t.g2)("el-dropdown"),me=(0,t.g2)("groupable-table"),ve=(0,t.g2)("filter-panel"),be=(0,t.g2)("el-form-item"),ge=(0,t.g2)("el-checkbox"),ke=(0,t.g2)("el-checkbox-group"),he=(0,t.g2)("el-form"),fe=(0,t.g2)("el-dialog"),ye=(0,t.g2)("d-arrow-left"),we=(0,t.g2)("el-icon"),Ce=(0,t.g2)("draggable"),Fe=(0,t.g2)("el-radio"),Ve=(0,t.g2)("el-timeline-item"),Se=(0,t.g2)("el-timeline"),_e=(0,t.g2)("upload-pod-dialog"),Te=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",r,[(0,t.Lk)("div",u,[(0,t.bF)(le,{modelValue:j.warehouse,"onUpdate:modelValue":l[0]||(l[0]=e=>j.warehouse=e),placeholder:"美西二号仓",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{label:"美西二号仓",value:"west2"}),(0,t.bF)(ee,{label:"美西一号仓",value:"west1"}),(0,t.bF)(ee,{label:"新泽西一号仓",value:"east1"}),(0,t.bF)(ee,{label:"萨凡纳二号仓",value:"east2"}),(0,t.bF)(ee,{label:"达拉斯三号仓",value:"east3"})])),_:1},8,["modelValue"]),(0,t.bF)(le,{modelValue:j.createDateType,"onUpdate:modelValue":l[1]||(l[1]=e=>j.createDateType=e),placeholder:"ETA",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{label:"ETA",value:"eta"}),(0,t.bF)(ee,{label:"提柜时间",value:"issue"}),(0,t.bF)(ee,{label:"抵仓时间",value:"appointment"}),(0,t.bF)(ee,{label:"预计拆柜时间",value:"expectedUnloading"}),(0,t.bF)(ee,{label:"拆柜完成时间",value:"unloading"})])),_:1},8,["modelValue"]),(0,t.Lk)("div",s,[(0,t.bF)(ae,{modelValue:j.dateRange,"onUpdate:modelValue":l[2]||(l[2]=e=>j.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small",class:"date-range-picker",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,t.bF)(le,{modelValue:j.searchType,"onUpdate:modelValue":l[3]||(l[3]=e=>j.searchType=e),placeholder:"部分模糊搜索",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{label:"部分模糊搜索",value:"trainNumber"}),(0,t.bF)(ee,{label:"柜号",value:"containerNo"}),(0,t.bF)(ee,{label:"SO号",value:"soNumber"}),(0,t.bF)(ee,{label:"货件编号",value:"shipmentNumber"}),(0,t.bF)(ee,{label:"追踪编号",value:"trackingNumber"})])),_:1},8,["modelValue"]),(0,t.bF)(te,{placeholder:"MEMO/跟进记录/ref/zip_code等",modelValue:j.searchText,"onUpdate:modelValue":l[4]||(l[4]=e=>j.searchText=e),size:"small",class:"search-input","prefix-icon":"el-icon-search"},null,8,["modelValue"]),(0,t.Lk)("div",d,[(0,t.bF)(oe,{type:"primary",size:"small",onClick:j.handleSearch},{default:(0,t.k6)((()=>l[56]||(l[56]=[(0,t.eW)("查询")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{size:"small",type:"warning",onClick:l[5]||(l[5]=e=>j.handleBatchOperation("followUp"))},{default:(0,t.k6)((()=>l[57]||(l[57]=[(0,t.eW)("批量跟进")]))),_:1}),(0,t.bF)(oe,{size:"small",type:"warning",onClick:l[6]||(l[6]=e=>j.handleBatchOperation("memo"))},{default:(0,t.k6)((()=>l[58]||(l[58]=[(0,t.eW)("批量MEMO")]))),_:1}),(0,t.bF)(oe,{size:"small",type:"warning",onClick:l[7]||(l[7]=e=>j.handleBatchOperation("createPC"))},{default:(0,t.k6)((()=>l[59]||(l[59]=[(0,t.eW)("创建PC")]))),_:1}),(0,t.bF)(oe,{size:"small"},{default:(0,t.k6)((()=>l[60]||(l[60]=[(0,t.eW)("导出列表")]))),_:1})])])]),(0,t.Lk)("div",p,[l[71]||(l[71]=(0,t.Lk)("span",{class:"view-label"},null,-1)),(0,t.bF)(ne,{modelValue:j.currentView,"onUpdate:modelValue":l[8]||(l[8]=e=>j.currentView=e),size:"small",class:"status-view-group"},{default:(0,t.k6)((()=>[(0,t.bF)(ie,{value:"all"},{default:(0,t.k6)((()=>l[61]||(l[61]=[(0,t.eW)("全部(0)")]))),_:1}),(0,t.bF)(ie,{value:"pending"},{default:(0,t.k6)((()=>l[62]||(l[62]=[(0,t.eW)("待处理(0)")]))),_:1}),(0,t.bF)(ie,{value:"processing"},{default:(0,t.k6)((()=>l[63]||(l[63]=[(0,t.eW)("处理中(0)")]))),_:1}),(0,t.bF)(ie,{value:"completed"},{default:(0,t.k6)((()=>l[64]||(l[64]=[(0,t.eW)("已完成(0)")]))),_:1}),(0,t.bF)(ie,{value:"cancelled"},{default:(0,t.k6)((()=>l[65]||(l[65]=[(0,t.eW)("已取消(0)")]))),_:1}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.customViews,(e=>((0,t.uX)(),(0,t.Wv)(ie,{key:e.id,label:e.id,onContextmenu:(0,o.D$)((l=>j.handleContextMenu(l,e)),["prevent"])},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.name),1)])),_:2},1032,["label","onContextmenu"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)(oe,{type:"text",size:"small",onClick:j.handleSaveView},{default:(0,t.k6)((()=>l[66]||(l[66]=[(0,t.eW)("新增视图")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{type:"text",size:"small",onClick:j.showGroupModal},{default:(0,t.k6)((()=>l[67]||(l[67]=[(0,t.eW)("高级分组")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{type:"text",size:"small",onClick:j.showSortModal},{default:(0,t.k6)((()=>l[68]||(l[68]=[(0,t.eW)("高级排序")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{type:"text",size:"small",onClick:j.showFilterPanel},{default:(0,t.k6)((()=>l[69]||(l[69]=[(0,t.eW)("筛选")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{type:"text",size:"small",onClick:j.showColumnSettings},{default:(0,t.k6)((()=>l[70]||(l[70]=[(0,t.eW)("字段配置")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",c,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(me,{ref:"mainTable",data:j.displayData,"row-key":"id","group-fields":j.groupField?[j.groupField]:[],"show-selection":!0,"show-group-column":!!j.groupField,"group-column-label":j.groupField?j.getGroupColumnLabel(j.groupField):"分组","default-expand-all":!1,"show-pagination":!0,"current-page":j.currentPage,"page-size":j.pageSize,"page-sizes":[10,20,50,100],total:j.total,onSelectionChange:j.handleSelectionChange,onSizeChange:j.handleSizeChange,onCurrentChange:j.handleCurrentChange,onCellClick:j.handleCellClick,onCellDblclick:j.handleCellDbClick,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(re,{type:"expand"},{default:(0,t.k6)((e=>[(0,t.Lk)("div",m,[l[72]||(l[72]=(0,t.Lk)("h4",{class:"sub-table-title"},"预约信息",-1)),(0,t.bF)(ue,{data:e.row.children||[],border:"",size:"small",stripe:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.childColumns,(e=>((0,t.uX)(),(0,t.Wv)(re,{key:e.prop,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},null,8,["prop","label","width","sortable"])))),128))])),_:2},1032,["data"])])])),_:1}),j.hasGroupedData?((0,t.uX)(),(0,t.Wv)(re,{key:0,label:"分组信息",width:"200"},{default:(0,t.k6)((e=>[e.row.isGroup?((0,t.uX)(),(0,t.CE)("span",v,[(0,t.bF)(se,{type:j.getGroupTagType(e.row.groupLevel)},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.row.groupName)+" ("+(0,i.v_)(e.row.count||0)+") ",1)])),_:2},1032,["type"])])):((0,t.uX)(),(0,t.CE)("span",b,"-"))])),_:1})):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.tableColumns,(e=>((0,t.uX)(),(0,t.CE)(t.FK,{key:e.prop},[!1!==e.visible&&"loadingStatus"===e.prop?((0,t.uX)(),(0,t.Wv)(re,{key:0,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,t.k6)((e=>[(0,t.bF)(se,{type:j.getStatusTagType(e.row.loadingStatus),effect:"plain",size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.row.loadingStatus),1)])),_:2},1032,["type"])])),_:2},1032,["prop","label","width","sortable"])):!1!==e.visible&&"operation"===e.prop?((0,t.uX)(),(0,t.Wv)(re,{key:1,label:e.label,width:e.width,fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(oe,{type:"text",size:"small",onClick:l=>j.handleDetail(e.row)},{default:(0,t.k6)((()=>l[73]||(l[73]=[(0,t.eW)("详情")]))),_:2},1032,["onClick"]),(0,t.bF)(ce,{size:"small",onCommand:l=>j.handleCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(pe,null,{default:(0,t.k6)((()=>[(0,t.bF)(de,{command:"palletDetail"},{default:(0,t.k6)((()=>l[75]||(l[75]=[(0,t.eW)("卡板明细")]))),_:1}),(0,t.bF)(de,{command:"copyAddress"},{default:(0,t.k6)((()=>l[76]||(l[76]=[(0,t.eW)("复制地址信息")]))),_:1}),(0,t.bF)(de,{command:"followUp"},{default:(0,t.k6)((()=>l[77]||(l[77]=[(0,t.eW)("跟进记录")]))),_:1}),(0,t.bF)(de,{command:"memo"},{default:(0,t.k6)((()=>l[78]||(l[78]=[(0,t.eW)("MEMO")]))),_:1}),(0,t.bF)(de,{command:"markException"},{default:(0,t.k6)((()=>l[79]||(l[79]=[(0,t.eW)("标记异常")]))),_:1}),(0,t.bF)(de,{command:"uploadPod"},{default:(0,t.k6)((()=>l[80]||(l[80]=[(0,t.eW)("上传POD")]))),_:1}),(0,t.bF)(de,{command:"history"},{default:(0,t.k6)((()=>l[81]||(l[81]=[(0,t.eW)("历史记录")]))),_:1}),(0,t.bF)(de,{command:"detail"},{default:(0,t.k6)((()=>l[82]||(l[82]=[(0,t.eW)("详情")]))),_:1}),(0,t.bF)(de,{command:"expense"},{default:(0,t.k6)((()=>l[83]||(l[83]=[(0,t.eW)("费用明细")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(oe,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[74]||(l[74]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:2},1032,["label","width"])):!1!==e.visible?((0,t.uX)(),(0,t.Wv)(re,{key:2,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,t.k6)((a=>[["address","city","state","zipCode","deliveryArea","appointmentNumber","deliveryAppointmentTime","deliveryTime","deliveryCompany","deliveryDriver","driverPhone","appointmentStatus","tags","followUpRecord","remarks","internalRemarks","quotationLianyu","shippingMark","platformQuotation"].includes(e.prop)&&j.editingCell.rowIndex===a.$index&&j.editingCell.prop===e.prop?((0,t.uX)(),(0,t.CE)("div",g,[["appointmentStatus","tags"].includes(e.prop)?((0,t.uX)(),(0,t.Wv)(le,{key:0,modelValue:j.editingCell.value,"onUpdate:modelValue":l[9]||(l[9]=e=>j.editingCell.value=e),size:"small",onBlur:l=>j.saveEdit(a.row,e.prop),onKeyup:(0,o.jR)((l=>j.saveEdit(a.row,e.prop)),["enter"]),style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.getOptionsForColumn(e.prop),(e=>((0,t.uX)(),(0,t.Wv)(ee,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onBlur","onKeyup"])):((0,t.uX)(),(0,t.Wv)(te,{key:1,modelValue:j.editingCell.value,"onUpdate:modelValue":l[10]||(l[10]=e=>j.editingCell.value=e),size:"small",onBlur:l=>j.saveEdit(a.row,e.prop),onKeyup:(0,o.jR)((l=>j.saveEdit(a.row,e.prop)),["enter"]),type:["zipCode","boxCount","weight","volume","palletCount"].includes(e.prop)?"number":"text"},null,8,["modelValue","onBlur","onKeyup","type"]))])):["address","city","state","zipCode","deliveryArea","appointmentNumber","deliveryAppointmentTime","deliveryTime","deliveryCompany","deliveryDriver","driverPhone","followUpRecord","remarks","internalRemarks","quotationLianyu","shippingMark","platformQuotation"].includes(e.prop)?((0,t.uX)(),(0,t.CE)("div",{key:1,class:"editable-cell",onClick:l=>j.handleCellClick(a.row,e,a.$el)},(0,i.v_)(a.row[e.prop]||"-"),9,k)):"appointmentStatus"===e.prop?((0,t.uX)(),(0,t.CE)("div",{key:2,class:"editable-cell tag-cell",onClick:l=>j.handleCellClick(a.row,e,a.$el)},[a.row.appointmentStatus?((0,t.uX)(),(0,t.Wv)(se,{key:0,type:j.getAppointmentStatusType(a.row.appointmentStatus),closable:"",onClose:e=>j.removeAppointmentStatus(a.row),size:"small"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(a.row.appointmentStatus),1)])),_:2},1032,["type","onClose"])):((0,t.uX)(),(0,t.CE)("span",f,"未设置"))],8,h)):"tags"===e.prop?((0,t.uX)(),(0,t.CE)("div",{key:3,class:"editable-cell tag-cell",onClick:l=>j.handleCellClick(a.row,e,a.$el)},[a.row.tags?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)("string"===typeof a.row.tags?a.row.tags.split(","):[a.row.tags],((e,l)=>((0,t.uX)(),(0,t.Wv)(se,{key:l,type:j.getTagType(e),closable:"",onClose:l=>j.removeTag(a.row,e),size:"small",style:{margin:"2px"}},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e),1)])),_:2},1032,["type","onClose"])))),128)):((0,t.uX)(),(0,t.CE)("span",w,"未设置"))],8,y)):((0,t.uX)(),(0,t.CE)("span",C,(0,i.v_)(a.row[e.prop]),1))])),_:2},1032,["prop","label","width","sortable"])):(0,t.Q3)("",!0)],64)))),128))])),_:1},8,["data","group-fields","show-group-column","group-column-label","current-page","page-size","total","onSelectionChange","onSizeChange","onCurrentChange","onCellClick","onCellDblclick"])),[[Te,j.loading]])]),(0,t.bF)(ve,{visible:j.filterPanelVisible,"onUpdate:visible":l[11]||(l[11]=e=>j.filterPanelVisible=e),columns:j.tableColumns,"existing-filters":j.activeFilters,"existing-logic":j.filterLogic,onApplyFilters:j.applyFilters,onCancel:j.cancelFilters},null,8,["visible","columns","existing-filters","existing-logic","onApplyFilters","onCancel"]),(0,t.bF)(fe,{title:"保存视图",modelValue:j.saveViewDialogVisible,"onUpdate:modelValue":l[15]||(l[15]=e=>j.saveViewDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)(oe,{onClick:l[14]||(l[14]=e=>j.saveViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[84]||(l[84]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.saveView},{default:(0,t.k6)((()=>l[85]||(l[85]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(he,{model:j.viewForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"视图名称",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(te,{modelValue:j.viewForm.name,"onUpdate:modelValue":l[12]||(l[12]=e=>j.viewForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(be,{label:"显示字段"},{default:(0,t.k6)((()=>[(0,t.bF)(ke,{modelValue:j.viewForm.columns,"onUpdate:modelValue":l[13]||(l[13]=e=>j.viewForm.columns=e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.tableColumns,(e=>((0,t.uX)(),(0,t.Wv)(ge,{key:e.prop,label:e.prop},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"视图操作",modelValue:j.viewOptionsDialogVisible,"onUpdate:modelValue":l[19]||(l[19]=e=>j.viewOptionsDialogVisible=e),width:"300px"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",F,[(0,t.Lk)("div",{class:"view-option-item",onClick:l[16]||(l[16]=(...e)=>j.handleRenameView&&j.handleRenameView(...e))},l[86]||(l[86]=[(0,t.Lk)("i",{class:"el-icon-edit"},null,-1),(0,t.Lk)("span",null,"重命名视图",-1)])),(0,t.Lk)("div",{class:"view-option-item",onClick:l[17]||(l[17]=(...e)=>j.handleCopyView&&j.handleCopyView(...e))},l[87]||(l[87]=[(0,t.Lk)("i",{class:"el-icon-document-copy"},null,-1),(0,t.Lk)("span",null,"复制视图",-1)])),(0,t.Lk)("div",{class:"view-option-item",onClick:l[18]||(l[18]=(...e)=>j.handleDeleteView&&j.handleDeleteView(...e))},l[88]||(l[88]=[(0,t.Lk)("i",{class:"el-icon-delete"},null,-1),(0,t.Lk)("span",null,"删除视图",-1)]))])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"重命名视图",modelValue:j.renameViewDialogVisible,"onUpdate:modelValue":l[22]||(l[22]=e=>j.renameViewDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)(oe,{onClick:l[21]||(l[21]=e=>j.renameViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[89]||(l[89]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.saveRenameView},{default:(0,t.k6)((()=>l[90]||(l[90]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(he,{model:j.renameForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"视图名称",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(te,{modelValue:j.renameForm.name,"onUpdate:modelValue":l[20]||(l[20]=e=>j.renameForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"编辑信息",modelValue:j.editDialogVisible,"onUpdate:modelValue":l[26]||(l[26]=e=>j.editDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)(oe,{onClick:l[25]||(l[25]=e=>j.editDialogVisible=!1)},{default:(0,t.k6)((()=>l[91]||(l[91]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.saveDialogEdit},{default:(0,t.k6)((()=>l[92]||(l[92]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(he,{model:j.editingForm,"label-width":"120px"},{default:(0,t.k6)((()=>[j.editingColumn.prop?((0,t.uX)(),(0,t.Wv)(be,{key:0,label:j.editingColumn.label},{default:(0,t.k6)((()=>[["appointmentStatus","tags"].includes(j.editingColumn.prop)?((0,t.uX)(),(0,t.Wv)(le,{key:0,modelValue:j.editingForm.value,"onUpdate:modelValue":l[23]||(l[23]=e=>j.editingForm.value=e),style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.getOptionsForColumn(j.editingColumn.prop),(e=>((0,t.uX)(),(0,t.Wv)(ee,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):((0,t.uX)(),(0,t.Wv)(te,{key:1,modelValue:j.editingForm.value,"onUpdate:modelValue":l[24]||(l[24]=e=>j.editingForm.value=e),type:["zipCode","boxCount","weight","volume","palletCount"].includes(j.editingColumn.prop)?"number":"text"},null,8,["modelValue","type"]))])),_:1},8,["label"])):(0,t.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bo)((0,t.Lk)("div",{class:"context-menu",style:(0,i.Tr)({left:j.contextMenuX+"px",top:j.contextMenuY+"px"})},[(0,t.Lk)("div",{class:"context-menu-item",onClick:l[27]||(l[27]=(...e)=>j.handleCopyView&&j.handleCopyView(...e))},l[93]||(l[93]=[(0,t.Lk)("span",null,"复制视图",-1)])),(0,t.Lk)("div",{class:"context-menu-item",onClick:l[28]||(l[28]=(...e)=>j.handleRenameView&&j.handleRenameView(...e))},l[94]||(l[94]=[(0,t.Lk)("span",null,"重命名",-1)])),(0,t.Lk)("div",{class:"context-menu-item",onClick:l[29]||(l[29]=(...e)=>j.handleDeleteView&&j.handleDeleteView(...e))},l[95]||(l[95]=[(0,t.Lk)("span",null,"删除",-1)]))],4),[[o.aG,j.contextMenuVisible]]),(0,t.bF)(fe,{title:"分组设置",modelValue:j.groupModalVisible,"onUpdate:modelValue":l[34]||(l[34]=e=>j.groupModalVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",x,[(0,t.bF)(oe,{onClick:l[33]||(l[33]=e=>j.groupModalVisible=!1)},{default:(0,t.k6)((()=>l[99]||(l[99]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"danger",onClick:j.clearGroupSettings},{default:(0,t.k6)((()=>l[100]||(l[100]=[(0,t.eW)("清除分组")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{type:"primary",onClick:j.applyGroupSettings},{default:(0,t.k6)((()=>l[101]||(l[101]=[(0,t.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",V,[(0,t.Lk)("div",S,[l[96]||(l[96]=(0,t.Lk)("span",{class:"group-level-label"},"一级分组：",-1)),(0,t.bF)(le,{modelValue:j.groupSettings.level1,"onUpdate:modelValue":l[30]||(l[30]=e=>j.groupSettings.level1=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(ee,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t.Lk)("div",_,[l[97]||(l[97]=(0,t.Lk)("span",{class:"group-level-label"},"二级分组：",-1)),(0,t.bF)(le,{modelValue:j.groupSettings.level2,"onUpdate:modelValue":l[31]||(l[31]=e=>j.groupSettings.level2=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(ee,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t.Lk)("div",T,[l[98]||(l[98]=(0,t.Lk)("span",{class:"group-level-label"},"三级分组：",-1)),(0,t.bF)(le,{modelValue:j.groupSettings.level3,"onUpdate:modelValue":l[32]||(l[32]=e=>j.groupSettings.level3=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(ee,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"排序设置",modelValue:j.sortModalVisible,"onUpdate:modelValue":l[36]||(l[36]=e=>j.sortModalVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",R,[(0,t.bF)(oe,{onClick:l[35]||(l[35]=e=>j.sortModalVisible=!1)},{default:(0,t.k6)((()=>l[104]||(l[104]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"danger",onClick:j.clearSortSettings},{default:(0,t.k6)((()=>l[105]||(l[105]=[(0,t.eW)("清除排序")]))),_:1},8,["onClick"]),(0,t.bF)(oe,{type:"primary",onClick:j.applySortSettings},{default:(0,t.k6)((()=>l[106]||(l[106]=[(0,t.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",L,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.sortSettings,((e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"sort-item"},[(0,t.bF)(le,{modelValue:e.field,"onUpdate:modelValue":l=>e.field=l,placeholder:"选择字段",style:{width:"200px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.sortableFields,(e=>((0,t.uX)(),(0,t.Wv)(ee,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(le,{modelValue:e.direction,"onUpdate:modelValue":l=>e.direction=l,placeholder:"排序方向",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{label:"升序",value:"asc"}),(0,t.bF)(ee,{label:"降序",value:"desc"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(oe,{type:"danger",size:"small",onClick:e=>j.removeSortField(a)},{default:(0,t.k6)((()=>l[102]||(l[102]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])))),128)),(0,t.Lk)("div",W,[(0,t.bF)(oe,{type:"primary",plain:"",onClick:j.addSortField},{default:(0,t.k6)((()=>l[103]||(l[103]=[(0,t.eW)("添加排序字段")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"字段配置",modelValue:j.columnSettingsVisible,"onUpdate:modelValue":l[40]||(l[40]=e=>j.columnSettingsVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",$,[(0,t.bF)(oe,{onClick:l[39]||(l[39]=e=>j.columnSettingsVisible=!1)},{default:(0,t.k6)((()=>l[109]||(l[109]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.applyColumnSettings},{default:(0,t.k6)((()=>l[110]||(l[110]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",U,[(0,t.Lk)("div",D,[(0,t.bF)(ge,{modelValue:j.allColumnsSelected,"onUpdate:modelValue":l[37]||(l[37]=e=>j.allColumnsSelected=e),onChange:j.handleSelectAllColumns},{default:(0,t.k6)((()=>l[107]||(l[107]=[(0,t.eW)("全选")]))),_:1},8,["modelValue","onChange"]),(0,t.bF)(oe,{type:"primary",size:"small",onClick:j.resetColumnSettings},{default:(0,t.k6)((()=>l[108]||(l[108]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",K,[(0,t.bF)(Ce,{modelValue:j.columnSettingsList,"onUpdate:modelValue":l[38]||(l[38]=e=>j.columnSettingsList=e),"item-key":"prop",handle:".drag-handle",onEnd:j.handleDragEnd},{item:(0,t.k6)((({element:e})=>[(0,t.Lk)("div",N,[(0,t.bF)(we,{class:"drag-handle"},{default:(0,t.k6)((()=>[(0,t.bF)(ye)])),_:1}),(0,t.bF)(ge,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:1},8,["modelValue","onEnd"])])])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{modelValue:j.batchDialogVisible,"onUpdate:modelValue":l[46]||(l[46]=e=>j.batchDialogVisible=e),title:"批量操作",width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",M,[(0,t.bF)(oe,{onClick:l[45]||(l[45]=e=>j.batchDialogVisible=!1)},{default:(0,t.k6)((()=>l[113]||(l[113]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.handleBatchSubmit},{default:(0,t.k6)((()=>l[114]||(l[114]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>["followUp"===j.batchOperation?((0,t.uX)(),(0,t.CE)("div",A,[(0,t.bF)(he,{model:j.batchForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"跟进记录",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(te,{type:"textarea",modelValue:j.batchForm.followUp,"onUpdate:modelValue":l[41]||(l[41]=e=>j.batchForm.followUp=e),rows:"4",placeholder:"请输入跟进记录"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])):(0,t.Q3)("",!0),"memo"===j.batchOperation?((0,t.uX)(),(0,t.CE)("div",E,[(0,t.bF)(he,{model:j.batchForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"MEMO",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(te,{type:"textarea",modelValue:j.batchForm.memo,"onUpdate:modelValue":l[42]||(l[42]=e=>j.batchForm.memo=e),rows:"4",placeholder:"请输入MEMO内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])):(0,t.Q3)("",!0),"createPC"===j.batchOperation?((0,t.uX)(),(0,t.CE)("div",P,[(0,t.bF)(he,{model:j.batchForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"PC类型",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(ne,{modelValue:j.batchForm.pcType,"onUpdate:modelValue":l[43]||(l[43]=e=>j.batchForm.pcType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(Fe,{label:"delivery"},{default:(0,t.k6)((()=>l[111]||(l[111]=[(0,t.eW)("出库PC")]))),_:1}),(0,t.bF)(Fe,{label:"transfer"},{default:(0,t.k6)((()=>l[112]||(l[112]=[(0,t.eW)("调拨PC")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),"transfer"===j.batchForm.pcType?((0,t.uX)(),(0,t.Wv)(be,{key:0,label:"目标仓库",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(le,{modelValue:j.batchForm.targetWarehouse,"onUpdate:modelValue":l[44]||(l[44]=e=>j.batchForm.targetWarehouse=e),placeholder:"请选择目标仓库"},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{label:"美西一号仓",value:"west1"}),(0,t.bF)(ee,{label:"美西二号仓",value:"west2"}),(0,t.bF)(ee,{label:"美东仓",value:"east"})])),_:1},8,["modelValue"])])),_:1})):(0,t.Q3)("",!0)])),_:1},8,["model"])])):(0,t.Q3)("",!0)])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"MEMO",modelValue:j.memoDialogVisible,"onUpdate:modelValue":l[49]||(l[49]=e=>j.memoDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",O,[(0,t.bF)(oe,{onClick:l[48]||(l[48]=e=>j.memoDialogVisible=!1)},{default:(0,t.k6)((()=>l[115]||(l[115]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.saveMemo},{default:(0,t.k6)((()=>l[116]||(l[116]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(he,{model:j.memoForm,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"备注"},{default:(0,t.k6)((()=>[(0,t.bF)(te,{modelValue:j.memoForm.memo,"onUpdate:modelValue":l[47]||(l[47]=e=>j.memoForm.memo=e),type:"textarea",rows:4,placeholder:"请输入备注信息"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"跟进记录",modelValue:j.followUpDialogVisible,"onUpdate:modelValue":l[53]||(l[53]=e=>j.followUpDialogVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",G,[(0,t.bF)(oe,{onClick:l[52]||(l[52]=e=>j.followUpDialogVisible=!1)},{default:(0,t.k6)((()=>l[118]||(l[118]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(oe,{type:"primary",onClick:j.saveFollowUp},{default:(0,t.k6)((()=>l[119]||(l[119]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",X,[(0,t.Lk)("div",I,[l[117]||(l[117]=(0,t.Lk)("h4",null,"历史记录",-1)),(0,t.bF)(Se,null,{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.followUpHistory,((e,l)=>((0,t.uX)(),(0,t.Wv)(Ve,{key:l,timestamp:e.time,type:e.type},{default:(0,t.k6)((()=>[(0,t.Lk)("div",z,[(0,t.Lk)("div",q,(0,i.v_)(e.content),1),(0,t.Lk)("div",B,"操作人："+(0,i.v_)(e.operator),1)])])),_:2},1032,["timestamp","type"])))),128))])),_:1})]),(0,t.bF)(he,{model:j.followUpForm,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(be,{label:"跟进内容"},{default:(0,t.k6)((()=>[(0,t.bF)(te,{modelValue:j.followUpForm.content,"onUpdate:modelValue":l[50]||(l[50]=e=>j.followUpForm.content=e),type:"textarea",rows:4,placeholder:"请输入跟进内容"},null,8,["modelValue"])])),_:1}),(0,t.bF)(be,{label:"跟进类型"},{default:(0,t.k6)((()=>[(0,t.bF)(le,{modelValue:j.followUpForm.type,"onUpdate:modelValue":l[51]||(l[51]=e=>j.followUpForm.type=e),placeholder:"请选择跟进类型",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{label:"常规跟进",value:"primary"}),(0,t.bF)(ee,{label:"重要跟进",value:"warning"}),(0,t.bF)(ee,{label:"紧急跟进",value:"danger"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),(0,t.bF)(fe,{title:"历史记录",modelValue:j.historyDialogVisible,"onUpdate:modelValue":l[54]||(l[54]=e=>j.historyDialogVisible=e),width:"800px"},{default:(0,t.k6)((()=>[(0,t.bF)(Se,null,{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.historyRecords,((e,l)=>((0,t.uX)(),(0,t.Wv)(Ve,{key:l,timestamp:e.time,type:e.type},{default:(0,t.k6)((()=>[(0,t.Lk)("div",H,[(0,t.Lk)("div",Q,(0,i.v_)(e.content),1),(0,t.Lk)("div",Y,"操作人："+(0,i.v_)(e.operator),1)])])),_:2},1032,["timestamp","type"])))),128))])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(_e,{visible:j.podDialogVisible,"onUpdate:visible":l[55]||(l[55]=e=>j.podDialogVisible=e),onSubmit:j.handlePodSubmit},null,8,["visible","onSubmit"])])}var J=a(953),Z=a(163),ee=a(7918),le=a(3344),ae=a(2998),te=a(616);const oe=JSON.parse('[{"prop":"containerNumber","label":"集装箱号","width":140,"sortable":true,"filterType":"text"},{"prop":"shippingNumber","label":"运单号","width":140,"sortable":true,"filterType":"text"},{"prop":"customerService","label":"客服","width":100,"sortable":true,"filterType":"text"},{"prop":"originalAddress","label":"原地址信息","width":180,"sortable":true,"filterType":"text"},{"prop":"address","label":"地址","width":180,"sortable":true,"filterType":"text"},{"prop":"city","label":"City","width":120,"sortable":true,"filterType":"text"},{"prop":"state","label":"State","width":100,"sortable":true,"filterType":"text"},{"prop":"zipCode","label":"Zip_Code","width":120,"sortable":true,"filterType":"text"},{"prop":"deliveryArea","label":"派送区域","width":120,"sortable":true,"filterType":"select","filterOptions":[{"label":"城区","value":"城区"},{"label":"郊区","value":"郊区"},{"label":"远郊","value":"远郊"},{"label":"跨州","value":"跨州"}]},{"prop":"warehouseCode","label":"仓库代码","width":120,"sortable":true,"filterType":"text"},{"prop":"channel","label":"渠道","width":100,"sortable":true,"filterType":"select","filterOptions":[{"label":"海运","value":"海运"},{"label":"空运","value":"空运"},{"label":"铁路","value":"铁路"},{"label":"公路","value":"公路"}]},{"prop":"boxCount","label":"箱数","width":80,"sortable":true,"filterType":"number"},{"prop":"weight","label":"重重","width":100,"sortable":true,"filterType":"number"},{"prop":"volume","label":"方数","width":100,"sortable":true,"filterType":"number"},{"prop":"palletCount","label":"板数","width":80,"sortable":true,"filterType":"number"},{"prop":"location","label":"库位","width":100,"sortable":true,"filterType":"text"},{"prop":"eta","label":"ETA","width":140,"sortable":true,"filterType":"date"},{"prop":"containerPickupTime","label":"提柜时间","width":140,"sortable":true,"filterType":"datetime"},{"prop":"arrivalTime","label":"抵仓时间","width":140,"sortable":true,"filterType":"datetime"},{"prop":"expectedUnpackingTime","label":"预计拆柜时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"unpackingCompletedTime","label":"拆柜完成时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"appointmentNumber","label":"预约号","width":120,"sortable":true,"filterType":"text"},{"prop":"deliveryAppointmentTime","label":"派送预约时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"deliveryTime","label":"送货时间","width":140,"sortable":true,"filterType":"datetime"},{"prop":"deliveryCompany","label":"送货公司","width":140,"sortable":true,"filterType":"text"},{"prop":"deliveryDriver","label":"送货司机","width":120,"sortable":true,"filterType":"text"},{"prop":"driverPhone","label":"司机电话","width":120,"sortable":true,"filterType":"text"},{"prop":"pcNumber","label":"PC号","width":120,"sortable":true,"filterType":"text"},{"prop":"appointmentStatus","label":"预约状态","width":120,"sortable":true,"filterType":"select","type":"status","options":[{"value":"未预约","type":"info"},{"value":"已预约","type":"warning"},{"value":"已确认","type":"primary"},{"value":"已抵达","type":"success"},{"value":"已取消","type":"danger"}],"filterOptions":[{"label":"未预约","value":"未预约"},{"label":"已预约","value":"已预约"},{"label":"已确认","value":"已确认"},{"label":"已抵达","value":"已抵达"},{"label":"已取消","value":"已取消"}]},{"prop":"tags","label":"标签","width":120,"sortable":false,"filterType":"select","type":"tags"},{"prop":"followUpRecord","label":"跟进记录","width":150,"sortable":false,"filterType":"text"},{"prop":"remarks","label":"MEMO","width":150,"sortable":false,"filterType":"text"},{"prop":"internalRemarks","label":"内部备注","width":150,"sortable":false,"filterType":"text"},{"prop":"quotationLianyu","label":"报价(联宇)","width":150,"sortable":true,"filterType":"number"},{"prop":"shippingMark","label":"唛头","width":120,"sortable":true,"filterType":"text"},{"prop":"platformQuotation","label":"询价平台报价","width":150,"sortable":true,"filterType":"number"},{"prop":"podPhoto","label":"POD照片","width":"120","sortable":true},{"prop":"operation","label":"操作","width":150,"fixed":"right","sortable":false,"type":"operation"}]'),ie=JSON.parse('[{"prop":"itemCode","label":"货件编码","width":140,"sortable":true},{"prop":"trackingNumber","label":"追踪编号","width":160,"sortable":true},{"prop":"productName","label":"货物名称","width":200,"sortable":true},{"prop":"quantity","label":"数量","width":100,"sortable":true},{"prop":"weight","label":"重量(KG)","width":120,"sortable":true},{"prop":"volume","label":"体积(CBM)","width":120,"sortable":true}]'),ne=JSON.parse('[{"id":1,"containerNumber":"MAEU1234567","shippingNumber":"SH20240501001","customerService":"王小明","originalAddress":"123 Main St, Newark, NJ 07101","address":"456 Elm St","city":"Los Angeles","state":"CA","zipCode":"90001","deliveryArea":"城区","warehouseCode":"LA001","channel":"海运","boxCount":45,"weight":2500,"volume":65.5,"palletCount":8,"location":"A-12-05","eta":"2024-05-15","containerPickupTime":"2024-05-16 08:30:00","arrivalTime":"2024-05-16 10:15:00","expectedUnpackingTime":"2024-05-16 13:00:00","unpackingCompletedTime":"2024-05-16 16:45:00","appointmentNumber":"APP00125","deliveryAppointmentTime":"2024-05-18 09:00:00","deliveryTime":"2024-05-18 09:15:00","deliveryCompany":"速达物流","deliveryDriver":"李强","driverPhone":"13812345678","pcNumber":"PC2024050101","appointmentStatus":"已确认","tags":["优先处理","特殊货物"],"followUpRecord":"客户已确认送货时间","remarks":"请轻拿轻放，货物易碎","internalRemarks":"VIP客户，优先处理","quotationLianyu":5600,"shippingMark":"ACME-2024","platformQuotation":5800,"children":[{"id":101,"itemCode":"I2024050101","trackingNumber":"TRK000123456","productName":"电子显示器","quantity":20,"weight":500,"volume":12.5},{"id":102,"itemCode":"I2024050102","trackingNumber":"TRK000123457","productName":"服务器设备","quantity":5,"weight":750,"volume":18.2}]},{"id":2,"containerNumber":"CMAU7654321","shippingNumber":"SH20240501002","customerService":"李娜","originalAddress":"789 Oak St, Seattle, WA 98101","address":"321 Pine Rd","city":"San Francisco","state":"CA","zipCode":"94107","deliveryArea":"郊区","warehouseCode":"SF002","channel":"海运","boxCount":32,"weight":1800,"volume":48.2,"palletCount":6,"location":"B-08-12","eta":"2024-05-18","containerPickupTime":"2024-05-19 07:45:00","arrivalTime":"2024-05-19 09:30:00","expectedUnpackingTime":"2024-05-19 12:00:00","unpackingCompletedTime":"2024-05-19 15:30:00","appointmentNumber":"APP00126","deliveryAppointmentTime":"2024-05-21 14:00:00","deliveryTime":null,"deliveryCompany":"快捷物流","deliveryDriver":"张伟","driverPhone":"13898765432","pcNumber":"PC2024050102","appointmentStatus":"已预约","tags":["常规货物"],"followUpRecord":"等待确认送货时间","remarks":"送货前需电话联系","internalRemarks":"","quotationLianyu":4200,"shippingMark":"BETA-2024","platformQuotation":4500,"children":[{"id":201,"itemCode":"I2024050201","trackingNumber":"TRK000234567","productName":"办公家具","quantity":15,"weight":800,"volume":25.5}]},{"id":3,"containerNumber":"OOLU8765432","shippingNumber":"SH20240502001","customerService":"张伟","originalAddress":"456 Market St, New York, NY 10001","address":"789 Beach Blvd","city":"San Diego","state":"CA","zipCode":"92109","deliveryArea":"远郊","warehouseCode":"SD003","channel":"空运","boxCount":18,"weight":950,"volume":28.4,"palletCount":4,"location":"C-05-07","eta":"2024-05-20","containerPickupTime":"2024-05-20 09:00:00","arrivalTime":"2024-05-20 11:30:00","expectedUnpackingTime":"2024-05-20 14:00:00","unpackingCompletedTime":null,"appointmentNumber":"APP00127","deliveryAppointmentTime":null,"deliveryTime":null,"deliveryCompany":"安顺物流","deliveryDriver":"","driverPhone":"","pcNumber":"PC2024050201","appointmentStatus":"未预约","tags":["易碎品","高价值"],"followUpRecord":"待处理","remarks":"贵重物品，需专人签收","internalRemarks":"保价货物，谨慎操作","quotationLianyu":7800,"shippingMark":"GAMMA-2024","platformQuotation":8200,"children":[{"id":301,"itemCode":"I2024050301","trackingNumber":"TRK000345678","productName":"医疗设备","quantity":8,"weight":450,"volume":15.8},{"id":302,"itemCode":"I2024050302","trackingNumber":"TRK000345679","productName":"医用耗材","quantity":10,"weight":250,"volume":8.5}]}]');var re=a(8548),ue=a(432),se=a.n(ue);const de=oe,pe=ie,ce=ne,me={name:"ContainerShipments",components:{FilterPanel:le.A,GroupableTable:ae.A,draggable:se(),DArrowLeft:re.V6m,UploadPodDialog:te.A},setup(){const e=(0,J.KR)(de),l=(0,J.KR)(pe),a=(0,J.KR)(ce),o=(0,J.KR)([]),i=(0,J.KR)(!1),n=(0,J.KR)([...de]),r=(0,J.KR)([]),u=(0,J.KR)("west2"),s=(0,J.KR)("ETA"),d=(0,J.KR)([]),p=(0,J.KR)("trainNumber"),c=(0,J.KR)(""),m=(0,J.KR)("no"),v=(0,J.KR)("all"),b=(0,J.KR)(!1),g=(0,J.KR)([]),k=(0,J.KR)("and"),h=(0,J.KR)(1),f=(0,J.KR)(20),y=(0,J.KR)(0),w=(0,t.EW)((()=>y.value)),C=(0,J.KR)("all"),F=(0,J.KR)(""),V=(0,J.KR)([]),S=(0,J.KR)(!1),_=(0,J.KR)(!1),T=(0,J.KR)(!1),x=(0,J.KR)(""),L=(0,J.KR)({name:"",columns:[]}),W=(0,J.KR)(null),R=(0,J.KR)({name:""}),U=(0,J.KR)(!1),D=(0,J.KR)({level1:"",level2:"",level3:""}),K=(0,t.EW)((()=>o.value.some((e=>e.isGroup)))),N=e=>{const l=["","primary","success","warning"];return l[e]||""},$=(0,t.EW)((()=>e.value.filter((e=>["trainNumber","loadingType","loadingStatus","loadingStartTime","loadingEndTime","loader","dockNumber","actualPallets"].includes(e.prop))))),A=(0,t.EW)((()=>e.value.filter((e=>["trainNumber","deliveryType","supplier","driverPhone","licensePlate","destination","deliveryCost"].includes(e.prop))))),E=(0,t.EW)((()=>e.value.filter((e=>["trainNumber","driverLicense","licensePlate","driverPhone","loadingStatus","loadingAppointmentTime"].includes(e.prop))))),P=(0,t.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop))));(0,t.wB)(C,(l=>{if(["all","pending","processing","completed","cancelled"].includes(l))F.value="",e.value.forEach((e=>e.visible=!0)),g.value=[],k.value="and",D.value={level1:"",level2:"",level3:""},x.value="",$e.value=[{field:"",direction:"asc"}];else if(["loadingView","dispatchView","driverView"].includes(l))F.value="","loadingView"===l?n.value=$.value:"dispatchView"===l?n.value=A.value:"driverView"===l&&(n.value=E.value);else{const e=V.value.find((e=>e.id===l));e&&(F.value=l,el(l))}O()})),(0,t.wB)(F,(e=>{e&&(C.value=e)})),(0,t.sV)((()=>{n.value=e.value,H(),a.value.forEach((e=>{e.tags&&Array.isArray(e.tags)&&(e.tags=e.tags.join(","))}));for(let e=4;e<=13;e++)a.value.push({id:e,containerNumber:`CONT${e}00${e}${e}${e}`,shippingNumber:`SH2024060${e}00${e}`,customerService:e%2===0?"李明":"张华",originalAddress:`${100+e} Harbor St, Oakland, CA 9460${e}`,address:`${200+e} Ocean Ave`,city:e%3===0?"Sacramento":e%3===1?"Oakland":"Riverside",state:"CA",zipCode:`9${e}${e}0${e}`,deliveryArea:e%2===0?"市区":"郊区",warehouseCode:`WH${e}00${e}`,channel:e%3===0?"空运":"海运",boxCount:20+2*e,weight:1e3+100*e,volume:30+1.5*e,palletCount:3+e%5,location:`D-0${e}-${10+e}`,eta:`2024-06-${10+e}`,containerPickupTime:`2024-06-${11+e} 08:00:00`,arrivalTime:`2024-06-${11+e} 10:30:00`,expectedUnpackingTime:`2024-06-${11+e} 13:00:00`,unpackingCompletedTime:e%3===0?null:`2024-06-${11+e} 16:00:00`,appointmentNumber:`APP00${130+e}`,deliveryAppointmentTime:e%4===0?null:`2024-06-${13+e} 09:00:00`,deliveryTime:e%5===0?null:`2024-06-${13+e} 09:30:00`,deliveryCompany:e%3===0?"顺风物流":e%3===1?"海洋物流":"空中物流",deliveryDriver:e%4===0?"":`司机${e}`,driverPhone:e%4===0?"":`138${e}${e}${e}${e}${e}${e}${e}${e}`,pcNumber:`PC202406${e}00${e}`,appointmentStatus:e%4===0?"未预约":e%4===1?"电话预约":e%4===2?"平台预约":"邮件预约",tags:e%3===0?"优先":e%3===1?"延期":"加急,特殊处理",followUpRecord:e%3===0?"待客户确认":e%3===1?"已联系客户":"客户已确认",remarks:`集装箱${e}的备注信息`,internalRemarks:e%2===0?"内部处理注意事项":"",quotationLianyu:4e3+200*e,shippingMark:`SHIP-${1e3+e}`,platformQuotation:4200+200*e,children:[{id:100*e+1,itemCode:`I20240${e}${e}01`,trackingNumber:`TRK000${e}${e}${e}01`,productName:e%2===0?"电子产品":"家居用品",quantity:10+e,weight:300+20*e,volume:10+.8*e,packageType:e%3===0?"木箱":e%3===1?"纸箱":"塑料箱",receiverName:`收件人${e}`,receiverPhone:`137${e}${e}${e}${e}${e}${e}${e}${e}`,deliveryAddress:`${e%3===0?"Sacramento":e%3===1?"Oakland":"Riverside"}市${10*e}号大厦`,deliveryStatus:e%4===0?"待派送":e%4===1?"派送中":e%4===2?"已派送":"已签收",shippingMark:`SHIP-${1e3+e}-A`,remarks:e%2===0?"需要签收确认":"送达后电话通知"}]});M()}));const M=()=>{i.value=!0;try{y.value=a.value.length,O();const e=a.value.filter((e=>"未预约"===e.appointmentStatus)).length,l=a.value.filter((e=>"已预约"===e.appointmentStatus||"已确认"===e.appointmentStatus)).length,t=a.value.filter((e=>"已完成"===e.appointmentStatus)).length,o=a.value.filter((e=>"已取消"===e.appointmentStatus)).length,i=document.querySelectorAll(".status-view-group .el-radio-button");i.length>=5&&(i[0].querySelector(".el-radio-button__inner").textContent=`全部(${a.value.length})`,i[1].querySelector(".el-radio-button__inner").textContent=`待处理(${e})`,i[2].querySelector(".el-radio-button__inner").textContent=`处理中(${l})`,i[3].querySelector(".el-radio-button__inner").textContent=`已完成(${t})`,i[4].querySelector(".el-radio-button__inner").textContent=`已取消(${o})`)}catch(e){console.error("加载数据失败:",e)}finally{i.value=!1}},O=()=>{let e=[...a.value];if(["pending","processing","completed","cancelled"].includes(C.value)){const l={pending:"待处理",processing:"处理中",completed:"已完成",cancelled:"已取消"},a=l[C.value];a&&(e=e.filter((e=>e.loadingStatus===a)))}if(c.value&&(e=e.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const l={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},a=l[s.value],[t,o]=d.value;e=e.filter((e=>{const l=e[a];if(!l)return!1;const i=l.split(" ")[0];return i>=t&&i<=o}))}g.value.length>0&&(e=e.filter((e=>{const l=g.value.map((l=>{const{field:a,operator:t,value:o}=l,i=e[a];if(null==i)return!1;switch(t){case"eq":return i==o;case"neq":return i!=o;case"contains":return i.toString().toLowerCase().includes(o.toString().toLowerCase());case"notContains":return!i.toString().toLowerCase().includes(o.toString().toLowerCase());case"startsWith":return i.toString().toLowerCase().startsWith(o.toString().toLowerCase());case"endsWith":return i.toString().toLowerCase().endsWith(o.toString().toLowerCase());case"gt":return Number(i)>Number(o);case"gte":return Number(i)>=Number(o);case"lt":return Number(i)<Number(o);case"lte":return Number(i)<=Number(o);default:return!0}}));return"and"===k.value?l.every((e=>e)):l.some((e=>e))}))),x.value&&(e=X(e,x.value)),y.value=e.length;const l=(h.value-1)*f.value,t=l+f.value;o.value=e.slice(l,t)},X=(e,l)=>{const a={};e.forEach((e=>{const t=e[l]||"未分类";a[t]||(a[t]=[]),a[t].push({...e})}));const t=[];for(const[o,i]of Object.entries(a))t.push({id:`group-${o}`,groupName:o,count:i.length,isGroup:!0,groupLevel:0,children:i});return t},I=e=>{r.value=e},z=e=>{const l={待处理:"info",处理中:"warning",已完成:"success",已取消:"danger"};return l[e]||"info"},q=()=>{L.value={name:"",columns:e.value.filter((e=>!1!==e.visible)).map((e=>e.prop))},S.value=!0},B=()=>{if(!L.value.name.trim())return void Z.nk.warning("请输入视图名称");const l={id:Date.now().toString(),name:L.value.name,columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:g.value,filterLogic:k.value,groupSettings:D.value,sortSettings:$e.value};V.value.push(l),F.value=l.id,S.value=!1,Je(),Z.nk.success("保存成功")},G=()=>{W.value&&ee.s.confirm("确定要删除该视图吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=V.value.findIndex((e=>e.id===W.value.id));-1!==e&&(V.value.splice(e,1),C.value===W.value.id&&(C.value="all",F.value=""),Je(),Z.nk.success("删除成功")),_.value=!1})).catch((()=>{_.value=!1}))},H=()=>{const e=localStorage.getItem("fbxViews");if(e)try{V.value=JSON.parse(e)}catch(l){console.error("加载保存的视图失败:",l)}},Q=e=>{console.log("查看详情",e)},Y=(e,l)=>{hl.value=l;let a="";switch(e){case"memo":pl.value=!0,cl.value.memo=l.remarks||"";break;case"followUp":ml.value=!0,yl(l);break;case"history":gl.value=!0,Fl(l);break;case"palletDetail":Z.nk.info("查看卡板明细");break;case"copyAddress":a=`${l.address||""}, ${l.city||""}, ${l.state||""} ${l.zipCode||""}`,navigator.clipboard.writeText(a).then((()=>{Z.nk.success("地址已复制到剪贴板")})).catch((e=>{console.error("复制失败:",e),Z.nk.error("复制地址失败")}));break;case"markException":wl(l);break;case"detail":Q(l);break;case"expense":Z.nk.info("查看费用明细");break;case"uploadPod":_l(l);break;default:break}},j=()=>{b.value=!0},le=()=>{console.log("showAddTrainDialog")},ae=(e,l)=>{console.log("展开/折叠行:",e.id,l?"展开":"折叠")},te=({prop:e,order:l})=>{if(!e||!l)return void O();const a=[...o.value];a.sort(((a,t)=>{let o=a[e],i=t[e];return isNaN(o)||isNaN(i)||(o=Number(o),i=Number(i)),"string"===typeof o&&"string"===typeof i?"ascending"===l?o.localeCompare(i):i.localeCompare(o):"ascending"===l?o>i?1:-1:o<i?1:-1})),o.value=a},oe=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:"分组"},ie=e=>{f.value=e,M()},ne=e=>{h.value=e,M()},re=()=>{h.value=1,O()},ue=({filters:e,logic:l})=>{g.value=e,k.value=l,h.value=1,F.value&&Ze(F.value),O()},se=()=>{},me=e=>{W.value=e,_.value=!0},ve=()=>{W.value&&(R.value.name=W.value.name,_.value=!1,T.value=!0)},be=()=>{if(!W.value)return;if(!R.value.name.trim())return void Z.nk.warning("请输入视图名称");const e=V.value.findIndex((e=>e.id===W.value.id));-1!==e&&(V.value[e].name=R.value.name,Je(),Z.nk.success("重命名成功"),T.value=!1)},ge=()=>{if(!W.value)return;const e={...W.value,id:Date.now().toString(),name:`${W.value.name} 副本`};V.value.push(e),Je(),Z.nk.success("复制成功"),_.value=!1},ke=(0,J.KR)(!1),he=(0,J.KR)(0),fe=(0,J.KR)(0),ye=(e,l)=>{e.preventDefault(),W.value=l,ke.value=!0,he.value=e.clientX,fe.value=e.clientY,setTimeout((()=>{document.addEventListener("click",we)}),0)},we=()=>{ke.value=!1,document.removeEventListener("click",we)},Ce=(0,J.KR)({rowIndex:-1,prop:"",value:""}),Fe=(0,J.KR)(!1),Ve=(0,J.KR)(null),Se=(0,J.KR)({}),_e=(0,J.KR)({value:""}),Te=(e,l,a)=>{const t=l.property;if(["address","city","state","zipCode","deliveryArea","appointmentNumber","deliveryAppointmentTime","deliveryTime","deliveryCompany","deliveryDriver","driverPhone","appointmentStatus","tags","followUpRecord","remarks","internalRemarks","quotationLianyu","shippingMark","platformQuotation"].includes(t)){const l=a?a.closest("tr"):null,o=l?Array.from(l.parentNode.children).indexOf(l):-1;console.log("单击编辑",e,t,o),Ce.value={rowIndex:o,prop:t,value:e[t]||""},setTimeout((()=>{const e=document.querySelector(".cell-editor input");e&&e.focus()}),50)}},xe=(l,a)=>{const t=a.property;["address","city","state","zipCode","deliveryArea","appointmentNumber","deliveryAppointmentTime","deliveryTime","deliveryCompany","deliveryDriver","driverPhone","appointmentStatus","tags","followUpRecord","remarks","internalRemarks","quotationLianyu","shippingMark","platformQuotation"].includes(t)&&(Ce.value={rowIndex:-1,prop:"",value:""},Ve.value=l,Se.value=e.value.find((e=>e.prop===t))||{prop:t,label:t},_e.value.value=l[t]||"",Fe.value=!0)},Le=(e,l)=>{Ce.value.prop===l&&(e[l]=Ce.value.value,setTimeout((()=>{Ce.value={rowIndex:-1,prop:"",value:""},Z.nk.success("保存成功")}),200))},We=()=>{Ve.value&&Se.value.prop&&(Ve.value[Se.value.prop]=_e.value.value,Fe.value=!1,Z.nk.success("保存成功"))},Re=l=>{const t=e.value.find((e=>e.prop===l));if(t&&t.filterOptions)return t.filterOptions;switch(l){case"appointmentStatus":return[{value:"待确认",label:"待确认"},{value:"已确认",label:"已确认"},{value:"已完成",label:"已完成"},{value:"已取消",label:"已取消"},{value:"延期",label:"延期"}];case"tags":return[{value:"优先",label:"优先"},{value:"紧急",label:"紧急"},{value:"延期",label:"延期"},{value:"异常",label:"异常"},{value:"正常",label:"正常"}];case"loader":return[{value:"张三",label:"张三"},{value:"李四",label:"李四"},{value:"王五",label:"王五"},{value:"赵六",label:"赵六"},{value:"钱七",label:"钱七"}];case"dockNumber":return Array.from({length:10},((e,l)=>{const a=l+1,t=`DOCK-${a<10?"0"+a:a}`;return{value:t,label:t}}));case"supplier":return[{value:"广州物流",label:"广州物流"},{value:"深圳物流",label:"深圳物流"},{value:"东莞物流",label:"东莞物流"},{value:"佛山物流",label:"佛山物流"},{value:"中山物流",label:"中山物流"}];case"driverLicense":case"licensePlate":case"driverPhone":return a.value.map((e=>({value:e[l],label:e[l]}))).filter(((e,l,a)=>e.value&&a.findIndex((l=>l.value===e.value))===l));default:return[]}},Ue=()=>{U.value=!0},De=()=>{const e=[];D.value.level1&&e.push(D.value.level1),D.value.level2&&e.push(D.value.level2),D.value.level3&&e.push(D.value.level3),x.value="",Ke(e),F.value&&Ze(F.value),U.value=!1,Z.nk.success("分组已应用")},Ke=l=>{if(!l||0===l.length)return void O();const t=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:l};let i=[...a.value];if(["pending","processing","completed","cancelled"].includes(C.value)){const e={pending:"待处理",processing:"处理中",completed:"已完成",cancelled:"已取消"},l=e[C.value];l&&(i=i.filter((e=>e.loadingStatus===l)))}if(c.value&&(i=i.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const e={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},l=e[s.value],[a,t]=d.value;i=i.filter((e=>{const o=e[l];if(!o)return!1;const i=o.split(" ")[0];return i>=a&&i<=t}))}g.value.length>0&&(i=i.filter((e=>{const l=g.value.map((l=>{const{field:a,operator:t,value:o}=l,i=e[a];if(null==i)return!1;switch(t){case"eq":return i==o;case"neq":return i!=o;case"contains":return i.toString().toLowerCase().includes(o.toString().toLowerCase());case"notContains":return!i.toString().toLowerCase().includes(o.toString().toLowerCase());case"startsWith":return i.toString().toLowerCase().startsWith(o.toString().toLowerCase());case"endsWith":return i.toString().toLowerCase().endsWith(o.toString().toLowerCase());case"gt":return Number(i)>Number(o);case"gte":return Number(i)>=Number(o);case"lt":return Number(i)<Number(o);case"lte":return Number(i)<=Number(o);default:return!0}}));return"and"===k.value?l.every((e=>e)):l.some((e=>e))})));const n=[],r=new Map;i.forEach((e=>{let a=n,o="",i=null;for(let n=0;n<l.length;n++){const u=l[n],s=e[u]||"未分类",d=t(u),p=`${o}/${u}:${s}`;let c=a.find((e=>e.groupKey===p));c||(c={id:`group-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,groupKey:p,groupName:`${d}: ${s}`,isGroup:!0,groupLevel:n,children:[],items:[],count:0},c.groupClass=0===n?"level-1-group":1===n?"level-2-group":"level-3-group",a.push(c),r.set(p,c)),c.items.push(e),c.count=c.items.length,o=p,a=c.children,i=c}if(i){const l={...e,parentGroupKey:i.groupKey};i.children.push(l)}}));const u=[];function m(e,l=0){e.forEach((e=>{u.push(e);const a=e.children.filter((e=>e.isGroup));a.length>0?m(a,l+1):e.children.forEach((e=>{u.push(e)}))}))}m(n),y.value=u.length;const v=(h.value-1)*f.value,b=v+f.value;o.value=u.slice(v,b)},Ne=(0,J.KR)(!1),$e=(0,J.KR)([{field:"",direction:"asc"}]),Ae=(0,t.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop)))),Ee=()=>{Ne.value=!0},Pe=()=>{$e.value.push({field:"",direction:"asc"})},Me=e=>{$e.value.splice(e,1),0===$e.value.length&&$e.value.push({field:"",direction:"asc"})},Oe=()=>{if($e.value.some((e=>!e.field)))return void Z.nk.warning("请选择所有排序字段");let e=[...o.value];$e.value.forEach((({field:l,direction:a})=>{e.sort(((e,t)=>{let o=e[l],i=t[l];return isNaN(o)||isNaN(i)||(o=Number(o),i=Number(i)),"string"===typeof o&&"string"===typeof i?"asc"===a?o.localeCompare(i):i.localeCompare(o):"asc"===a?o>i?1:-1:o<i?1:-1}))})),o.value=e,Ne.value=!1,F.value&&Ze(F.value),Z.nk.success("排序已应用")},Xe=()=>{D.value={level1:"",level2:"",level3:""},x.value="",F.value&&Ze(F.value),O(),U.value=!1,Z.nk.success("已清除分组设置")},Ie=()=>{$e.value=[{field:"",direction:"asc"}],F.value&&Ze(F.value),O(),Ne.value=!1,Z.nk.success("已清除排序设置")},ze=(0,J.KR)(!1),qe=(0,J.KR)([]),Be=(0,t.EW)({get:()=>qe.value.every((e=>e.visible)),set:e=>{qe.value.forEach((l=>l.visible=e))}}),Ge=()=>{qe.value=e.value.map((e=>({...e,visible:!1!==e.visible}))),ze.value=!0},He=e=>{qe.value.forEach((l=>l.visible=e))},Qe=()=>{qe.value=e.value.map((e=>({...e,visible:!0})))},Ye=()=>{},je=()=>{e.value=e.value.map((e=>{const l=qe.value.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}})),F.value&&Ze(F.value),ze.value=!1,Z.nk.success("字段配置已更新")},Je=()=>{localStorage.setItem("fbxViews",JSON.stringify(V.value))},Ze=l=>{const a=V.value.findIndex((e=>e.id===l));a>-1&&(V.value[a]={...V.value[a],columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:g.value,filterLogic:k.value,groupSettings:D.value,sortSettings:$e.value},Je())},el=l=>{const a=V.value.find((e=>e.id===l));a&&(a.columns&&(e.value=e.value.map((e=>{const l=a.columns.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}}))),a.filters&&(g.value=[...a.filters],k.value=a.filterLogic||"and"),a.groupSettings&&(D.value={...a.groupSettings}),a.sortSettings&&($e.value=[...a.sortSettings]),O())},ll=(0,J.KR)(""),al=(0,J.KR)(!1),tl=(0,J.KR)({followUp:"",memo:"",pcType:"delivery",targetWarehouse:""}),ol=e=>{0!==r.value.length?(ll.value=e,tl.value.followUp="",tl.value.memo="",tl.value.pcType="delivery",tl.value.targetWarehouse="",al.value=!0):Z.nk.warning("请先选择要操作的数据")},il=()=>{switch(ll.value){case"followUp":if(!tl.value.followUp)return void Z.nk.warning("请输入跟进记录");Z.nk.success(`已为${r.value.length}条记录添加跟进记录`);break;case"memo":if(!tl.value.memo)return void Z.nk.warning("请输入MEMO");Z.nk.success(`已为${r.value.length}条记录添加MEMO`);break;case"createPC":if("transfer"===tl.value.pcType&&!tl.value.targetWarehouse)return void Z.nk.warning("请选择目标仓库");const e="delivery"===tl.value.pcType?"出库PC":"调拨PC";Z.nk.success(`已创建${e}，包含${r.value.length}条记录`);break}al.value=!1},nl=e=>{Ve.value[Se.value.prop]=e,Fe.value=!1},rl=e=>{switch(e){case"电话预约":return"warning";case"平台预约":return"";case"邮件预约":return"info";case"未预约":return"danger";default:return""}},ul=e=>{switch(e.trim()){case"加急":return"danger";case"特殊处理":return"warning";default:return""}},sl=e=>{e.appointmentStatus="",Z.nk.success("已移除预约状态")},dl=(e,l)=>{if(e.tags){if("string"===typeof e.tags){const a=e.tags.split(","),t=a.filter((e=>e.trim()!==l.trim()));e.tags=t.join(",")}else e.tags="";Z.nk.success("已移除标签")}},pl=(0,J.KR)(!1),cl=(0,J.KR)({memo:""}),ml=(0,J.KR)(!1),vl=(0,J.KR)({content:"",type:"primary"}),bl=(0,J.KR)([]),gl=(0,J.KR)(!1),kl=(0,J.KR)([]),hl=(0,J.KR)(null),fl=()=>{cl.value.memo.trim()?(hl.value&&(hl.value.remarks=cl.value.memo,Vl(hl.value,"memo","更新备注"),Z.nk.success("保存成功")),pl.value=!1):Z.nk.warning("请输入备注内容")},yl=e=>{bl.value=[{time:"2024-03-20 10:00:00",content:`客户确认收货地址 - ${e.address||"未知地址"}`,operator:"张三",type:"primary"},{time:"2024-03-20 14:30:00",content:`预约派送时间 - ${e.deliveryAppointmentTime||"未设置"}`,operator:"李四",type:"warning"}]},wl=e=>{hl.value=e,vl.value={content:"",type:"danger"},ml.value=!0},Cl=()=>{if(vl.value.content.trim()){if(hl.value){if(bl.value.unshift({time:(new Date).toLocaleString(),content:vl.value.content,operator:"当前用户",type:vl.value.type}),"danger"===vl.value.type){let e=[];if("string"===typeof hl.value.tags&&hl.value.tags?e=hl.value.tags.split(",").map((e=>e.trim())):Array.isArray(hl.value.tags)&&(e=[...hl.value.tags]),!e.includes("异常")){e.push("异常"),hl.value.tags=e.join(",");const l=a.value.findIndex((e=>e.id===hl.value.id));-1!==l&&(a.value[l]={...hl.value});const t=o.value.findIndex((e=>e.id===hl.value.id));-1!==t&&(o.value[t]={...hl.value})}}Vl(hl.value,"followUp","添加跟进记录"),vl.value.content="",vl.value.type="primary",Z.nk.success("保存成功")}ml.value=!1}else Z.nk.warning("请输入跟进内容")},Fl=e=>{kl.value=[{time:"2024-03-20 10:00:00",content:`创建订单 - ${e.containerNumber||"未知集装箱号"}`,operator:"系统",type:"primary"},{time:"2024-03-20 14:30:00",content:`更新备注信息 - ${e.remarks||"无备注"}`,operator:"张三",type:"info"},{time:"2024-03-20 16:00:00",content:`添加跟进记录 - ${e.followUpRecord||"无跟进记录"}`,operator:"李四",type:"warning"}]},Vl=(e,l,a)=>{kl.value.unshift({time:(new Date).toLocaleString(),content:a,operator:"当前用户",type:"memo"===l?"info":"followUp"===l?"warning":"primary"})},Sl=(0,J.KR)(!1),_l=e=>{hl.value=e,Sl.value=!0},Tl=async e=>{try{console.log("上传POD文件:",e),Z.nk.success("POD上传成功"),hl.value&&(hl.value.podStatus="已上传",hl.value.receiveTime=e.get("receiveTime"))}catch(l){console.error("上传POD失败:",l),Z.nk.error("上传POD失败，请重试")}};return{tableColumns:e,childColumns:l,tableData:a,displayData:o,loading:i,visibleColumns:n,selectedRows:r,warehouse:u,createDateType:s,dateRange:d,searchType:p,searchText:c,sendOrder:m,currentStatus:v,filterPanelVisible:b,activeFilters:g,filterLogic:k,currentPage:h,pageSize:f,totalItems:y,total:w,currentView:C,selectedCustomView:F,customViews:V,saveViewDialogVisible:S,viewOptionsDialogVisible:_,renameViewDialogVisible:T,groupField:x,viewForm:L,currentEditingView:W,renameForm:R,groupableFields:P,groupModalVisible:U,groupSettings:D,hasGroupedData:K,getGroupTagType:N,showGroupModal:Ue,applyGroupSettings:De,handleSaveView:q,saveView:B,handleDeleteView:G,loadSavedViews:H,getStatusTagType:z,handleDetail:Q,handleCommand:Y,showFilterPanel:j,showAddTrainDialog:le,handleExpandChange:ae,handleSelectionChange:I,handleSortChange:te,handleSizeChange:ie,handleCurrentChange:ne,handleSearch:re,applyFilters:ue,cancelFilters:se,fetchData:M,applyFiltersAndPagination:O,groupData:X,handleViewOptions:me,handleRenameView:ve,saveRenameView:be,handleCopyView:ge,contextMenuVisible:ke,contextMenuX:he,contextMenuY:fe,handleContextMenu:ye,closeContextMenu:we,editingCell:Ce,editDialogVisible:Fe,editingRow:Ve,editingColumn:Se,editingForm:_e,handleCellClick:Te,handleCellDbClick:xe,saveEdit:Le,saveDialogEdit:We,getOptionsForColumn:Re,getGroupColumnLabel:oe,sortModalVisible:Ne,sortSettings:$e,sortableFields:Ae,showSortModal:Ee,addSortField:Pe,removeSortField:Me,applySortSettings:Oe,clearGroupSettings:Xe,clearSortSettings:Ie,columnSettingsVisible:ze,columnSettingsList:qe,allColumnsSelected:Be,showColumnSettings:Ge,handleSelectAllColumns:He,resetColumnSettings:Qe,handleDragEnd:Ye,applyColumnSettings:je,saveViewsToStorage:Je,updateViewConfig:Ze,applyViewConfig:el,batchOperation:ll,batchDialogVisible:al,batchForm:tl,handleBatchOperation:ol,handleBatchSubmit:il,handleSaveEdit:nl,getAppointmentStatusType:rl,getTagType:ul,removeAppointmentStatus:sl,removeTag:dl,memoDialogVisible:pl,memoForm:cl,followUpDialogVisible:ml,followUpForm:vl,followUpHistory:bl,historyDialogVisible:gl,historyRecords:kl,saveMemo:fl,saveFollowUp:Cl,loadFollowUpHistory:yl,loadHistoryRecords:Fl,podDialogVisible:Sl,handleUploadPod:_l,handlePodSubmit:Tl}}};var ve=a(6262);const be=(0,ve.A)(me,[["render",j],["__scopeId","data-v-57473347"]]),ge=be}}]);
//# sourceMappingURL=89.b1af8bfd.js.map