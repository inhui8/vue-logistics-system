"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[8926],{8926:(e,l,a)=>{a.r(l),a.d(l,{default:()=>g});var t=a(641),u=a(953),n=a(33),r=a(7918),d=a(163),o=a(8548);const i={class:"driver-list-container"},s={class:"card-header"},p={class:"dialog-footer"},c={__name:"DriverList",setup(e){const l=(0,u.KR)([{id:"supplier_1",name:"测试供应商A - 专做提框服务"},{id:"supplier_2",name:"测试供应商B - FBA派送专家"},{id:"supplier_3",name:"测试供应商C - 全能型选手"}]),a=(0,u.KR)([]),c=(e=30)=>{const a=["张师傅","李师傅","王司机","赵司机","孙师傅","周工","吴经理","郑技术员"],t=["131","132","133","134","135","136","137","138","139","186","158"],u=["A1","A2","A3","B1","B2","C1","C2"],n=["idle","on_trip","on_leave","deactivated"],r=[],d=new Date,o=new Date(d.getFullYear()+5,d.getMonth(),d.getDate());for(let i=0;i<e;i++){const e=l.value[Math.floor(Math.random()*l.value.length)];let s=o;Math.random()<.1?s=new Date(d.getTime()+Math.floor(40*Math.random()*24*60*60*1e3)):Math.random()<.2&&(s=new Date(d.getTime()+Math.floor(365*Math.random()*24*60*60*1e3))),r.push({id:`driver_${i+1}`,name:a[Math.floor(Math.random()*a.length)]+String.fromCharCode(65+i%26),supplierId:e.id,supplierName:e.name,phone:`${t[Math.floor(Math.random()*t.length)]}${String(Math.random()).slice(2,10)}`,licenseNumber:`DL${String(Math.random()).slice(2,14)}`,allowedVehicleTypes:u[Math.floor(Math.random()*u.length)],licenseExpiryDate:s.toISOString().split("T")[0],status:n[Math.floor(Math.random()*n.length)]})}return r},b=[{value:"idle",label:"空闲"},{value:"on_trip",label:"执行任务中"},{value:"on_leave",label:"休假中"},{value:"deactivated",label:"停用"}],m=(0,u.Kh)({supplierId:"",name:"",phone:"",status:"",licenseExpiringSoon:!1}),g=(0,u.Kh)({currentPage:1,pageSize:10}),f=(0,t.EW)((()=>h.value.length)),h=(0,t.EW)((()=>a.value.filter((e=>{const l=!m.supplierId||e.supplierId===m.supplierId,a=!m.name||e.name.includes(m.name),t=!m.phone||e.phone.includes(m.phone),u=!m.status||e.status===m.status,n=!m.licenseExpiringSoon||D(e.licenseExpiryDate,30);return l&&a&&t&&u&&n})))),k=(0,t.EW)((()=>{const e=(g.currentPage-1)*g.pageSize,l=e+g.pageSize;return h.value.slice(e,l)})),F=(0,u.KR)(!1),v=(0,u.KR)(""),_=(0,u.KR)(!1),y=(0,u.KR)(null),V={id:null,name:"",supplierId:"",phone:"",licenseNumber:"",allowedVehicleTypes:"",licenseExpiryDate:"",status:"idle"},w=(0,u.Kh)({...V}),x=(0,u.Kh)({supplierId:[{required:!0,message:"请选择所属供应商",trigger:"change"}],name:[{required:!0,message:"请输入驾驶员姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系方式",trigger:"blur"}],licenseNumber:[{required:!0,message:"请输入驾驶证号",trigger:"blur"}],allowedVehicleTypes:[{required:!0,message:"请输入准驾车型",trigger:"blur"}],licenseExpiryDate:[{required:!0,message:"请选择驾驶证有效期",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),C=e=>b.find((l=>l.value===e))?.label||e,E=e=>{switch(e){case"idle":return"success";case"on_trip":return"primary";case"on_leave":return"warning";case"deactivated":return"info";default:return"info"}},D=(e,l=30)=>{if(!e)return!1;const a=new Date,t=new Date(e),u=t.getTime()-a.getTime(),n=Math.ceil(u/864e5);return n>=0&&n<=l},M=()=>{g.currentPage=1},I=e=>{g.pageSize=e,g.currentPage=1},W=e=>{g.currentPage=e},S=()=>{Object.assign(w,V),(0,t.dY)((()=>{y.value?.clearValidate()}))},K=()=>{S(),_.value=!1,v.value="新增驾驶员",F.value=!0},N=e=>{S(),_.value=!0,v.value="编辑驾驶员信息",(0,t.dY)((()=>{Object.assign(w,JSON.parse(JSON.stringify(e)))})),F.value=!0},U=e=>{r.s.confirm(`确定要删除驾驶员 ${e.name} 吗?`,"警告",{type:"warning"}).then((()=>{console.log("删除驾驶员:",e.id);const l=a.value.findIndex((l=>l.id===e.id));-1!==l&&a.value.splice(l,1),d.nk.success("删除成功")})).catch((()=>d.nk.info("取消删除")))},z=()=>{S(),F.value=!1},T=async()=>{if(y.value)try{await y.value.validate();const e=l.value.find((e=>e.id===w.supplierId))?.name||"",t={...w,supplierName:e};if(_.value){console.log("更新驾驶员:",t);const e=a.value.findIndex((e=>e.id===t.id));-1!==e&&(a.value[e]=t),d.nk.success("更新成功")}else{const e={...t,id:`driver_${Date.now()}`};console.log("新增驾驶员:",e),a.value.unshift(e),d.nk.success("新增成功")}F.value=!1}catch(e){console.log("表单验证失败:",e),d.nk.error("请检查表单填写是否正确")}};return(0,t.sV)((()=>{a.value=c()})),(e,a)=>{const r=(0,t.g2)("el-icon"),d=(0,t.g2)("el-button"),c=(0,t.g2)("el-option"),h=(0,t.g2)("el-select"),V=(0,t.g2)("el-form-item"),S=(0,t.g2)("el-input"),R=(0,t.g2)("el-checkbox"),A=(0,t.g2)("el-form"),X=(0,t.g2)("el-table-column"),q=(0,t.g2)("el-tooltip"),Y=(0,t.g2)("el-tag"),L=(0,t.g2)("el-table"),P=(0,t.g2)("el-pagination"),$=(0,t.g2)("el-col"),O=(0,t.g2)("el-row"),j=(0,t.g2)("el-divider"),B=(0,t.g2)("el-date-picker"),J=(0,t.g2)("el-dialog"),Q=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(Q,null,{header:(0,t.k6)((()=>[(0,t.Lk)("div",s,[a[15]||(a[15]=(0,t.Lk)("span",null,"驾驶员列表",-1)),(0,t.bF)(d,{type:"primary",onClick:K},{default:(0,t.k6)((()=>[(0,t.bF)(r,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,u.R1)(o.FWt))])),_:1}),a[14]||(a[14]=(0,t.eW)(" 新增驾驶员 "))])),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(A,{inline:!0,model:m,class:"filter-form"},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"供应商"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:m.supplierId,"onUpdate:modelValue":a[0]||(a[0]=e=>m.supplierId=e),placeholder:"选择供应商",clearable:"",filterable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(l.value,(e=>((0,t.uX)(),(0,t.Wv)(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"驾驶员姓名"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:m.name,"onUpdate:modelValue":a[1]||(a[1]=e=>m.name=e),placeholder:"输入姓名",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"联系方式"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:m.phone,"onUpdate:modelValue":a[2]||(a[2]=e=>m.phone=e),placeholder:"输入手机号",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:m.status,"onUpdate:modelValue":a[3]||(a[3]=e=>m.status=e),placeholder:"选择状态",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(b,(e=>(0,t.bF)(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(V,{label:"驾照到期预警"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:m.licenseExpiringSoon,"onUpdate:modelValue":a[4]||(a[4]=e=>m.licenseExpiringSoon=e)},{default:(0,t.k6)((()=>a[16]||(a[16]=[(0,t.eW)("只看即将到期")]))),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(V,null,{default:(0,t.k6)((()=>[(0,t.bF)(d,{type:"primary",onClick:M},{default:(0,t.k6)((()=>a[17]||(a[17]=[(0,t.eW)("查询")]))),_:1})])),_:1})])),_:1},8,["model"]),(0,t.bF)(L,{data:k.value,style:{width:"100%"},border:""},{default:(0,t.k6)((()=>[(0,t.bF)(X,{prop:"name",label:"姓名",width:"120",fixed:""}),(0,t.bF)(X,{prop:"supplierName",label:"所属供应商",width:"200","show-overflow-tooltip":""}),(0,t.bF)(X,{prop:"phone",label:"联系方式",width:"130"}),(0,t.bF)(X,{prop:"licenseNumber",label:"驾驶证号",width:"180"}),(0,t.bF)(X,{prop:"allowedVehicleTypes",label:"准驾车型",width:"120"}),(0,t.bF)(X,{prop:"licenseExpiryDate",label:"驾驶证有效期",width:"140"},{default:(0,t.k6)((e=>[(0,t.Lk)("span",{class:(0,n.C4)({"expiring-soon":D(e.row.licenseExpiryDate)})},[(0,t.eW)((0,n.v_)(e.row.licenseExpiryDate)+" ",1),D(e.row.licenseExpiryDate)?((0,t.uX)(),(0,t.Wv)(q,{key:0,content:"驾照即将到期",placement:"top"},{default:(0,t.k6)((()=>[(0,t.bF)(r,{color:"#E6A23C",style:{"margin-left":"5px"}},{default:(0,t.k6)((()=>[(0,t.bF)((0,u.R1)(o.N5l))])),_:1})])),_:1})):(0,t.Q3)("",!0)],2)])),_:1}),(0,t.bF)(X,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(Y,{type:E(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(C(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(X,{label:"操作",fixed:"right",width:"150"},{default:(0,t.k6)((e=>[(0,t.bF)(d,{text:"",type:"primary",size:"small",onClick:l=>N(e.row)},{default:(0,t.k6)((()=>a[18]||(a[18]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(d,{text:"",type:"danger",size:"small",onClick:l=>U(e.row)},{default:(0,t.k6)((()=>a[19]||(a[19]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t.bF)(P,{style:{"margin-top":"20px","justify-content":"flex-end"},background:"",layout:"total, sizes, prev, pager, next, jumper",total:f.value,"page-sizes":[10,20,50,100],"page-size":g.pageSize,"current-page":g.currentPage,onSizeChange:I,onCurrentChange:W},null,8,["total","page-size","current-page"]),(0,t.bF)(J,{modelValue:F.value,"onUpdate:modelValue":a[13]||(a[13]=e=>F.value=e),title:v.value,width:"60%",onClose:z,"close-on-click-modal":!1},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",p,[(0,t.bF)(d,{onClick:a[12]||(a[12]=e=>F.value=!1)},{default:(0,t.k6)((()=>a[22]||(a[22]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(d,{type:"primary",onClick:T},{default:(0,t.k6)((()=>a[23]||(a[23]=[(0,t.eW)("确认")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(A,{ref_key:"driverFormRef",ref:y,model:w,rules:x,"label-width":"120px"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{gutter:20},{default:(0,t.k6)((()=>[(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"所属供应商",prop:"supplierId"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:w.supplierId,"onUpdate:modelValue":a[5]||(a[5]=e=>w.supplierId=e),placeholder:"选择供应商",filterable:"",style:{width:"100%"},disabled:_.value},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(l.value,(e=>((0,t.uX)(),(0,t.Wv)(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"驾驶员姓名",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:w.name,"onUpdate:modelValue":a[6]||(a[6]=e=>w.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(O,{gutter:20},{default:(0,t.k6)((()=>[(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"联系方式",prop:"phone"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:w.phone,"onUpdate:modelValue":a[7]||(a[7]=e=>w.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"状态",prop:"status"},{default:(0,t.k6)((()=>[(0,t.bF)(h,{modelValue:w.status,"onUpdate:modelValue":a[8]||(a[8]=e=>w.status=e),placeholder:"选择状态",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(b,(e=>(0,t.bF)(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(j,null,{default:(0,t.k6)((()=>a[20]||(a[20]=[(0,t.eW)("证照信息")]))),_:1}),(0,t.bF)(O,{gutter:20},{default:(0,t.k6)((()=>[(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"驾驶证号",prop:"licenseNumber"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:w.licenseNumber,"onUpdate:modelValue":a[9]||(a[9]=e=>w.licenseNumber=e),placeholder:"请输入驾驶证号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"准驾车型",prop:"allowedVehicleTypes"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{modelValue:w.allowedVehicleTypes,"onUpdate:modelValue":a[10]||(a[10]=e=>w.allowedVehicleTypes=e),placeholder:"如：C1, A2"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(O,{gutter:20},{default:(0,t.k6)((()=>[(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"驾驶证有效期",prop:"licenseExpiryDate"},{default:(0,t.k6)((()=>[(0,t.bF)(B,{modelValue:w.licenseExpiryDate,"onUpdate:modelValue":a[11]||(a[11]=e=>w.licenseExpiryDate=e),type:"date",placeholder:"选择有效期至",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.bF)($,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"从业资格证 (占位)"},{default:(0,t.k6)((()=>[(0,t.bF)(S,{disabled:"",placeholder:"待实现"})])),_:1})])),_:1})])),_:1}),(0,t.bF)(O,null,{default:(0,t.k6)((()=>[(0,t.bF)($,{span:24},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"相关证照上传"},{default:(0,t.k6)((()=>[(0,t.bF)(d,{link:"",type:"primary",disabled:""},{default:(0,t.k6)((()=>a[21]||(a[21]=[(0,t.eW)("点击上传 (待实现)")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])),_:1})])}}};var b=a(6262);const m=(0,b.A)(c,[["__scopeId","data-v-d93252e0"]]),g=m}}]);
//# sourceMappingURL=8926.7cf1f688.js.map