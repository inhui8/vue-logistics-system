"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[5367],{5367:(e,l,a)=>{a.r(l),a.d(l,{default:()=>Z});var t=a(641),i=a(33);const r={class:"inquiry-list-container"},o={class:"filter-bar"},u={class:"filter-row"},n={class:"date-buttons"},d={class:"action-buttons"},s={class:"view-management"},p={class:"status-view-group"},c={class:"custom-view-group"},m={class:"table-tools"},b={class:"table-container"},v={class:"sub-table-container"},g={class:"dialog-footer"},k={class:"sort-list"},f={class:"sort-item"},F={class:"dialog-footer"},h={class:"column-settings"},y={class:"column-settings-header"},w={class:"column-list"},V={class:"column-item"},C={class:"dialog-footer"},_={key:1},S={class:"quote-list-header"},W={class:"dialog-footer"},D={key:0,class:"negotiation-price"},I={class:"dialog-footer"},R={class:"dialog-footer"},q={class:"dialog-footer"},L={class:"view-list"},K={class:"dialog-footer"},T={class:"dialog-footer"};function U(e,l,a,U,x,N){const O=(0,t.g2)("el-option"),A=(0,t.g2)("el-select"),E=(0,t.g2)("el-date-picker"),X=(0,t.g2)("el-input"),z=(0,t.g2)("Plus"),P=(0,t.g2)("el-icon"),M=(0,t.g2)("el-button"),B=(0,t.g2)("Filter"),Q=(0,t.g2)("el-radio-button"),$=(0,t.g2)("el-radio-group"),G=(0,t.g2)("el-button-group"),H=(0,t.g2)("Grid"),Y=(0,t.g2)("Sort"),J=(0,t.g2)("Setting"),j=(0,t.g2)("el-table-column"),Z=(0,t.g2)("el-table"),ee=(0,t.g2)("el-tag"),le=(0,t.g2)("arrow-down"),ae=(0,t.g2)("el-dropdown-item"),te=(0,t.g2)("el-dropdown-menu"),ie=(0,t.g2)("el-dropdown"),re=(0,t.g2)("groupable-table"),oe=(0,t.g2)("filter-panel"),ue=(0,t.g2)("el-form-item"),ne=(0,t.g2)("el-form"),de=(0,t.g2)("el-dialog"),se=(0,t.g2)("d-arrow-left"),pe=(0,t.g2)("draggable"),ce=(0,t.g2)("el-checkbox"),me=(0,t.g2)("el-col"),be=(0,t.g2)("el-row"),ve=(0,t.g2)("el-descriptions-item"),ge=(0,t.g2)("el-descriptions"),ke=(0,t.g2)("el-divider"),fe=(0,t.g2)("el-input-number"),Fe=(0,t.g2)("el-timeline-item"),he=(0,t.g2)("el-timeline"),ye=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.Lk)("div",o,[(0,t.Lk)("div",u,[(0,t.bF)(A,{modelValue:U.filterForm.status,"onUpdate:modelValue":l[0]||(l[0]=e=>U.filterForm.status=e),placeholder:"询价状态",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"询价中",value:"inquiring"}),(0,t.bF)(O,{label:"报价收集完成",value:"quoted"}),(0,t.bF)(O,{label:"已授标",value:"awarded"}),(0,t.bF)(O,{label:"已取消",value:"cancelled"})])),_:1},8,["modelValue"]),(0,t.bF)(A,{modelValue:U.filterForm.orderType,"onUpdate:modelValue":l[1]||(l[1]=e=>U.filterForm.orderType=e),placeholder:"订单类型",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"FBA派送",value:"FBA"}),(0,t.bF)(O,{label:"提柜服务",value:"PICKUP"}),(0,t.bF)(O,{label:"派送服务",value:"DELIVERY"}),(0,t.bF)(O,{label:"仓储服务",value:"WAREHOUSE"})])),_:1},8,["modelValue"]),(0,t.bF)(A,{modelValue:U.createDateType,"onUpdate:modelValue":l[2]||(l[2]=e=>U.createDateType=e),placeholder:"创建日期",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"创建日期",value:"create"}),(0,t.bF)(O,{label:"报价截止日期",value:"deadline"})])),_:1},8,["modelValue"]),(0,t.Lk)("div",n,[(0,t.bF)(E,{modelValue:U.dateRange,"onUpdate:modelValue":l[3]||(l[3]=e=>U.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small",class:"date-range-picker",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,t.bF)(A,{modelValue:U.searchType,"onUpdate:modelValue":l[4]||(l[4]=e=>U.searchType=e),placeholder:"搜索类型",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"询价单号",value:"id"}),(0,t.bF)(O,{label:"订单号",value:"orderNumber"}),(0,t.bF)(O,{label:"发起人",value:"initiator"})])),_:1},8,["modelValue"]),(0,t.bF)(X,{modelValue:U.searchText,"onUpdate:modelValue":l[5]||(l[5]=e=>U.searchText=e),placeholder:"请输入搜索内容",size:"small",class:"search-input",clearable:""},null,8,["modelValue"]),(0,t.Lk)("div",d,[(0,t.bF)(M,{type:"primary",size:"small",onClick:U.handleCreateInquiry},{default:(0,t.k6)((()=>[(0,t.bF)(P,null,{default:(0,t.k6)((()=>[(0,t.bF)(z)])),_:1}),l[41]||(l[41]=(0,t.eW)(" 发起新询价 "))])),_:1},8,["onClick"]),(0,t.bF)(M,{size:"small",onClick:e.showFilterPanel},{default:(0,t.k6)((()=>[(0,t.bF)(P,null,{default:(0,t.k6)((()=>[(0,t.bF)(B)])),_:1}),l[42]||(l[42]=(0,t.eW)(" 高级筛选 "))])),_:1},8,["onClick"])])])]),(0,t.Lk)("div",s,[(0,t.Lk)("div",p,[(0,t.bF)($,{modelValue:U.currentView,"onUpdate:modelValue":l[6]||(l[6]=e=>U.currentView=e),size:"small"},{default:(0,t.k6)((()=>[(0,t.bF)(Q,{label:"all"},{default:(0,t.k6)((()=>l[43]||(l[43]=[(0,t.eW)("全部")]))),_:1}),(0,t.bF)(Q,{label:"inquiring"},{default:(0,t.k6)((()=>l[44]||(l[44]=[(0,t.eW)("询价中")]))),_:1}),(0,t.bF)(Q,{label:"quoted"},{default:(0,t.k6)((()=>l[45]||(l[45]=[(0,t.eW)("待授标")]))),_:1}),(0,t.bF)(Q,{label:"awarded"},{default:(0,t.k6)((()=>l[46]||(l[46]=[(0,t.eW)("已授标")]))),_:1}),(0,t.bF)(Q,{label:"cancelled"},{default:(0,t.k6)((()=>l[47]||(l[47]=[(0,t.eW)("已取消")]))),_:1})])),_:1},8,["modelValue"])]),(0,t.Lk)("div",c,[(0,t.bF)(A,{modelValue:U.selectedCustomView,"onUpdate:modelValue":l[7]||(l[7]=e=>U.selectedCustomView=e),placeholder:"自定义视图",size:"small",class:"view-select"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.customViews,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)(G,null,{default:(0,t.k6)((()=>[(0,t.bF)(M,{size:"small",onClick:U.handleCreateView},{default:(0,t.k6)((()=>[(0,t.bF)(P,null,{default:(0,t.k6)((()=>[(0,t.bF)(z)])),_:1}),l[48]||(l[48]=(0,t.eW)(" 新增视图 "))])),_:1},8,["onClick"]),(0,t.bF)(M,{size:"small",onClick:U.handleViewOptions},{default:(0,t.k6)((()=>l[49]||(l[49]=[(0,t.eW)("视图管理")]))),_:1},8,["onClick"])])),_:1})]),(0,t.Lk)("div",m,[(0,t.bF)(G,null,{default:(0,t.k6)((()=>[(0,t.bF)(M,{size:"small",onClick:U.showGroupModal},{default:(0,t.k6)((()=>[(0,t.bF)(P,null,{default:(0,t.k6)((()=>[(0,t.bF)(H)])),_:1}),l[50]||(l[50]=(0,t.eW)(" 分组 "))])),_:1},8,["onClick"]),(0,t.bF)(M,{size:"small",onClick:U.showSortModal},{default:(0,t.k6)((()=>[(0,t.bF)(P,null,{default:(0,t.k6)((()=>[(0,t.bF)(Y)])),_:1}),l[51]||(l[51]=(0,t.eW)(" 排序 "))])),_:1},8,["onClick"]),(0,t.bF)(M,{size:"small",onClick:U.showColumnSettings},{default:(0,t.k6)((()=>[(0,t.bF)(P,null,{default:(0,t.k6)((()=>[(0,t.bF)(J)])),_:1}),l[52]||(l[52]=(0,t.eW)(" 列设置 "))])),_:1},8,["onClick"])])),_:1})])]),(0,t.Lk)("div",b,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(re,{ref:"mainTable",data:U.displayData,"row-key":"id","group-fields":U.groupField?[U.groupField]:[],"show-selection":!0,"show-group-column":!!U.groupField,"group-column-label":U.groupField?e.getGroupColumnLabel(U.groupField):"分组","default-expand-all":!1,"show-pagination":!0,"current-page":U.currentPage,"page-size":U.pageSize,"page-sizes":[10,20,50,100],total:U.total,onSelectionChange:U.handleSelectionChange,onSizeChange:U.handleSizeChange,onCurrentChange:U.handleCurrentChange,onCellClick:e.handleCellClick,onCellDblclick:e.handleCellDbClick,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(j,{type:"expand"},{default:(0,t.k6)((a=>[(0,t.Lk)("div",v,[l[54]||(l[54]=(0,t.Lk)("h4",{class:"sub-table-title"},"子订单信息",-1)),(0,t.bF)(Z,{data:a.row.subOrders||[],border:"",size:"small",stripe:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.childColumns,(a=>((0,t.uX)(),(0,t.Wv)(j,{key:a.prop,prop:a.prop,label:a.label,width:a.width,sortable:a.sortable},(0,t.eX)({_:2},["operation"===a.prop?{name:"default",fn:(0,t.k6)((a=>[(0,t.bF)(M,{type:"text",size:"small",onClick:l=>e.handleSubOrderDetail(a.row)},{default:(0,t.k6)((()=>l[53]||(l[53]=[(0,t.eW)("详情")]))),_:2},1032,["onClick"])])),key:"0"}:void 0]),1032,["prop","label","width","sortable"])))),128))])),_:2},1032,["data"])])])),_:1}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.visibleColumns,(e=>((0,t.uX)(),(0,t.Wv)(j,{key:e.prop,prop:e.prop,label:e.label,width:e.width,"min-width":e.minWidth,fixed:e.fixed,sortable:e.sortable},(0,t.eX)({_:2},["status"===e.prop?{name:"default",fn:(0,t.k6)((e=>[(0,t.bF)(ee,{type:U.getStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.formatStatus(e.row.status)),1)])),_:2},1032,["type"])])),key:"0"}:"operation"===e.prop?{name:"default",fn:(0,t.k6)((e=>[(0,t.bF)(M,{text:"",type:"primary",size:"small",onClick:l=>U.handleViewDetails(e.row)},{default:(0,t.k6)((()=>l[55]||(l[55]=[(0,t.eW)("详情")]))),_:2},1032,["onClick"]),(0,t.bF)(ie,{trigger:"click",onCommand:l=>U.handleOperationCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(te,null,{default:(0,t.k6)((()=>[(0,t.bF)(ae,{command:"viewQuotes"},{default:(0,t.k6)((()=>l[57]||(l[57]=[(0,t.eW)("查看报价")]))),_:1}),"inquiring"===e.row.status?((0,t.uX)(),(0,t.Wv)(ae,{key:0,command:"cancelInquiry"},{default:(0,t.k6)((()=>l[58]||(l[58]=[(0,t.eW)("取消询价")]))),_:1})):(0,t.Q3)("",!0)])),_:2},1024)])),default:(0,t.k6)((()=>[(0,t.bF)(M,{text:"",type:"primary",size:"small"},{default:(0,t.k6)((()=>[l[56]||(l[56]=(0,t.eW)(" 更多")),(0,t.bF)(P,{class:"el-icon--right"},{default:(0,t.k6)((()=>[(0,t.bF)(le)])),_:1})])),_:1})])),_:2},1032,["onCommand"])])),key:"1"}:void 0]),1032,["prop","label","width","min-width","fixed","sortable"])))),128))])),_:1},8,["data","group-fields","show-group-column","group-column-label","current-page","page-size","total","onSelectionChange","onSizeChange","onCurrentChange","onCellClick","onCellDblclick"])),[[ye,U.loading]])]),(0,t.bF)(oe,{visible:U.filterPanelVisible,"onUpdate:visible":l[8]||(l[8]=e=>U.filterPanelVisible=e),columns:U.tableColumns,"active-filters":U.activeFilters,"filter-logic":U.filterLogic,onApply:e.applyFilters,onCancel:e.cancelFilters},null,8,["visible","columns","active-filters","filter-logic","onApply","onCancel"]),(0,t.bF)(de,{title:"分组设置",modelValue:U.groupModalVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>U.groupModalVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",g,[(0,t.bF)(M,{onClick:l[12]||(l[12]=e=>U.groupModalVisible=!1)},{default:(0,t.k6)((()=>l[59]||(l[59]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(M,{type:"primary",onClick:U.applyGroupSettings},{default:(0,t.k6)((()=>l[60]||(l[60]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:U.groupSettings,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"一级分组"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{modelValue:U.groupSettings.level1,"onUpdate:modelValue":l[9]||(l[9]=e=>U.groupSettings.level1=e),placeholder:"请选择",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(ue,{label:"二级分组"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{modelValue:U.groupSettings.level2,"onUpdate:modelValue":l[10]||(l[10]=e=>U.groupSettings.level2=e),placeholder:"请选择",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(ue,{label:"三级分组"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{modelValue:U.groupSettings.level3,"onUpdate:modelValue":l[11]||(l[11]=e=>U.groupSettings.level3=e),placeholder:"请选择",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(de,{title:"排序设置",modelValue:U.sortModalVisible,"onUpdate:modelValue":l[16]||(l[16]=e=>U.sortModalVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",F,[(0,t.bF)(M,{onClick:l[15]||(l[15]=e=>U.sortModalVisible=!1)},{default:(0,t.k6)((()=>l[63]||(l[63]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(M,{type:"primary",onClick:U.applySortSettings},{default:(0,t.k6)((()=>l[64]||(l[64]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",k,[(0,t.bF)(pe,{modelValue:U.sortSettings,"onUpdate:modelValue":l[14]||(l[14]=e=>U.sortSettings=e),"item-key":"field",handle:".drag-handle"},{item:(0,t.k6)((({element:e})=>[(0,t.Lk)("div",f,[(0,t.bF)(P,{class:"drag-handle"},{default:(0,t.k6)((()=>[(0,t.bF)(se)])),_:1}),(0,t.bF)(A,{modelValue:e.field,"onUpdate:modelValue":l=>e.field=l,placeholder:"选择字段",style:{width:"200px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.sortableFields,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(A,{modelValue:e.order,"onUpdate:modelValue":l=>e.order=l,placeholder:"排序方式",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(O,{label:"升序",value:"ascending"}),(0,t.bF)(O,{label:"降序",value:"descending"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(M,{type:"danger",link:"",onClick:l=>U.removeSortField(e)},{default:(0,t.k6)((()=>l[61]||(l[61]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])])),_:1},8,["modelValue"]),(0,t.bF)(M,{type:"primary",link:"",onClick:U.addSortField},{default:(0,t.k6)((()=>l[62]||(l[62]=[(0,t.eW)("添加排序字段")]))),_:1},8,["onClick"])])])),_:1},8,["modelValue"]),(0,t.bF)(de,{title:"列设置",modelValue:U.columnSettingsVisible,"onUpdate:modelValue":l[20]||(l[20]=e=>U.columnSettingsVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",C,[(0,t.bF)(M,{onClick:l[19]||(l[19]=e=>U.columnSettingsVisible=!1)},{default:(0,t.k6)((()=>l[67]||(l[67]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(M,{type:"primary",onClick:U.applyColumnSettings},{default:(0,t.k6)((()=>l[68]||(l[68]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",h,[(0,t.Lk)("div",y,[(0,t.bF)(ce,{modelValue:U.allColumnsSelected,"onUpdate:modelValue":l[17]||(l[17]=e=>U.allColumnsSelected=e),onChange:U.handleSelectAllColumns},{default:(0,t.k6)((()=>l[65]||(l[65]=[(0,t.eW)("全选")]))),_:1},8,["modelValue","onChange"]),(0,t.bF)(M,{type:"primary",size:"small",onClick:U.resetColumnSettings},{default:(0,t.k6)((()=>l[66]||(l[66]=[(0,t.eW)("重置")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",w,[(0,t.bF)(pe,{modelValue:U.columnSettingsList,"onUpdate:modelValue":l[18]||(l[18]=e=>U.columnSettingsList=e),"item-key":"prop",handle:".drag-handle",onEnd:U.handleDragEnd},{item:(0,t.k6)((({element:e})=>[(0,t.Lk)("div",V,[(0,t.bF)(P,{class:"drag-handle"},{default:(0,t.k6)((()=>[(0,t.bF)(se)])),_:1}),(0,t.bF)(ce,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:1},8,["modelValue","onEnd"])])])])),_:1},8,["modelValue"]),(0,t.bF)(de,{modelValue:U.dialogVisible,"onUpdate:modelValue":l[32]||(l[32]=e=>U.dialogVisible=e),title:U.dialogTitle,width:"75%",onClose:U.handleDialogClose,"close-on-click-modal":!1},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",R,[(0,t.bF)(M,{onClick:l[31]||(l[31]=e=>U.dialogVisible=!1)},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.isCreating?"取消":"关闭"),1)])),_:1}),U.isCreating?((0,t.uX)(),(0,t.Wv)(M,{key:0,type:"primary",onClick:U.handleSubmitInquiry},{default:(0,t.k6)((()=>l[80]||(l[80]=[(0,t.eW)("确认发起")]))),_:1},8,["onClick"])):(0,t.Q3)("",!0)])])),default:(0,t.k6)((()=>[U.isCreating?((0,t.uX)(),(0,t.Wv)(ne,{key:0,ref:"inquiryFormRef",model:U.inquiryForm,rules:U.formRules,"label-width":"120px"},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"服务需求描述",prop:"serviceDescription"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{modelValue:U.inquiryForm.serviceDescription,"onUpdate:modelValue":l[21]||(l[21]=e=>U.inquiryForm.serviceDescription=e),type:"textarea",rows:3,placeholder:"详细描述询价的服务内容、起止地、货物信息、时效要求等"},null,8,["modelValue"])])),_:1}),(0,t.bF)(be,{gutter:20},{default:(0,t.k6)((()=>[(0,t.bF)(me,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"报价截止时间",prop:"deadline"},{default:(0,t.k6)((()=>[(0,t.bF)(E,{modelValue:U.inquiryForm.deadline,"onUpdate:modelValue":l[22]||(l[22]=e=>U.inquiryForm.deadline=e),type:"datetime",placeholder:"选择截止时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.bF)(me,{span:12},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"邀请供应商",prop:"invitedSupplierIds"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{modelValue:U.inquiryForm.invitedSupplierIds,"onUpdate:modelValue":l[23]||(l[23]=e=>U.inquiryForm.invitedSupplierIds=e),multiple:"",filterable:"",placeholder:"选择要邀请报价的供应商",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.mockSuppliers,(e=>((0,t.uX)(),(0,t.Wv)(O,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(ue,{label:"备注 (可选)"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{modelValue:U.inquiryForm.remarks,"onUpdate:modelValue":l[24]||(l[24]=e=>U.inquiryForm.remarks=e),type:"textarea",rows:2,placeholder:"其他补充说明"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):((0,t.uX)(),(0,t.CE)("div",_,[l[75]||(l[75]=(0,t.Lk)("h4",null,"询价信息",-1)),(0,t.bF)(ge,{column:2,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(ve,{label:"询价单号"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.currentInquiry?.id),1)])),_:1}),(0,t.bF)(ve,{label:"订单号"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.currentInquiry?.orderNumber),1)])),_:1}),(0,t.bF)(ve,{label:"服务类型"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.formatServiceType(U.currentInquiry?.serviceType)),1)])),_:1}),(0,t.bF)(ve,{label:"截止时间"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.currentInquiry?.deadline),1)])),_:1}),(0,t.bF)(ve,{label:"需要预约"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.currentInquiry?.needAppointment?"是":"否"),1)])),_:1}),(0,t.bF)(ve,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.formatStatus(U.currentInquiry?.status)),1)])),_:1}),(0,t.bF)(ve,{label:"服务需求",span:2},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.currentInquiry?.serviceDescription),1)])),_:1}),(0,t.bF)(ve,{label:"备注",span:2},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(U.currentInquiry?.remarks||"-"),1)])),_:1})])),_:1}),(0,t.bF)(ke),(0,t.Lk)("div",S,[(0,t.Lk)("h4",null,"供应商报价列表 ("+(0,i.v_)(U.currentInquiry?.quotes?.length||0)+" 条)",1),"inquiring"===U.currentInquiry?.status?((0,t.uX)(),(0,t.Wv)(M,{key:0,type:"primary",size:"small",onClick:U.handleInviteSuppliers},{default:(0,t.k6)((()=>l[69]||(l[69]=[(0,t.eW)(" 邀请供应商报价 ")]))),_:1},8,["onClick"])):(0,t.Q3)("",!0)]),(0,t.bF)(Z,{data:U.currentInquiry?.quotes,style:{width:"100%"},border:"",size:"small"},{default:(0,t.k6)((()=>[(0,t.bF)(j,{prop:"supplierName",label:"供应商",width:"200","show-overflow-tooltip":""}),(0,t.bF)(j,{prop:"price",label:"报价 (USD)",width:"120",sortable:""},{default:(0,t.k6)((e=>[(0,t.Lk)("span",{class:(0,i.C4)({"best-quote":U.isBestQuote(e.row.price)})},(0,i.v_)(e.row.price?.toFixed(2)),3)])),_:1}),(0,t.bF)(j,{prop:"responseTime",label:"报价时间",width:"160"}),(0,t.bF)(j,{prop:"remarks",label:"备注","show-overflow-tooltip":""}),(0,t.bF)(j,{label:"操作",width:"180",fixed:"right"},{default:(0,t.k6)((e=>["quoted"===U.currentInquiry?.status||"inquiring"===U.currentInquiry?.status?((0,t.uX)(),(0,t.Wv)(M,{key:0,text:"",type:"success",size:"small",onClick:l=>U.handleAward(e.row)},{default:(0,t.k6)((()=>l[70]||(l[70]=[(0,t.eW)("授标")]))),_:2},1032,["onClick"])):(0,t.Q3)("",!0),(0,t.bF)(ie,{trigger:"click",onCommand:l=>U.handleQuoteCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(te,null,{default:(0,t.k6)((()=>[(0,t.bF)(ae,{command:"negotiate"},{default:(0,t.k6)((()=>l[72]||(l[72]=[(0,t.eW)("议价")]))),_:1}),(0,t.bF)(ae,{command:"viewNegotiationHistory"},{default:(0,t.k6)((()=>l[73]||(l[73]=[(0,t.eW)("查看议价记录")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(M,{text:"",type:"primary",size:"small"},{default:(0,t.k6)((()=>[l[71]||(l[71]=(0,t.eW)(" 更多")),(0,t.bF)(P,{class:"el-icon--right"},{default:(0,t.k6)((()=>[(0,t.bF)(le)])),_:1})])),_:1})])),_:2},1032,["onCommand"]),"awarded"===U.currentInquiry?.status&&U.currentInquiry?.awardedSupplierId===e.row.supplierId?((0,t.uX)(),(0,t.Wv)(ee,{key:1,type:"success"},{default:(0,t.k6)((()=>l[74]||(l[74]=[(0,t.eW)("已中标")]))),_:1})):(0,t.Q3)("",!0)])),_:1})])),_:1},8,["data"])])),(0,t.bF)(de,{modelValue:U.negotiateDialogVisible,"onUpdate:modelValue":l[28]||(l[28]=e=>U.negotiateDialogVisible=e),title:"议价",width:"500px","append-to-body":""},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",W,[(0,t.bF)(M,{onClick:l[27]||(l[27]=e=>U.negotiateDialogVisible=!1)},{default:(0,t.k6)((()=>l[77]||(l[77]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(M,{type:"primary",onClick:U.submitNegotiation},{default:(0,t.k6)((()=>l[78]||(l[78]=[(0,t.eW)("确认")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:U.negotiateForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"当前报价"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,i.v_)(U.currentQuote?.price)+" USD",1)])),_:1}),(0,t.bF)(ue,{label:"议价金额",prop:"price"},{default:(0,t.k6)((()=>[(0,t.bF)(fe,{modelValue:U.negotiateForm.price,"onUpdate:modelValue":l[25]||(l[25]=e=>U.negotiateForm.price=e),precision:2,step:.1,min:0,"controls-position":"right"},null,8,["modelValue"]),l[76]||(l[76]=(0,t.Lk)("span",{class:"unit"},"USD",-1))])),_:1}),(0,t.bF)(ue,{label:"议价说明",prop:"remarks"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{type:"textarea",modelValue:U.negotiateForm.remarks,"onUpdate:modelValue":l[26]||(l[26]=e=>U.negotiateForm.remarks=e),rows:3,placeholder:"请输入议价说明"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(de,{modelValue:U.negotiationHistoryDialogVisible,"onUpdate:modelValue":l[30]||(l[30]=e=>U.negotiationHistoryDialogVisible=e),title:"议价记录",width:"700px","append-to-body":""},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",I,[(0,t.bF)(M,{onClick:l[29]||(l[29]=e=>U.negotiationHistoryDialogVisible=!1)},{default:(0,t.k6)((()=>l[79]||(l[79]=[(0,t.eW)("关闭")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(he,null,{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(U.negotiationHistory,((e,l)=>((0,t.uX)(),(0,t.Wv)(Fe,{key:l,timestamp:e.time,type:e.type},{default:(0,t.k6)((()=>[(0,t.Lk)("h4",null,(0,i.v_)(e.title),1),(0,t.Lk)("p",null,(0,i.v_)(e.content),1),e.price?((0,t.uX)(),(0,t.CE)("p",D,"金额："+(0,i.v_)(e.price)+" USD",1)):(0,t.Q3)("",!0)])),_:2},1032,["timestamp","type"])))),128))])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue","title","onClose"]),(0,t.bF)(de,{title:"保存视图",modelValue:U.saveViewDialogVisible,"onUpdate:modelValue":l[35]||(l[35]=e=>U.saveViewDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",q,[(0,t.bF)(M,{onClick:l[34]||(l[34]=e=>U.saveViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[81]||(l[81]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(M,{type:"primary",onClick:U.saveView},{default:(0,t.k6)((()=>l[82]||(l[82]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:U.viewForm,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"视图名称"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{modelValue:U.viewForm.name,"onUpdate:modelValue":l[33]||(l[33]=e=>U.viewForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(de,{title:"视图管理",modelValue:U.viewOptionsDialogVisible,"onUpdate:modelValue":l[37]||(l[37]=e=>U.viewOptionsDialogVisible=e),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",K,[(0,t.bF)(M,{onClick:l[36]||(l[36]=e=>U.viewOptionsDialogVisible=!1)},{default:(0,t.k6)((()=>l[86]||(l[86]=[(0,t.eW)("关闭")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",L,[(0,t.bF)(Z,{data:U.customViews,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(j,{prop:"name",label:"视图名称"}),(0,t.bF)(j,{label:"操作",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(M,{text:"",type:"primary",onClick:l=>U.handleRenameView(e.row)},{default:(0,t.k6)((()=>l[83]||(l[83]=[(0,t.eW)("重命名")]))),_:2},1032,["onClick"]),(0,t.bF)(M,{text:"",type:"primary",onClick:l=>U.handleCopyView(e.row)},{default:(0,t.k6)((()=>l[84]||(l[84]=[(0,t.eW)("复制")]))),_:2},1032,["onClick"]),(0,t.bF)(M,{text:"",type:"danger",onClick:l=>U.handleDeleteView(e.row)},{default:(0,t.k6)((()=>l[85]||(l[85]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])])),_:1},8,["modelValue"]),(0,t.bF)(de,{title:"重命名视图",modelValue:U.renameViewDialogVisible,"onUpdate:modelValue":l[40]||(l[40]=e=>U.renameViewDialogVisible=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",T,[(0,t.bF)(M,{onClick:l[39]||(l[39]=e=>U.renameViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[87]||(l[87]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(M,{type:"primary",onClick:U.saveRenameView},{default:(0,t.k6)((()=>l[88]||(l[88]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(ne,{model:U.renameForm,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"视图名称"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{modelValue:U.renameForm.name,"onUpdate:modelValue":l[38]||(l[38]=e=>U.renameForm.name=e),placeholder:"请输入新的视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}var x=a(953),N=a(7918),O=a(163),A=a(8548),E=a(3344),X=a(2998),z=a(432),P=a.n(z);const M=JSON.parse('[{"prop":"id","label":"询价单号","width":150,"sortable":true,"filterType":"text"},{"prop":"orderNumber","label":"订单号","width":150,"sortable":true,"filterType":"text"},{"prop":"orderType","label":"订单类型","width":120,"sortable":true,"filterType":"select","filterOptions":[{"label":"FBA派送","value":"FBA"},{"label":"提柜服务","value":"PICKUP"},{"label":"派送服务","value":"DELIVERY"},{"label":"仓储服务","value":"WAREHOUSE"}]},{"prop":"serviceDescription","label":"服务需求描述","min-width":250,"sortable":true,"filterType":"text"},{"prop":"initiator","label":"发起人","width":120,"sortable":true,"filterType":"text"},{"prop":"createdAt","label":"创建时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"deadline","label":"报价截止时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"supplierCount","label":"受邀供应商数","width":130,"sortable":true,"filterType":"number"},{"prop":"quoteCount","label":"已报价数","width":110,"sortable":true,"filterType":"number"},{"prop":"status","label":"状态","width":130,"sortable":true,"filterType":"select","filterOptions":[{"label":"询价中","value":"inquiring"},{"label":"报价收集完成","value":"quoted"},{"label":"已授标","value":"awarded"},{"label":"已取消","value":"cancelled"}]},{"prop":"operation","label":"操作","width":200,"fixed":"right","sortable":false}]'),B=JSON.parse('[{"prop":"id","label":"子订单号","width":150,"sortable":true},{"prop":"orderNumber","label":"订单号","width":150,"sortable":true},{"prop":"pcNumber","label":"PC号","width":120,"sortable":true},{"prop":"serviceType","label":"服务类型","width":120,"sortable":true},{"prop":"origin","label":"起运地","width":120,"sortable":true},{"prop":"destination","label":"目的地","width":120,"sortable":true},{"prop":"status","label":"状态","width":100,"sortable":true},{"prop":"operation","label":"操作","width":120,"fixed":"right"}]'),Q=JSON.parse('{"l":[{"id":"INQ-2403001","orderNumber":"ORD-2403001","orderType":"FBA","serviceDescription":"LAX 港 - ONT8 提柜 (需今日完成)","initiator":"仓库管理员X","createdAt":"2024-03-20 09:00:00","deadline":"2024-03-20 18:00:00","supplierCount":3,"quoteCount":2,"status":"inquiring","invitedSupplierIds":["supplier_1","supplier_2","supplier_3"],"quotes":[{"supplierId":"supplier_1","supplierName":"测试供应商A - 专做提框服务","price":450,"responseTime":"2024-03-20 10:30:00","remarks":"价格含税"},{"supplierId":"supplier_2","supplierName":"测试供应商B - FBA派送专家","price":480,"responseTime":"2024-03-20 11:15:00","remarks":"含装卸费"}],"subOrders":[{"id":"SUB-ORD-2403001-1","orderNumber":"ORD-2403001","pcNumber":"PC-2403001-1","serviceType":"提柜","origin":"LAX","destination":"ONT8","status":"待报价"},{"id":"SUB-ORD-2403001-2","orderNumber":"ORD-2403001","pcNumber":"PC-2403001-2","serviceType":"派送","origin":"ONT8","destination":"FBA","status":"待报价"}]},{"id":"INQ-2403002","orderNumber":"ORD-2403002","orderType":"PICKUP","serviceDescription":"LGB 港 - LAX9 提柜 (3日内)","initiator":"运营专员Y","createdAt":"2024-03-20 10:30:00","deadline":"2024-03-22 18:00:00","supplierCount":4,"quoteCount":3,"status":"quoted","invitedSupplierIds":["supplier_1","supplier_2","supplier_3","supplier_4"],"quotes":[{"supplierId":"supplier_1","supplierName":"测试供应商A - 专做提框服务","price":380,"responseTime":"2024-03-20 14:20:00","remarks":"价格含税"},{"supplierId":"supplier_3","supplierName":"测试供应商C - 全能型选手","price":420,"responseTime":"2024-03-20 15:45:00","remarks":"含装卸费"},{"supplierId":"supplier_4","supplierName":"测试供应商D - 区域小霸王","price":450,"responseTime":"2024-03-20 16:30:00","remarks":"含装卸费"}],"subOrders":[{"id":"SUB-ORD-2403002-1","orderNumber":"ORD-2403002","pcNumber":"PC-2403002-1","serviceType":"提柜","origin":"LGB","destination":"LAX9","status":"已报价"}]}]}'),$=M,G=B,H=Q.l,Y={name:"InquiryList",components:{FilterPanel:E.A,GroupableTable:X.A,draggable:P(),Plus:A.FWt,Filter:A.dJT,Grid:A.xA9,Sort:A.FUI,Setting:A.B5R,DArrowLeft:A.V6m,ArrowDown:A.yd$},setup(){const e=(0,x.KR)($),l=(0,x.KR)(G),a=(0,x.KR)(H),i=(0,x.KR)([]),r=(0,x.KR)(!1),o=(0,x.KR)([...$]),u=(0,x.KR)([]),n=(0,x.KR)({status:"",orderType:"",dateRange:[]}),d=(0,x.KR)("create"),s=(0,x.KR)([]),p=(0,x.KR)("id"),c=(0,x.KR)(""),m=(0,x.KR)(!1),b=(0,x.KR)([]),v=(0,x.KR)("and"),g=(0,x.KR)(1),k=(0,x.KR)(20),f=(0,x.KR)(0),F=(0,t.EW)((()=>f.value)),h=(0,x.KR)("all"),y=(0,x.KR)(""),w=(0,x.KR)([]),V=(0,x.KR)(!1),C=(0,x.KR)(!1),_=(0,x.KR)(!1),S=(0,x.KR)(""),W=(0,x.KR)({name:"",columns:[]}),D=(0,x.KR)(null),I=(0,x.KR)({name:""}),R=(0,x.KR)(!1),q=(0,x.KR)({level1:"",level2:"",level3:""}),L=(0,t.EW)((()=>i.value.some((e=>e.isGroup)))),K=(0,x.KR)(!1),T=(0,x.KR)([]),U=(0,t.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop)))),A=(0,x.KR)(!1),E=(0,x.KR)([...$]),X=(0,t.EW)({get:()=>E.value.every((e=>e.visible)),set:e=>E.value.forEach((l=>l.visible=e))}),z=(0,x.KR)(!1),P=(0,x.KR)(""),M=(0,x.KR)(!1),B=(0,x.KR)(null),Q=(0,x.KR)(null),Y={serviceDescription:"",deadline:"",invitedSupplierIds:[],remarks:""},J=(0,x.KR)({...Y}),j={serviceDescription:[{required:!0,message:"请输入服务需求描述",trigger:"blur"}],deadline:[{required:!0,message:"请选择报价截止时间",trigger:"change"}],invitedSupplierIds:[{required:!0,type:"array",message:"请至少邀请一个供应商",trigger:"change"}]},Z=(0,x.KR)([{id:"supplier_1",name:"测试供应商A - 专做提框服务"},{id:"supplier_2",name:"测试供应商B - FBA派送专家"},{id:"supplier_3",name:"测试供应商C - 全能型选手"},{id:"supplier_4",name:"测试供应商D - 区域小霸王"}]),ee=(0,t.EW)((()=>Q.value&&Q.value.quotes&&0!==Q.value.quotes.length?Math.min(...Q.value.quotes.map((e=>e.price))):1/0)),le=e=>null!==e&&void 0!==e&&e===ee.value,ae=e=>{const l={inquiring:"询价中",quoted:"报价收集完成",awarded:"已授标",cancelled:"已取消"};return l[e]||e},te=e=>{const l={inquiring:"primary",quoted:"warning",awarded:"success",cancelled:"info"};return l[e]||"info"},ie=()=>{r.value=!0;try{f.value=a.value.length,re()}catch(e){console.error("加载数据失败:",e)}finally{r.value=!1}},re=()=>{let e=[...a.value];if("all"!==h.value&&(e=e.filter((e=>e.status===h.value))),n.value.orderType&&(e=e.filter((e=>e.orderType===n.value.orderType))),s.value&&2===s.value.length){const[l,a]=s.value;e=e.filter((e=>{const t="create"===d.value?e.createdAt:e.deadline;return t>=l&&t<=a}))}c.value&&(e=e.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),T.value.length>0&&e.sort(((e,l)=>{for(const a of T.value){const t=e[a.field],i=l[a.field];if(t!==i)return"ascending"===a.order?t>i?1:-1:t<i?1:-1}return 0})),S.value&&(e=oe(e,S.value));const l=(g.value-1)*k.value,t=l+k.value;i.value=e.slice(l,t)},oe=(e,l)=>{const a={};e.forEach((e=>{const t=e[l]||"未分类";a[t]||(a[t]=[]),a[t].push({...e})}));const t=[];for(const[i,r]of Object.entries(a))t.push({id:`group-${i}`,groupName:i,count:r.length,isGroup:!0,groupLevel:0,children:r});return t},ue=e=>{u.value=e},ne=e=>{k.value=e,g.value=1,re()},de=e=>{g.value=e,re()},se=()=>{g.value=1,re()},pe=()=>{J.value={...Y},M.value=!0,P.value="发起新询价",z.value=!0},ce=e=>{Q.value=JSON.parse(JSON.stringify(e)),M.value=!1,P.value=`询价单详情 (${e.id})`,z.value=!0},me=e=>{N.s.confirm(`确定要取消询价单 ${e.id} 吗?`,"确认取消",{type:"warning"}).then((()=>{const l=a.value.findIndex((l=>l.id===e.id));-1!==l&&"inquiring"===a.value[l].status?(a.value[l].status="cancelled",O.nk.success("询价已取消"),re()):O.nk.error("操作失败或状态已不允许取消")})).catch((()=>O.nk.info("取消操作")))},be=e=>{if(!Q.value)return;const l=Q.value;N.s.confirm(`确定将此询价授予供应商 ${e.supplierName} (${e.price?.toFixed(2)} USD) 吗?`,"确认授标",{type:"success"}).then((()=>{const t=a.value.findIndex((e=>e.id===l.id));-1!==t?(a.value[t].status="awarded",a.value[t].awardedSupplierId=e.supplierId,a.value[t].awardedSupplierName=e.supplierName,a.value[t].awardedPrice=e.price,Q.value.status="awarded",Q.value.awardedSupplierId=e.supplierId,Q.value.awardedSupplierName=e.supplierName,Q.value.awardedPrice=e.price,O.nk.success("授标成功"),re()):O.nk.error("授标失败: 未找到询价单")})).catch((()=>O.nk.info("取消授标")))},ve=async()=>{if(B.value)try{await B.value.validate();const e=new Date,l={id:`INQ-${String(e.getFullYear()).slice(2)}${String(e.getMonth()+1).padStart(2,"0")}${String(Date.now()).slice(-4)}`,orderNumber:`ORD-${String(e.getFullYear()).slice(2)}${String(e.getMonth()+1).padStart(2,"0")}${String(Date.now()).slice(-4)}`,orderType:"FBA",serviceDescription:J.value.serviceDescription,initiator:"当前用户",createdAt:e.toLocaleString(),deadline:J.value.deadline,supplierCount:J.value.invitedSupplierIds.length,quoteCount:0,status:"inquiring",invitedSupplierIds:J.value.invitedSupplierIds,quotes:[],awardedSupplierId:null,awardedSupplierName:null,awardedPrice:null,remarks:J.value.remarks,subOrders:[]};a.value.unshift(l),O.nk.success("询价发起成功"),z.value=!1,re()}catch(e){console.log("表单验证失败:",e),O.nk.error("请检查表单填写是否正确")}},ge=()=>{J.value={...Y},Q.value=null,z.value=!1},ke=()=>{W.value={name:"",columns:e.value.filter((e=>!1!==e.visible)).map((e=>e.prop))},V.value=!0},fe=l=>{const a=w.value.find((e=>e.id===l));a&&(o.value=e.value.filter((e=>a.columns.includes(e.prop))),b.value=a.filters||[],v.value=a.filterLogic||"and",q.value=a.groupSettings||{level1:"",level2:"",level3:""},S.value=q.value.level1,T.value=a.sortSettings||[],re())},Fe=()=>{if(!W.value.name)return void O.nk.warning("请输入视图名称");const e={id:Date.now().toString(),name:W.value.name,columns:W.value.columns,filters:b.value,filterLogic:v.value,groupSettings:q.value,sortSettings:T.value};w.value.push(e),xe(),V.value=!1,O.nk.success("视图保存成功")},he=e=>{N.s.confirm(`确定要删除视图 "${e.name}" 吗?`,"确认删除",{type:"warning"}).then((()=>{const l=w.value.findIndex((l=>l.id===e.id));-1!==l&&(w.value.splice(l,1),xe(),O.nk.success("视图删除成功"))})).catch((()=>O.nk.info("取消删除")))},ye=()=>{C.value=!0},we=e=>{D.value=e,I.value.name=e.name,_.value=!0},Ve=()=>{if(!I.value.name)return void O.nk.warning("请输入视图名称");const e=D.value;e&&(e.name=I.value.name,xe(),_.value=!1,O.nk.success("视图重命名成功"))},Ce=e=>{const l={id:Date.now().toString(),name:`${e.name} (副本)`,columns:[...e.columns],filters:[...e.filters],filterLogic:e.filterLogic,groupSettings:{...e.groupSettings},sortSettings:[...e.sortSettings]};w.value.push(l),xe(),O.nk.success("视图复制成功")},_e=()=>{R.value=!0},Se=()=>{S.value=q.value.level1,re(),R.value=!1},We=()=>{K.value=!0},De=()=>{T.value.push({field:"",order:"ascending"})},Ie=e=>{const l=T.value.findIndex((l=>l===e));-1!==l&&T.value.splice(l,1)},Re=()=>{re(),K.value=!1},qe=()=>{A.value=!0},Le=e=>{E.value.forEach((l=>l.visible=e))},Ke=()=>{E.value=[...$]},Te=()=>{},Ue=()=>{o.value=E.value.filter((e=>e.visible)),re(),A.value=!1},xe=()=>{localStorage.setItem("inquiryViews",JSON.stringify(w.value))},Ne=()=>{const e=localStorage.getItem("inquiryViews");if(e)try{w.value=JSON.parse(e)}catch(l){console.error("加载保存的视图失败:",l)}};(0,t.wB)(y,(e=>{e&&(h.value=e,fe(e))}));const Oe=()=>{W.value={name:"",columns:e.value.filter((e=>!1!==e.visible)).map((e=>e.prop)),filters:b.value,filterLogic:v.value,groupSettings:q.value,sortSettings:T.value},V.value=!0},Ae=(e,l)=>{switch(e){case"viewQuotes":ce(l);break;case"cancelInquiry":me(l);break}},Ee=(0,x.KR)(!1),Xe=(0,x.KR)(!1),ze=(0,x.KR)(null),Pe=(0,x.KR)({price:0,remarks:""}),Me=(0,x.KR)([]),Be=e=>{const l={PICKUP:"提柜",DELIVERY:"派送",DIRECT:"直送"};return l[e]||e},Qe=(e,l)=>{switch(ze.value=l,e){case"negotiate":Pe.value.price=l.price,Ee.value=!0;break;case"viewNegotiationHistory":Ge(l);break}},$e=()=>{ze.value&&(Me.value.unshift({time:(new Date).toLocaleString(),type:"primary",title:"发起议价",content:Pe.value.remarks,price:Pe.value.price}),ze.value.price=Pe.value.price,ze.value.remarks=`${ze.value.remarks||""}\n[议价]${Pe.value.remarks}`,Ee.value=!1,O.nk.success("议价提交成功"))},Ge=e=>{Me.value=[{time:"2024-03-14 14:30:00",type:"primary",title:"供应商回复",content:"考虑到运力安排，可以接受这个价格",price:e.price},{time:"2024-03-14 14:00:00",type:"warning",title:"发起议价",content:"希望能够优化一下价格",price:e.price+20},{time:"2024-03-14 10:00:00",type:"info",title:"初始报价",content:"首次报价",price:e.price+40}],Xe.value=!0},He=()=>{O.nk.success("邀请供应商报价功能待实现")};return(0,t.sV)((()=>{o.value=e.value,Ne(),ie()})),{tableColumns:e,childColumns:l,tableData:a,displayData:i,loading:r,visibleColumns:o,selectedRows:u,filterForm:n,createDateType:d,dateRange:s,searchType:p,searchText:c,filterPanelVisible:m,activeFilters:b,filterLogic:v,currentPage:g,pageSize:k,totalItems:f,total:F,currentView:h,selectedCustomView:y,customViews:w,saveViewDialogVisible:V,viewOptionsDialogVisible:C,renameViewDialogVisible:_,groupField:S,viewForm:W,currentEditingView:D,renameForm:I,groupModalVisible:R,groupSettings:q,hasGroupedData:L,sortModalVisible:K,sortSettings:T,sortableFields:U,columnSettingsVisible:A,columnSettingsList:E,allColumnsSelected:X,dialogVisible:z,dialogTitle:P,isCreating:M,inquiryFormRef:B,currentInquiry:Q,inquiryForm:J,formRules:j,mockSuppliers:Z,lowestPrice:ee,isBestQuote:le,formatStatus:ae,getStatusTagType:te,handleSelectionChange:ue,handleSizeChange:ne,handleCurrentChange:de,handleSearch:se,handleCreateInquiry:pe,handleViewDetails:ce,handleCancelInquiry:me,handleAward:be,handleSubmitInquiry:ve,handleDialogClose:ge,handleSaveView:ke,saveView:Fe,handleDeleteView:he,handleViewOptions:ye,handleRenameView:we,saveRenameView:Ve,handleCopyView:Ce,showGroupModal:_e,applyGroupSettings:Se,showSortModal:We,addSortField:De,removeSortField:Ie,applySortSettings:Re,showColumnSettings:qe,handleSelectAllColumns:Le,resetColumnSettings:Ke,handleDragEnd:Te,applyColumnSettings:Ue,applyViewConfig:fe,handleCreateView:Oe,handleOperationCommand:Ae,formatServiceType:Be,negotiateDialogVisible:Ee,negotiationHistoryDialogVisible:Xe,currentQuote:ze,negotiateForm:Pe,negotiationHistory:Me,handleQuoteCommand:Qe,submitNegotiation:$e,handleInviteSuppliers:He}}};var J=a(6262);const j=(0,J.A)(Y,[["render",U],["__scopeId","data-v-60e24556"]]),Z=j}}]);
//# sourceMappingURL=5367.ef4b3f34.js.map