"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[5551],{1830:(e,l,a)=>{a.r(l),a.d(l,{default:()=>fe});var o=a(641),t=a(3751),i=a(33);const r={class:"delivery-trains-container"},n={class:"filter-bar"},u={class:"filter-row"},s={class:"date-buttons"},d={class:"action-buttons"},p={class:"view-management"},c={class:"table-container"},m={class:"sub-table-container"},v={class:"image-slot"},b={key:1},g={key:0,class:"group-name"},h={key:1},k={key:0,class:"cell-editor"},f=["onClick"],w={key:2},y={class:"tag-cell"},F={class:"view-options-menu"},C={class:"group-settings"},V={class:"group-level"},T={class:"group-level"},x={class:"group-level"},_={class:"dialog-footer"},S={class:"sort-settings"},D={class:"sort-actions"},R={class:"dialog-footer"},P={class:"column-settings"},W={class:"column-settings-header"},U={class:"column-list"},N={class:"column-item"},E={class:"dialog-footer"},L={class:"dialog-footer"},K={class:"follow-up-container"},A={class:"follow-up-history"},O={class:"follow-up-item"},M={class:"follow-up-content"},X={key:0,class:"follow-up-files"},z={class:"file-list"},I={class:"follow-up-operator"},q={class:"dialog-footer"},B={class:"expense-detail-container"},G={class:"expense-form"},$={class:"dialog-footer"},j={class:"dialog-footer"};function Y(e,l,a,Y,H,J){const Q=(0,o.g2)("el-option"),Z=(0,o.g2)("el-select"),ee=(0,o.g2)("el-date-picker"),le=(0,o.g2)("el-input"),ae=(0,o.g2)("el-button"),oe=(0,o.g2)("el-dropdown-item"),te=(0,o.g2)("el-dropdown-menu"),ie=(0,o.g2)("el-dropdown"),re=(0,o.g2)("el-radio-button"),ne=(0,o.g2)("el-radio-group"),ue=(0,o.g2)("picture-filled"),se=(0,o.g2)("el-icon"),de=(0,o.g2)("el-image"),pe=(0,o.g2)("el-table-column"),ce=(0,o.g2)("el-table"),me=(0,o.g2)("el-tag"),ve=(0,o.g2)("groupable-table"),be=(0,o.g2)("filter-panel"),ge=(0,o.g2)("el-form-item"),he=(0,o.g2)("el-checkbox"),ke=(0,o.g2)("el-checkbox-group"),fe=(0,o.g2)("el-form"),we=(0,o.g2)("el-dialog"),ye=(0,o.g2)("d-arrow-left"),Fe=(0,o.g2)("draggable"),Ce=(0,o.g2)("expense-detail-dialog"),Ve=(0,o.g2)("document"),Te=(0,o.g2)("el-link"),xe=(0,o.g2)("el-timeline-item"),_e=(0,o.g2)("el-timeline"),Se=(0,o.g2)("el-upload"),De=(0,o.g2)("history-record-dialog"),Re=(0,o.g2)("gps-track-dialog"),Pe=(0,o.g2)("VehicleAssignmentDialog"),We=(0,o.g2)("UploadPodDialog"),Ue=(0,o.g2)("FileUploadWithTagDialog"),Ne=(0,o.g2)("el-input-number"),Ee=(0,o.g2)("AppointmentModal"),Le=(0,o.gN)("loading");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",n,[(0,o.Lk)("div",u,[(0,o.bF)(Z,{modelValue:Y.warehouse,"onUpdate:modelValue":l[0]||(l[0]=e=>Y.warehouse=e),placeholder:"美西二号仓",size:"small",class:"filter-item"},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"美西二号仓",value:"west2"}),(0,o.bF)(Q,{label:"美西一号仓",value:"west1"}),(0,o.bF)(Q,{label:"新泽西一号仓",value:"east1"}),(0,o.bF)(Q,{label:"萨凡纳二号仓",value:"east2"}),(0,o.bF)(Q,{label:"达拉斯三号仓",value:"east3"})])),_:1},8,["modelValue"]),(0,o.bF)(Z,{modelValue:Y.createDateType,"onUpdate:modelValue":l[1]||(l[1]=e=>Y.createDateType=e),placeholder:"ETA",size:"small",class:"filter-item"},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"ETA",value:"eta"}),(0,o.bF)(Q,{label:"提柜时间",value:"issue"}),(0,o.bF)(Q,{label:"抵仓时间",value:"appointment"}),(0,o.bF)(Q,{label:"预计拆柜时间",value:"expectedUnloading"}),(0,o.bF)(Q,{label:"拆柜完成时间",value:"unloading"})])),_:1},8,["modelValue"]),(0,o.Lk)("div",s,[(0,o.bF)(ee,{modelValue:Y.dateRange,"onUpdate:modelValue":l[2]||(l[2]=e=>Y.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small",class:"date-range-picker",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,o.bF)(Z,{modelValue:Y.searchType,"onUpdate:modelValue":l[3]||(l[3]=e=>Y.searchType=e),placeholder:"搜索类型",size:"small",class:"filter-item"},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"柜号",value:"containerNo"})])),_:1},8,["modelValue"]),(0,o.bF)(le,{placeholder:"请输入",modelValue:Y.searchText,"onUpdate:modelValue":l[4]||(l[4]=e=>Y.searchText=e),size:"small",class:"search-input","prefix-icon":"el-icon-search"},null,8,["modelValue"]),(0,o.Lk)("div",d,[(0,o.bF)(ae,{type:"primary",size:"small",onClick:Y.handleSearch},{default:(0,o.k6)((()=>l[64]||(l[64]=[(0,o.eW)("查询")]))),_:1},8,["onClick"]),(0,o.bF)(ie,{trigger:"click",onCommand:e.handleBatchCommand},{dropdown:(0,o.k6)((()=>[(0,o.bF)(te,null,{default:(0,o.k6)((()=>[(0,o.bF)(oe,{command:"extractFees"},{default:(0,o.k6)((()=>l[66]||(l[66]=[(0,o.eW)("批量提取费用")]))),_:1}),(0,o.bF)(oe,{command:"memo"},{default:(0,o.k6)((()=>l[67]||(l[67]=[(0,o.eW)("批量Memo")]))),_:1}),(0,o.bF)(oe,{command:"followUp"},{default:(0,o.k6)((()=>l[68]||(l[68]=[(0,o.eW)("批量跟进记录")]))),_:1})])),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(ae,{type:"warning",size:"small"},{default:(0,o.k6)((()=>l[65]||(l[65]=[(0,o.eW)(" 批量操作"),(0,o.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:1},8,["onCommand"]),(0,o.bF)(ae,{size:"small"},{default:(0,o.k6)((()=>l[69]||(l[69]=[(0,o.eW)("导出列表")]))),_:1}),(0,o.bF)(ae,{size:"small"},{default:(0,o.k6)((()=>l[70]||(l[70]=[(0,o.eW)("导出")]))),_:1})])])]),(0,o.Lk)("div",p,[l[83]||(l[83]=(0,o.Lk)("span",{class:"view-label"},null,-1)),(0,o.bF)(ne,{modelValue:Y.currentView,"onUpdate:modelValue":l[5]||(l[5]=e=>Y.currentView=e),size:"small",class:"status-view-group"},{default:(0,o.k6)((()=>[(0,o.bF)(re,{value:"all"},{default:(0,o.k6)((()=>l[71]||(l[71]=[(0,o.eW)("全部(21794)")]))),_:1}),(0,o.bF)(re,{value:"waitRegister"},{default:(0,o.k6)((()=>l[72]||(l[72]=[(0,o.eW)("已备货(107)")]))),_:1}),(0,o.bF)(re,{value:"registered"},{default:(0,o.k6)((()=>l[73]||(l[73]=[(0,o.eW)("已预约(152)")]))),_:1}),(0,o.bF)(re,{value:"loading"},{default:(0,o.k6)((()=>l[74]||(l[74]=[(0,o.eW)("已check in(0)")]))),_:1}),(0,o.bF)(re,{value:"loaded"},{default:(0,o.k6)((()=>l[75]||(l[75]=[(0,o.eW)("已提走(3)")]))),_:1}),(0,o.bF)(re,{value:"shipped"},{default:(0,o.k6)((()=>l[76]||(l[76]=[(0,o.eW)("已送达(1585)")]))),_:1}),(0,o.bF)(re,{value:"delivered"},{default:(0,o.k6)((()=>l[77]||(l[77]=[(0,o.eW)("已发POD(16351)")]))),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.customViews,(e=>((0,o.uX)(),(0,o.Wv)(re,{key:e.id,label:e.id,onContextmenu:(0,t.D$)((l=>Y.handleContextMenu(l,e)),["prevent"])},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.name),1)])),_:2},1032,["label","onContextmenu"])))),128))])),_:1},8,["modelValue"]),(0,o.bF)(ae,{type:"text",size:"small",onClick:Y.handleSaveView},{default:(0,o.k6)((()=>l[78]||(l[78]=[(0,o.eW)("新增视图")]))),_:1},8,["onClick"]),(0,o.bF)(ae,{type:"text",size:"small",onClick:Y.showGroupModal},{default:(0,o.k6)((()=>l[79]||(l[79]=[(0,o.eW)("高级分组")]))),_:1},8,["onClick"]),(0,o.bF)(ae,{type:"text",size:"small",onClick:Y.showSortModal},{default:(0,o.k6)((()=>l[80]||(l[80]=[(0,o.eW)("高级排序")]))),_:1},8,["onClick"]),(0,o.bF)(ae,{type:"text",size:"small",onClick:Y.showFilterPanel},{default:(0,o.k6)((()=>l[81]||(l[81]=[(0,o.eW)("筛选")]))),_:1},8,["onClick"]),(0,o.bF)(ae,{type:"text",size:"small",onClick:Y.showColumnSettings},{default:(0,o.k6)((()=>l[82]||(l[82]=[(0,o.eW)("字段配置")]))),_:1},8,["onClick"])]),(0,o.Lk)("div",c,[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(ve,{ref:"mainTable",data:Y.displayData,"row-key":"orderNumber","group-fields":Y.groupField?[Y.groupField]:[],"show-selection":!0,"show-group-column":!!Y.groupField,"group-column-label":Y.groupField?Y.getGroupColumnLabel(Y.groupField):"分组","default-expand-all":!1,"show-pagination":!0,"current-page":Y.currentPage,"page-size":Y.pageSize,"page-sizes":[10,20,50,100],total:Y.total,onSelectionChange:Y.handleSelectionChange,onSizeChange:Y.handleSizeChange,onCurrentChange:Y.handleCurrentChange,onCellClick:Y.handleCellClick,onCellDblclick:Y.handleCellDbClick,style:{width:"100%"},"expand-row-keys":e.expandedRowKeys,onExpandChange:Y.handleExpandChange,border:"",resizable:!0},{default:(0,o.k6)((()=>[(0,o.bF)(pe,{type:"expand"},{default:(0,o.k6)((a=>[(0,o.Lk)("div",m,[l[87]||(l[87]=(0,o.Lk)("h4",{class:"sub-table-title"},"PC信息",-1)),(0,o.bF)(ce,{data:a.row.children||[],border:"",size:"small",stripe:"",style:{width:"100%"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.childColumns,(a=>((0,o.uX)(),(0,o.Wv)(pe,{key:a.prop,prop:a.prop,label:a.label,width:a.width,sortable:a.sortable,fixed:a.fixed},(0,o.eX)({_:2},["podImage"===a.prop?{name:"default",fn:(0,o.k6)((e=>[e.row.podImage?((0,o.uX)(),(0,o.Wv)(de,{key:0,src:e.row.podImage,"preview-src-list":[e.row.podImage],fit:"cover",style:{width:"50px",height:"50px"}},{error:(0,o.k6)((()=>[(0,o.Lk)("div",v,[(0,o.bF)(se,null,{default:(0,o.k6)((()=>[(0,o.bF)(ue)])),_:1})])])),_:2},1032,["src","preview-src-list"])):((0,o.uX)(),(0,o.CE)("span",b,"-"))])),key:"0"}:"operation"===a.prop?{name:"default",fn:(0,o.k6)((a=>[(0,o.bF)(ae,{type:"text",size:"small",onClick:l=>e.handleViewDetails(a.row)},{default:(0,o.k6)((()=>l[84]||(l[84]=[(0,o.eW)("详情")]))),_:2},1032,["onClick"]),(0,o.bF)(ie,{size:"small",onCommand:e=>Y.handleChildCommand(e,a.row)},{dropdown:(0,o.k6)((()=>[(0,o.bF)(te,null,{default:(0,o.k6)((()=>[(0,o.bF)(oe,{command:"uploadPod"},{default:(0,o.k6)((()=>l[86]||(l[86]=[(0,o.eW)("上传POD")]))),_:1})])),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(ae,{type:"text",size:"small"},{default:(0,o.k6)((()=>l[85]||(l[85]=[(0,o.eW)(" 更多"),(0,o.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),key:"1"}:void 0]),1032,["prop","label","width","sortable","fixed"])))),128))])),_:2},1032,["data"])])])),_:1}),Y.hasGroupedData?((0,o.uX)(),(0,o.Wv)(pe,{key:0,label:"分组信息",width:"200"},{default:(0,o.k6)((e=>[e.row.isGroup?((0,o.uX)(),(0,o.CE)("span",g,[(0,o.bF)(me,{type:Y.getGroupTagType(e.row.groupLevel)},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.row.groupName)+" ("+(0,i.v_)(e.row.count||0)+") ",1)])),_:2},1032,["type"])])):((0,o.uX)(),(0,o.CE)("span",h,"-"))])),_:1})):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.tableColumns,(e=>((0,o.uX)(),(0,o.CE)(o.FK,{key:e.prop},[!1!==e.visible&&"orderStatus"===e.prop?((0,o.uX)(),(0,o.Wv)(pe,{key:0,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,o.k6)((e=>[(0,o.bF)(me,{type:Y.getStatusTagType(e.row.orderStatus),effect:"plain",size:"small"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.row.orderStatus),1)])),_:2},1032,["type"])])),_:2},1032,["prop","label","width","sortable"])):!1!==e.visible&&"operation"===e.prop?((0,o.uX)(),(0,o.Wv)(pe,{key:1,label:e.label,width:e.width,fixed:"right"},{default:(0,o.k6)((e=>[(0,o.bF)(ae,{type:"text",size:"small",onClick:l=>Y.handleDetail(e.row)},{default:(0,o.k6)((()=>l[88]||(l[88]=[(0,o.eW)("详情")]))),_:2},1032,["onClick"]),(0,o.bF)(ie,{size:"small",onCommand:l=>Y.handleCommand(l,e.row)},{dropdown:(0,o.k6)((()=>[(0,o.bF)(te,null,{default:(0,o.k6)((()=>[(0,o.bF)(oe,{command:"vehicleAssignment"},{default:(0,o.k6)((()=>l[90]||(l[90]=[(0,o.eW)("车辆分配")]))),_:1}),(0,o.bF)(oe,{command:"memo"},{default:(0,o.k6)((()=>l[91]||(l[91]=[(0,o.eW)("Memo")]))),_:1}),(0,o.bF)(oe,{command:"followUp"},{default:(0,o.k6)((()=>l[92]||(l[92]=[(0,o.eW)("跟进记录")]))),_:1}),(0,o.bF)(oe,{command:"history"},{default:(0,o.k6)((()=>l[93]||(l[93]=[(0,o.eW)("历史记录")]))),_:1}),(0,o.bF)(oe,{command:"podUpload"},{default:(0,o.k6)((()=>l[94]||(l[94]=[(0,o.eW)("POD上传")]))),_:1}),(0,o.bF)(oe,{command:"expenseDetail"},{default:(0,o.k6)((()=>l[95]||(l[95]=[(0,o.eW)("费用明细")]))),_:1}),(0,o.bF)(oe,{command:"expensePull"},{default:(0,o.k6)((()=>l[96]||(l[96]=[(0,o.eW)("费用拉取")]))),_:1}),(0,o.bF)(oe,{command:"gpsTrack"},{default:(0,o.k6)((()=>l[97]||(l[97]=[(0,o.eW)("GPS轨迹")]))),_:1}),(0,o.bF)(oe,{command:"markException"},{default:(0,o.k6)((()=>l[98]||(l[98]=[(0,o.eW)("标记异常")]))),_:1}),(0,o.bF)(oe,{command:"fileUploadWithTag"},{default:(0,o.k6)((()=>l[99]||(l[99]=[(0,o.eW)("文件上传")]))),_:1}),(0,o.bF)(oe,{command:"pickup"},{default:(0,o.k6)((()=>l[100]||(l[100]=[(0,o.eW)("提货预约")]))),_:1})])),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(ae,{type:"text",size:"small"},{default:(0,o.k6)((()=>l[89]||(l[89]=[(0,o.eW)(" 更多"),(0,o.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:2},1032,["label","width"])):!1!==e.visible?((0,o.uX)(),(0,o.Wv)(pe,{key:2,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,o.k6)((a=>[Y.isEditableField(e.prop)&&Y.editingCell.rowIndex===a.$index&&Y.editingCell.prop===e.prop?((0,o.uX)(),(0,o.CE)("div",k,["datetime"===Y.getEditControlType(e.prop)?((0,o.uX)(),(0,o.Wv)(ee,{key:0,modelValue:Y.editingCell.value,"onUpdate:modelValue":l[6]||(l[6]=e=>Y.editingCell.value=e),type:"datetime",size:"small",onBlur:l=>Y.saveEdit(a.row,e.prop),onKeyup:(0,t.jR)((l=>Y.saveEdit(a.row,e.prop)),["enter"]),style:{width:"100%"}},null,8,["modelValue","onBlur","onKeyup"])):"select"===Y.getEditControlType(e.prop)?((0,o.uX)(),(0,o.Wv)(Z,{key:1,modelValue:Y.editingCell.value,"onUpdate:modelValue":l[7]||(l[7]=e=>Y.editingCell.value=e),size:"small",onBlur:l=>Y.saveEdit(a.row,e.prop),onKeyup:(0,t.jR)((l=>Y.saveEdit(a.row,e.prop)),["enter"]),style:{width:"100%"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.getEditControlOptions(e.prop),(e=>((0,o.uX)(),(0,o.Wv)(Q,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onBlur","onKeyup"])):((0,o.uX)(),(0,o.Wv)(le,{key:2,modelValue:Y.editingCell.value,"onUpdate:modelValue":l[8]||(l[8]=e=>Y.editingCell.value=e),size:"small",onBlur:l=>Y.saveEdit(a.row,e.prop),onKeyup:(0,t.jR)((l=>Y.saveEdit(a.row,e.prop)),["enter"])},null,8,["modelValue","onBlur","onKeyup"]))])):Y.isEditableField(e.prop)?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"editable-cell",onClick:l=>Y.handleCellClick(a.row,e,a.$el)},(0,i.v_)(a.row[e.prop]||"-"),9,f)):((0,o.uX)(),(0,o.CE)("span",w,(0,i.v_)(a.row[e.prop]||"-"),1))])),_:2},1032,["prop","label","width","sortable"])):(0,o.Q3)("",!0)],64)))),128)),(0,o.bF)(pe,{prop:"tags",label:"标签",width:"200"},{default:(0,o.k6)((e=>[(0,o.Lk)("div",y,[Array.isArray(e.row.tags)&&e.row.tags.length?((0,o.uX)(!0),(0,o.CE)(o.FK,{key:0},(0,o.pI)(e.row.tags,(l=>((0,o.uX)(),(0,o.Wv)(me,{key:l,type:Y.getTagType(l),closable:"",onClose:a=>Y.handleTagClose(e.row,"tags",l)},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(l),1)])),_:2},1032,["type","onClose"])))),128)):"string"===typeof e.row.tags&&e.row.tags?((0,o.uX)(!0),(0,o.CE)(o.FK,{key:1},(0,o.pI)(e.row.tags.split(","),(l=>((0,o.uX)(),(0,o.Wv)(me,{key:l,type:Y.getTagType(l),closable:"",onClose:a=>Y.handleTagClose(e.row,"tags",l)},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(l.trim()),1)])),_:2},1032,["type","onClose"])))),128)):((0,o.uX)(),(0,o.Wv)(me,{key:2,type:"info"},{default:(0,o.k6)((()=>l[101]||(l[101]=[(0,o.eW)("未设置")]))),_:1}))])])),_:1})])),_:1},8,["data","group-fields","show-group-column","group-column-label","current-page","page-size","total","onSelectionChange","onSizeChange","onCurrentChange","onCellClick","onCellDblclick","expand-row-keys","onExpandChange"])),[[Le,Y.loading]])]),(0,o.bF)(be,{visible:Y.filterPanelVisible,"onUpdate:visible":l[9]||(l[9]=e=>Y.filterPanelVisible=e),columns:Y.tableColumns,"existing-filters":Y.activeFilters,"existing-logic":Y.filterLogic,onApplyFilters:Y.applyFilters,onCancel:Y.cancelFilters},null,8,["visible","columns","existing-filters","existing-logic","onApplyFilters","onCancel"]),(0,o.bF)(we,{title:"保存视图",modelValue:Y.saveViewDialogVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>Y.saveViewDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.bF)(ae,{onClick:l[12]||(l[12]=e=>Y.saveViewDialogVisible=!1)},{default:(0,o.k6)((()=>l[102]||(l[102]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.saveView},{default:(0,o.k6)((()=>l[103]||(l[103]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(fe,{model:Y.viewForm,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(ge,{label:"视图名称",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(le,{modelValue:Y.viewForm.name,"onUpdate:modelValue":l[10]||(l[10]=e=>Y.viewForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"显示字段"},{default:(0,o.k6)((()=>[(0,o.bF)(ke,{modelValue:Y.viewForm.columns,"onUpdate:modelValue":l[11]||(l[11]=e=>Y.viewForm.columns=e)},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.tableColumns,(e=>((0,o.uX)(),(0,o.Wv)(he,{key:e.prop,label:e.prop},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"视图操作",modelValue:Y.viewOptionsDialogVisible,"onUpdate:modelValue":l[17]||(l[17]=e=>Y.viewOptionsDialogVisible=e),width:"300px"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",F,[(0,o.Lk)("div",{class:"view-option-item",onClick:l[14]||(l[14]=(...e)=>Y.handleRenameView&&Y.handleRenameView(...e))},l[104]||(l[104]=[(0,o.Lk)("i",{class:"el-icon-edit"},null,-1),(0,o.Lk)("span",null,"重命名视图",-1)])),(0,o.Lk)("div",{class:"view-option-item",onClick:l[15]||(l[15]=(...e)=>Y.handleCopyView&&Y.handleCopyView(...e))},l[105]||(l[105]=[(0,o.Lk)("i",{class:"el-icon-document-copy"},null,-1),(0,o.Lk)("span",null,"复制视图",-1)])),(0,o.Lk)("div",{class:"view-option-item",onClick:l[16]||(l[16]=(...e)=>Y.handleDeleteView&&Y.handleDeleteView(...e))},l[106]||(l[106]=[(0,o.Lk)("i",{class:"el-icon-delete"},null,-1),(0,o.Lk)("span",null,"删除视图",-1)]))])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"重命名视图",modelValue:Y.renameViewDialogVisible,"onUpdate:modelValue":l[20]||(l[20]=e=>Y.renameViewDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.bF)(ae,{onClick:l[19]||(l[19]=e=>Y.renameViewDialogVisible=!1)},{default:(0,o.k6)((()=>l[107]||(l[107]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.saveRenameView},{default:(0,o.k6)((()=>l[108]||(l[108]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(fe,{model:Y.renameForm,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(ge,{label:"视图名称",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(le,{modelValue:Y.renameForm.name,"onUpdate:modelValue":l[18]||(l[18]=e=>Y.renameForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"编辑信息",modelValue:Y.editDialogVisible,"onUpdate:modelValue":l[24]||(l[24]=e=>Y.editDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.bF)(ae,{onClick:l[23]||(l[23]=e=>Y.editDialogVisible=!1)},{default:(0,o.k6)((()=>l[109]||(l[109]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.saveDialogEdit},{default:(0,o.k6)((()=>l[110]||(l[110]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(fe,{model:Y.editingForm,"label-width":"120px"},{default:(0,o.k6)((()=>[Y.editingColumn.prop?((0,o.uX)(),(0,o.Wv)(ge,{key:0,label:Y.editingColumn.label},{default:(0,o.k6)((()=>[["loadingType","deliveryType","loader","dockNumber","driverLicense","licensePlate","driverPhone","supplier"].includes(Y.editingColumn.prop)?((0,o.uX)(),(0,o.Wv)(Z,{key:0,modelValue:Y.editingForm.value,"onUpdate:modelValue":l[21]||(l[21]=e=>Y.editingForm.value=e),style:{width:"100%"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.getOptionsForColumn(Y.editingColumn.prop),(e=>((0,o.uX)(),(0,o.Wv)(Q,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):((0,o.uX)(),(0,o.Wv)(le,{key:1,modelValue:Y.editingForm.value,"onUpdate:modelValue":l[22]||(l[22]=e=>Y.editingForm.value=e),type:["actualPallets","palletsMerged","deliveryCost"].includes(Y.editingColumn.prop)?"number":"text"},null,8,["modelValue","type"]))])),_:1},8,["label"])):(0,o.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bo)((0,o.Lk)("div",{class:"context-menu",style:(0,i.Tr)({left:Y.contextMenuX+"px",top:Y.contextMenuY+"px"})},[(0,o.Lk)("div",{class:"context-menu-item",onClick:l[25]||(l[25]=(...e)=>Y.handleCopyView&&Y.handleCopyView(...e))},l[111]||(l[111]=[(0,o.Lk)("span",null,"复制视图",-1)])),(0,o.Lk)("div",{class:"context-menu-item",onClick:l[26]||(l[26]=(...e)=>Y.handleRenameView&&Y.handleRenameView(...e))},l[112]||(l[112]=[(0,o.Lk)("span",null,"重命名",-1)])),(0,o.Lk)("div",{class:"context-menu-item",onClick:l[27]||(l[27]=(...e)=>Y.handleDeleteView&&Y.handleDeleteView(...e))},l[113]||(l[113]=[(0,o.Lk)("span",null,"删除",-1)]))],4),[[t.aG,Y.contextMenuVisible]]),(0,o.bF)(we,{title:"分组设置",modelValue:Y.groupModalVisible,"onUpdate:modelValue":l[32]||(l[32]=e=>Y.groupModalVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",_,[(0,o.bF)(ae,{onClick:l[31]||(l[31]=e=>Y.groupModalVisible=!1)},{default:(0,o.k6)((()=>l[117]||(l[117]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"danger",onClick:Y.clearGroupSettings},{default:(0,o.k6)((()=>l[118]||(l[118]=[(0,o.eW)("清除分组")]))),_:1},8,["onClick"]),(0,o.bF)(ae,{type:"primary",onClick:Y.applyGroupSettings},{default:(0,o.k6)((()=>l[119]||(l[119]=[(0,o.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",C,[(0,o.Lk)("div",V,[l[114]||(l[114]=(0,o.Lk)("span",{class:"group-level-label"},"一级分组：",-1)),(0,o.bF)(Z,{modelValue:Y.groupSettings.level1,"onUpdate:modelValue":l[28]||(l[28]=e=>Y.groupSettings.level1=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.groupableFields,(e=>((0,o.uX)(),(0,o.Wv)(Q,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,o.Lk)("div",T,[l[115]||(l[115]=(0,o.Lk)("span",{class:"group-level-label"},"二级分组：",-1)),(0,o.bF)(Z,{modelValue:Y.groupSettings.level2,"onUpdate:modelValue":l[29]||(l[29]=e=>Y.groupSettings.level2=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.groupableFields,(e=>((0,o.uX)(),(0,o.Wv)(Q,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,o.Lk)("div",x,[l[116]||(l[116]=(0,o.Lk)("span",{class:"group-level-label"},"三级分组：",-1)),(0,o.bF)(Z,{modelValue:Y.groupSettings.level3,"onUpdate:modelValue":l[30]||(l[30]=e=>Y.groupSettings.level3=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.groupableFields,(e=>((0,o.uX)(),(0,o.Wv)(Q,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"排序设置",modelValue:Y.sortModalVisible,"onUpdate:modelValue":l[34]||(l[34]=e=>Y.sortModalVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",R,[(0,o.bF)(ae,{onClick:l[33]||(l[33]=e=>Y.sortModalVisible=!1)},{default:(0,o.k6)((()=>l[122]||(l[122]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"danger",onClick:Y.clearSortSettings},{default:(0,o.k6)((()=>l[123]||(l[123]=[(0,o.eW)("清除排序")]))),_:1},8,["onClick"]),(0,o.bF)(ae,{type:"primary",onClick:Y.applySortSettings},{default:(0,o.k6)((()=>l[124]||(l[124]=[(0,o.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",S,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.sortSettings,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{key:a,class:"sort-item"},[(0,o.bF)(Z,{modelValue:e.field,"onUpdate:modelValue":l=>e.field=l,placeholder:"选择字段",style:{width:"200px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.sortableFields,(e=>((0,o.uX)(),(0,o.Wv)(Q,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,o.bF)(Z,{modelValue:e.direction,"onUpdate:modelValue":l=>e.direction=l,placeholder:"排序方向",style:{width:"120px"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"升序",value:"asc"}),(0,o.bF)(Q,{label:"降序",value:"desc"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,o.bF)(ae,{type:"danger",size:"small",onClick:e=>Y.removeSortField(a)},{default:(0,o.k6)((()=>l[120]||(l[120]=[(0,o.eW)("删除")]))),_:2},1032,["onClick"])])))),128)),(0,o.Lk)("div",D,[(0,o.bF)(ae,{type:"primary",plain:"",onClick:Y.addSortField},{default:(0,o.k6)((()=>l[121]||(l[121]=[(0,o.eW)("添加排序字段")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"字段配置",modelValue:Y.columnSettingsVisible,"onUpdate:modelValue":l[38]||(l[38]=e=>Y.columnSettingsVisible=e),width:"600px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",E,[(0,o.bF)(ae,{onClick:l[37]||(l[37]=e=>Y.columnSettingsVisible=!1)},{default:(0,o.k6)((()=>l[127]||(l[127]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.applyColumnSettings},{default:(0,o.k6)((()=>l[128]||(l[128]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",P,[(0,o.Lk)("div",W,[(0,o.bF)(he,{modelValue:Y.allColumnsSelected,"onUpdate:modelValue":l[35]||(l[35]=e=>Y.allColumnsSelected=e),onChange:Y.handleSelectAllColumns},{default:(0,o.k6)((()=>l[125]||(l[125]=[(0,o.eW)("全选")]))),_:1},8,["modelValue","onChange"]),(0,o.bF)(ae,{type:"primary",size:"small",onClick:Y.resetColumnSettings},{default:(0,o.k6)((()=>l[126]||(l[126]=[(0,o.eW)("重置")]))),_:1},8,["onClick"])]),(0,o.Lk)("div",U,[(0,o.bF)(Fe,{modelValue:Y.columnSettingsList,"onUpdate:modelValue":l[36]||(l[36]=e=>Y.columnSettingsList=e),"item-key":"prop",handle:".drag-handle",onEnd:Y.handleDragEnd},{item:(0,o.k6)((({element:e})=>[(0,o.Lk)("div",N,[(0,o.bF)(se,{class:"drag-handle"},{default:(0,o.k6)((()=>[(0,o.bF)(ye)])),_:1}),(0,o.bF)(he,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:1},8,["modelValue","onEnd"])])])])),_:1},8,["modelValue"]),(0,o.bF)(Ce,{visible:Y.expenseDialogVisible,"onUpdate:visible":l[39]||(l[39]=e=>Y.expenseDialogVisible=e),"train-data":Y.currentTrainData,onExpensePushed:Y.handleExpensePushed,onPushCancelled:Y.handlePushCancelled},null,8,["visible","train-data","onExpensePushed","onPushCancelled"]),(0,o.bF)(we,{title:"MEMO",modelValue:Y.memoDialogVisible,"onUpdate:modelValue":l[42]||(l[42]=e=>Y.memoDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",L,[(0,o.bF)(ae,{onClick:l[41]||(l[41]=e=>Y.memoDialogVisible=!1)},{default:(0,o.k6)((()=>l[129]||(l[129]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.saveMemo},{default:(0,o.k6)((()=>l[130]||(l[130]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.bF)(fe,{model:Y.memoForm,"label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(ge,{label:"备注"},{default:(0,o.k6)((()=>[(0,o.bF)(le,{modelValue:Y.memoForm.memo,"onUpdate:modelValue":l[40]||(l[40]=e=>Y.memoForm.memo=e),type:"textarea",rows:4,placeholder:"请输入备注信息"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"跟进记录",modelValue:Y.followUpDialogVisible,"onUpdate:modelValue":l[46]||(l[46]=e=>Y.followUpDialogVisible=e),width:"600px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",q,[(0,o.bF)(ae,{onClick:l[45]||(l[45]=e=>Y.followUpDialogVisible=!1)},{default:(0,o.k6)((()=>l[134]||(l[134]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.saveFollowUp},{default:(0,o.k6)((()=>l[135]||(l[135]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",K,[(0,o.Lk)("div",A,[l[131]||(l[131]=(0,o.Lk)("h4",null,"历史记录",-1)),(0,o.bF)(_e,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Y.followUpHistory,((e,l)=>((0,o.uX)(),(0,o.Wv)(xe,{key:l,timestamp:e.time,type:e.type},{default:(0,o.k6)((()=>[(0,o.Lk)("div",O,[(0,o.Lk)("div",M,(0,i.v_)(e.content),1),e.files&&e.files.length?((0,o.uX)(),(0,o.CE)("div",X,[(0,o.Lk)("div",z,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.files,((e,l)=>((0,o.uX)(),(0,o.CE)("div",{key:l,class:"file-item"},[(0,o.bF)(Te,{type:"primary",href:e.url,target:"_blank"},{default:(0,o.k6)((()=>[(0,o.bF)(se,null,{default:(0,o.k6)((()=>[(0,o.bF)(Ve)])),_:1}),(0,o.eW)(" "+(0,i.v_)(e.name),1)])),_:2},1032,["href"])])))),128))])])):(0,o.Q3)("",!0),(0,o.Lk)("div",I,"操作人："+(0,i.v_)(e.operator),1)])])),_:2},1032,["timestamp","type"])))),128))])),_:1})]),(0,o.bF)(fe,{model:Y.followUpForm,"label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(ge,{label:"跟进内容"},{default:(0,o.k6)((()=>[(0,o.bF)(le,{modelValue:Y.followUpForm.content,"onUpdate:modelValue":l[43]||(l[43]=e=>Y.followUpForm.content=e),type:"textarea",rows:4,placeholder:"请输入跟进内容"},null,8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"跟进类型"},{default:(0,o.k6)((()=>[(0,o.bF)(Z,{modelValue:Y.followUpForm.type,"onUpdate:modelValue":l[44]||(l[44]=e=>Y.followUpForm.type=e),placeholder:"请选择跟进类型",style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"常规跟进",value:"primary"}),(0,o.bF)(Q,{label:"重要跟进",value:"warning"}),(0,o.bF)(Q,{label:"紧急跟进",value:"danger"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"上传文件"},{default:(0,o.k6)((()=>[(0,o.bF)(Se,{class:"upload-demo",action:"/api/upload","on-success":Y.handleUploadSuccess,"on-error":Y.handleUploadError,"before-upload":Y.beforeUpload,"file-list":Y.followUpForm.files,multiple:""},{tip:(0,o.k6)((()=>l[133]||(l[133]=[(0,o.Lk)("div",{class:"el-upload__tip"}," 支持上传图片、文档等文件，单个文件不超过10MB ",-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(ae,{type:"primary"},{default:(0,o.k6)((()=>l[132]||(l[132]=[(0,o.eW)("点击上传")]))),_:1})])),_:1},8,["on-success","on-error","before-upload","file-list"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),(0,o.bF)(De,{visible:Y.historyDialogVisible,"onUpdate:visible":l[47]||(l[47]=e=>Y.historyDialogVisible=e),"train-data":Y.currentTrainData},null,8,["visible","train-data"]),(0,o.bF)(Re,{visible:Y.gpsTrackDialogVisible,"onUpdate:visible":l[48]||(l[48]=e=>Y.gpsTrackDialogVisible=e),"train-data":Y.currentGpsTrainData},null,8,["visible","train-data"]),(0,o.bF)(Pe,{modelValue:Y.vehicleAssignmentVisible,"onUpdate:modelValue":l[49]||(l[49]=e=>Y.vehicleAssignmentVisible=e),onAssign:Y.handleVehicleAssign,onCancelAssign:Y.handleVehicleCancelAssign},null,8,["modelValue","onAssign","onCancelAssign"]),(0,o.bF)(We,{modelValue:Y.podDialogVisible,"onUpdate:modelValue":l[50]||(l[50]=e=>Y.podDialogVisible=e),"current-pod-row":Y.currentPodRow,onSubmit:Y.handlePodSubmit,onCancel:Y.handlePodCancel},null,8,["modelValue","current-pod-row","onSubmit","onCancel"]),(0,o.bF)(Ue,{modelValue:Y.fileUploadWithTagVisible,"onUpdate:modelValue":l[51]||(l[51]=e=>Y.fileUploadWithTagVisible=e),"current-row":Y.currentFileRow,onSubmit:Y.handleFileUploadWithTagSubmit,onCancel:Y.handleFileUploadWithTagCancel},null,8,["modelValue","current-row","onSubmit","onCancel"]),(0,o.bF)(we,{title:"费用明细",modelValue:Y.expenseDetailVisible,"onUpdate:modelValue":l[57]||(l[57]=e=>Y.expenseDetailVisible=e),width:"800px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",$,[(0,o.bF)(ae,{onClick:l[56]||(l[56]=e=>Y.expenseDetailVisible=!1)},{default:(0,o.k6)((()=>l[139]||(l[139]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.handleAddExpense},{default:(0,o.k6)((()=>l[140]||(l[140]=[(0,o.eW)("添加")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",B,[(0,o.bF)(ce,{data:Y.expenseList,border:"",size:"small",style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(pe,{prop:"expenseType",label:"费用类型",width:"120"}),(0,o.bF)(pe,{prop:"amount",label:"金额",width:"120"},{default:(0,o.k6)((e=>[(0,o.eW)((0,i.v_)(Y.formatCurrency(e.row.amount)),1)])),_:1}),(0,o.bF)(pe,{prop:"currency",label:"币种",width:"80"}),(0,o.bF)(pe,{prop:"description",label:"说明"}),(0,o.bF)(pe,{prop:"createTime",label:"创建时间",width:"160"}),(0,o.bF)(pe,{prop:"creator",label:"创建人",width:"100"}),(0,o.bF)(pe,{label:"操作",width:"120",fixed:"right"},{default:(0,o.k6)((e=>[(0,o.bF)(ae,{type:"text",size:"small",onClick:l=>Y.handleEditExpense(e.row)},{default:(0,o.k6)((()=>l[136]||(l[136]=[(0,o.eW)("编辑")]))),_:2},1032,["onClick"]),(0,o.bF)(ae,{type:"text",size:"small",onClick:l=>Y.handleDeleteExpense(e.row)},{default:(0,o.k6)((()=>l[137]||(l[137]=[(0,o.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,o.Lk)("div",G,[l[138]||(l[138]=(0,o.Lk)("h4",null,"添加费用",-1)),(0,o.bF)(fe,{model:Y.expenseForm,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(ge,{label:"费用类型",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(Z,{modelValue:Y.expenseForm.expenseType,"onUpdate:modelValue":l[52]||(l[52]=e=>Y.expenseForm.expenseType=e),placeholder:"请选择费用类型",style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"运输费",value:"transport"}),(0,o.bF)(Q,{label:"装卸费",value:"loading"}),(0,o.bF)(Q,{label:"仓储费",value:"storage"}),(0,o.bF)(Q,{label:"其他费用",value:"other"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"金额",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(Ne,{modelValue:Y.expenseForm.amount,"onUpdate:modelValue":l[53]||(l[53]=e=>Y.expenseForm.amount=e),precision:2,step:.1,min:0,style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"币种",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(Z,{modelValue:Y.expenseForm.currency,"onUpdate:modelValue":l[54]||(l[54]=e=>Y.expenseForm.currency=e),placeholder:"请选择币种",style:{width:"200px"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"人民币",value:"CNY"}),(0,o.bF)(Q,{label:"美元",value:"USD"}),(0,o.bF)(Q,{label:"欧元",value:"EUR"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"说明"},{default:(0,o.k6)((()=>[(0,o.bF)(le,{modelValue:Y.expenseForm.description,"onUpdate:modelValue":l[55]||(l[55]=e=>Y.expenseForm.description=e),type:"textarea",rows:3,placeholder:"请输入费用说明"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])])),_:1},8,["modelValue"]),(0,o.bF)(we,{title:"编辑费用",modelValue:Y.editExpenseVisible,"onUpdate:modelValue":l[63]||(l[63]=e=>Y.editExpenseVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",j,[(0,o.bF)(ae,{onClick:l[62]||(l[62]=e=>Y.editExpenseVisible=!1)},{default:(0,o.k6)((()=>l[141]||(l[141]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(ae,{type:"primary",onClick:Y.saveEditExpense},{default:(0,o.k6)((()=>l[142]||(l[142]=[(0,o.eW)("保存")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.bF)(fe,{model:Y.editExpenseForm,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(ge,{label:"费用类型",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(Z,{modelValue:Y.editExpenseForm.expenseType,"onUpdate:modelValue":l[58]||(l[58]=e=>Y.editExpenseForm.expenseType=e),placeholder:"请选择费用类型",style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"运输费",value:"transport"}),(0,o.bF)(Q,{label:"装卸费",value:"loading"}),(0,o.bF)(Q,{label:"仓储费",value:"storage"}),(0,o.bF)(Q,{label:"其他费用",value:"other"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"金额",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(Ne,{modelValue:Y.editExpenseForm.amount,"onUpdate:modelValue":l[59]||(l[59]=e=>Y.editExpenseForm.amount=e),precision:2,step:.1,min:0,style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"币种",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(Z,{modelValue:Y.editExpenseForm.currency,"onUpdate:modelValue":l[60]||(l[60]=e=>Y.editExpenseForm.currency=e),placeholder:"请选择币种",style:{width:"200px"}},{default:(0,o.k6)((()=>[(0,o.bF)(Q,{label:"人民币",value:"CNY"}),(0,o.bF)(Q,{label:"美元",value:"USD"}),(0,o.bF)(Q,{label:"欧元",value:"EUR"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(ge,{label:"说明"},{default:(0,o.k6)((()=>[(0,o.bF)(le,{modelValue:Y.editExpenseForm.description,"onUpdate:modelValue":l[61]||(l[61]=e=>Y.editExpenseForm.description=e),type:"textarea",rows:3,placeholder:"请输入费用说明"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(Ee,{visible:Y.pickupModalVisible,"current-appointment":Y.pickupAppointmentData,"edit-mode":Y.pickupEditMode,onSave:Y.handlePickupModalSave,onClose:Y.closePickupModal,"min-date":null,"available-time-slots":Y.fixedTimeSlots,appointments:Y.tableData,"appointment-settings":Y.mockAppointmentSettings},null,8,["visible","current-appointment","edit-mode","onSave","onClose","available-time-slots","appointments","appointment-settings"])])}var H=a(953),J=a(163),Q=a(7918),Z=a(3344),ee=a(2998),le=a(5493),ae=a(1018),oe=a(6629),te=a(2895),ie=a(616),re=a(3473),ne=a(218);const ue=JSON.parse('[{"prop":"orderNumber","label":"订单号","width":"150","sortable":true},{"prop":"orderStatus","label":"订单状态","width":"120","sortable":true,"filterOptions":[{"value":"已备货","label":"已备货"},{"value":"已预约","label":"已预约"},{"value":"司机已check in","label":"司机已check in"},{"value":"司机已提走","label":"司机已提走"},{"value":"部分送达","label":"部分送达"},{"value":"已送达","label":"已送达"},{"value":"已发POD","label":"已发POD"}]},{"prop":"prepareTime","label":"是否备货","width":"160","sortable":true,"filterOptions":[{"value":"已备货","label":"已备货"},{"value":"未备货","label":"未备货"}]},{"prop":"loadingType","label":"装车类型","width":"160","sortable":true,"filterOptions":[{"value":"整车","label":"整车"},{"value":"散板","label":"散板"},{"value":"一提多卸","label":"一提多卸"},{"value":"多提一卸","label":"多提一卸"},{"value":"多提多卸","label":"多提多卸"}]},{"prop":"goodsType","label":"货物类型","width":"160","sortable":true,"filterOptions":[{"value":"卡板","label":"卡板"},{"value":"地板","label":"地板"},{"value":"混装","label":"混装"},{"value":"快递","label":"快递"}]},{"prop":"appointmentTime","label":"提货预约时间","width":"160","sortable":true,"editable":true,"type":"datetime"},{"prop":"loadingFinishTime","label":"装货完成时间","width":"160","sortable":true,"editable":true,"type":"datetime"},{"prop":"specialRequirements","label":"特殊要求","width":"160","sortable":true},{"prop":"remarks","label":"供应商备注","width":"150","sortable":true},{"prop":"DockNumber","label":"Dock号","width":"150","sortable":true},{"prop":"vehicleAssignment","label":"派送车牌","width":"120","sortable":true,"editable":true},{"prop":"driver","label":"司机","width":"100","sortable":true,"editable":true,"type":"select","options":[{"value":"张三","label":"张三"},{"value":"李四","label":"李四"},{"value":"王五","label":"王五"},{"value":"赵六","label":"赵六"}]},{"prop":"driverPhone","label":"司机电话","width":"120","sortable":true,"editable":true,"type":"input"},{"prop":"DriverLicense","label":"司机驾照","width":"150","sortable":true},{"prop":"SealNumber","label":"封条号","width":"150","sortable":true},{"prop":"operation","label":"操作","width":"120","fixed":"right"}]'),se=JSON.parse('[{"orderNumber":"ORD20250327-001","orderStatus":"已备货","prepareTime":"已备货","requiredPickUpTime":"2025-03-28 14:00:00","appointmentTime":"2025-03-28 13:30:00","deliveryTime":"2025-03-29 10:00:00","loadingType":"卡板","deliveryType":"整车","specialRequirements":"轻拿轻放","remarks":"客户要求送达前电话通知","DockNumber":"1234567890","SealNumber":"1234567890","vehicleAssignment":"沪A12345","driver":"张三","driverPhone":"13812345678","DriverLicense":"1234567890","children":[{"pcNumber":"PC001","bookingTime":"2025-03-28 13:30:00","bookingNumber":"ORD20250327-001","startWarehouse":"上海仓","destination":"上海","destinationAddress":"上海市松江区佘山镇佘北公路1号","palletCount":10,"rank":1,"weight":500,"volume":20,"podImage":null}],"goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-002","orderStatus":"已预约","prepareTime":"未备货","loadingType":"地板","deliveryType":"整车","requiredPickUpTime":"2025-03-27 09:00:00","appointmentTime":"2025-03-27 08:30:00","deliveryTime":"2025-03-28 11:00:00","specialRequirements":"需温控","remarks":"医疗器械，保持恒温","DockNumber":"1234567890","SealNumber":"1234567890","vehicleAssignment":"京B98765","driver":"李四","driverPhone":"13987654321","DriverLicense":"1234567890","children":[{"pcNumber":"PC002","bookingTime":"2025-03-27 08:30:00","bookingNumber":"ORD20250327-002","startWarehouse":"北京仓","destination":"北京","destinationAddress":"北京市顺义区空港物流园区8号","palletCount":10,"weight":500,"volume":20,"podImage":null}],"goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-003","orderStatus":"司机已check in","prepareTime":"已备货","loadingType":"混装","deliveryType":"整车","requiredPickUpTime":"2025-03-27 11:00:00","appointmentTime":"2025-03-27 10:30:00","deliveryTime":"2025-03-28 09:00:00","specialRequirements":"防潮","remarks":"纸制品，注意防潮","DockNumber":"1234567890","SealNumber":"1234567890","vehicleAssignment":"粤C56789","driver":"王五","driverPhone":"13567891234","DriverLicense":"1234567890","children":[{"pcNumber":"PC003","bookingTime":"2025-03-27 10:30:00","bookingNumber":"ORD20250327-003","startWarehouse":"广州仓","destination":"广州","destinationAddress":"广州市南沙区进港大道123号","palletCount":10,"weight":500,"volume":20,"podImage":null}],"goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-004","orderStatus":"司机已提走","prepareTime":"已备货","requiredPickUpTime":"2025-03-26 13:00:00","appointmentTime":"2025-03-26 12:30:00","deliveryTime":"2025-03-27 15:00:00","specialRequirements":"小心易碎","remarks":"玻璃制品","DockNumber":"1234567890","SealNumber":"1234567890","vehicleAssignment":"川D43210","driver":"赵六","driverPhone":"13456789012","DriverLicense":"1234567890","goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-005","orderStatus":"部分送达","prepareTime":"已备货","requiredPickUpTime":"2025-03-25 10:30:00","appointmentTime":"2025-03-25 10:00:00","deliveryTime":"2025-03-26 14:00:00","specialRequirements":"分批交付","remarks":"首批50%，次批50%","followUpRecord":"第一批已送达，第二批将于明日送达","vehicleAssignment":"粤B54321","driver":"张三","driverPhone":"13812345678","DriverLicense":"1234567890","children":[{"pcNumber":"PC004","bookingTime":"2025-03-25 10:00:00","bookingNumber":"ORD20250327-004","startWarehouse":"深圳仓","destination":"深圳","destinationAddress":"深圳市宝安区航空路1001号","palletCount":10,"weight":500,"volume":20,"podImage":null}],"goodsType":"一提多卸","podPhoto":"pod_20250326_005.jpg","operation":""},{"orderNumber":"ORD20250327-006","orderStatus":"已送达","prepareTime":"已备货","requiredPickUpTime":"2025-03-24 09:00:00","appointmentTime":"2025-03-24 08:30:00","deliveryTime":"2025-03-25 11:00:00","specialRequirements":"无","remarks":"常规货物","followUpRecord":"货物已全部送达","vehicleAssignment":"鄂A67890","driver":"李四","driverPhone":"13987654321","children":[{"pcNumber":"PC005","bookingTime":"2025-03-24 08:30:00","bookingNumber":"ORD20250327-005","startWarehouse":"武汉仓","destination":"武汉","destinationAddress":"武汉市东西湖区金银湖路88号","palletCount":10,"weight":500,"volume":20,"podImage":null}],"goodsType":"一提多卸","podPhoto":"pod_20250325_006.jpg","operation":""},{"orderNumber":"ORD20250327-007","orderStatus":"已发POD","prepareTime":"已备货","requiredPickUpTime":"2025-03-23 14:00:00","appointmentTime":"2025-03-23 13:30:00","deliveryTime":"2025-03-24 16:00:00","specialRequirements":"无","remarks":"常规货物","followUpRecord":"已发送POD给客户确认","vehicleAssignment":"浙B12345","driver":"王五","driverPhone":"13567891234","goodsType":"一提多卸","podPhoto":"pod_20250324_007.jpg","operation":""},{"orderNumber":"ORD20250327-008","orderStatus":"已备货","prepareTime":"已备货","requiredPickUpTime":"2025-03-29 11:00:00","appointmentTime":"2025-03-29 10:30:00","deliveryTime":"2025-03-30 13:00:00","specialRequirements":"需冷藏","remarks":"生鲜产品，保持0-4度","followUpRecord":"已安排冷藏车","vehicleAssignment":"渝D98765","driver":"赵六","driverPhone":"13456789012","goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-009","orderStatus":"已预约","prepareTime":"已备货","requiredPickUpTime":"2025-03-28 16:00:00","appointmentTime":"2025-03-28 15:30:00","deliveryTime":"2025-03-29 14:00:00","specialRequirements":"无","remarks":"常规货物","followUpRecord":"已预约车辆","vehicleAssignment":"陕A54321","driver":"张三","driverPhone":"13812345678","goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-010","orderStatus":"司机已check in","prepareTime":"已备货","requiredPickUpTime":"2025-03-27 13:30:00","appointmentTime":"2025-03-27 13:00:00","deliveryTime":"2025-03-28 15:30:00","specialRequirements":"小心轻放","remarks":"精密仪器","followUpRecord":"司机已到达，正在装货","vehicleAssignment":"苏A67890","driver":"李四","driverPhone":"13987654321","goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-011","orderStatus":"司机已提走","prepareTime":"已备货","requiredPickUpTime":"2025-03-26 15:30:00","appointmentTime":"2025-03-26 15:00:00","deliveryTime":"2025-03-27 17:00:00","specialRequirements":"防潮","remarks":"化工原料，注意防潮","followUpRecord":"货物已装车，司机已离开","vehicleAssignment":"鲁B23456","driver":"王五","driverPhone":"13567891234","goodsType":"一提多卸","podPhoto":"","operation":""},{"orderNumber":"ORD20250327-012","orderStatus":"部分送达","prepareTime":"已备货","requiredPickUpTime":"2025-03-25 11:30:00","appointmentTime":"2025-03-25 11:00:00","deliveryTime":"2025-03-26 13:30:00","specialRequirements":"分批交付","remarks":"首批70%，次批30%","followUpRecord":"第一批已送达，第二批将于明日送达","vehicleAssignment":"津C87654","driver":"赵六","driverPhone":"13456789012","goodsType":"一提多卸","podPhoto":"pod_20250326_012.jpg","operation":""},{"orderNumber":"ORD20250327-013","orderStatus":"已送达","prepareTime":"已备货","requiredPickUpTime":"2025-03-24 10:00:00","appointmentTime":"2025-03-24 09:30:00","deliveryTime":"2025-03-25 12:00:00","specialRequirements":"无","remarks":"常规货物","followUpRecord":"货物已全部送达","vehicleAssignment":"湘A34567","driver":"张三","driverPhone":"13812345678","goodsType":"一提多卸","podPhoto":"pod_20250325_013.jpg","operation":""},{"orderNumber":"ORD20250327-014","orderStatus":"已发POD","prepareTime":"已备货","requiredPickUpTime":"2025-03-23 15:00:00","appointmentTime":"2025-03-23 14:30:00","deliveryTime":"2025-03-24 17:00:00","specialRequirements":"无","remarks":"常规货物","followUpRecord":"已发送POD给客户确认","vehicleAssignment":"苏E45678","driver":"李四","driverPhone":"13987654321","goodsType":"一提多卸","podPhoto":"pod_20250324_014.jpg","operation":""}]'),de=JSON.parse('[{"prop":"pcNumber","label":"PC号","width":"120","sortable":true},{"prop":"bookingTime","label":"预约时间","width":"160","sortable":true},{"prop":"bookingNumber","label":"预约号","width":120,"sortable":true},{"prop":"startWarehouse","label":"起始仓库","width":120,"sortable":true},{"prop":"destination","label":"目的地","width":"120","sortable":true},{"prop":"destinationAddress","label":"目的地地址","width":"200","sortable":true},{"prop":"palletCount","label":"板数","width":"80","sortable":true},{"prop":"BoxCount","label":"箱数","width":"80","sortable":true},{"prop":"weight","label":"重量(kg)","width":"100","sortable":true},{"prop":"loadingType","label":"装车类型","width":100,"sortable":true},{"prop":"rank","label":"优先级","width":100,"sortable":true},{"prop":"volume","label":"方数(m³)","width":"100","sortable":true},{"prop":"Arrived","label":"交仓完成时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"podImage","label":"POD图片","width":"100","sortable":true},{"prop":"operation","label":"操作","width":"150","fixed":"right","sortable":false,"type":"operation"}]');var pe=a(8548),ce=a(432),me=a.n(ce);const ve=ue,be=se,ge={name:"SuppilerSeasOrder",components:{FilterPanel:Z.A,GroupableTable:ee.A,ExpenseDetailDialog:le.A,HistoryRecordDialog:ae.A,GpsTrackDialog:oe.A,draggable:me(),DArrowLeft:pe.V6m,VehicleAssignmentDialog:te.A,UploadPodDialog:ie.A,FileUploadWithTagDialog:re.A,PictureFilled:pe.F46,Document:pe.yoT,AppointmentModal:ne.A},setup(){const e=(0,H.KR)(ve),l=(0,H.KR)(de),a=(0,H.KR)(be),t=(0,H.KR)([]),i=(0,H.KR)(!1),r=(0,H.KR)([...ve]),n=(0,H.KR)([]),u=(0,H.KR)("west2"),s=(0,H.KR)("卸船时间"),d=(0,H.KR)([]),p=(0,H.KR)("订单号"),c=(0,H.KR)(""),m=(0,H.KR)("no"),v=(0,H.KR)("all"),b=(0,H.KR)(!1),g=(0,H.KR)([]),h=(0,H.KR)("and"),k=(0,H.KR)(1),f=(0,H.KR)(20),w=(0,H.KR)(se.length),y=(0,o.EW)((()=>w.value)),F=(0,H.KR)("all"),C=(0,H.KR)(""),V=(0,H.KR)([]),T=(0,H.KR)(!1),x=(0,H.KR)(!1),_=(0,H.KR)(!1),S=(0,H.KR)(""),D=(0,H.KR)({name:"",columns:[]}),R=(0,H.KR)(null),P=(0,H.KR)({name:""}),W=(0,H.KR)(!1),U=(0,H.KR)({level1:"",level2:"",level3:""}),N=(0,o.EW)((()=>t.value.some((e=>e.isGroup)))),E=e=>{const l=["","primary","success","warning"];return l[e]||""},L=(0,o.EW)((()=>e.value.filter((e=>["trainNumber","loadingType","loadingStatus","loadingStartTime","loadingEndTime","loader","dockNumber","actualPallets"].includes(e.prop))))),K=(0,o.EW)((()=>e.value.filter((e=>["trainNumber","deliveryType","supplier","driverPhone","licensePlate","destination","deliveryCost"].includes(e.prop))))),A=(0,o.EW)((()=>e.value.filter((e=>["trainNumber","driverLicense","licensePlate","driverPhone","loadingStatus","loadingAppointmentTime"].includes(e.prop))))),O=(0,o.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop))));(0,o.wB)(F,(l=>{if(["all","waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(l))C.value="",e.value.forEach((e=>e.visible=!0)),g.value=[],h.value="and",U.value={level1:"",level2:"",level3:""},S.value="",Me.value=[{field:"",direction:"asc"}];else if(["loadingView","dispatchView","driverView"].includes(l))C.value="","loadingView"===l?r.value=L.value:"dispatchView"===l?r.value=K.value:"driverView"===l&&(r.value=A.value);else{const e=V.value.find((e=>e.id===l));e&&(C.value=l,tl(l))}X()})),(0,o.wB)(C,(e=>{e&&(F.value=e)})),(0,o.sV)((()=>{r.value=e.value,j(),M()}));const M=()=>{i.value=!0;try{a.value=se,w.value=se.length,X()}catch(e){console.error("加载数据失败:",e),J.nk.error("加载数据失败")}finally{i.value=!1}},X=()=>{let e=[...a.value];if(["waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(F.value)){const l={waitRegister:"未装车",registered:"已登记",loading:"装车中",loaded:"装车完成",shipped:"已发货",delivered:"已签收",pod:"已签收POD"},a=l[F.value];a&&(e=e.filter((e=>e.loadingStatus===a)))}if(c.value&&(e=e.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const l={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},a=l[s.value],[o,t]=d.value;e=e.filter((e=>{const l=e[a];if(!l)return!1;const i=l.split(" ")[0];return i>=o&&i<=t}))}g.value.length>0&&(e=e.filter((e=>{const l=g.value.map((l=>{const{field:a,operator:o,value:t}=l,i=e[a];if(null==i)return!1;switch(o){case"eq":return i==t;case"neq":return i!=t;case"contains":return i.toString().toLowerCase().includes(t.toString().toLowerCase());case"notContains":return!i.toString().toLowerCase().includes(t.toString().toLowerCase());case"startsWith":return i.toString().toLowerCase().startsWith(t.toString().toLowerCase());case"endsWith":return i.toString().toLowerCase().endsWith(t.toString().toLowerCase());case"gt":return Number(i)>Number(t);case"gte":return Number(i)>=Number(t);case"lt":return Number(i)<Number(t);case"lte":return Number(i)<=Number(t);default:return!0}}));return"and"===h.value?l.every((e=>e)):l.some((e=>e))}))),S.value&&(e=z(e,S.value)),w.value=e.length;const l=(k.value-1)*f.value,o=l+f.value;t.value=e.slice(l,o)},z=(e,l)=>{const a={};e.forEach((e=>{const o=e[l]||"未分类";a[o]||(a[o]=[]),a[o].push({...e})}));const o=[];for(const[t,i]of Object.entries(a))o.push({id:`group-${t}`,groupName:t,count:i.length,isGroup:!0,groupLevel:0,children:i});return o},I=e=>{n.value=e},q=e=>{const l={未装车:"info",已登记:"warning",装车中:"warning",装车完成:"success",已发货:"success",已签收:"success",已签收POD:"success",退件:"danger",待审批:"info",应付未完成:"info"};return l[e]||"info"},B=()=>{D.value={name:"",columns:e.value.filter((e=>!1!==e.visible)).map((e=>e.prop))},T.value=!0},G=()=>{if(!D.value.name.trim())return void J.nk.warning("请输入视图名称");const l={id:Date.now().toString(),name:D.value.name,columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:g.value,filterLogic:h.value,groupSettings:U.value,sortSettings:Me.value};V.value.push(l),C.value=l.id,T.value=!1,al(),J.nk.success("保存成功")},$=()=>{R.value&&Q.s.confirm("确定要删除该视图吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=V.value.findIndex((e=>e.id===R.value.id));-1!==e&&(V.value.splice(e,1),F.value===R.value.id&&(F.value="all",C.value=""),al(),J.nk.success("删除成功")),x.value=!1})).catch((()=>{x.value=!1}))},j=()=>{const e=localStorage.getItem("deliveryTrainsViews");if(e)try{V.value=JSON.parse(e)}catch(l){console.error("加载保存的视图失败:",l)}},Y=e=>{console.log("查看详情",e)},Z=(e,l)=>{switch(e){case"pickup":ga(l);break;case"vehicleAssignment":Ol(l);break;case"memo":hl(l);break;case"followUp":fl(l);break;case"history":Cl(l);break;case"gpsTrack":Pl(l);break;case"fileUpload":Wl(l);break;case"podUpload":Ul(l);break;case"markException":yl(l);break;case"fileUploadWithTag":Gl(l);break;case"expenseDetail":ia(l);break;case"expensePull":da(l);break}},ee=()=>{b.value=!0},le=()=>{console.log("showAddTrainDialog")},ae=(0,H.KR)([]),oe=(e,l)=>{ae.value=l?[e.orderNumber]:[]},te=({prop:e,order:l})=>{if(!e||!l)return void X();const a=[...t.value];a.sort(((a,o)=>{let t=a[e],i=o[e];return isNaN(t)||isNaN(i)||(t=Number(t),i=Number(i)),"string"===typeof t&&"string"===typeof i?"ascending"===l?t.localeCompare(i):i.localeCompare(t):"ascending"===l?t>i?1:-1:t<i?1:-1})),t.value=a},ie=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:"分组"},re=e=>{f.value=e,M()},ne=e=>{k.value=e,M()},ue=()=>{k.value=1,X()},pe=({filters:e,logic:l})=>{g.value=e,h.value=l,k.value=1,C.value&&ol(C.value),X()},ce=()=>{},me=e=>{R.value=e,x.value=!0},ge=()=>{R.value&&(P.value.name=R.value.name,x.value=!1,_.value=!0)},he=()=>{if(!R.value)return;if(!P.value.name.trim())return void J.nk.warning("请输入视图名称");const e=V.value.findIndex((e=>e.id===R.value.id));-1!==e&&(V.value[e].name=P.value.name,al(),J.nk.success("重命名成功"),_.value=!1)},ke=()=>{if(!R.value)return;const e={...R.value,id:Date.now().toString(),name:`${R.value.name} 副本`};V.value.push(e),al(),J.nk.success("复制成功"),x.value=!1},fe=(0,H.KR)(!1),we=(0,H.KR)(0),ye=(0,H.KR)(0),Fe=(e,l)=>{e.preventDefault(),R.value=l,fe.value=!0,we.value=e.clientX,ye.value=e.clientY,setTimeout((()=>{document.addEventListener("click",Ce)}),0)},Ce=()=>{fe.value=!1,document.removeEventListener("click",Ce)},Ve=(0,H.KR)({rowIndex:-1,prop:"",value:""}),Te=(0,H.KR)(!1),xe=(0,H.KR)(null),_e=(0,H.KR)({}),Se=(0,H.KR)({value:""}),De=(e,l,a)=>{const o=l.property;if(Ll(o)){const l=a?a.closest("tr"):null,t=l?Array.from(l.parentNode.children).indexOf(l):-1;Ve.value={rowIndex:t,prop:o,value:e[o]||""},setTimeout((()=>{const e=document.querySelector(".cell-editor input, .cell-editor select");e&&e.focus()}),50)}},Re=l=>{const a=e.value.find((e=>e.prop===l));return a?.type||"input"},Pe=l=>{const a=e.value.find((e=>e.prop===l));return a?.options||[]},We=(l,a)=>{const o=a.property;Ll(o)&&(Ve.value={rowIndex:-1,prop:"",value:""},xe.value=l,_e.value=e.value.find((e=>e.prop===o))||{prop:o,label:o},Se.value.value=l[o]||"",Te.value=!0)},Ue=(e,l)=>{Ve.value.prop===l&&(e[l]=Ve.value.value,setTimeout((()=>{const l=a.value.findIndex((l=>l.id===e.id));-1!==l&&(a.value[l]={...e}),Ve.value={rowIndex:-1,prop:"",value:""},J.nk.success("保存成功")}),200))},Ne=()=>{if(xe.value&&_e.value.prop){xe.value[_e.value.prop]=Se.value.value;const e=a.value.findIndex((e=>e.id===xe.value.id));-1!==e&&(a.value[e]={...xe.value}),Te.value=!1,J.nk.success("保存成功")}},Ee=l=>{const o=e.value.find((e=>e.prop===l));if(o&&o.filterOptions)return o.filterOptions;switch(l){case"loader":return[{value:"张三",label:"张三"},{value:"李四",label:"李四"},{value:"王五",label:"王五"},{value:"赵六",label:"赵六"},{value:"钱七",label:"钱七"}];case"dockNumber":return Array.from({length:10},((e,l)=>{const a=l+1,o=`DOCK-${a<10?"0"+a:a}`;return{value:o,label:o}}));case"supplier":return[{value:"广州物流",label:"广州物流"},{value:"深圳物流",label:"深圳物流"},{value:"东莞物流",label:"东莞物流"},{value:"佛山物流",label:"佛山物流"},{value:"中山物流",label:"中山物流"}];case"driverLicense":case"licensePlate":case"driverPhone":return a.value.map((e=>({value:e[l],label:e[l]}))).filter(((e,l,a)=>e.value&&a.findIndex((l=>l.value===e.value))===l));default:return[]}},Le=()=>{W.value=!0},Ke=()=>{const e=[];U.value.level1&&e.push(U.value.level1),U.value.level2&&e.push(U.value.level2),U.value.level3&&e.push(U.value.level3),S.value="",Ae(e),C.value&&ol(C.value),W.value=!1,J.nk.success("分组已应用")},Ae=l=>{if(!l||0===l.length)return void X();const o=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:l};let i=[...a.value];if(["waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(F.value)){const e={waitRegister:"未装车",registered:"已登记",loading:"装车中",loaded:"装车完成",shipped:"已发货",delivered:"已签收",pod:"已签收POD"},l=e[F.value];l&&(i=i.filter((e=>e.loadingStatus===l)))}if(c.value&&(i=i.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const e={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},l=e[s.value],[a,o]=d.value;i=i.filter((e=>{const t=e[l];if(!t)return!1;const i=t.split(" ")[0];return i>=a&&i<=o}))}g.value.length>0&&(i=i.filter((e=>{const l=g.value.map((l=>{const{field:a,operator:o,value:t}=l,i=e[a];if(null==i)return!1;switch(o){case"eq":return i==t;case"neq":return i!=t;case"contains":return i.toString().toLowerCase().includes(t.toString().toLowerCase());case"notContains":return!i.toString().toLowerCase().includes(t.toString().toLowerCase());case"startsWith":return i.toString().toLowerCase().startsWith(t.toString().toLowerCase());case"endsWith":return i.toString().toLowerCase().endsWith(t.toString().toLowerCase());case"gt":return Number(i)>Number(t);case"gte":return Number(i)>=Number(t);case"lt":return Number(i)<Number(t);case"lte":return Number(i)<=Number(t);default:return!0}}));return"and"===h.value?l.every((e=>e)):l.some((e=>e))})));const r=[],n=new Map;i.forEach((e=>{let a=r,t="",i=null;for(let r=0;r<l.length;r++){const u=l[r],s=e[u]||"未分类",d=o(u),p=`${t}/${u}:${s}`;let c=a.find((e=>e.groupKey===p));c||(c={id:`group-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,groupKey:p,groupName:`${d}: ${s}`,isGroup:!0,groupLevel:r,children:[],items:[],count:0},c.groupClass=0===r?"level-1-group":1===r?"level-2-group":"level-3-group",a.push(c),n.set(p,c)),c.items.push(e),c.count=c.items.length,t=p,a=c.children,i=c}if(i){const l={...e,parentGroupKey:i.groupKey};i.children.push(l)}}));const u=[];function m(e,l=0){e.forEach((e=>{u.push(e);const a=e.children.filter((e=>e.isGroup));a.length>0?m(a,l+1):e.children.forEach((e=>{u.push(e)}))}))}m(r),w.value=u.length;const v=(k.value-1)*f.value,b=v+f.value;t.value=u.slice(v,b)},Oe=(0,H.KR)(!1),Me=(0,H.KR)([{field:"",direction:"asc"}]),Xe=(0,o.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop)))),ze=()=>{Oe.value=!0},Ie=()=>{Me.value.push({field:"",direction:"asc"})},qe=e=>{Me.value.splice(e,1),0===Me.value.length&&Me.value.push({field:"",direction:"asc"})},Be=()=>{if(Me.value.some((e=>!e.field)))return void J.nk.warning("请选择所有排序字段");let e=[...t.value];Me.value.forEach((({field:l,direction:a})=>{e.sort(((e,o)=>{let t=e[l],i=o[l];return isNaN(t)||isNaN(i)||(t=Number(t),i=Number(i)),"string"===typeof t&&"string"===typeof i?"asc"===a?t.localeCompare(i):i.localeCompare(t):"asc"===a?t>i?1:-1:t<i?1:-1}))})),t.value=e,Oe.value=!1,C.value&&ol(C.value),J.nk.success("排序已应用")},Ge=()=>{U.value={level1:"",level2:"",level3:""},S.value="",C.value&&ol(C.value),X(),W.value=!1,J.nk.success("已清除分组设置")},$e=()=>{Me.value=[{field:"",direction:"asc"}],C.value&&ol(C.value),X(),Oe.value=!1,J.nk.success("已清除排序设置")},je=(0,H.KR)(!1),Ye=(0,H.KR)([]),He=(0,o.EW)({get:()=>Ye.value.every((e=>e.visible)),set:e=>{Ye.value.forEach((l=>l.visible=e))}}),Je=()=>{Ye.value=e.value.map((e=>({...e,visible:!1!==e.visible}))),je.value=!0},Qe=e=>{Ye.value.forEach((l=>l.visible=e))},Ze=()=>{Ye.value=e.value.map((e=>({...e,visible:!0})))},el=()=>{},ll=()=>{e.value=e.value.map((e=>{const l=Ye.value.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}})),C.value&&ol(C.value),je.value=!1,J.nk.success("字段配置已更新")},al=()=>{localStorage.setItem("deliveryTrainsViews",JSON.stringify(V.value))},ol=l=>{const a=V.value.findIndex((e=>e.id===l));a>-1&&(V.value[a]={...V.value[a],columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:g.value,filterLogic:h.value,groupSettings:U.value,sortSettings:Me.value},al())},tl=l=>{const a=V.value.find((e=>e.id===l));a&&(a.columns&&(e.value=e.value.map((e=>{const l=a.columns.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}}))),a.filters&&(g.value=[...a.filters],h.value=a.filterLogic||"and"),a.groupSettings&&(U.value={...a.groupSettings}),a.sortSettings&&(Me.value=[...a.sortSettings]),X())},il=(0,H.KR)(!1),rl=(0,H.KR)(null),nl=e=>{console.log("费用已推送:",e),J.nk.success("费用推送成功")},ul=e=>{console.log("取消推送:",e),J.nk.success("已取消推送")},sl=e=>{switch(e.trim()){case"异常":return"danger";case"紧急":return"warning";default:return""}},dl=(e,l,a)=>{if(e[l]){if(Array.isArray(e[l])){const o=e[l].indexOf(a);if(o>-1){const a=[...e[l]];a.splice(o,1),e[l]=a}}else if("string"===typeof e[l]){const o=e[l].split(",").map((e=>e.trim())),t=o.indexOf(a);t>-1&&(o.splice(t,1),e[l]=o.join(","))}J.nk.success("标签已移除")}},pl=(0,H.KR)(!1),cl=(0,H.KR)(!1),ml=(0,H.KR)({memo:""}),vl=(0,H.KR)({content:"",type:"primary",files:[]}),bl=(0,H.KR)([{time:"2024-03-20 10:00:00",content:"已联系司机，预计下午到达",operator:"张三",type:"primary"},{time:"2024-03-20 15:30:00",content:"司机到达装货点，开始装货",operator:"李四",type:"warning"}]),gl=(0,H.KR)(null),hl=e=>{gl.value=e,ml.value.memo=e.memo||"",pl.value=!0},kl=()=>{gl.value&&(gl.value.memo=ml.value.memo,J.nk.success("保存成功"),pl.value=!1)},fl=e=>{gl.value=e,vl.value={content:"",type:"primary",files:[]},cl.value=!0},wl=()=>{if(vl.value.content){if(bl.value.unshift({time:(new Date).toLocaleString(),content:vl.value.content,operator:"当前用户",type:vl.value.type,files:vl.value.files.map((e=>({name:e.name,url:e.url||e.response?.url})))}),gl.value&&"danger"===vl.value.type){let e=[];if(Array.isArray(gl.value.tags)?e=[...gl.value.tags]:"string"===typeof gl.value.tags&&gl.value.tags&&(e=gl.value.tags.split(",").map((e=>e.trim()))),!e.includes("异常")){e.push("异常"),gl.value.tags=e;const l=a.value.findIndex((e=>e.id===gl.value.id));-1!==l&&(a.value[l]={...gl.value});const o=t.value.findIndex((e=>e.id===gl.value.id));-1!==o&&(t.value[o]={...gl.value})}}vl.value={content:"",type:"primary",files:[]},cl.value=!1,J.nk.success("保存成功")}else J.nk.warning("请输入跟进内容")},yl=e=>{gl.value=e,vl.value={content:"",type:"danger"},cl.value=!0},Fl=(0,H.KR)(!1),Cl=e=>{rl.value=e,Fl.value=!0},Vl=(0,H.KR)(!1),Tl=(0,H.KR)(null),xl=(e,l)=>{switch(e){case"viewDetails":_l(l);break;case"uploadPod":Sl(l);break;case"deletePc":Dl(l);break}},_l=e=>{console.log("查看PC详情:",e)},Sl=e=>{console.log("上传POD:",e)},Dl=e=>{Q.s.confirm("确认要删除该PC记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{console.log("删除PC:",e),J.nk.success("删除成功")})).catch((()=>{}))},Rl=e=>{console.log("处理车辆分配",e)},Pl=e=>{Tl.value=e,Vl.value=!0},Wl=e=>{console.log("处理文件上传",e)},Ul=e=>{Il.value=e,zl.value=!0},Nl=()=>{zl.value=!1,Il.value=null},El=async e=>{try{if(console.log("提交POD数据:",e),Il.value){Il.value.podStatus="已上传",Il.value.podUploadTime=e.receiptTime;const l=a.value.findIndex((e=>e.id===Il.value.id));-1!==l&&(a.value[l]={...Il.value});const o=t.value.findIndex((e=>e.id===Il.value.id));-1!==o&&(t.value[o]={...Il.value})}J.nk.success("POD上传成功"),zl.value=!1}catch(l){console.error("POD上传失败:",l),J.nk.error("POD上传失败")}},Ll=l=>{const a=e.value.find((e=>e.prop===l));return a?.editable||!1},Kl=(0,H.KR)(!1),Al=(0,H.KR)(null),Ol=e=>{Al.value=e,Kl.value=!0},Ml=e=>{if(!Al.value)return;Al.value.licensePlate=e.plateNumber,Al.value.driver=e.driver,Al.value.driverPhone=e.driverPhone,Al.value.gpsNumber=e.gpsNumber,Al.value.vehicleAssignment=e.plateNumber;const l=a.value.findIndex((e=>e.id===Al.value.id));-1!==l&&(a.value[l]={...Al.value});const o=t.value.findIndex((e=>e.id===Al.value.id));-1!==o&&(t.value[o]={...Al.value}),Kl.value=!1,J.nk.success("车辆分配成功")},Xl=()=>{if(!Al.value)return;Al.value.licensePlate="",Al.value.driver="",Al.value.driverPhone="",Al.value.gpsNumber="";const e=a.value.findIndex((e=>e.id===Al.value.id));-1!==e&&(a.value[e]={...Al.value});const l=t.value.findIndex((e=>e.id===Al.value.id));-1!==l&&(t.value[l]={...Al.value}),Kl.value=!1,J.nk.success("已取消车辆分配")},zl=(0,H.KR)(!1),Il=(0,H.KR)(null),ql=(0,H.KR)(!1),Bl=(0,H.KR)(null),Gl=e=>{Bl.value=e,ql.value=!0},$l=async e=>{try{if(console.log("提交文件数据:",e),Bl.value){Bl.value.fileTag=e.fileTag,Bl.value.fileRemark=e.remark;const l=a.value.findIndex((e=>e.id===Bl.value.id));-1!==l&&(a.value[l]={...Bl.value});const o=t.value.findIndex((e=>e.id===Bl.value.id));-1!==o&&(t.value[o]={...Bl.value})}J.nk.success("文件上传成功"),ql.value=!1}catch(l){console.error("文件上传失败:",l),J.nk.error("文件上传失败")}},jl=()=>{ql.value=!1,Bl.value=null},Yl=(0,H.KR)("/api/upload"),Hl=(e,l,a)=>{vl.value.files=a,J.nk.success("文件上传成功")},Jl=()=>{J.nk.error("文件上传失败")},Ql=e=>{const l=e.size/1024/1024<10;return!!l||(J.nk.error("上传文件大小不能超过 10MB!"),!1)},Zl=(0,H.KR)(!1),ea=(0,H.KR)(!1),la=(0,H.KR)([]),aa=(0,H.KR)({expenseType:"",amount:0,currency:"CNY",description:""}),oa=(0,H.KR)({id:"",expenseType:"",amount:0,currency:"CNY",description:""}),ta=e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(e),ia=e=>{gl.value=e,la.value=[{id:"1",expenseType:"transport",amount:1e3,currency:"CNY",description:"运输费用",createTime:"2024-03-20 10:00:00",creator:"张三"},{id:"2",expenseType:"loading",amount:500,currency:"CNY",description:"装卸费用",createTime:"2024-03-20 11:00:00",creator:"李四"}],Zl.value=!0},ra=()=>{if(!aa.value.expenseType||!aa.value.amount||!aa.value.currency)return void J.nk.warning("请填写完整的费用信息");const e={id:Date.now().toString(),...aa.value,createTime:(new Date).toLocaleString(),creator:"当前用户"};la.value.unshift(e),aa.value={expenseType:"",amount:0,currency:"CNY",description:""},J.nk.success("添加成功")},na=e=>{oa.value={...e},ea.value=!0},ua=()=>{if(!oa.value.expenseType||!oa.value.amount||!oa.value.currency)return void J.nk.warning("请填写完整的费用信息");const e=la.value.findIndex((e=>e.id===oa.value.id));-1!==e&&(la.value[e]={...oa.value}),ea.value=!1,J.nk.success("保存成功")},sa=e=>{Q.s.confirm("确认要删除该费用记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const l=la.value.findIndex((l=>l.id===e.id));-1!==l&&la.value.splice(l,1),J.nk.success("删除成功")})).catch((()=>{}))},da=e=>{Q.s.confirm("确认要拉取该订单的费用明细吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{J.nk.success("费用拉取成功"),ia(e)})).catch((()=>{}))},pa=(0,H.KR)(!1),ca=(0,H.KR)(null),ma=(0,H.KR)(null),va=(0,H.KR)(!1),ba=()=>({id:null,trainNumber:"",supplierName:"",appointmentDate:"",appointmentTime:"",driverPhone:"",cargoType:"",loadType:"",createdAt:null,updatedAt:null,isCheckedIn:!1,isLoaded:!1}),ga=e=>{console.log("Handling pickup appointment for order:",e),ma.value=e;let l="";if(l="地板"===e.loadingType?"地板":"卡板"===e.loadingType?"卡板":"混装"===e.loadingType?"地板":e.loadingType||"",e.pickupAppointmentTime){va.value=!0;const[a,o]=e.pickupAppointmentTime.split(" ");ca.value={...ba(),id:e.orderNumber,trainNumber:e.orderNumber,supplierName:e.supplier,driverPhone:e.driverPhone,cargoType:l,appointmentDate:a||"",appointmentTime:o||"",loadType:e.loadType||""},console.log("Prepared pickup data (Edit Mode):",ca.value)}else va.value=!1,ca.value={...ba(),trainNumber:e.orderNumber,supplierName:"供应商A",driverPhone:e.driverPhone,cargoType:l},console.log("Prepared pickup data (New Mode):",ca.value);pa.value=!0},ha=()=>{pa.value=!1,ca.value=null,ma.value=null,va.value=!1},ka=e=>{if(console.log("Pickup modal saved:",e),ma.value){const l=a.value.findIndex((e=>e.orderNumber===ma.value.orderNumber));if(-1!==l){const o=`${e.appointmentDate} ${e.appointmentTime}`;a.value[l].pickupAppointmentTime=o,console.log(`Updated pickupAppointmentTime for order ${ma.value.orderNumber} to ${o}`),X()}else console.error("Could not find original order row to update pickup time");ha(),J.nk.success("提货预约已保存")}else console.error("currentPickupOrderRow is null during save"),J.nk.error("保存预约失败，请重试")},fa=(0,H.KR)({"2024-05-28":{isOpen:!0,timeSlots:{"08:00:00":{floor:5,pallet:3},"09:00:00":{floor:5,pallet:3},"10:00:00":{floor:4,pallet:2},"11:00:00":{floor:4,pallet:2},"13:00:00":{floor:6,pallet:4},"14:00:00":{floor:6,pallet:4},"15:00:00":{floor:5,pallet:3},"16:00:00":{floor:5,pallet:3},"17:00:00":{floor:2,pallet:1}}},"2024-05-29":{isOpen:!0,timeSlots:{"09:00:00":{floor:3,pallet:1},"10:00:00":{floor:3,pallet:1},"11:00:00":{floor:0,pallet:2},"14:00:00":{floor:4,pallet:0},"15:00:00":{floor:4,pallet:2}}},"2024-05-30":{isOpen:!0,timeSlots:{"08:00:00":{floor:2,pallet:2},"09:00:00":{floor:2,pallet:2},"10:00:00":{floor:1,pallet:1}}},"2024-05-31":{isOpen:!1,timeSlots:{}}}),wa=(0,H.KR)(["08:00:00","09:00:00","10:00:00","11:00:00","13:00:00","14:00:00","15:00:00","16:00:00","17:00:00"]);return{tableColumns:e,childColumns:l,tableData:a,displayData:t,loading:i,visibleColumns:r,selectedRows:n,warehouse:u,createDateType:s,dateRange:d,searchType:p,searchText:c,sendOrder:m,currentStatus:v,filterPanelVisible:b,activeFilters:g,filterLogic:h,currentPage:k,pageSize:f,totalItems:w,total:y,currentView:F,selectedCustomView:C,customViews:V,saveViewDialogVisible:T,viewOptionsDialogVisible:x,renameViewDialogVisible:_,groupField:S,viewForm:D,currentEditingView:R,renameForm:P,groupableFields:O,groupModalVisible:W,groupSettings:U,hasGroupedData:N,getGroupTagType:E,showGroupModal:Le,applyGroupSettings:Ke,handleSaveView:B,saveView:G,handleDeleteView:$,loadSavedViews:j,getStatusTagType:q,handleDetail:Y,handleCommand:Z,showFilterPanel:ee,showAddTrainDialog:le,handleExpandChange:oe,handleSelectionChange:I,handleSortChange:te,handleSizeChange:re,handleCurrentChange:ne,handleSearch:ue,applyFilters:pe,cancelFilters:ce,fetchData:M,applyFiltersAndPagination:X,groupData:z,handleViewOptions:me,handleRenameView:ge,saveRenameView:he,handleCopyView:ke,contextMenuVisible:fe,contextMenuX:we,contextMenuY:ye,handleContextMenu:Fe,closeContextMenu:Ce,editingCell:Ve,editDialogVisible:Te,editingRow:xe,editingColumn:_e,editingForm:Se,handleCellClick:De,handleCellDbClick:We,saveEdit:Ue,saveDialogEdit:Ne,getOptionsForColumn:Ee,getGroupColumnLabel:ie,sortModalVisible:Oe,sortSettings:Me,sortableFields:Xe,showSortModal:ze,addSortField:Ie,removeSortField:qe,applySortSettings:Be,clearGroupSettings:Ge,clearSortSettings:$e,columnSettingsVisible:je,columnSettingsList:Ye,allColumnsSelected:He,showColumnSettings:Je,handleSelectAllColumns:Qe,resetColumnSettings:Ze,handleDragEnd:el,applyColumnSettings:ll,saveViewsToStorage:al,updateViewConfig:ol,applyViewConfig:tl,expenseDialogVisible:il,currentTrainData:rl,handleExpensePushed:nl,handlePushCancelled:ul,getTagType:sl,handleTagClose:dl,memoDialogVisible:pl,followUpDialogVisible:cl,memoForm:ml,followUpForm:vl,followUpHistory:bl,currentEditingTrain:gl,handleMemo:hl,saveMemo:kl,handleFollowUp:fl,saveFollowUp:wl,handleMarkException:yl,historyDialogVisible:Fl,handleHistory:Cl,gpsTrackDialogVisible:Vl,currentGpsTrainData:Tl,handleChildCommand:xl,handleVehicleAssignment:Rl,handleGpsTrack:Pl,handleFileUpload:Wl,handlePodUpload:Ul,getEditControlType:Re,getEditControlOptions:Pe,isEditableField:Ll,vehicleAssignmentVisible:Kl,openVehicleAssignment:Ol,handleVehicleAssign:Ml,handleVehicleCancelAssign:Xl,podDialogVisible:zl,currentPodRow:Il,handlePodSubmit:El,handlePodCancel:Nl,fileUploadWithTagVisible:ql,currentFileRow:Bl,handleFileUploadWithTag:Gl,handleFileUploadWithTagSubmit:$l,handleFileUploadWithTagCancel:jl,uploadUrl:Yl,handleUploadSuccess:Hl,handleUploadError:Jl,beforeUpload:Ql,expenseDetailVisible:Zl,editExpenseVisible:ea,expenseList:la,expenseForm:aa,editExpenseForm:oa,formatCurrency:ta,handleExpenseDetail:ia,handleAddExpense:ra,handleEditExpense:na,saveEditExpense:ua,handleDeleteExpense:sa,handleExpensePull:da,pickupModalVisible:pa,pickupAppointmentData:ca,currentPickupOrderRow:ma,pickupEditMode:va,handlePickupAppointment:ga,handlePickupModalSave:ka,closePickupModal:ha,mockAppointmentSettings:fa,fixedTimeSlots:wa}}};var he=a(6262);const ke=(0,he.A)(ge,[["render",Y],["__scopeId","data-v-f1bf6100"]]),fe=ke},2895:(e,l,a)=>{a.d(l,{A:()=>v});var o=a(641),t=a(3751),i=a(33);const r={class:"search-area"},n={class:"pagination-container"};function u(e,l,a,u,s,d){const p=(0,o.g2)("el-input"),c=(0,o.g2)("el-form-item"),m=(0,o.g2)("el-option"),v=(0,o.g2)("el-select"),b=(0,o.g2)("el-button"),g=(0,o.g2)("el-form"),h=(0,o.g2)("el-table-column"),k=(0,o.g2)("el-tag"),f=(0,o.g2)("el-table"),w=(0,o.g2)("el-pagination"),y=(0,o.g2)("el-dialog"),F=(0,o.gN)("loading");return(0,o.uX)(),(0,o.Wv)(y,{title:"车辆分配",modelValue:u.dialogVisible,"onUpdate:modelValue":l[4]||(l[4]=e=>u.dialogVisible=e),width:"900px","close-on-click-modal":!1},{default:(0,o.k6)((()=>[(0,o.Lk)("div",r,[(0,o.bF)(g,{inline:!0,model:u.searchForm,class:"search-form"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{label:"搜索车辆"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:u.searchForm.plateNumber,"onUpdate:modelValue":l[0]||(l[0]=e=>u.searchForm.plateNumber=e),placeholder:"请输入车牌号",clearable:"",onKeyup:(0,t.jR)(u.handleSearch,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,o.bF)(c,{label:"状态"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{modelValue:u.searchForm.status,"onUpdate:modelValue":l[1]||(l[1]=e=>u.searchForm.status=e),placeholder:"请选择状态",clearable:""},{default:(0,o.k6)((()=>[(0,o.bF)(m,{label:"忙碌中",value:"busy"}),(0,o.bF)(m,{label:"空闲",value:"idle"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(b,{type:"primary",onClick:u.handleSearch},{default:(0,o.k6)((()=>l[5]||(l[5]=[(0,o.eW)("搜索")]))),_:1},8,["onClick"]),(0,o.bF)(b,{onClick:u.resetSearch},{default:(0,o.k6)((()=>l[6]||(l[6]=[(0,o.eW)("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])]),(0,o.bo)(((0,o.uX)(),(0,o.Wv)(f,{data:u.tableData,border:"",style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(h,{prop:"plateNumber",label:"车牌号",width:"120"}),(0,o.bF)(h,{prop:"driver",label:"司机",width:"100"}),(0,o.bF)(h,{prop:"driverPhone",label:"司机电话",width:"120"}),(0,o.bF)(h,{prop:"status",label:"状态",width:"100"},{default:(0,o.k6)((e=>[(0,o.bF)(k,{type:"busy"===e.row.status?"danger":"success"},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)("busy"===e.row.status?"忙碌中":"空闲"),1)])),_:2},1032,["type"])])),_:1}),(0,o.bF)(h,{prop:"gpsNumber",label:"GPS绑定号码",width:"120"}),(0,o.bF)(h,{label:"操作",width:"150",fixed:"right"},{default:(0,o.k6)((e=>["idle"===e.row.status?((0,o.uX)(),(0,o.Wv)(b,{key:0,type:"primary",size:"small",onClick:l=>u.handleAssign(e.row)},{default:(0,o.k6)((()=>l[7]||(l[7]=[(0,o.eW)(" 分配 ")]))),_:2},1032,["onClick"])):((0,o.uX)(),(0,o.Wv)(b,{key:1,type:"danger",size:"small",onClick:l=>u.handleCancelAssign(e.row)},{default:(0,o.k6)((()=>l[8]||(l[8]=[(0,o.eW)(" 取消分配 ")]))),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"])),[[F,u.loading]]),(0,o.Lk)("div",n,[(0,o.bF)(w,{"current-page":u.currentPage,"onUpdate:currentPage":l[2]||(l[2]=e=>u.currentPage=e),"page-size":u.pageSize,"onUpdate:pageSize":l[3]||(l[3]=e=>u.pageSize=e),"page-sizes":[10,20,50,100],total:u.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])),_:1},8,["modelValue"])}var s=a(953),d=a(7918);const p={name:"VehicleAssignmentDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","assign","cancel-assign"],setup(e,{emit:l}){const a=(0,s.KR)(e.modelValue),t=(0,s.KR)(!1),i=(0,s.KR)(1),r=(0,s.KR)(10),n=(0,s.KR)(100),u=(0,s.Kh)({plateNumber:"",status:""}),p=Array.from({length:100},((e,l)=>({id:l+1,plateNumber:`粤B${String(Math.floor(1e4*Math.random())).padStart(5,"0")}`,driver:["张三","李四","王五","赵六"][Math.floor(4*Math.random())],driverPhone:`138${String(Math.floor(1e8*Math.random())).padStart(8,"0")}`,status:Math.random()>.5?"busy":"idle",gpsNumber:`GPS${String(Math.floor(1e3*Math.random())).padStart(3,"0")}`}))),c=(0,s.KR)(p);(0,o.wB)((()=>e.modelValue),(e=>{a.value=e})),(0,o.wB)((()=>a.value),(e=>{l("update:modelValue",e)}));const m=()=>{t.value=!0,setTimeout((()=>{const e=p.filter((e=>{const l=!u.plateNumber||e.plateNumber.includes(u.plateNumber),a=!u.status||e.status===u.status;return l&&a}));c.value=e,n.value=e.length,t.value=!1}),500)},v=()=>{u.plateNumber="",u.status="",m()},b=e=>{d.s.confirm("确认要分配该车辆吗？","分配车辆",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.status="忙碌中",l("assign",e)})).catch((()=>{}))},g=e=>{d.s.confirm("确认要取消分配该车辆吗？","取消分配",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.status="空闲",l("cancel-assign",e)})).catch((()=>{}))},h=e=>{r.value=e,m()},k=e=>{i.value=e,m()};return{dialogVisible:a,loading:t,searchForm:u,tableData:c,currentPage:i,pageSize:r,total:n,handleSearch:m,resetSearch:v,handleAssign:b,handleCancelAssign:g,handleSizeChange:h,handleCurrentChange:k}}};var c=a(6262);const m=(0,c.A)(p,[["render",u],["__scopeId","data-v-6acbac67"]]),v=m}}]);
//# sourceMappingURL=5551.1074869c.js.map