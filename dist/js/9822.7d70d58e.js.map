{"version":3,"file":"js/9822.7d70d58e.js","mappings":"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","sources":["webpack://vue-logistics-system/./src/views/Admin/RatingManagement/RatingDashboard.vue","webpack://vue-logistics-system/./src/views/Admin/RatingManagement/RatingDashboard.vue?f626"],"sourcesContent":["<template>\r\n  <div class=\"rating-dashboard-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>供应商评分看板</span>\r\n          <!-- 筛选区域 -->\r\n           <el-form :inline=\"true\" :model=\"filterForm\" size=\"small\" class=\"dashboard-filter\">\r\n              <el-form-item label=\"评分周期\">\r\n                <el-select v-model=\"filterForm.period\" placeholder=\"选择周期\" clearable style=\"width: 150px;\">\r\n                  <el-option v-for=\"p in mockPeriods\" :key=\"p\" :label=\"p\" :value=\"p\" />\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item label=\"供应商类型\">\r\n                <el-select v-model=\"filterForm.supplierType\" placeholder=\"选择类型\" clearable style=\"width: 150px;\">\r\n                  <el-option label=\"提框\" value=\"pickup\" />\r\n                  <el-option label=\"派送\" value=\"delivery\" />\r\n                  <el-option label=\"综合\" value=\"both\" />\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type=\"primary\" @click=\"handleQuery\">查询</el-button>\r\n              </el-form-item>\r\n           </el-form>\r\n        </div>\r\n      </template>\r\n\r\n       <div v-loading=\"loading\">\r\n          <el-row :gutter=\"20\">\r\n            <!-- 供应商评分排名 -->\r\n            <el-col :span=\"12\">\r\n              <h4>供应商评分排名 ({{ filterForm.period || '最新' }})</h4>\r\n              <el-table :data=\"supplierRankings\" style=\"width: 100%\" height=\"400px\" border size=\"small\">\r\n                  <el-table-column type=\"index\" label=\"排名\" width=\"60\" align=\"center\" />\r\n                  <el-table-column prop=\"supplierName\" label=\"供应商\" show-overflow-tooltip />\r\n                  <el-table-column prop=\"score\" label=\"综合评分\" width=\"100\" sortable align=\"center\">\r\n                      <template #default=\"scope\">\r\n                        <span :style=\"getScoreStyle(scope.row.score)\">{{ scope.row.score.toFixed(1) }}</span>\r\n                      </template>\r\n                  </el-table-column>\r\n                   <el-table-column prop=\"typeLabel\" label=\"类型\" width=\"80\" align=\"center\"/>\r\n                   <el-table-column label=\"操作\" width=\"80\" align=\"center\">\r\n                     <template #default=\"scope\">\r\n                         <el-button text type=\"primary\" size=\"small\" @click=\"viewSupplierDetails(scope.row)\">详情</el-button>\r\n                     </template>\r\n                   </el-table-column>\r\n              </el-table>\r\n               <el-pagination\r\n                   small\r\n                   background\r\n                   layout=\"prev, pager, next\"\r\n                   :total=\"totalRankings\"\r\n                   :page-size=\"rankingPagination.pageSize\"\r\n                   :current-page=\"rankingPagination.currentPage\"\r\n                   @current-change=\"handleRankingPageChange\"\r\n                   style=\"margin-top: 10px; justify-content: center;\"\r\n                 />\r\n            </el-col>\r\n\r\n            <!-- 评分趋势与对比 -->\r\n            <el-col :span=\"12\">\r\n               <h4>评分趋势 / 对比分析 (模拟图表)</h4>\r\n                <div class=\"chart-placeholder large-chart\">\r\n                    (此处集成图表库，展示整体评分趋势、按供应商类型对比、或选定供应商的维度得分雷达图等)\r\n                     <br/><br/>\r\n                     (当前筛选: {{ filterForm.period || '最新' }}, {{ filterForm.supplierType ? typeMap[filterForm.supplierType] : '所有类型' }})\r\n                </div>\r\n                 <h4>关键绩效仪表盘 (模拟)</h4>\r\n                  <el-row :gutter=\"15\" class=\"kpi-dashboard\">\r\n                    <el-col :span=\"8\">\r\n                        <div class=\"kpi-card good\">\r\n                           <div class=\"kpi-value\">{{ kpiData.averageScore.toFixed(1) }}</div>\r\n                           <div class=\"kpi-label\">平均综合评分</div>\r\n                        </div>\r\n                    </el-col>\r\n                     <el-col :span=\"8\">\r\n                        <div class=\"kpi-card\" :class=\"kpiData.onTimeRate >= 95 ? 'good' : 'warning'\">\r\n                           <div class=\"kpi-value\">{{ kpiData.onTimeRate.toFixed(1) }}%</div>\r\n                           <div class=\"kpi-label\">平均准时率</div>\r\n                        </div>\r\n                    </el-col>\r\n                     <el-col :span=\"8\">\r\n                        <div class=\"kpi-card\" :class=\"kpiData.damageRate <= 1 ? 'good' : 'bad'\">\r\n                           <div class=\"kpi-value\">{{ kpiData.damageRate.toFixed(1) }}%</div>\r\n                           <div class=\"kpi-label\">平均货损率</div>\r\n                        </div>\r\n                    </el-col>\r\n                  </el-row>\r\n            </el-col>\r\n          </el-row>\r\n       </div>\r\n\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, onMounted } from 'vue';\r\nimport { ElMessage } from 'element-plus';\r\n\r\n// --- 模拟数据 ---\r\nconst mockSuppliers = ref([\r\n  { id: 'supplier_1', name: '测试供应商A - 专做提框服务', type: 'pickup' },\r\n  { id: 'supplier_2', name: '测试供应商B - FBA派送专家', type: 'delivery' },\r\n  { id: 'supplier_3', name: '测试供应商C - 全能型选手', type: 'both' },\r\n  { id: 'supplier_4', name: '测试供应商D - 区域小霸王', type: 'delivery' },\r\n   { id: 'supplier_5', name: '测试供应商E - 新晋合作方', type: 'pickup' },\r\n]);\r\n\r\nconst mockPeriods = ref(['2024-Q1', '2023-Q4', '2023-Q3']); // 模拟可选周期\r\n\r\n// 存储所有周期的评分数据 (模拟)\r\nconst allRatingData = ref({}); \r\n\r\nconst typeMap = { pickup: '提框', delivery: '派送', both: '综合' };\r\n\r\nconst generateMockRatingDataForPeriod = (period) => {\r\n  const data = mockSuppliers.value.map(supplier => {\r\n      // 模拟分数波动\r\n      let baseScore = 85;\r\n      if (supplier.type === 'pickup') baseScore = 88;\r\n      if (supplier.name.includes('新晋')) baseScore = 75;\r\n      if (period === '2023-Q4') baseScore += Math.random() * 5 - 2;\r\n      if (period === '2023-Q3') baseScore += Math.random() * 8 - 4;\r\n\r\n      const score = Math.max(60, Math.min(99.9, baseScore + Math.random() * 15 - 7.5));\r\n      const onTimeRate = Math.max(80, Math.min(99.9, score * 1.05 + Math.random() * 10 - 8));\r\n      const damageRate = Math.max(0.1, Math.min(5, (100 - score) * 0.1 + Math.random() * 1 - 0.5));\r\n\r\n      return {\r\n          supplierId: supplier.id,\r\n          supplierName: supplier.name,\r\n          type: supplier.type,\r\n          typeLabel: typeMap[supplier.type] || '未知',\r\n          score: score,\r\n          period: period,\r\n          // 可以添加更多维度得分\r\n          onTimeRate: onTimeRate,\r\n          damageRate: damageRate,\r\n      };\r\n  });\r\n  return data.sort((a, b) => b.score - a.score); // 按分数降序\r\n};\r\n\r\n// --- 筛选与查询 ---\r\nconst filterForm = reactive({\r\n  period: mockPeriods.value[0], // 默认选最新周期\r\n  supplierType: '',\r\n});\r\n\r\nconst loading = ref(false);\r\nconst currentPeriodData = ref([]); // 当前查询周期的数据\r\n\r\nconst rankingPagination = reactive({\r\n    currentPage: 1,\r\n    pageSize: 10, \r\n});\r\n\r\nconst totalRankings = computed(() => filteredRankings.value.length);\r\n\r\n// 根据筛选条件过滤当前周期数据\r\nconst filteredRankings = computed(() => {\r\n    return currentPeriodData.value.filter(r => \r\n        !filterForm.supplierType || r.type === filterForm.supplierType\r\n    );\r\n});\r\n\r\n// 前端分页排名数据\r\nconst supplierRankings = computed(() => {\r\n  const start = (rankingPagination.currentPage - 1) * rankingPagination.pageSize;\r\n  const end = start + rankingPagination.pageSize;\r\n  return filteredRankings.value.slice(start, end);\r\n});\r\n\r\n// 计算 KPI (基于当前筛选结果)\r\nconst kpiData = computed(() => {\r\n    const dataToCalc = filteredRankings.value; // 使用过滤后的数据计算KPI\r\n    if (dataToCalc.length === 0) {\r\n        return { averageScore: 0, onTimeRate: 0, damageRate: 0 };\r\n    }\r\n    const avgScore = dataToCalc.reduce((sum, r) => sum + r.score, 0) / dataToCalc.length;\r\n    const avgOnTime = dataToCalc.reduce((sum, r) => sum + r.onTimeRate, 0) / dataToCalc.length;\r\n    const avgDamage = dataToCalc.reduce((sum, r) => sum + r.damageRate, 0) / dataToCalc.length;\r\n    return {\r\n        averageScore: avgScore,\r\n        onTimeRate: avgOnTime,\r\n        damageRate: avgDamage\r\n    };\r\n});\r\n\r\nconst handleQuery = () => {\r\n  loading.value = true;\r\n  rankingPagination.currentPage = 1; // 重置分页\r\n  console.log(`查询评分: 周期=${filterForm.period}, 类型=${filterForm.supplierType}`);\r\n  // 模拟 API 请求\r\n  setTimeout(() => {\r\n     const periodKey = filterForm.period || mockPeriods.value[0]; // 如果没选，查最新的\r\n     if (!allRatingData.value[periodKey]) {\r\n         console.log(`为周期 ${periodKey} 生成模拟数据`);\r\n         allRatingData.value[periodKey] = generateMockRatingDataForPeriod(periodKey);\r\n     }\r\n     currentPeriodData.value = allRatingData.value[periodKey];\r\n     loading.value = false;\r\n  }, 500);\r\n};\r\n\r\nconst handleRankingPageChange = (page) => {\r\n    rankingPagination.currentPage = page;\r\n};\r\n\r\n// --- 其他方法 ---\r\nconst getScoreStyle = (score) => {\r\n    if (score >= 90) return { color: '#67C23A' }; // 优秀绿色\r\n    if (score >= 80) return { color: '#409EFF' }; // 良好蓝色\r\n    if (score >= 70) return { color: '#E6A23C' }; // 一般橙色\r\n    return { color: '#F56C6C' }; // 较差红色\r\n};\r\n\r\nconst viewSupplierDetails = (row) => {\r\n    console.log('查看供应商评分详情:', row);\r\n    ElMessage.info(`查看供应商 ${row.supplierName} 在 ${row.period} 的详细评分数据 (待实现)`);\r\n    // 实际可以弹窗或跳转到供应商详情页的评分标签\r\n};\r\n\r\n\r\n// --- 生命周期 ---\r\nonMounted(() => {\r\n  // 首次加载默认查询最新周期\r\n  handleQuery();\r\n});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.rating-dashboard-container {\r\n  padding: 20px;\r\n}\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n.dashboard-filter {\r\n    margin-left: auto; /* 让筛选表单靠右 */\r\n}\r\n.dashboard-filter .el-form-item {\r\n    margin-bottom: 0; /* 减少间距 */\r\n}\r\nh4 {\r\n    margin-bottom: 15px;\r\n    margin-top: 5px;\r\n}\r\n.chart-placeholder {\r\n  height: 280px; /* 调整图表高度 */\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #f8f8f9;\r\n  color: #909399;\r\n  border: 1px dashed #dcdfe6;\r\n  border-radius: 4px;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n.large-chart {\r\n    height: 350px; /* 趋势图可以高一点 */\r\n}\r\n\r\n.kpi-dashboard {\r\n    margin-top: 10px;\r\n}\r\n.kpi-card {\r\n    border-radius: 4px;\r\n    padding: 15px;\r\n    text-align: center;\r\n    color: #fff;\r\n    background-color: #909399; /* 默认灰色 */\r\n}\r\n.kpi-card.good {\r\n    background-color: #67C23A;\r\n}\r\n.kpi-card.warning {\r\n    background-color: #E6A23C;\r\n}\r\n.kpi-card.bad {\r\n     background-color: #F56C6C;\r\n}\r\n.kpi-value {\r\n    font-size: 24px;\r\n    font-weight: bold;\r\n    margin-bottom: 5px;\r\n}\r\n.kpi-label {\r\n    font-size: 13px;\r\n}\r\n\r\n</style> ","import script from \"./RatingDashboard.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./RatingDashboard.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./RatingDashboard.vue?vue&type=style&index=0&id=7efae48c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7efae48c\"]])\n\nexport default __exports__"],"names":["mockSuppliers","ref","id","name","type","mockPeriods","allRatingData","typeMap","pickup","delivery","both","generateMockRatingDataForPeriod","period","data","value","map","supplier","baseScore","includes","Math","random","score","max","min","onTimeRate","damageRate","supplierId","supplierName","typeLabel","sort","a","b","filterForm","reactive","supplierType","loading","currentPeriodData","rankingPagination","currentPage","pageSize","totalRankings","computed","filteredRankings","length","filter","r","supplierRankings","start","end","slice","kpiData","dataToCalc","averageScore","avgScore","reduce","sum","avgOnTime","avgDamage","handleQuery","console","log","setTimeout","periodKey","handleRankingPageChange","page","getScoreStyle","color","viewSupplierDetails","row","ElMessage","info","onMounted","__exports__"],"sourceRoot":""}