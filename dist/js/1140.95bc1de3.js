"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[1140],{4287:(e,l,a)=>{a.d(l,{A:()=>W});var t=a(641),o=a(33);const n={class:"upload-container"},i={class:"form-section"},d={class:"form-content"},p={class:"form-section"},u={class:"form-content"},s={class:"form-section"},r={class:"form-content"},m={key:0,class:"form-section"},b={class:"form-content"},c={class:"preview-container"},k={class:"preview-header"},h={class:"preview-title"},f={class:"preview-content"},v=["src"],w={key:1,class:"preview-placeholder"},y={class:"dialog-footer"};function F(e,l,a,F,g,x){const C=(0,t.g2)("el-radio"),_=(0,t.g2)("el-radio-group"),T=(0,t.g2)("el-input"),V=(0,t.g2)("upload-filled"),W=(0,t.g2)("el-icon"),P=(0,t.g2)("el-upload"),U=(0,t.g2)("el-button"),E=(0,t.g2)("document"),R=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(R,{title:"文件上传",modelValue:F.dialogVisible,"onUpdate:modelValue":l[2]||(l[2]=e=>F.dialogVisible=e),width:"600px","close-on-click-modal":!1,onClose:F.handleClose},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",y,[(0,t.bF)(U,{onClick:F.handleClose},{default:(0,t.k6)((()=>l[13]||(l[13]=[(0,t.eW)("取消")]))),_:1},8,["onClick"]),(0,t.bF)(U,{type:"primary",onClick:F.handleSubmit,disabled:!F.isValid,loading:F.uploading},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(F.uploading?"上传中...":"确定"),1)])),_:1},8,["onClick","disabled","loading"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[l[5]||(l[5]=(0,t.Lk)("div",{class:"form-label required"},"文件类型：",-1)),(0,t.Lk)("div",d,[(0,t.bF)(_,{modelValue:F.form.fileType,"onUpdate:modelValue":l[0]||(l[0]=e=>F.form.fileType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(C,{label:"record"},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("留底文件")]))),_:1}),(0,t.bF)(C,{label:"abnormal"},{default:(0,t.k6)((()=>l[4]||(l[4]=[(0,t.eW)("异常文件")]))),_:1})])),_:1},8,["modelValue"])])]),(0,t.Lk)("div",p,[l[6]||(l[6]=(0,t.Lk)("div",{class:"form-label"},"备注：",-1)),(0,t.Lk)("div",u,[(0,t.bF)(T,{modelValue:F.form.remark,"onUpdate:modelValue":l[1]||(l[1]=e=>F.form.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])])]),(0,t.Lk)("div",s,[l[9]||(l[9]=(0,t.Lk)("div",{class:"form-label required"},"上传文件：",-1)),(0,t.Lk)("div",r,[(0,t.bF)(P,{ref:"uploadRef",class:"upload-area",action:"#","auto-upload":!1,"on-change":F.handleFileChange,"on-remove":F.handleFileRemove,"on-preview":F.handleFilePreview,"file-list":F.fileList,limit:5,multiple:"",drag:"",accept:".pdf,.jpg,.jpeg,.png"},{tip:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.Lk)("div",{class:"el-upload__tip"}," 支持 .pdf、.jpg、.jpeg、.png 格式，单个文件不超过 10MB ",-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(W,{class:"el-icon-upload"},{default:(0,t.k6)((()=>[(0,t.bF)(V)])),_:1}),l[8]||(l[8]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))])),_:1},8,["on-change","on-remove","on-preview","file-list"])])]),F.previewVisible?((0,t.uX)(),(0,t.CE)("div",m,[l[12]||(l[12]=(0,t.Lk)("div",{class:"form-label"},"预览：",-1)),(0,t.Lk)("div",b,[(0,t.Lk)("div",c,[(0,t.Lk)("div",k,[(0,t.Lk)("div",h,(0,o.v_)(F.previewFile.name),1),(0,t.bF)(U,{type:"text",onClick:F.closePreview},{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.eW)("关闭")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",f,[F.isImageFile(F.previewFile)?((0,t.uX)(),(0,t.CE)("img",{key:0,src:F.previewUrl,class:"preview-image"},null,8,v)):((0,t.uX)(),(0,t.CE)("div",w,[(0,t.bF)(E,{class:"preview-icon"}),(0,t.Lk)("div",null,(0,o.v_)(F.previewFile.name),1),(0,t.bF)(U,{type:"primary",size:"small",onClick:F.downloadFile},{default:(0,t.k6)((()=>l[11]||(l[11]=[(0,t.eW)("下载查看")]))),_:1},8,["onClick"])]))])])])])):(0,t.Q3)("",!0)])])),_:1},8,["modelValue","onClose"])}var g=a(953),x=a(8548),C=a(163);const _={name:"TrainFileUploadDialog",components:{UploadFilled:x.m8m,Document:x.yoT},props:{visible:{type:Boolean,default:!1},trainId:{type:[String,Number],default:""}},emits:["update:visible","submit","cancel"],setup(e,{emit:l}){const a=(0,t.EW)({get:()=>e.visible,set:e=>l("update:visible",e)}),o=(0,g.KR)(null),n=(0,g.KR)(!1),i=(0,g.KR)({fileType:"record",remark:"",files:[]}),d=(0,g.KR)([]),p=(0,g.KR)(!1),u=(0,g.KR)({}),s=(0,g.KR)(""),r=(0,t.EW)((()=>i.value.fileType&&i.value.files.length>0)),m=e=>{const l=["application/pdf","image/jpeg","image/png","image/jpg"],a=e.raw.type;if(!l.includes(a))return C.nk.error("不支持的文件类型"),!1;const t=10485760;if(e.raw.size>t)return C.nk.error("文件大小不能超过 10MB"),!1;i.value.files.includes(e.raw)||i.value.files.push(e.raw)},b=e=>{const l=i.value.files.findIndex((l=>l===e.raw));l>-1&&i.value.files.splice(l,1)},c=e=>{if(!e||!e.name)return!1;const l=e.name.split(".").pop().toLowerCase();return["jpg","jpeg","png"].includes(l)},k=e=>{u.value=e,c(e)?s.value=URL.createObjectURL(e.raw):s.value="",p.value=!0},h=()=>{p.value=!1,s.value&&(URL.revokeObjectURL(s.value),s.value="")},f=()=>{if(u.value&&u.value.raw){const e=URL.createObjectURL(u.value.raw),l=document.createElement("a");l.href=e,l.download=u.value.name,document.body.appendChild(l),l.click(),setTimeout((()=>{document.body.removeChild(l),URL.revokeObjectURL(e)}),0)}},v=async()=>{if(r.value){n.value=!0;try{const a={trainId:e.trainId,fileTag:i.value.fileType,remark:i.value.remark,files:i.value.files};l("submit",a)}catch(a){console.error("文件上传失败:",a),C.nk.error("文件上传失败")}finally{n.value=!1}}else C.nk.warning("请选择文件类型并上传文件")},w=()=>{s.value&&URL.revokeObjectURL(s.value),i.value={fileType:"record",remark:"",files:[]},d.value=[],p.value=!1,l("cancel"),a.value=!1};return(0,t.wB)((()=>e.visible),(e=>{e&&(i.value={fileType:"record",remark:"",files:[]},d.value=[],p.value=!1)})),{dialogVisible:a,form:i,fileList:d,uploadRef:o,uploading:n,previewVisible:p,previewFile:u,previewUrl:s,isValid:r,handleFileChange:m,handleFileRemove:b,handleFilePreview:k,isImageFile:c,closePreview:h,downloadFile:f,handleSubmit:v,handleClose:w}}};var T=a(6262);const V=(0,T.A)(_,[["render",F],["__scopeId","data-v-1bb54d49"]]),W=V},8547:(e,l,a)=>{a.r(l),a.d(l,{default:()=>L});var t=a(641),o=a(33);const n={class:"train-detail-container"},i={class:"detail-header"},d={class:"header-actions"},p={class:"basic-info-section"},u={class:"pc-detail-section"},s={class:"section-header"},r={class:"section-actions"},m={class:"expense-detail-section"},b={class:"expense-header"},c={class:"expense-actions"},k={class:"expense-summary"},h={class:"total-amount"},f={class:"paid-amount"},v={class:"unpaid-amount"},w={class:"file-upload-section"},y={class:"upload-header"},F={class:"dialog-footer"};function g(e,l,a,g,x,C){const _=(0,t.g2)("el-button"),T=(0,t.g2)("el-descriptions-item"),V=(0,t.g2)("el-option"),W=(0,t.g2)("el-select"),P=(0,t.g2)("el-date-picker"),U=(0,t.g2)("el-input"),E=(0,t.g2)("el-tag"),R=(0,t.g2)("el-input-number"),N=(0,t.g2)("el-descriptions"),L=(0,t.g2)("el-tab-pane"),S=(0,t.g2)("el-table-column"),z=(0,t.g2)("el-dropdown-item"),A=(0,t.g2)("el-dropdown-menu"),D=(0,t.g2)("el-dropdown"),I=(0,t.g2)("el-table"),K=(0,t.g2)("el-tabs"),B=(0,t.g2)("expense-detail-dialog"),X=(0,t.g2)("train-file-upload-dialog"),$=(0,t.g2)("upload-pod-dialog"),j=(0,t.g2)("FileUploadWithTagDialog"),O=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",i,[(0,t.bF)(_,{onClick:g.goBack,icon:"el-icon-back"},{default:(0,t.k6)((()=>l[18]||(l[18]=[(0,t.eW)("返回")]))),_:1},8,["onClick"]),l[21]||(l[21]=(0,t.Lk)("div",{class:"header-title"},"运单详情",-1)),(0,t.Lk)("div",d,[(0,t.bF)(_,{type:"primary",onClick:g.handleEdit},{default:(0,t.k6)((()=>l[19]||(l[19]=[(0,t.eW)("编辑")]))),_:1},8,["onClick"]),(0,t.bF)(_,{onClick:g.handleExport},{default:(0,t.k6)((()=>l[20]||(l[20]=[(0,t.eW)("导出")]))),_:1},8,["onClick"])])]),(0,t.bF)(K,{modelValue:g.activeTab,"onUpdate:modelValue":l[11]||(l[11]=e=>g.activeTab=e),class:"detail-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(L,{label:"基本信息",name:"basic"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",p,[l[22]||(l[22]=(0,t.Lk)("h3",{class:"section-title"},"运单基本信息",-1)),(0,t.bF)(N,{column:3,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"车次号"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(g.basicInfo.trainNumber),1)])),_:1}),(0,t.bF)(T,{label:"装车类型"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{modelValue:g.basicInfo.loadingType,"onUpdate:modelValue":l[0]||(l[0]=e=>g.basicInfo.loadingType=e),size:"small",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"卡板",value:"卡板"}),(0,t.bF)(V,{label:"地板",value:"地板"}),(0,t.bF)(V,{label:"混装",value:"混装"}),(0,t.bF)(V,{label:"快递",value:"快递"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"派送类型"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{modelValue:g.basicInfo.deliveryType,"onUpdate:modelValue":l[1]||(l[1]=e=>g.basicInfo.deliveryType=e),size:"small",style:{width:"120px"}},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"整车",value:"整车"}),(0,t.bF)(V,{label:"散板",value:"散板"}),(0,t.bF)(V,{label:"一提多卸",value:"一提多卸"}),(0,t.bF)(V,{label:"多提一卸",value:"多提一卸"}),(0,t.bF)(V,{label:"多提多卸",value:"多提多卸"}),(0,t.bF)(V,{label:"快递",value:"快递"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"创建时间"},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(g.basicInfo.createTime),1)])),_:1}),(0,t.bF)(T,{label:"装车预约时间"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{modelValue:g.basicInfo.loadingAppointmentTime,"onUpdate:modelValue":l[2]||(l[2]=e=>g.basicInfo.loadingAppointmentTime=e),type:"datetime",size:"small",style:{width:"180px"},placeholder:"选择日期时间"},null,8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"车牌号"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:g.basicInfo.licensePlate,"onUpdate:modelValue":l[3]||(l[3]=e=>g.basicInfo.licensePlate=e),size:"small",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"司机电话"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:g.basicInfo.driverPhone,"onUpdate:modelValue":l[4]||(l[4]=e=>g.basicInfo.driverPhone=e),size:"small",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"司机姓名"},{default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:g.basicInfo.driverName,"onUpdate:modelValue":l[5]||(l[5]=e=>g.basicInfo.driverName=e),size:"small",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"供应商"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{modelValue:g.basicInfo.supplier,"onUpdate:modelValue":l[6]||(l[6]=e=>g.basicInfo.supplier=e),size:"small",style:{width:"150px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.supplierOptions,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(E,{type:g.getStatusTagType(g.basicInfo.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(g.basicInfo.status),1)])),_:1},8,["type"])])),_:1}),(0,t.bF)(T,{label:"板数"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:g.basicInfo.palletCount,"onUpdate:modelValue":l[7]||(l[7]=e=>g.basicInfo.palletCount=e),size:"small",min:0,style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"货物重量"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:g.basicInfo.weight,"onUpdate:modelValue":l[8]||(l[8]=e=>g.basicInfo.weight=e),size:"small",min:0,precision:2,style:{width:"120px"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(T,{label:"方数(CBM)"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{modelValue:g.basicInfo.cbm,"onUpdate:modelValue":l[9]||(l[9]=e=>g.basicInfo.cbm=e),size:"small",min:0,precision:2,style:{width:"120px"}},null,8,["modelValue"])])),_:1})])),_:1})])])),_:1}),(0,t.bF)(L,{label:"PC明细",name:"pc"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",u,[(0,t.Lk)("div",s,[l[25]||(l[25]=(0,t.Lk)("h3",{class:"section-title"},"PC明细",-1)),(0,t.Lk)("div",r,[(0,t.bF)(_,{type:"primary",size:"small",onClick:g.handleAddPC},{default:(0,t.k6)((()=>l[23]||(l[23]=[(0,t.eW)("添加PC")]))),_:1},8,["onClick"]),(0,t.bF)(_,{size:"small",onClick:g.handleExportPC},{default:(0,t.k6)((()=>l[24]||(l[24]=[(0,t.eW)("导出PC")]))),_:1},8,["onClick"])])]),(0,t.bF)(I,{data:g.pcDetailData,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{prop:"pcNumber",label:"PC号",width:"120"}),(0,t.bF)(S,{prop:"appointmentParty",label:"预约方",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.appointmentParty,"onUpdate:modelValue":l=>e.row.appointmentParty=l,size:"small",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"appointmentTime",label:"预约时间",width:"150"},{default:(0,t.k6)((e=>[(0,t.bF)(P,{modelValue:e.row.appointmentTime,"onUpdate:modelValue":l=>e.row.appointmentTime=l,type:"datetime",size:"small",style:{width:"150px"},placeholder:"选择日期时间"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"appointmentNumber",label:"预约号",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.appointmentNumber,"onUpdate:modelValue":l=>e.row.appointmentNumber=l,size:"small",style:{width:"120px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"startWarehouse",label:"起始仓库",width:"120",sortable:""}),(0,t.bF)(S,{prop:"destination",label:"目的地",width:"150",sortable:""}),(0,t.bF)(S,{prop:"palletCount",label:"板数",width:"100",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.palletCount,"onUpdate:modelValue":l=>e.row.palletCount=l,modelModifiers:{number:!0},type:"number",min:"0",size:"small",style:{width:"80px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"weight",label:"重量(kg)",width:"120",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.weight,"onUpdate:modelValue":l=>e.row.weight=l,modelModifiers:{number:!0},type:"number",min:"0",size:"small",step:"0.01",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"loadingType",label:"装车类型",width:"100",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.loadingType,"onUpdate:modelValue":l=>e.row.loadingType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[(0,t.bF)(V,{label:"卡板",value:"卡板"}),(0,t.bF)(V,{label:"地板",value:"地板"}),(0,t.bF)(V,{label:"混装",value:"混装"}),(0,t.bF)(V,{label:"快递",value:"快递"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"boxCount",label:"箱数",width:"100",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.boxCount,"onUpdate:modelValue":l=>e.row.boxCount=l,modelModifiers:{number:!0},type:"number",min:"0",size:"small",style:{width:"80px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"priority",label:"优先级",width:"90",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.priority,"onUpdate:modelValue":l=>e.row.priority=l,modelModifiers:{number:!0},type:"number",min:"1",size:"small",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"volume",label:"方数(m³)",width:"120",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.volume,"onUpdate:modelValue":l=>e.row.volume=l,modelModifiers:{number:!0},type:"number",min:"0",size:"small",step:"0.01",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"status",label:"状态",width:"100",sortable:""},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getPCStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.status),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"remark",label:"备注",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.remark,"onUpdate:modelValue":l=>e.row.remark=l,size:"small",style:{width:"120px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{label:"操作",width:"220",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleViewPC(e.row)},{default:(0,t.k6)((()=>l[26]||(l[26]=[(0,t.eW)("查看")]))),_:2},1032,["onClick"]),(0,t.bF)(D,{size:"small",onCommand:l=>g.handlePCCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(A,null,{default:(0,t.k6)((()=>[(0,t.bF)(z,{command:"uploadPod"},{default:(0,t.k6)((()=>l[28]||(l[28]=[(0,t.eW)("上传POD")]))),_:1}),(0,t.bF)(z,{command:"followUp"},{default:(0,t.k6)((()=>l[29]||(l[29]=[(0,t.eW)("跟进记录")]))),_:1}),(0,t.bF)(z,{command:"memo"},{default:(0,t.k6)((()=>l[30]||(l[30]=[(0,t.eW)("MEMO")]))),_:1}),(0,t.bF)(z,{command:"exception"},{default:(0,t.k6)((()=>l[31]||(l[31]=[(0,t.eW)("标记异常")]))),_:1}),(0,t.bF)(z,{command:"delete"},{default:(0,t.k6)((()=>l[32]||(l[32]=[(0,t.eW)("删除PC")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(_,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[27]||(l[27]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])])),_:1}),(0,t.bF)(L,{label:"费用明细",name:"expense"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",m,[(0,t.Lk)("div",b,[l[36]||(l[36]=(0,t.Lk)("h3",{class:"section-title"},"费用明细",-1)),(0,t.Lk)("div",c,[(0,t.bF)(_,{type:"primary",size:"small",onClick:g.handleAddExpense},{default:(0,t.k6)((()=>l[33]||(l[33]=[(0,t.eW)("添加费用")]))),_:1},8,["onClick"]),(0,t.bF)(_,{type:"success",size:"small",onClick:g.handleBatchPushExpense},{default:(0,t.k6)((()=>l[34]||(l[34]=[(0,t.eW)("批量推送费用")]))),_:1},8,["onClick"]),(0,t.bF)(_,{size:"small",onClick:g.handleExportExpense},{default:(0,t.k6)((()=>l[35]||(l[35]=[(0,t.eW)("导出费用")]))),_:1},8,["onClick"])])]),(0,t.bF)(K,{modelValue:g.expenseActiveTab,"onUpdate:modelValue":l[10]||(l[10]=e=>g.expenseActiveTab=e),type:"card",class:"expense-type-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(L,{label:"全部费用",name:"all"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{data:g.allExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"pcNumber",label:"PC号",width:"120"}),(0,t.bF)(S,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getExpenseStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.status),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"fromWarehouse",label:"起始仓库",width:"120"}),(0,t.bF)(S,{prop:"toWarehouse",label:"目的仓库",width:"120"}),(0,t.bF)(S,{prop:"paymentNo",label:"付款申请号",width:"150"}),(0,t.bF)(S,{prop:"supplier",label:"供应商",width:"120"}),(0,t.bF)(S,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"amount",label:"金额",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.amount,"onUpdate:modelValue":l=>e.row.amount=l,size:"small",min:0,precision:2,step:100,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"expenseDate",label:"费用日期",width:"120"}),(0,t.bF)(S,{prop:"operator",label:"操作人",width:"100"}),(0,t.bF)(S,{prop:"operateTime",label:"操作时间",width:"150"}),(0,t.bF)(S,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[37]||(l[37]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(D,{size:"small",onCommand:l=>g.handleExpenseCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(A,null,{default:(0,t.k6)((()=>[(0,t.bF)(z,{command:"push"},{default:(0,t.k6)((()=>l[39]||(l[39]=[(0,t.eW)("推送费用")]))),_:1}),(0,t.bF)(z,{command:"delete"},{default:(0,t.k6)((()=>l[40]||(l[40]=[(0,t.eW)("删除")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(_,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[38]||(l[38]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"派送费",name:"delivery"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{data:g.deliveryExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"pcNumber",label:"PC号",width:"120"}),(0,t.bF)(S,{prop:"status",label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getExpenseStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.status),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"fromWarehouse",label:"起始仓库",width:"120"}),(0,t.bF)(S,{prop:"toWarehouse",label:"目的仓库",width:"120"}),(0,t.bF)(S,{prop:"paymentNo",label:"付款申请号",width:"150"}),(0,t.bF)(S,{prop:"supplier",label:"供应商",width:"120"}),(0,t.bF)(S,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"amount",label:"金额",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{modelValue:e.row.amount,"onUpdate:modelValue":l=>e.row.amount=l,size:"small",min:0,precision:2,step:100,style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"expenseDate",label:"费用日期",width:"120"}),(0,t.bF)(S,{prop:"operator",label:"操作人",width:"100"}),(0,t.bF)(S,{prop:"operateTime",label:"操作时间",width:"150"}),(0,t.bF)(S,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[41]||(l[41]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(D,{size:"small",onCommand:l=>g.handleExpenseCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(A,null,{default:(0,t.k6)((()=>[(0,t.bF)(z,{command:"push"},{default:(0,t.k6)((()=>l[43]||(l[43]=[(0,t.eW)("推送费用")]))),_:1}),(0,t.bF)(z,{command:"delete"},{default:(0,t.k6)((()=>l[44]||(l[44]=[(0,t.eW)("删除")]))),_:1})])),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(_,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[42]||(l[42]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"异常费",name:"abnormal"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{data:g.abnormalExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(S,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(S,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[45]||(l[45]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[46]||(l[46]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"等时费",name:"waiting"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{data:g.waitingExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(S,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(S,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[47]||(l[47]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[48]||(l[48]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"装车费",name:"loading"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{data:g.loadingExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(S,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(S,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[49]||(l[49]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[50]||(l[50]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,t.bF)(L,{label:"其他费用",name:"other"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{data:g.otherExpenses,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"expenseType",label:"费用类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(W,{modelValue:e.row.expenseType,"onUpdate:modelValue":l=>e.row.expenseType=l,size:"small",style:{width:"100px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(g.expenseTypes,(e=>((0,t.uX)(),(0,t.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{prop:"amount",label:"金额",width:"120"}),(0,t.bF)(S,{prop:"currency",label:"币种",width:"80"}),(0,t.bF)(S,{prop:"paymentStatus",label:"支付状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getPaymentStatusTagType(e.row.paymentStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.row.paymentStatus),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"expenseRemark",label:"费用备注",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(U,{modelValue:e.row.expenseRemark,"onUpdate:modelValue":l=>e.row.expenseRemark=l,size:"small",placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.bF)(S,{label:"操作",width:"150",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleEditExpense(e.row)},{default:(0,t.k6)((()=>l[51]||(l[51]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(_,{type:"text",size:"small",onClick:l=>g.handleDeleteExpense(e.row)},{default:(0,t.k6)((()=>l[52]||(l[52]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Lk)("div",k,[(0,t.bF)(N,{column:3,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"总费用"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",h,(0,o.v_)(g.totalExpense),1)])),_:1}),(0,t.bF)(T,{label:"已支付"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",f,(0,o.v_)(g.paidExpense),1)])),_:1}),(0,t.bF)(T,{label:"未支付"},{default:(0,t.k6)((()=>[(0,t.Lk)("span",v,(0,o.v_)(g.unpaidExpense),1)])),_:1})])),_:1})])])])),_:1}),(0,t.bF)(L,{label:"文件上传",name:"file"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",w,[(0,t.Lk)("div",y,[l[55]||(l[55]=(0,t.Lk)("h3",{class:"section-title"},"文件管理",-1)),(0,t.Lk)("div",null,[(0,t.bF)(_,{type:"primary",size:"small",onClick:g.showFileUploadDialog},{default:(0,t.k6)((()=>l[53]||(l[53]=[(0,t.eW)("上传文件")]))),_:1},8,["onClick"]),(0,t.bF)(_,{type:"success",size:"small",onClick:g.handleBatchApprove},{default:(0,t.k6)((()=>l[54]||(l[54]=[(0,t.eW)("批量审核")]))),_:1},8,["onClick"])])]),(0,t.bF)(I,{data:g.fileList,border:"",style:{width:"100%"},onSelectionChange:g.handleFileSelectionChange},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"fileName",label:"文件名","min-width":"200"}),(0,t.bF)(S,{prop:"fileType",label:"文件类型",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getFileTypeTagType(e.row.fileType)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(g.getFileTypeLabel(e.row.fileType)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"fileSize",label:"文件大小",width:"120"}),(0,t.bF)(S,{prop:"uploadTime",label:"上传时间",width:"180"}),(0,t.bF)(S,{prop:"uploadBy",label:"上传人",width:"120"}),(0,t.bF)(S,{prop:"status",label:"审核状态",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(E,{type:g.getPodStatusTagType(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(g.getPodStatusLabel(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(S,{prop:"remark",label:"备注","min-width":"150"}),(0,t.bF)(S,{label:"操作",width:"200",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(D,{size:"small",onCommand:l=>g.handleFileCommand(l,e.row)},{dropdown:(0,t.k6)((()=>[(0,t.bF)(A,null,{default:(0,t.k6)((()=>[(0,t.bF)(z,{command:"preview"},{default:(0,t.k6)((()=>l[57]||(l[57]=[(0,t.eW)("预览")]))),_:1}),(0,t.bF)(z,{command:"download"},{default:(0,t.k6)((()=>l[58]||(l[58]=[(0,t.eW)("下载")]))),_:1}),"pending"===e.row.status?((0,t.uX)(),(0,t.Wv)(z,{key:0,command:"approve"},{default:(0,t.k6)((()=>l[59]||(l[59]=[(0,t.eW)("审核通过")]))),_:1})):(0,t.Q3)("",!0),"pending"===e.row.status?((0,t.uX)(),(0,t.Wv)(z,{key:1,command:"reject"},{default:(0,t.k6)((()=>l[60]||(l[60]=[(0,t.eW)("审核不通过")]))),_:1})):(0,t.Q3)("",!0),"approved"===e.row.status?((0,t.uX)(),(0,t.Wv)(z,{key:2,command:"pushCustomerService"},{default:(0,t.k6)((()=>l[61]||(l[61]=[(0,t.eW)("推送客服")]))),_:1})):(0,t.Q3)("",!0),"approved"===e.row.status?((0,t.uX)(),(0,t.Wv)(z,{key:3,command:"pushCustomer"},{default:(0,t.k6)((()=>l[62]||(l[62]=[(0,t.eW)("推送客户")]))),_:1})):(0,t.Q3)("",!0),(0,t.bF)(z,{command:"delete"},{default:(0,t.k6)((()=>l[63]||(l[63]=[(0,t.eW)("删除")]))),_:1})])),_:2},1024)])),default:(0,t.k6)((()=>[(0,t.bF)(_,{type:"text",size:"small"},{default:(0,t.k6)((()=>l[56]||(l[56]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data","onSelectionChange"])])])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(B,{visible:g.expenseDialogVisible,"onUpdate:visible":l[12]||(l[12]=e=>g.expenseDialogVisible=e),"expense-data":g.currentExpense,"expense-type":g.expenseActiveTab,onSubmit:g.handleExpenseSubmit,onCancel:g.handleExpenseCancel},null,8,["visible","expense-data","expense-type","onSubmit","onCancel"]),(0,t.bF)(X,{visible:g.fileUploadDialogVisible,"onUpdate:visible":l[13]||(l[13]=e=>g.fileUploadDialogVisible=e),"train-id":g.basicInfo.id,onSubmit:g.handleFileUploadSubmit,onCancel:g.handleFileUploadCancel},null,8,["visible","train-id","onSubmit","onCancel"]),(0,t.bF)($,{visible:g.podDialogVisible,"onUpdate:visible":l[14]||(l[14]=e=>g.podDialogVisible=e),"current-pod-row":g.currentPodRow,onSubmit:g.handlePodSubmit,onCancel:g.handlePodCancel},null,8,["visible","current-pod-row","onSubmit","onCancel"]),(0,t.bF)(j,{modelValue:g.fileUploadWithTagVisible,"onUpdate:modelValue":l[15]||(l[15]=e=>g.fileUploadWithTagVisible=e),"current-row":g.currentFileRow,onSubmit:g.handleFileUploadWithTagSubmit,onCancel:g.handleFileUploadWithTagCancel},null,8,["modelValue","current-row","onSubmit","onCancel"]),(0,t.bF)(O,{title:"添加PC到运单",modelValue:g.addPcDialogVisible,"onUpdate:modelValue":l[17]||(l[17]=e=>g.addPcDialogVisible=e),width:"70%"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",F,[(0,t.bF)(_,{onClick:g.handleCancelAddPc},{default:(0,t.k6)((()=>l[64]||(l[64]=[(0,t.eW)("取消")]))),_:1},8,["onClick"]),(0,t.bF)(_,{type:"primary",onClick:g.handleConfirmAddPc},{default:(0,t.k6)((()=>l[65]||(l[65]=[(0,t.eW)("确认添加")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.bF)(U,{modelValue:g.searchPcQuery,"onUpdate:modelValue":l[16]||(l[16]=e=>g.searchPcQuery=e),placeholder:"搜索PC号",size:"small",clearable:"",style:{"margin-bottom":"10px",width:"300px"}},null,8,["modelValue"]),(0,t.bF)(I,{data:g.filteredAvailablePcs,border:"",style:{width:"100%"},height:"400px",onSelectionChange:g.handleAvailablePcSelectionChange},{default:(0,t.k6)((()=>[(0,t.bF)(S,{type:"selection",width:"55"}),(0,t.bF)(S,{prop:"pcNumber",label:"PC号",width:"150"}),(0,t.bF)(S,{prop:"appointmentParty",label:"预约方",width:"100"}),(0,t.bF)(S,{prop:"appointmentTime",label:"预约时间",width:"160"}),(0,t.bF)(S,{prop:"appointmentNumber",label:"预约号",width:"120"}),(0,t.bF)(S,{prop:"startWarehouse",label:"起始仓库",width:"120"}),(0,t.bF)(S,{prop:"destination",label:"目的地",width:"150"}),(0,t.bF)(S,{prop:"palletCount",label:"板数",width:"80"}),(0,t.bF)(S,{prop:"weight",label:"重量(kg)",width:"100"}),(0,t.bF)(S,{prop:"loadingType",label:"装车类型",width:"100"}),(0,t.bF)(S,{prop:"boxCount",label:"箱数",width:"80"}),(0,t.bF)(S,{prop:"priority",label:"优先级",width:"80"}),(0,t.bF)(S,{prop:"volume",label:"方数(m³)",width:"100"})])),_:1},8,["data","onSelectionChange"])])),_:1},8,["modelValue"])])}var x=a(953),C=a(5220),_=a(163),T=a(7918),V=a(5493),W=a(4287),P=a(616),U=a(3473);const E={name:"TrainDetail",components:{ExpenseDetailDialog:V.A,TrainFileUploadDialog:W.A,UploadPodDialog:P.A,FileUploadWithTagDialog:U.A},setup(){const e=(0,C.rd)(),l=(0,C.lq)(),a=l.params.id,o=(0,x.KR)("basic"),n=(0,x.KR)(!1),i=(0,x.KR)([]),d=(0,x.KR)(!1),p=(0,x.KR)(null),u=(0,x.KR)(!1),s=(0,x.KR)(null),r=(0,x.KR)([{id:"1",fileName:"POD_20230715.pdf",fileType:"pod",fileSize:"2.5MB",uploadTime:"2023-07-15 10:30:00",uploadBy:"供应商A",status:"pending",remark:"供应商POD文件"},{id:"2",fileName:"invoice.pdf",fileType:"normal",fileSize:"1.2MB",uploadTime:"2023-07-15 11:00:00",uploadBy:"供应商A",status:"pending",remark:"发票文件"}]),m=(0,x.KR)({id:a,trainNumber:"TRAIN20230715001",loadingType:"整车",deliveryType:"派送",createTime:"2023-07-15 10:00:00",loadingAppointmentTime:"2023-07-15 14:00:00",licensePlate:"粤B12345",driverPhone:"13800138000",driverName:"张三",supplier:"物流供应商A",status:"已登记",palletCount:"20",weight:"5000kg",cbm:"10m³"}),b=(0,x.KR)([{pcNumber:"PC123456",loadingType:"整车",orderType:"普通订单",destination:"深圳市南山区",palletCount:"10",weight:"2500kg",volume:"5m³",appointmentNumber:"APT20230715001",appointmentTime:"2023-07-15 14:00:00",appointmentParty:"客户A",status:"待装车",remark:"无"}]),c=(0,x.KR)("all"),k=(0,x.KR)([{id:"1",pcNumber:"PC123456",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715001",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"基础派送费",amount:"2000.00",expenseDate:"2023-07-15",operator:"张三",operateTime:"2023-07-15 10:30:00",type:"delivery"},{id:"2",pcNumber:"PC123457",status:"已审核",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715002",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"偏远地区附加费",amount:"500.00",expenseDate:"2023-07-15",operator:"李四",operateTime:"2023-07-15 11:20:00",type:"delivery"},{id:"3",pcNumber:"PC123458",status:"已锁单",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715003",supplier:"物流供应商A",expenseType:"exception",expenseRemark:"货物破损赔偿",amount:"800.00",expenseDate:"2023-07-16",operator:"王五",operateTime:"2023-07-16 09:15:00",type:"abnormal"}]),h=(0,x.KR)([{id:"1",pcNumber:"PC123456",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715001",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"基础派送费",amount:"2000.00",expenseDate:"2023-07-15",operator:"张三",operateTime:"2023-07-15 10:30:00"},{id:"2",pcNumber:"PC123457",status:"已审核",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715002",supplier:"物流供应商A",expenseType:"delivery",expenseRemark:"偏远地区附加费",amount:"500.00",expenseDate:"2023-07-15",operator:"李四",operateTime:"2023-07-15 11:20:00"}]),f=(0,x.KR)([{id:"3",pcNumber:"PC123458",status:"已锁单",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715003",supplier:"物流供应商A",expenseType:"exception",expenseRemark:"货物破损赔偿",amount:"800.00",expenseDate:"2023-07-16",operator:"王五",operateTime:"2023-07-16 09:15:00"}]),v=(0,x.KR)([{id:"4",pcNumber:"PC123456",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715004",supplier:"物流供应商A",expenseType:"waiting",expenseRemark:"装货等待费",amount:"300.00",expenseDate:"2023-07-16",operator:"赵六",operateTime:"2023-07-16 14:30:00"}]),w=(0,x.KR)([{id:"5",pcNumber:"PC123457",status:"已审核",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715005",supplier:"物流供应商A",expenseType:"loading",expenseRemark:"装车人工费",amount:"600.00",expenseDate:"2023-07-16",operator:"钱七",operateTime:"2023-07-16 16:45:00"}]),y=(0,x.KR)([{id:"6",pcNumber:"PC123458",status:"已付款",fromWarehouse:"美西一号仓",toWarehouse:"美西二号仓",paymentNo:"PAY20230715006",supplier:"物流供应商A",expenseType:"other",expenseRemark:"保险费",amount:"200.00",expenseDate:"2023-07-17",operator:"孙八",operateTime:"2023-07-17 09:00:00"}]),F=(0,t.EW)((()=>{const e=[...h.value,...f.value,...v.value,...w.value,...y.value];return e.reduce(((e,l)=>e+Number(l.amount)),0).toFixed(2)})),g=(0,t.EW)((()=>{const e=[...h.value,...f.value,...v.value,...w.value,...y.value];return e.filter((e=>"已支付"===e.paymentStatus)).reduce(((e,l)=>e+Number(l.amount)),0).toFixed(2)})),V=(0,t.EW)((()=>{const e=[...h.value,...f.value,...v.value,...w.value,...y.value];return e.filter((e=>"未支付"===e.paymentStatus)).reduce(((e,l)=>e+Number(l.amount)),0).toFixed(2)})),W=e=>{const l={待登记:"info",已登记:"primary",装车中:"warning",装车完成:"success",已发货:"success",已签收:"success",已取消:"danger"};return l[e]||"info"},P=e=>{const l={待装车:"info",装车中:"warning",已装车:"success",已发货:"success",已签收:"success",异常:"danger"};return l[e]||"info"},U=e=>"abnormal"===e?"danger":"primary",E=e=>"abnormal"===e?"异常文件":"留底文件",R=()=>{e.go(-1)},N=()=>{_.nk.info("编辑运单功能待实现")},L=()=>{_.nk.info("导出运单功能待实现")},S=()=>{Ve(),_e.value="",Te.value=[],xe.value=!0},z=()=>{_.nk.info("导出PC明细功能待实现")},A=e=>{_.nk.info(`查看PC明细：${e.pcNumber}`)},D=e=>{_.nk.info(`编辑PC明细：${e.pcNumber}`)},I=(e,l)=>{switch(e){case"uploadPod":ce(l);break;case"followUp":_.nk.info(`跟进记录：${l.pcNumber}`);break;case"memo":_.nk.info(`MEMO：${l.pcNumber}`);break;case"exception":_.nk.info(`标记异常：${l.pcNumber}`);break;case"delete":T.s.confirm(`确定要删除PC ${l.pcNumber} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=b.value.findIndex((e=>e.pcNumber===l.pcNumber));-1!==e?(b.value.splice(e,1),_.nk.success(`已删除PC ${l.pcNumber}`)):_.nk.error("未找到要删除的PC")})).catch((()=>{_.nk.info("已取消删除操作")}));break;default:break}},K=()=>{n.value=!0},B=e=>{const l={id:String(r.value.length+1),fileName:e.files[0].name,fileType:e.fileTag,fileSize:`${(e.files[0].size/1048576).toFixed(1)}MB`,uploadTime:(new Date).toLocaleString(),uploadBy:"当前用户",remark:e.remark||""};r.value.unshift(l),_.nk.success("文件上传成功"),n.value=!1},X=e=>{i.value=e},$=()=>{n.value=!1},j=e=>{_.nk.info(`预览文件：${e.fileName}`)},O=e=>{_.nk.success(`文件 ${e.fileName} 开始下载`)},M=e=>{T.s.confirm(`确定要删除文件 ${e.fileName} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{r.value=r.value.filter((l=>l.id!==e.id)),_.nk.success(`已删除文件 ${e.fileName}`)})).catch((()=>{}))},Y=e=>"已支付"===e?"success":"warning",Q=()=>{p.value=null,d.value=!0},q=()=>{_.nk.info("导出费用功能待实现")},H=e=>{p.value={...e},d.value=!0},G=e=>{T.s.confirm(`确定要删除费用 ${e.expenseType} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const l={delivery:h,abnormal:f,waiting:v,loading:w,other:y},a=l[c.value];if(a){const l=a.value.findIndex((l=>l.id===e.id));-1!==l&&(a.value.splice(l,1),_.nk.success("删除成功"))}})).catch((()=>{}))},J=e=>{const l={delivery:h,abnormal:f,waiting:v,loading:w,other:y},a=l[c.value];if(a){if(p.value){const l=a.value.findIndex((e=>e.id===p.value.id));-1!==l&&(a.value[l]={...p.value,...e})}else{const l={id:String(a.value.length+1),...e};a.value.push(l)}_.nk.success(p.value?"费用更新成功":"费用添加成功")}d.value=!1},Z=()=>{d.value=!1},ee=e=>{const l={已付款:"success",已审核:"warning",已锁单:"info"};return l[e]||"info"},le=(e,l)=>{switch(e){case"push":T.s.confirm(`确定要推送费用 ${l.expenseType} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{_.nk.success("费用推送成功")})).catch((()=>{}));break;case"delete":G(l);break}},ae=(0,x.KR)([]),te=e=>{ae.value=e},oe=()=>{0!==ae.value.length?T.s.confirm(`确定要批量推送 ${ae.value.length} 条费用记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{_.nk.success("批量推送成功")})).catch((()=>{})):_.nk.warning("请选择要推送的费用")};(0,t.sV)((()=>{console.log("加载运单详情：",a)}));const ne=(0,x.KR)([{value:"delivery",label:"派送费",type:"success"},{value:"loading",label:"装车费",type:"primary"},{value:"waiting",label:"等时费",type:"warning"},{value:"exception",label:"异常费",type:"danger"},{value:"storage",label:"仓储费",type:"warning"},{value:"other",label:"其他费用",type:"info"}]),ie=e=>{const l=ne.value.find((l=>l.value===e));return l?l.label:e},de=e=>{const l=ne.value.find((l=>l.value===e));return l?l.type:"info"},pe=e=>{const l={pending:"warning",approved:"success",rejected:"danger"};return l[e]||"info"},ue=e=>{const l={pending:"待审核",approved:"已通过",rejected:"已拒绝"};return l[e]||e},se=(e,l)=>{switch(e){case"preview":j(l);break;case"download":O(l);break;case"approve":T.s.confirm("确定要通过该文件的审核吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.status="approved",_.nk.success("文件审核通过")})).catch((()=>{}));break;case"reject":T.s.confirm("确定要拒绝该文件的审核吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{l.status="rejected",_.nk.success("文件审核已拒绝")})).catch((()=>{}));break;case"delete":M(l);break;case"pushCustomerService":_.nk.info(`推送客服: ${l.fileName}`);break;case"pushCustomer":_.nk.info(`推送客户: ${l.fileName}`);break}},re=(0,x.KR)([{label:"美西一号仓",value:"warehouse1"},{label:"美西二号仓",value:"warehouse2"},{label:"美西三号仓",value:"warehouse3"},{label:"美东一号仓",value:"warehouse4"},{label:"美东二号仓",value:"warehouse5"}]),me=(0,x.KR)([{label:"洛杉矶",value:"LA"},{label:"旧金山",value:"SF"},{label:"纽约",value:"NY"},{label:"西雅图",value:"SEA"},{label:"芝加哥",value:"CHI"}]),be=(0,x.KR)([{label:"物流供应商A",value:"supplierA"},{label:"物流供应商B",value:"supplierB"},{label:"物流供应商C",value:"supplierC"},{label:"物流供应商D",value:"supplierD"}]),ce=e=>{s.value=e,u.value=!0},ke=async e=>{try{if(console.log("提交POD数据:",e),s.value){s.value.podStatus="已上传",s.value.podUploadTime=e.receiptTime;const l=r.value.findIndex((e=>e.id===s.value.id));-1!==l&&(r.value[l]={...s.value})}_.nk.success("POD上传成功"),u.value=!1}catch(l){console.error("POD上传失败:",l),_.nk.error("POD上传失败")}},he=()=>{u.value=!1,s.value=null},fe=(0,x.KR)(!1),ve=(0,x.KR)(null),we=e=>{ve.value=e,fe.value=!0},ye=async e=>{try{if(console.log("提交文件数据:",e),ve.value){ve.value.fileTag=e.fileTag,ve.value.fileRemark=e.remark;const l=r.value.findIndex((e=>e.id===ve.value.id));-1!==l&&(r.value[l]={...ve.value})}_.nk.success("文件上传成功"),fe.value=!1}catch(l){console.error("文件上传失败:",l),_.nk.error("文件上传失败")}},Fe=()=>{fe.value=!1,ve.value=null},ge=()=>{if(0===i.value.length)return void _.nk.warning("请选择需要审核的文件");const e=i.value.filter((e=>"pending"===e.status));0!==e.length?T.s.confirm(`确定要批量审核通过选中的 ${e.length} 个文件吗？`,"批量审核确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.forEach((e=>{const l=r.value.find((l=>l.id===e.id));l&&(l.status="approved")})),_.nk.success(`已成功批量审核 ${e.length} 个文件`)})).catch((()=>{_.nk.info("已取消批量审核操作")})):_.nk.warning("选中的文件都已审核，无需重复操作")},xe=(0,x.KR)(!1),Ce=(0,x.KR)([]),_e=(0,x.KR)(""),Te=(0,x.KR)([]),Ve=()=>{const e=b.value.map((e=>e.pcNumber));Ce.value=[{pcNumber:"PC777777",appointmentParty:"客户C",appointmentTime:"2024-03-10 10:00:00",appointmentNumber:"BK777",startWarehouse:"东莞仓库",destination:"芝加哥",palletCount:5,weight:1e3,loadingType:"卡板",boxCount:80,priority:1,volume:2},{pcNumber:"PC888888",appointmentParty:"客户D",appointmentTime:"2024-03-11 11:00:00",appointmentNumber:"BK888",startWarehouse:"广州仓库",destination:"纽约",palletCount:8,weight:1800,loadingType:"地板",boxCount:200,priority:2,volume:4},{pcNumber:"PC999999",appointmentParty:"客户E",appointmentTime:"2024-03-12 15:30:00",appointmentNumber:"BK999",startWarehouse:"深圳仓库",destination:"洛杉矶",palletCount:12,weight:3e3,loadingType:"混装",boxCount:150,priority:3,volume:6}].filter((l=>!e.includes(l.pcNumber)))},We=(0,t.EW)((()=>_e.value?Ce.value.filter((e=>e.pcNumber.toLowerCase().includes(_e.value.toLowerCase()))):Ce.value)),Pe=e=>{Te.value=e},Ue=()=>{if(0===Te.value.length)return void _.nk.warning("请至少选择一个PC进行添加");const e=Te.value.map((e=>({pcNumber:e.pcNumber,appointmentParty:e.appointmentParty||"",appointmentTime:e.appointmentTime||"",appointmentNumber:e.appointmentNumber||"",startWarehouse:e.startWarehouse||"N/A",destination:e.destination||"N/A",palletCount:e.palletCount||0,weight:e.weight||0,loadingType:e.loadingType||"卡板",boxCount:e.boxCount||0,priority:e.priority||3,volume:e.volume||0,status:"待装车",remark:""})));b.value.push(...e),_.nk.success(`成功添加 ${e.length} 个PC`),xe.value=!1},Ee=()=>{xe.value=!1};return{activeTab:o,basicInfo:m,pcDetailData:b,fileList:r,fileUploadDialogVisible:n,expenseActiveTab:c,allExpenses:k,deliveryExpenses:h,abnormalExpenses:f,waitingExpenses:v,loadingExpenses:w,otherExpenses:y,totalExpense:F,paidExpense:g,unpaidExpense:V,getStatusTagType:W,getPCStatusTagType:P,getFileTypeTagType:U,getFileTypeLabel:E,goBack:R,handleEdit:N,handleExport:L,handleAddPC:S,handleExportPC:z,handleViewPC:A,handleEditPC:D,handlePCCommand:I,showFileUploadDialog:K,handleFileUploadSubmit:B,handleFileUploadCancel:$,handlePreviewFile:j,handleDownloadFile:O,handleDeleteFile:M,getPaymentStatusTagType:Y,handleAddExpense:Q,handleExportExpense:q,handleEditExpense:H,handleDeleteExpense:G,expenseDialogVisible:d,currentExpense:p,handleExpenseSubmit:J,handleExpenseCancel:Z,getExpenseStatusTagType:ee,handleExpenseCommand:le,handleBatchPushExpense:oe,selectedExpenses:ae,handleSelectionChange:te,expenseTypes:ne,getExpenseTypeLabel:ie,getExpenseTypeTag:de,getPodStatusTagType:pe,getPodStatusLabel:ue,handleFileCommand:se,warehouseOptions:re,destinationOptions:me,supplierOptions:be,podDialogVisible:u,currentPodRow:s,handleUploadPod:ce,handlePodSubmit:ke,handlePodCancel:he,fileUploadWithTagVisible:fe,currentFileRow:ve,handleFileUploadWithTag:we,handleFileUploadWithTagSubmit:ye,handleFileUploadWithTagCancel:Fe,handleBatchApprove:ge,handleFileSelectionChange:X,selectedFiles:i,addPcDialogVisible:xe,searchPcQuery:_e,filteredAvailablePcs:We,handleConfirmAddPc:Ue,handleCancelAddPc:Ee,handleAvailablePcSelectionChange:Pe}}};var R=a(6262);const N=(0,R.A)(E,[["render",g],["__scopeId","data-v-24663ea0"]]),L=N}}]);
//# sourceMappingURL=1140.95bc1de3.js.map