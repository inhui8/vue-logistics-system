"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[522],{4287:(e,l,a)=>{a.d(l,{A:()=>W});var o=a(641),i=a(33);const t={class:"upload-container"},n={class:"form-section"},r={class:"form-content"},u={class:"form-section"},s={class:"form-content"},d={class:"form-section"},p={class:"form-content"},c={key:0,class:"form-section"},v={class:"form-content"},m={class:"preview-container"},b={class:"preview-header"},g={class:"preview-title"},k={class:"preview-content"},f=["src"],h={key:1,class:"preview-placeholder"},w={class:"dialog-footer"};function y(e,l,a,y,C,F){const V=(0,o.g2)("el-radio"),_=(0,o.g2)("el-radio-group"),L=(0,o.g2)("el-input"),S=(0,o.g2)("upload-filled"),W=(0,o.g2)("el-icon"),R=(0,o.g2)("el-upload"),x=(0,o.g2)("el-button"),D=(0,o.g2)("document"),T=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(T,{title:"文件上传",modelValue:y.dialogVisible,"onUpdate:modelValue":l[2]||(l[2]=e=>y.dialogVisible=e),width:"600px","close-on-click-modal":!1,onClose:y.handleClose},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",w,[(0,o.bF)(x,{onClick:y.handleClose},{default:(0,o.k6)((()=>l[13]||(l[13]=[(0,o.eW)("取消")]))),_:1},8,["onClick"]),(0,o.bF)(x,{type:"primary",onClick:y.handleSubmit,disabled:!y.isValid,loading:y.uploading},{default:(0,o.k6)((()=>[(0,o.eW)((0,i.v_)(y.uploading?"上传中...":"确定"),1)])),_:1},8,["onClick","disabled","loading"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",t,[(0,o.Lk)("div",n,[l[5]||(l[5]=(0,o.Lk)("div",{class:"form-label required"},"文件类型：",-1)),(0,o.Lk)("div",r,[(0,o.bF)(_,{modelValue:y.form.fileType,"onUpdate:modelValue":l[0]||(l[0]=e=>y.form.fileType=e)},{default:(0,o.k6)((()=>[(0,o.bF)(V,{label:"record"},{default:(0,o.k6)((()=>l[3]||(l[3]=[(0,o.eW)("留底文件")]))),_:1}),(0,o.bF)(V,{label:"abnormal"},{default:(0,o.k6)((()=>l[4]||(l[4]=[(0,o.eW)("异常文件")]))),_:1})])),_:1},8,["modelValue"])])]),(0,o.Lk)("div",u,[l[6]||(l[6]=(0,o.Lk)("div",{class:"form-label"},"备注：",-1)),(0,o.Lk)("div",s,[(0,o.bF)(L,{modelValue:y.form.remark,"onUpdate:modelValue":l[1]||(l[1]=e=>y.form.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])])]),(0,o.Lk)("div",d,[l[9]||(l[9]=(0,o.Lk)("div",{class:"form-label required"},"上传文件：",-1)),(0,o.Lk)("div",p,[(0,o.bF)(R,{ref:"uploadRef",class:"upload-area",action:"#","auto-upload":!1,"on-change":y.handleFileChange,"on-remove":y.handleFileRemove,"on-preview":y.handleFilePreview,"file-list":y.fileList,limit:5,multiple:"",drag:"",accept:".pdf,.jpg,.jpeg,.png"},{tip:(0,o.k6)((()=>l[7]||(l[7]=[(0,o.Lk)("div",{class:"el-upload__tip"}," 支持 .pdf、.jpg、.jpeg、.png 格式，单个文件不超过 10MB ",-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(W,{class:"el-icon-upload"},{default:(0,o.k6)((()=>[(0,o.bF)(S)])),_:1}),l[8]||(l[8]=(0,o.Lk)("div",{class:"el-upload__text"},[(0,o.eW)(" 将文件拖到此处，或"),(0,o.Lk)("em",null,"点击上传")],-1))])),_:1},8,["on-change","on-remove","on-preview","file-list"])])]),y.previewVisible?((0,o.uX)(),(0,o.CE)("div",c,[l[12]||(l[12]=(0,o.Lk)("div",{class:"form-label"},"预览：",-1)),(0,o.Lk)("div",v,[(0,o.Lk)("div",m,[(0,o.Lk)("div",b,[(0,o.Lk)("div",g,(0,i.v_)(y.previewFile.name),1),(0,o.bF)(x,{type:"text",onClick:y.closePreview},{default:(0,o.k6)((()=>l[10]||(l[10]=[(0,o.eW)("关闭")]))),_:1},8,["onClick"])]),(0,o.Lk)("div",k,[y.isImageFile(y.previewFile)?((0,o.uX)(),(0,o.CE)("img",{key:0,src:y.previewUrl,class:"preview-image"},null,8,f)):((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(D,{class:"preview-icon"}),(0,o.Lk)("div",null,(0,i.v_)(y.previewFile.name),1),(0,o.bF)(x,{type:"primary",size:"small",onClick:y.downloadFile},{default:(0,o.k6)((()=>l[11]||(l[11]=[(0,o.eW)("下载查看")]))),_:1},8,["onClick"])]))])])])])):(0,o.Q3)("",!0)])])),_:1},8,["modelValue","onClose"])}var C=a(953),F=a(8548),V=a(163);const _={name:"TrainFileUploadDialog",components:{UploadFilled:F.m8m,Document:F.yoT},props:{visible:{type:Boolean,default:!1},trainId:{type:[String,Number],default:""}},emits:["update:visible","submit","cancel"],setup(e,{emit:l}){const a=(0,o.EW)({get:()=>e.visible,set:e=>l("update:visible",e)}),i=(0,C.KR)(null),t=(0,C.KR)(!1),n=(0,C.KR)({fileType:"record",remark:"",files:[]}),r=(0,C.KR)([]),u=(0,C.KR)(!1),s=(0,C.KR)({}),d=(0,C.KR)(""),p=(0,o.EW)((()=>n.value.fileType&&n.value.files.length>0)),c=e=>{const l=["application/pdf","image/jpeg","image/png","image/jpg"],a=e.raw.type;if(!l.includes(a))return V.nk.error("不支持的文件类型"),!1;const o=10485760;if(e.raw.size>o)return V.nk.error("文件大小不能超过 10MB"),!1;n.value.files.includes(e.raw)||n.value.files.push(e.raw)},v=e=>{const l=n.value.files.findIndex((l=>l===e.raw));l>-1&&n.value.files.splice(l,1)},m=e=>{if(!e||!e.name)return!1;const l=e.name.split(".").pop().toLowerCase();return["jpg","jpeg","png"].includes(l)},b=e=>{s.value=e,m(e)?d.value=URL.createObjectURL(e.raw):d.value="",u.value=!0},g=()=>{u.value=!1,d.value&&(URL.revokeObjectURL(d.value),d.value="")},k=()=>{if(s.value&&s.value.raw){const e=URL.createObjectURL(s.value.raw),l=document.createElement("a");l.href=e,l.download=s.value.name,document.body.appendChild(l),l.click(),setTimeout((()=>{document.body.removeChild(l),URL.revokeObjectURL(e)}),0)}},f=async()=>{if(p.value){t.value=!0;try{const a={trainId:e.trainId,fileTag:n.value.fileType,remark:n.value.remark,files:n.value.files};l("submit",a)}catch(a){console.error("文件上传失败:",a),V.nk.error("文件上传失败")}finally{t.value=!1}}else V.nk.warning("请选择文件类型并上传文件")},h=()=>{d.value&&URL.revokeObjectURL(d.value),n.value={fileType:"record",remark:"",files:[]},r.value=[],u.value=!1,l("cancel"),a.value=!1};return(0,o.wB)((()=>e.visible),(e=>{e&&(n.value={fileType:"record",remark:"",files:[]},r.value=[],u.value=!1)})),{dialogVisible:a,form:n,fileList:r,uploadRef:i,uploading:t,previewVisible:u,previewFile:s,previewUrl:d,isValid:p,handleFileChange:c,handleFileRemove:v,handleFilePreview:b,isImageFile:m,closePreview:g,downloadFile:k,handleSubmit:f,handleClose:h}}};var L=a(6262);const S=(0,L.A)(_,[["render",y],["__scopeId","data-v-1bb54d49"]]),W=S},9405:e=>{e.exports=JSON.parse('[{"prop":"pcNumber","label":"PC号","width":120,"sortable":true},{"prop":"bookingParty","label":"预约方","width":120,"sortable":true},{"prop":"bookingTime","label":"预约时间","width":160,"sortable":true},{"prop":"bookingNumber","label":"预约号","width":120,"sortable":true},{"prop":"startWarehouse","label":"起始仓库","width":120,"sortable":true},{"prop":"destination","label":"目的地","width":150,"sortable":true},{"prop":"palletCount","label":"板数","width":100,"sortable":true},{"prop":"weight","label":"重量","width":100,"sortable":true},{"prop":"rank","label":"优先级","width":100,"sortable":true},{"prop":"volume","label":"方数","width":100,"sortable":true},{"prop":"DriverStartTime","label":"司机出发时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"DriverEndTime","label":"司机到达时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"Arrived","label":"交仓完成时间","width":120,"sortable":true,"filterType":"datetime"},{"prop":"podImage","label":"POD图片","width":150,"sortable":false,"filterType":"image","type":"image"},{"prop":"operation","label":"操作","width":150,"fixed":"right","sortable":false,"type":"operation"}]')},9651:(e,l,a)=>{a.r(l),a.d(l,{default:()=>be});var o=a(641),i=a(3751),t=a(33);const n={class:"delivery-trains-container"},r={class:"filter-bar"},u={class:"filter-row"},s={class:"date-buttons"},d={class:"send-order-filter"},p={class:"action-buttons"},c={class:"view-management"},v={class:"table-container"},m={class:"sub-table-container"},b={key:0,class:"group-name"},g={key:1},k={key:0,class:"cell-editor"},f=["onClick"],h={key:2},w={class:"tag-cell"},y={class:"view-options-menu"},C={class:"group-settings"},F={class:"group-level"},V={class:"group-level"},_={class:"group-level"},L={class:"dialog-footer"},S={class:"sort-settings"},W={class:"sort-actions"},R={class:"dialog-footer"},x={class:"column-settings"},D={class:"column-settings-header"},T={class:"column-list"},U={class:"column-item"},K={class:"dialog-footer"},P={class:"dialog-footer"},E={class:"follow-up-container"},N={class:"follow-up-history"},X={class:"follow-up-item"},O={class:"follow-up-content"},z={class:"follow-up-operator"},M={key:0,class:"follow-up-files"},I={class:"dialog-footer"},A={class:"badge-container"};function G(e,l,a,G,$,j){const B=(0,o.g2)("el-option"),q=(0,o.g2)("el-select"),Q=(0,o.g2)("el-date-picker"),H=(0,o.g2)("el-input"),J=(0,o.g2)("el-radio-button"),Y=(0,o.g2)("el-radio-group"),Z=(0,o.g2)("el-button"),ee=(0,o.g2)("el-dropdown-item"),le=(0,o.g2)("el-dropdown-menu"),ae=(0,o.g2)("el-dropdown"),oe=(0,o.g2)("el-table-column"),ie=(0,o.g2)("el-table"),te=(0,o.g2)("el-tag"),ne=(0,o.g2)("groupable-table"),re=(0,o.g2)("filter-panel"),ue=(0,o.g2)("el-form-item"),se=(0,o.g2)("el-checkbox"),de=(0,o.g2)("el-checkbox-group"),pe=(0,o.g2)("el-form"),ce=(0,o.g2)("el-dialog"),ve=(0,o.g2)("d-arrow-left"),me=(0,o.g2)("el-icon"),be=(0,o.g2)("draggable"),ge=(0,o.g2)("expense-detail-dialog"),ke=(0,o.g2)("document"),fe=(0,o.g2)("el-timeline-item"),he=(0,o.g2)("el-timeline"),we=(0,o.g2)("el-upload"),ye=(0,o.g2)("history-record-dialog"),Ce=(0,o.g2)("gps-track-dialog"),Fe=(0,o.g2)("train-file-upload-dialog"),Ve=(0,o.g2)("upload-pod-dialog"),_e=(0,o.g2)("file-upload-with-tag-dialog"),Le=(0,o.g2)("el-badge"),Se=(0,o.g2)("el-tab-pane"),We=(0,o.g2)("el-tabs"),Re=(0,o.gN)("loading");return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",r,[(0,o.Lk)("div",u,[(0,o.bF)(q,{modelValue:G.warehouse,"onUpdate:modelValue":l[0]||(l[0]=e=>G.warehouse=e),placeholder:"美西二号仓",size:"small",class:"filter-item"},{default:(0,o.k6)((()=>[(0,o.bF)(B,{label:"美西二号仓",value:"west2"}),(0,o.bF)(B,{label:"美西一号仓",value:"west1"})])),_:1},8,["modelValue"]),(0,o.bF)(q,{modelValue:G.createDateType,"onUpdate:modelValue":l[1]||(l[1]=e=>G.createDateType=e),placeholder:"创建日期",size:"small",class:"filter-item"},{default:(0,o.k6)((()=>[(0,o.bF)(B,{label:"创建日期",value:"create"}),(0,o.bF)(B,{label:"出单日期",value:"issue"}),(0,o.bF)(B,{label:"装车预约时间",value:"appointment"})])),_:1},8,["modelValue"]),(0,o.Lk)("div",s,[(0,o.bF)(Q,{modelValue:G.dateRange,"onUpdate:modelValue":l[2]||(l[2]=e=>G.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small",class:"date-range-picker",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,o.bF)(q,{modelValue:G.searchType,"onUpdate:modelValue":l[3]||(l[3]=e=>G.searchType=e),placeholder:"批次号",size:"small",class:"filter-item"},{default:(0,o.k6)((()=>[(0,o.bF)(B,{label:"车次号",value:"trainNumber"}),(0,o.bF)(B,{label:"PC号",value:"trainNumber"}),(0,o.bF)(B,{label:"出单人",value:"issuer"}),(0,o.bF)(B,{label:"装车人",value:"loader"}),(0,o.bF)(B,{label:"司机电话",value:"driverPhone"})])),_:1},8,["modelValue"]),(0,o.bF)(H,{placeholder:"请输入",modelValue:G.searchText,"onUpdate:modelValue":l[4]||(l[4]=e=>G.searchText=e),size:"small",class:"search-input","prefix-icon":"el-icon-search"},null,8,["modelValue"]),(0,o.Lk)("div",d,[l[55]||(l[55]=(0,o.Lk)("span",{class:"label-text"},"是否SEND订单：",-1)),(0,o.bF)(Y,{modelValue:G.sendOrder,"onUpdate:modelValue":l[5]||(l[5]=e=>G.sendOrder=e),size:"small"},{default:(0,o.k6)((()=>[(0,o.bF)(J,{label:"no"},{default:(0,o.k6)((()=>l[53]||(l[53]=[(0,o.eW)("否")]))),_:1}),(0,o.bF)(J,{label:"yes"},{default:(0,o.k6)((()=>l[54]||(l[54]=[(0,o.eW)("是")]))),_:1})])),_:1},8,["modelValue"])]),(0,o.Lk)("div",p,[(0,o.bF)(Z,{type:"primary",size:"small",onClick:G.handleSearch},{default:(0,o.k6)((()=>l[56]||(l[56]=[(0,o.eW)("查询")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"warning",size:"small"},{default:(0,o.k6)((()=>l[57]||(l[57]=[(0,o.eW)("批量操作")]))),_:1}),(0,o.bF)(Z,{size:"small"},{default:(0,o.k6)((()=>l[58]||(l[58]=[(0,o.eW)("导出列表")]))),_:1}),(0,o.bF)(Z,{size:"small"},{default:(0,o.k6)((()=>l[59]||(l[59]=[(0,o.eW)("导出")]))),_:1})])])]),(0,o.Lk)("div",c,[l[73]||(l[73]=(0,o.Lk)("span",{class:"view-label"},null,-1)),(0,o.bF)(Y,{modelValue:G.currentView,"onUpdate:modelValue":l[6]||(l[6]=e=>G.currentView=e),size:"small",class:"status-view-group"},{default:(0,o.k6)((()=>[(0,o.bF)(J,{value:"all"},{default:(0,o.k6)((()=>l[60]||(l[60]=[(0,o.eW)("全部(21794)")]))),_:1}),(0,o.bF)(J,{value:"waitRegister"},{default:(0,o.k6)((()=>l[61]||(l[61]=[(0,o.eW)("待登记(107)")]))),_:1}),(0,o.bF)(J,{value:"registered"},{default:(0,o.k6)((()=>l[62]||(l[62]=[(0,o.eW)("已登记(152)")]))),_:1}),(0,o.bF)(J,{value:"loading"},{default:(0,o.k6)((()=>l[63]||(l[63]=[(0,o.eW)("装车中(0)")]))),_:1}),(0,o.bF)(J,{value:"loaded"},{default:(0,o.k6)((()=>l[64]||(l[64]=[(0,o.eW)("装车完成(3)")]))),_:1}),(0,o.bF)(J,{value:"shipped"},{default:(0,o.k6)((()=>l[65]||(l[65]=[(0,o.eW)("已发货(1585)")]))),_:1}),(0,o.bF)(J,{value:"delivered"},{default:(0,o.k6)((()=>l[66]||(l[66]=[(0,o.eW)("已签收(16351)")]))),_:1}),(0,o.bF)(J,{value:"pod"},{default:(0,o.k6)((()=>l[67]||(l[67]=[(0,o.eW)("已签收POD(3585)")]))),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.customViews,(e=>((0,o.uX)(),(0,o.Wv)(J,{key:e.id,label:e.id,onContextmenu:(0,i.D$)((l=>G.handleContextMenu(l,e)),["prevent"])},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(e.name),1)])),_:2},1032,["label","onContextmenu"])))),128))])),_:1},8,["modelValue"]),(0,o.bF)(Z,{type:"text",size:"small",onClick:G.handleSaveView},{default:(0,o.k6)((()=>l[68]||(l[68]=[(0,o.eW)("新增视图")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"text",size:"small",onClick:G.showGroupModal},{default:(0,o.k6)((()=>l[69]||(l[69]=[(0,o.eW)("高级分组")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"text",size:"small",onClick:G.showSortModal},{default:(0,o.k6)((()=>l[70]||(l[70]=[(0,o.eW)("高级排序")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"text",size:"small",onClick:G.showFilterPanel},{default:(0,o.k6)((()=>l[71]||(l[71]=[(0,o.eW)("筛选")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"text",size:"small",onClick:G.showColumnSettings},{default:(0,o.k6)((()=>l[72]||(l[72]=[(0,o.eW)("字段配置")]))),_:1},8,["onClick"])]),(0,o.Lk)("div",v,[(0,o.bo)(((0,o.uX)(),(0,o.Wv)(ne,{ref:"mainTable",data:G.displayData,"row-key":"id","group-fields":G.groupField?[G.groupField]:[],"show-selection":!0,"show-group-column":!!G.groupField,"group-column-label":G.groupField?G.getGroupColumnLabel(G.groupField):"分组","default-expand-all":!1,"show-pagination":!0,"current-page":G.currentPage,"page-size":G.pageSize,"page-sizes":[10,20,50,100],total:G.total,onSelectionChange:G.handleSelectionChange,onSizeChange:G.handleSizeChange,onCurrentChange:G.handleCurrentChange,onCellClick:G.handleCellClick,onCellDblclick:G.handleCellDbClick,style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(oe,{type:"expand"},{default:(0,o.k6)((e=>[(0,o.Lk)("div",m,[l[78]||(l[78]=(0,o.Lk)("h4",{class:"sub-table-title"},"预约信息",-1)),(0,o.bF)(ie,{data:e.row.children||[],border:"",size:"small",stripe:"",style:{width:"100%"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.childColumns,(e=>((0,o.uX)(),(0,o.Wv)(oe,{key:e.prop,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,o.k6)((a=>["expenseType"===e.prop?((0,o.uX)(),(0,o.Wv)(q,{key:0,modelValue:a.row.expenseType,"onUpdate:modelValue":e=>a.row.expenseType=e,size:"small",style:{width:"100%"},placeholder:"请选择费用类型",onChange:e=>G.handleExpenseTypeChange(a.row)},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.expenseTypes,(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):"operation"===e.prop?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.bF)(Z,{type:"text",size:"small",onClick:e=>G.handleDetail(a.row)},{default:(0,o.k6)((()=>l[74]||(l[74]=[(0,o.eW)("详情")]))),_:2},1032,["onClick"]),(0,o.bF)(ae,{size:"small",onCommand:e=>G.handleChildCommand(e,a.row)},{dropdown:(0,o.k6)((()=>[(0,o.bF)(le,null,{default:(0,o.k6)((()=>[(0,o.bF)(ee,{command:"lastPod"},{default:(0,o.k6)((()=>l[76]||(l[76]=[(0,o.eW)("上传POD")]))),_:1}),(0,o.bF)(ee,{command:"deletePc"},{default:(0,o.k6)((()=>l[77]||(l[77]=[(0,o.eW)("删除PC")]))),_:1})])),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(Z,{type:"text",size:"small"},{default:(0,o.k6)((()=>l[75]||(l[75]=[(0,o.eW)(" 更多"),(0,o.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[(0,o.eW)((0,t.v_)(a.row[e.prop]),1)],64))])),_:2},1032,["prop","label","width","sortable"])))),128))])),_:2},1032,["data"])])])),_:1}),G.hasGroupedData?((0,o.uX)(),(0,o.Wv)(oe,{key:0,label:"分组信息",width:"200"},{default:(0,o.k6)((e=>[e.row.isGroup?((0,o.uX)(),(0,o.CE)("span",b,[(0,o.bF)(te,{type:G.getGroupTagType(e.row.groupLevel)},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(e.row.groupName)+" ("+(0,t.v_)(e.row.count||0)+") ",1)])),_:2},1032,["type"])])):((0,o.uX)(),(0,o.CE)("span",g,"-"))])),_:1})):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.tableColumns,(e=>((0,o.uX)(),(0,o.CE)(o.FK,{key:e.prop},[!1!==e.visible&&"loadingStatus"===e.prop?((0,o.uX)(),(0,o.Wv)(oe,{key:0,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,o.k6)((e=>[(0,o.bF)(te,{type:G.getStatusTagType(e.row.loadingStatus),effect:"plain",size:"small"},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(e.row.loadingStatus),1)])),_:2},1032,["type"])])),_:2},1032,["prop","label","width","sortable"])):!1!==e.visible&&"operation"===e.prop?((0,o.uX)(),(0,o.Wv)(oe,{key:1,label:e.label,width:e.width,fixed:"right"},{default:(0,o.k6)((e=>[(0,o.bF)(Z,{type:"text",size:"small",onClick:l=>G.handleDetail(e.row)},{default:(0,o.k6)((()=>l[79]||(l[79]=[(0,o.eW)("详情")]))),_:2},1032,["onClick"]),(0,o.bF)(ae,{size:"small",onCommand:l=>G.handleCommand(l,e.row)},{dropdown:(0,o.k6)((()=>[(0,o.bF)(le,null,{default:(0,o.k6)((()=>[(0,o.bF)(ee,{command:"memo"},{default:(0,o.k6)((()=>l[81]||(l[81]=[(0,o.eW)("MEMO")]))),_:1}),(0,o.bF)(ee,{command:"followUp"},{default:(0,o.k6)((()=>l[82]||(l[82]=[(0,o.eW)("跟进记录")]))),_:1}),(0,o.bF)(ee,{command:"history"},{default:(0,o.k6)((()=>l[83]||(l[83]=[(0,o.eW)("历史记录")]))),_:1}),(0,o.bF)(ee,{command:"expense"},{default:(0,o.k6)((()=>l[84]||(l[84]=[(0,o.eW)("费用明细")]))),_:1}),(0,o.bF)(ee,{command:"markException"},{default:(0,o.k6)((()=>l[85]||(l[85]=[(0,o.eW)("标记异常")]))),_:1}),(0,o.bF)(ee,{command:"pcDetail"},{default:(0,o.k6)((()=>l[86]||(l[86]=[(0,o.eW)("GPS轨迹")]))),_:1}),(0,o.bF)(ee,{command:"PCdetail"},{default:(0,o.k6)((()=>l[87]||(l[87]=[(0,o.eW)("PC明细")]))),_:1}),(0,o.bF)(ee,{command:"cancel"},{default:(0,o.k6)((()=>l[88]||(l[88]=[(0,o.eW)("取消车次")]))),_:1}),(0,o.bF)(ee,{command:"uploadFile"},{default:(0,o.k6)((()=>l[89]||(l[89]=[(0,o.eW)("文件上传")]))),_:1})])),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(Z,{type:"text",size:"small"},{default:(0,o.k6)((()=>l[80]||(l[80]=[(0,o.eW)(" 更多"),(0,o.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:2},1032,["onCommand"])])),_:2},1032,["label","width"])):!1!==e.visible?((0,o.uX)(),(0,o.Wv)(oe,{key:2,prop:e.prop,label:e.label,width:e.width,sortable:e.sortable},{default:(0,o.k6)((a=>[["loadingType","deliveryType","carNumber","loader","dockNumber","warehouseRemarks","driverLicense","licensePlate","driverPhone","supplier","actualPallets","palletsMerged","deliveryCost"].includes(e.prop)&&G.editingCell.rowIndex===a.$index&&G.editingCell.prop===e.prop?((0,o.uX)(),(0,o.CE)("div",k,[["loadingType","deliveryType","loader","dockNumber","driverLicense","licensePlate","driverPhone","supplier"].includes(e.prop)?((0,o.uX)(),(0,o.Wv)(q,{key:0,modelValue:G.editingCell.value,"onUpdate:modelValue":l[7]||(l[7]=e=>G.editingCell.value=e),size:"small",onBlur:l=>G.saveEdit(a.row,e.prop),onKeyup:(0,i.jR)((l=>G.saveEdit(a.row,e.prop)),["enter"]),style:{width:"100%"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.getOptionsForColumn(e.prop),(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onBlur","onKeyup"])):((0,o.uX)(),(0,o.Wv)(H,{key:1,modelValue:G.editingCell.value,"onUpdate:modelValue":l[8]||(l[8]=e=>G.editingCell.value=e),size:"small",onBlur:l=>G.saveEdit(a.row,e.prop),onKeyup:(0,i.jR)((l=>G.saveEdit(a.row,e.prop)),["enter"]),type:["actualPallets","palletsMerged","deliveryCost"].includes(e.prop)?"number":"text"},null,8,["modelValue","onBlur","onKeyup","type"]))])):["loadingType","deliveryType","carNumber","loader","dockNumber","warehouseRemarks","driverLicense","licensePlate","driverPhone","supplier","actualPallets","palletsMerged","deliveryCost"].includes(e.prop)?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"editable-cell",onClick:l=>G.handleCellClick(a.row,e,a.$el)},(0,t.v_)(a.row[e.prop]||"-"),9,f)):((0,o.uX)(),(0,o.CE)("span",h,(0,t.v_)(a.row[e.prop]),1))])),_:2},1032,["prop","label","width","sortable"])):(0,o.Q3)("",!0)],64)))),128)),(0,o.bF)(oe,{prop:"tags",label:"标签",width:"200"},{default:(0,o.k6)((e=>[(0,o.Lk)("div",w,[Array.isArray(e.row.tags)&&e.row.tags.length?((0,o.uX)(!0),(0,o.CE)(o.FK,{key:0},(0,o.pI)(e.row.tags,(l=>((0,o.uX)(),(0,o.Wv)(te,{key:l,type:G.getTagType(l),closable:"",onClose:a=>G.handleTagClose(e.row,"tags",l)},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(l),1)])),_:2},1032,["type","onClose"])))),128)):"string"===typeof e.row.tags&&e.row.tags?((0,o.uX)(!0),(0,o.CE)(o.FK,{key:1},(0,o.pI)(e.row.tags.split(","),(l=>((0,o.uX)(),(0,o.Wv)(te,{key:l,type:G.getTagType(l),closable:"",onClose:a=>G.handleTagClose(e.row,"tags",l)},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(l.trim()),1)])),_:2},1032,["type","onClose"])))),128)):((0,o.uX)(),(0,o.Wv)(te,{key:2,type:"info"},{default:(0,o.k6)((()=>l[90]||(l[90]=[(0,o.eW)("未设置")]))),_:1}))])])),_:1})])),_:1},8,["data","group-fields","show-group-column","group-column-label","current-page","page-size","total","onSelectionChange","onSizeChange","onCurrentChange","onCellClick","onCellDblclick"])),[[Re,G.loading]])]),(0,o.bF)(re,{visible:G.filterPanelVisible,"onUpdate:visible":l[9]||(l[9]=e=>G.filterPanelVisible=e),columns:G.tableColumns,"existing-filters":G.activeFilters,"existing-logic":G.filterLogic,onApplyFilters:G.applyFilters,onCancel:G.cancelFilters},null,8,["visible","columns","existing-filters","existing-logic","onApplyFilters","onCancel"]),(0,o.bF)(ce,{title:"保存视图",modelValue:G.saveViewDialogVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>G.saveViewDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.bF)(Z,{onClick:l[12]||(l[12]=e=>G.saveViewDialogVisible=!1)},{default:(0,o.k6)((()=>l[91]||(l[91]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"primary",onClick:G.saveView},{default:(0,o.k6)((()=>l[92]||(l[92]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(pe,{model:G.viewForm,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{label:"视图名称",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(H,{modelValue:G.viewForm.name,"onUpdate:modelValue":l[10]||(l[10]=e=>G.viewForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(ue,{label:"显示字段"},{default:(0,o.k6)((()=>[(0,o.bF)(de,{modelValue:G.viewForm.columns,"onUpdate:modelValue":l[11]||(l[11]=e=>G.viewForm.columns=e)},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.tableColumns,(e=>((0,o.uX)(),(0,o.Wv)(se,{key:e.prop,label:e.prop},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(ce,{title:"视图操作",modelValue:G.viewOptionsDialogVisible,"onUpdate:modelValue":l[17]||(l[17]=e=>G.viewOptionsDialogVisible=e),width:"300px"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",y,[(0,o.Lk)("div",{class:"view-option-item",onClick:l[14]||(l[14]=(...e)=>G.handleRenameView&&G.handleRenameView(...e))},l[93]||(l[93]=[(0,o.Lk)("i",{class:"el-icon-edit"},null,-1),(0,o.Lk)("span",null,"重命名视图",-1)])),(0,o.Lk)("div",{class:"view-option-item",onClick:l[15]||(l[15]=(...e)=>G.handleCopyView&&G.handleCopyView(...e))},l[94]||(l[94]=[(0,o.Lk)("i",{class:"el-icon-document-copy"},null,-1),(0,o.Lk)("span",null,"复制视图",-1)])),(0,o.Lk)("div",{class:"view-option-item",onClick:l[16]||(l[16]=(...e)=>G.handleDeleteView&&G.handleDeleteView(...e))},l[95]||(l[95]=[(0,o.Lk)("i",{class:"el-icon-delete"},null,-1),(0,o.Lk)("span",null,"删除视图",-1)]))])])),_:1},8,["modelValue"]),(0,o.bF)(ce,{title:"重命名视图",modelValue:G.renameViewDialogVisible,"onUpdate:modelValue":l[20]||(l[20]=e=>G.renameViewDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.bF)(Z,{onClick:l[19]||(l[19]=e=>G.renameViewDialogVisible=!1)},{default:(0,o.k6)((()=>l[96]||(l[96]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"primary",onClick:G.saveRenameView},{default:(0,o.k6)((()=>l[97]||(l[97]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(pe,{model:G.renameForm,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{label:"视图名称",required:""},{default:(0,o.k6)((()=>[(0,o.bF)(H,{modelValue:G.renameForm.name,"onUpdate:modelValue":l[18]||(l[18]=e=>G.renameForm.name=e),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(ce,{title:"编辑信息",modelValue:G.editDialogVisible,"onUpdate:modelValue":l[24]||(l[24]=e=>G.editDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.bF)(Z,{onClick:l[23]||(l[23]=e=>G.editDialogVisible=!1)},{default:(0,o.k6)((()=>l[98]||(l[98]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"primary",onClick:G.saveDialogEdit},{default:(0,o.k6)((()=>l[99]||(l[99]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(pe,{model:G.editingForm,"label-width":"120px"},{default:(0,o.k6)((()=>[G.editingColumn.prop?((0,o.uX)(),(0,o.Wv)(ue,{key:0,label:G.editingColumn.label},{default:(0,o.k6)((()=>[["loadingType","deliveryType","loader","dockNumber","driverLicense","licensePlate","driverPhone","supplier"].includes(G.editingColumn.prop)?((0,o.uX)(),(0,o.Wv)(q,{key:0,modelValue:G.editingForm.value,"onUpdate:modelValue":l[21]||(l[21]=e=>G.editingForm.value=e),style:{width:"100%"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.getOptionsForColumn(G.editingColumn.prop),(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):((0,o.uX)(),(0,o.Wv)(H,{key:1,modelValue:G.editingForm.value,"onUpdate:modelValue":l[22]||(l[22]=e=>G.editingForm.value=e),type:["actualPallets","palletsMerged","deliveryCost"].includes(G.editingColumn.prop)?"number":"text"},null,8,["modelValue","type"]))])),_:1},8,["label"])):(0,o.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bo)((0,o.Lk)("div",{class:"context-menu",style:(0,t.Tr)({left:G.contextMenuX+"px",top:G.contextMenuY+"px"})},[(0,o.Lk)("div",{class:"context-menu-item",onClick:l[25]||(l[25]=(...e)=>G.handleCopyView&&G.handleCopyView(...e))},l[100]||(l[100]=[(0,o.Lk)("span",null,"复制视图",-1)])),(0,o.Lk)("div",{class:"context-menu-item",onClick:l[26]||(l[26]=(...e)=>G.handleRenameView&&G.handleRenameView(...e))},l[101]||(l[101]=[(0,o.Lk)("span",null,"重命名",-1)])),(0,o.Lk)("div",{class:"context-menu-item",onClick:l[27]||(l[27]=(...e)=>G.handleDeleteView&&G.handleDeleteView(...e))},l[102]||(l[102]=[(0,o.Lk)("span",null,"删除",-1)]))],4),[[i.aG,G.contextMenuVisible]]),(0,o.bF)(ce,{title:"分组设置",modelValue:G.groupModalVisible,"onUpdate:modelValue":l[32]||(l[32]=e=>G.groupModalVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",L,[(0,o.bF)(Z,{onClick:l[31]||(l[31]=e=>G.groupModalVisible=!1)},{default:(0,o.k6)((()=>l[106]||(l[106]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"danger",onClick:G.clearGroupSettings},{default:(0,o.k6)((()=>l[107]||(l[107]=[(0,o.eW)("清除分组")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"primary",onClick:G.applyGroupSettings},{default:(0,o.k6)((()=>l[108]||(l[108]=[(0,o.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",C,[(0,o.Lk)("div",F,[l[103]||(l[103]=(0,o.Lk)("span",{class:"group-level-label"},"一级分组：",-1)),(0,o.bF)(q,{modelValue:G.groupSettings.level1,"onUpdate:modelValue":l[28]||(l[28]=e=>G.groupSettings.level1=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.groupableFields,(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,o.Lk)("div",V,[l[104]||(l[104]=(0,o.Lk)("span",{class:"group-level-label"},"二级分组：",-1)),(0,o.bF)(q,{modelValue:G.groupSettings.level2,"onUpdate:modelValue":l[29]||(l[29]=e=>G.groupSettings.level2=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.groupableFields,(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,o.Lk)("div",_,[l[105]||(l[105]=(0,o.Lk)("span",{class:"group-level-label"},"三级分组：",-1)),(0,o.bF)(q,{modelValue:G.groupSettings.level3,"onUpdate:modelValue":l[30]||(l[30]=e=>G.groupSettings.level3=e),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.groupableFields,(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue"]),(0,o.bF)(ce,{title:"排序设置",modelValue:G.sortModalVisible,"onUpdate:modelValue":l[34]||(l[34]=e=>G.sortModalVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",R,[(0,o.bF)(Z,{onClick:l[33]||(l[33]=e=>G.sortModalVisible=!1)},{default:(0,o.k6)((()=>l[111]||(l[111]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"danger",onClick:G.clearSortSettings},{default:(0,o.k6)((()=>l[112]||(l[112]=[(0,o.eW)("清除排序")]))),_:1},8,["onClick"]),(0,o.bF)(Z,{type:"primary",onClick:G.applySortSettings},{default:(0,o.k6)((()=>l[113]||(l[113]=[(0,o.eW)("应用")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",S,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.sortSettings,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{key:a,class:"sort-item"},[(0,o.bF)(q,{modelValue:e.field,"onUpdate:modelValue":l=>e.field=l,placeholder:"选择字段",style:{width:"200px"},clearable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.sortableFields,(e=>((0,o.uX)(),(0,o.Wv)(B,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,o.bF)(q,{modelValue:e.direction,"onUpdate:modelValue":l=>e.direction=l,placeholder:"排序方向",style:{width:"120px"}},{default:(0,o.k6)((()=>[(0,o.bF)(B,{label:"升序",value:"asc"}),(0,o.bF)(B,{label:"降序",value:"desc"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,o.bF)(Z,{type:"danger",size:"small",onClick:e=>G.removeSortField(a)},{default:(0,o.k6)((()=>l[109]||(l[109]=[(0,o.eW)("删除")]))),_:2},1032,["onClick"])])))),128)),(0,o.Lk)("div",W,[(0,o.bF)(Z,{type:"primary",plain:"",onClick:G.addSortField},{default:(0,o.k6)((()=>l[110]||(l[110]=[(0,o.eW)("添加排序字段")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),(0,o.bF)(ce,{title:"字段配置",modelValue:G.columnSettingsVisible,"onUpdate:modelValue":l[38]||(l[38]=e=>G.columnSettingsVisible=e),width:"600px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",K,[(0,o.bF)(Z,{onClick:l[37]||(l[37]=e=>G.columnSettingsVisible=!1)},{default:(0,o.k6)((()=>l[116]||(l[116]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"primary",onClick:G.applyColumnSettings},{default:(0,o.k6)((()=>l[117]||(l[117]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",x,[(0,o.Lk)("div",D,[(0,o.bF)(se,{modelValue:G.allColumnsSelected,"onUpdate:modelValue":l[35]||(l[35]=e=>G.allColumnsSelected=e),onChange:G.handleSelectAllColumns},{default:(0,o.k6)((()=>l[114]||(l[114]=[(0,o.eW)("全选")]))),_:1},8,["modelValue","onChange"]),(0,o.bF)(Z,{type:"primary",size:"small",onClick:G.resetColumnSettings},{default:(0,o.k6)((()=>l[115]||(l[115]=[(0,o.eW)("重置")]))),_:1},8,["onClick"])]),(0,o.Lk)("div",T,[(0,o.bF)(be,{modelValue:G.columnSettingsList,"onUpdate:modelValue":l[36]||(l[36]=e=>G.columnSettingsList=e),"item-key":"prop",handle:".drag-handle",onEnd:G.handleDragEnd},{item:(0,o.k6)((({element:e})=>[(0,o.Lk)("div",U,[(0,o.bF)(me,{class:"drag-handle"},{default:(0,o.k6)((()=>[(0,o.bF)(ve)])),_:1}),(0,o.bF)(se,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])])),_:1},8,["modelValue","onEnd"])])])])),_:1},8,["modelValue"]),(0,o.bF)(ge,{visible:G.expenseDialogVisible,"onUpdate:visible":l[39]||(l[39]=e=>G.expenseDialogVisible=e),"train-data":G.currentTrainData,onExpensePushed:G.handleExpensePushed,onPushCancelled:G.handlePushCancelled},null,8,["visible","train-data","onExpensePushed","onPushCancelled"]),(0,o.bF)(ce,{title:"MEMO",modelValue:G.memoDialogVisible,"onUpdate:modelValue":l[42]||(l[42]=e=>G.memoDialogVisible=e),width:"500px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",P,[(0,o.bF)(Z,{onClick:l[41]||(l[41]=e=>G.memoDialogVisible=!1)},{default:(0,o.k6)((()=>l[118]||(l[118]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"primary",onClick:G.saveMemo},{default:(0,o.k6)((()=>l[119]||(l[119]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.bF)(pe,{model:G.memoForm,"label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{label:"备注"},{default:(0,o.k6)((()=>[(0,o.bF)(H,{modelValue:G.memoForm.memo,"onUpdate:modelValue":l[40]||(l[40]=e=>G.memoForm.memo=e),type:"textarea",rows:4,placeholder:"请输入备注信息"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(ce,{title:"跟进记录",modelValue:G.followUpDialogVisible,"onUpdate:modelValue":l[46]||(l[46]=e=>G.followUpDialogVisible=e),width:"600px"},{footer:(0,o.k6)((()=>[(0,o.Lk)("span",I,[(0,o.bF)(Z,{onClick:l[45]||(l[45]=e=>G.followUpDialogVisible=!1)},{default:(0,o.k6)((()=>l[123]||(l[123]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(Z,{type:"primary",onClick:G.saveFollowUp},{default:(0,o.k6)((()=>l[124]||(l[124]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",E,[(0,o.Lk)("div",N,[l[120]||(l[120]=(0,o.Lk)("h4",null,"历史记录",-1)),(0,o.bF)(he,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(G.followUpHistory,((e,l)=>((0,o.uX)(),(0,o.Wv)(fe,{key:l,timestamp:e.time,type:e.type},{default:(0,o.k6)((()=>[(0,o.Lk)("div",X,[(0,o.Lk)("div",O,(0,t.v_)(e.content),1),(0,o.Lk)("div",z,"操作人："+(0,t.v_)(e.operator),1),e.files&&e.files.length?((0,o.uX)(),(0,o.CE)("div",M,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.files,(e=>((0,o.uX)(),(0,o.Wv)(te,{key:e.id,type:"info",size:"small",class:"file-tag",onClick:l=>G.handleFilePreview(e)},{default:(0,o.k6)((()=>[(0,o.bF)(me,null,{default:(0,o.k6)((()=>[(0,o.bF)(ke)])),_:1}),(0,o.eW)(" "+(0,t.v_)(e.name),1)])),_:2},1032,["onClick"])))),128))])):(0,o.Q3)("",!0)])])),_:2},1032,["timestamp","type"])))),128))])),_:1})]),(0,o.bF)(pe,{model:G.followUpForm,"label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(ue,{label:"跟进内容"},{default:(0,o.k6)((()=>[(0,o.bF)(H,{modelValue:G.followUpForm.content,"onUpdate:modelValue":l[43]||(l[43]=e=>G.followUpForm.content=e),type:"textarea",rows:4,placeholder:"请输入跟进内容"},null,8,["modelValue"])])),_:1}),(0,o.bF)(ue,{label:"跟进类型"},{default:(0,o.k6)((()=>[(0,o.bF)(q,{modelValue:G.followUpForm.type,"onUpdate:modelValue":l[44]||(l[44]=e=>G.followUpForm.type=e),placeholder:"请选择跟进类型",style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(B,{label:"常规跟进",value:"primary"}),(0,o.bF)(B,{label:"重要跟进",value:"warning"}),(0,o.bF)(B,{label:"紧急跟进",value:"danger"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(ue,{label:"上传文件"},{default:(0,o.k6)((()=>[(0,o.bF)(we,{class:"upload-demo",action:"/api/upload","on-preview":G.handlePreview,"on-remove":G.handleRemove,"before-remove":G.beforeRemove,multiple:"",limit:3,"on-exceed":G.handleExceed,"file-list":G.followUpForm.files},{tip:(0,o.k6)((()=>l[122]||(l[122]=[(0,o.Lk)("div",{class:"el-upload__tip"}," 支持上传jpg/png/pdf文件，且不超过500kb ",-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(Z,{type:"primary"},{default:(0,o.k6)((()=>l[121]||(l[121]=[(0,o.eW)("点击上传")]))),_:1})])),_:1},8,["on-preview","on-remove","before-remove","on-exceed","file-list"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),(0,o.bF)(ye,{visible:e.historyDialogVisible,"onUpdate:visible":l[47]||(l[47]=l=>e.historyDialogVisible=l),"train-data":G.currentTrainData},null,8,["visible","train-data"]),(0,o.bF)(Ce,{visible:e.gpsTrackDialogVisible,"onUpdate:visible":l[48]||(l[48]=l=>e.gpsTrackDialogVisible=l),"train-data":e.currentGpsTrainData},null,8,["visible","train-data"]),(0,o.bF)(Fe,{visible:G.fileUploadDialogVisible,"onUpdate:visible":l[49]||(l[49]=e=>G.fileUploadDialogVisible=e),"train-id":G.currentTrainData?.id,onSubmit:G.handleFileUploadSubmit,onCancel:G.handleFileUploadCancel},null,8,["visible","train-id","onSubmit","onCancel"]),(0,o.bF)(Ve,{visible:G.podDialogVisible,"onUpdate:visible":l[50]||(l[50]=e=>G.podDialogVisible=e),"current-pod-row":G.currentPodRow,onSubmit:G.handlePodSubmit,onCancel:G.handlePodCancel},null,8,["visible","current-pod-row","onSubmit","onCancel"]),(0,o.bF)(_e,{visible:G.fileUploadWithTagVisible,"onUpdate:visible":l[51]||(l[51]=e=>G.fileUploadWithTagVisible=e),"current-row":G.currentFileRow,onSubmit:G.handleFileUploadSubmit,onCancel:G.handleFileUploadCancel},null,8,["visible","current-row","onSubmit","onCancel"]),(0,o.bF)(We,{modelValue:e.activeTab,"onUpdate:modelValue":l[52]||(l[52]=l=>e.activeTab=l),class:"delivery-tabs"},{default:(0,o.k6)((()=>[(0,o.bF)(Se,{label:"全部",name:"all"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",A,[(0,o.bF)(Le,{value:G.pendingPODCount,hidden:0===G.pendingPODCount,type:"warning"},{default:(0,o.k6)((()=>l[125]||(l[125]=[(0,o.Lk)("span",null,"POD待审核",-1)]))),_:1},8,["value","hidden"]),(0,o.bF)(Le,{value:G.pendingFileCount,hidden:0===G.pendingFileCount,type:"warning"},{default:(0,o.k6)((()=>l[126]||(l[126]=[(0,o.Lk)("span",null,"文件待审核",-1)]))),_:1},8,["value","hidden"])])])),_:1})])),_:1},8,["modelValue"])])}var $=a(953),j=a(163),B=a(7918),q=a(3344),Q=a(2998),H=a(5493),J=a(1018),Y=a(6629),Z=a(4287),ee=a(616),le=a(3473),ae=a(1178),oe=a(9405),ie=a(9595),te=a(8548),ne=a(432),re=a.n(ne),ue=a(5220);const se=ae,de=oe,pe=ie,ce={name:"DeliveryTrains",components:{FilterPanel:q.A,GroupableTable:Q.A,ExpenseDetailDialog:H.A,HistoryRecordDialog:J.A,GpsTrackDialog:Y.A,TrainFileUploadDialog:Z.A,UploadPodDialog:ee.A,FileUploadWithTagDialog:le.A,draggable:re(),DArrowLeft:te.V6m},setup(){window.onerror=function(e){return!!e.includes("ResizeObserver")};const e=(0,$.KR)(se),l=(0,$.KR)(de),a=(0,$.KR)(pe),i=(0,$.KR)([]),t=(0,$.KR)(!1),n=(0,$.KR)([...se]),r=(0,$.KR)([]),u=(0,$.KR)("west2"),s=(0,$.KR)("create"),d=(0,$.KR)([]),p=(0,$.KR)("trainNumber"),c=(0,$.KR)(""),v=(0,$.KR)("no"),m=(0,$.KR)("all"),b=(0,$.KR)(!1),g=(0,$.KR)([]),k=(0,$.KR)("and"),f=(0,$.KR)(1),h=(0,$.KR)(20),w=(0,$.KR)(0),y=(0,o.EW)((()=>w.value)),C=(0,$.KR)("all"),F=(0,$.KR)(""),V=(0,$.KR)([]),_=(0,$.KR)(!1),L=(0,$.KR)(!1),S=(0,$.KR)(!1),W=(0,$.KR)(""),R=(0,$.KR)({name:"",columns:[]}),x=(0,$.KR)(null),D=(0,$.KR)({name:""}),T=(0,$.KR)(!1),U=(0,$.KR)({level1:"",level2:"",level3:""}),K=(0,o.EW)((()=>i.value.some((e=>e.isGroup)))),P=e=>{const l=["","primary","success","warning"];return l[e]||""},E=(0,o.EW)((()=>e.value.filter((e=>["trainNumber","loadingType","loadingStatus","loadingStartTime","loadingEndTime","loader","dockNumber","actualPallets"].includes(e.prop))))),N=(0,o.EW)((()=>e.value.filter((e=>["trainNumber","deliveryType","supplier","driverPhone","licensePlate","destination","deliveryCost"].includes(e.prop))))),X=(0,o.EW)((()=>e.value.filter((e=>["trainNumber","driverLicense","licensePlate","driverPhone","loadingStatus","loadingAppointmentTime"].includes(e.prop))))),O=(0,o.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop))));(0,o.wB)(C,(l=>{if(["all","waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(l))F.value="",e.value.forEach((e=>e.visible=!0)),g.value=[],k.value="and",U.value={level1:"",level2:"",level3:""},W.value="",Ne.value=[{field:"",direction:"asc"}];else if(["loadingView","dispatchView","driverView"].includes(l))F.value="","loadingView"===l?n.value=E.value:"dispatchView"===l?n.value=N.value:"driverView"===l&&(n.value=X.value);else{const e=V.value.find((e=>e.id===l));e&&(F.value=l,ll(l))}M()})),(0,o.wB)(F,(e=>{e&&(C.value=e)})),(0,o.sV)((()=>{n.value=e.value,J(),z()}));const z=()=>{t.value=!0;try{w.value=a.value.length,M()}catch(e){console.error("加载数据失败:",e)}finally{t.value=!1}},M=()=>{let e=[...a.value];if(["waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(C.value)){const l={waitRegister:"未装车",registered:"已登记",loading:"装车中",loaded:"装车完成",shipped:"已发货",delivered:"已签收",pod:"已签收POD"},a=l[C.value];a&&(e=e.filter((e=>e.loadingStatus===a)))}if(c.value&&(e=e.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const l={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},a=l[s.value],[o,i]=d.value;e=e.filter((e=>{const l=e[a];if(!l)return!1;const t=l.split(" ")[0];return t>=o&&t<=i}))}g.value.length>0&&(e=e.filter((e=>{const l=g.value.map((l=>{const{field:a,operator:o,value:i}=l,t=e[a];if(null==t)return!1;switch(o){case"eq":return t==i;case"neq":return t!=i;case"contains":return t.toString().toLowerCase().includes(i.toString().toLowerCase());case"notContains":return!t.toString().toLowerCase().includes(i.toString().toLowerCase());case"startsWith":return t.toString().toLowerCase().startsWith(i.toString().toLowerCase());case"endsWith":return t.toString().toLowerCase().endsWith(i.toString().toLowerCase());case"gt":return Number(t)>Number(i);case"gte":return Number(t)>=Number(i);case"lt":return Number(t)<Number(i);case"lte":return Number(t)<=Number(i);default:return!0}}));return"and"===k.value?l.every((e=>e)):l.some((e=>e))}))),W.value&&(e=I(e,W.value)),w.value=e.length;const l=(f.value-1)*h.value,o=l+h.value;i.value=e.slice(l,o)},I=(e,l)=>{const a={};e.forEach((e=>{const o=e[l]||"未分类";a[o]||(a[o]=[]),a[o].push({...e})}));const o=[];for(const[i,t]of Object.entries(a))o.push({id:`group-${i}`,groupName:i,count:t.length,isGroup:!0,groupLevel:0,children:t});return o},A=e=>{r.value=e},G=e=>{const l={未装车:"info",已登记:"warning",装车中:"warning",装车完成:"success",已发货:"success",已签收:"success",已签收POD:"success",退件:"danger",待审批:"info",应付未完成:"info"};return l[e]||"info"},q=()=>{R.value={name:"",columns:e.value.filter((e=>!1!==e.visible)).map((e=>e.prop))},_.value=!0},Q=()=>{if(!R.value.name.trim())return void j.nk.warning("请输入视图名称");const l={id:Date.now().toString(),name:R.value.name,columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:g.value,filterLogic:k.value,groupSettings:U.value,sortSettings:Ne.value};V.value.push(l),F.value=l.id,_.value=!1,Ze(),j.nk.success("保存成功")},H=()=>{x.value&&B.s.confirm("确定要删除该视图吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=V.value.findIndex((e=>e.id===x.value.id));-1!==e&&(V.value.splice(e,1),C.value===x.value.id&&(C.value="all",F.value=""),Ze(),j.nk.success("删除成功")),L.value=!1})).catch((()=>{L.value=!1}))},J=()=>{const e=localStorage.getItem("deliveryTrainsViews");if(e)try{V.value=JSON.parse(e)}catch(l){console.error("加载保存的视图失败:",l)}},Y=e=>{e.isGroup||Rl.push(`/tms/delivery-train-detail/${e.id}`)},Z=(e,l)=>{switch(e){case"memo":ml(l);break;case"followUp":gl(l);break;case"expense":ol.value=l,al.value=!0;break;case"markException":Fl(l);break;case"history":_l(l);break;case"pcDetail":Sl.value=l,Ll.value=!0;break;case"uploadFile":Xl(l);break}},ee=()=>{b.value=!0},le=()=>{console.log("showAddTrainDialog")},ae=(e,l)=>{console.log("展开/折叠行:",e.id,l?"展开":"折叠")},oe=({prop:e,order:l})=>{if(!e||!l)return void M();const a=[...i.value];a.sort(((a,o)=>{let i=a[e],t=o[e];return isNaN(i)||isNaN(t)||(i=Number(i),t=Number(t)),"string"===typeof i&&"string"===typeof t?"ascending"===l?i.localeCompare(t):t.localeCompare(i):"ascending"===l?i>t?1:-1:i<t?1:-1})),i.value=a},ie=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:"分组"},te=e=>{h.value=e,z()},ne=e=>{f.value=e,z()},re=()=>{f.value=1,M()},ce=({filters:e,logic:l})=>{g.value=e,k.value=l,f.value=1,F.value&&el(F.value),M()},ve=()=>{},me=e=>{x.value=e,L.value=!0},be=()=>{x.value&&(D.value.name=x.value.name,L.value=!1,S.value=!0)},ge=()=>{if(!x.value)return;if(!D.value.name.trim())return void j.nk.warning("请输入视图名称");const e=V.value.findIndex((e=>e.id===x.value.id));-1!==e&&(V.value[e].name=D.value.name,Ze(),j.nk.success("重命名成功"),S.value=!1)},ke=()=>{if(!x.value)return;const e={...x.value,id:Date.now().toString(),name:`${x.value.name} 副本`};V.value.push(e),Ze(),j.nk.success("复制成功"),L.value=!1},fe=(0,$.KR)(!1),he=(0,$.KR)(0),we=(0,$.KR)(0),ye=(e,l)=>{e.preventDefault(),x.value=l,fe.value=!0,he.value=e.clientX,we.value=e.clientY,setTimeout((()=>{document.addEventListener("click",Ce)}),0)},Ce=()=>{fe.value=!1,document.removeEventListener("click",Ce)},Fe=(0,$.KR)({rowIndex:-1,prop:"",value:""}),Ve=(0,$.KR)(!1),_e=(0,$.KR)(null),Le=(0,$.KR)({}),Se=(0,$.KR)({value:""}),We=(e,l,a)=>{const o=l.property;if(["loadingType","deliveryType","carNumber","loader","dockNumber","warehouseRemarks","driverLicense","licensePlate","driverPhone","supplier","actualPallets","palletsMerged","deliveryCost"].includes(o)){const l=a?a.closest("tr"):null,i=l?Array.from(l.parentNode.children).indexOf(l):-1;console.log("单击编辑",e,o,i),Fe.value={rowIndex:i,prop:o,value:e[o]||""},setTimeout((()=>{const e=document.querySelector(".cell-editor input");e&&e.focus()}),50)}},Re=(l,a)=>{const o=a.property;["loadingType","deliveryType","carNumber","loader","dockNumber","warehouseRemarks","driverLicense","licensePlate","driverPhone","supplier","actualPallets","palletsMerged","deliveryCost"].includes(o)&&(Fe.value={rowIndex:-1,prop:"",value:""},_e.value=l,Le.value=e.value.find((e=>e.prop===o))||{prop:o,label:o},Se.value.value=l[o]||"",Ve.value=!0)},xe=(e,l)=>{Fe.value.prop===l&&(e[l]=Fe.value.value,setTimeout((()=>{Fe.value={rowIndex:-1,prop:"",value:""},j.nk.success("保存成功")}),200))},De=()=>{_e.value&&Le.value.prop&&(_e.value[Le.value.prop]=Se.value.value,Ve.value=!1,j.nk.success("保存成功"))},Te=l=>{const o=e.value.find((e=>e.prop===l));if(o&&o.filterOptions)return o.filterOptions;switch(l){case"loader":return[{value:"张三",label:"张三"},{value:"李四",label:"李四"},{value:"王五",label:"王五"},{value:"赵六",label:"赵六"},{value:"钱七",label:"钱七"}];case"dockNumber":return Array.from({length:10},((e,l)=>{const a=l+1,o=`DOCK-${a<10?"0"+a:a}`;return{value:o,label:o}}));case"supplier":return[{value:"广州物流",label:"广州物流"},{value:"深圳物流",label:"深圳物流"},{value:"东莞物流",label:"东莞物流"},{value:"佛山物流",label:"佛山物流"},{value:"中山物流",label:"中山物流"}];case"driverLicense":case"licensePlate":case"driverPhone":return a.value.map((e=>({value:e[l],label:e[l]}))).filter(((e,l,a)=>e.value&&a.findIndex((l=>l.value===e.value))===l));default:return[]}},Ue=()=>{T.value=!0},Ke=()=>{const e=[];U.value.level1&&e.push(U.value.level1),U.value.level2&&e.push(U.value.level2),U.value.level3&&e.push(U.value.level3),W.value="",Pe(e),F.value&&el(F.value),T.value=!1,j.nk.success("分组已应用")},Pe=l=>{if(!l||0===l.length)return void M();const o=l=>{const a=e.value.find((e=>e.prop===l));return a?a.label:l};let t=[...a.value];if(["waitRegister","registered","loading","loaded","shipped","delivered","pod"].includes(C.value)){const e={waitRegister:"未装车",registered:"已登记",loading:"装车中",loaded:"装车完成",shipped:"已发货",delivered:"已签收",pod:"已签收POD"},l=e[C.value];l&&(t=t.filter((e=>e.loadingStatus===l)))}if(c.value&&(t=t.filter((e=>{const l=e[p.value];return!!l&&l.toString().toLowerCase().includes(c.value.toLowerCase())}))),d.value&&2===d.value.length){const e={create:"createdAt",issue:"issueDate",appointment:"loadingAppointmentTime"},l=e[s.value],[a,o]=d.value;t=t.filter((e=>{const i=e[l];if(!i)return!1;const t=i.split(" ")[0];return t>=a&&t<=o}))}g.value.length>0&&(t=t.filter((e=>{const l=g.value.map((l=>{const{field:a,operator:o,value:i}=l,t=e[a];if(null==t)return!1;switch(o){case"eq":return t==i;case"neq":return t!=i;case"contains":return t.toString().toLowerCase().includes(i.toString().toLowerCase());case"notContains":return!t.toString().toLowerCase().includes(i.toString().toLowerCase());case"startsWith":return t.toString().toLowerCase().startsWith(i.toString().toLowerCase());case"endsWith":return t.toString().toLowerCase().endsWith(i.toString().toLowerCase());case"gt":return Number(t)>Number(i);case"gte":return Number(t)>=Number(i);case"lt":return Number(t)<Number(i);case"lte":return Number(t)<=Number(i);default:return!0}}));return"and"===k.value?l.every((e=>e)):l.some((e=>e))})));const n=[],r=new Map;t.forEach((e=>{let a=n,i="",t=null;for(let n=0;n<l.length;n++){const u=l[n],s=e[u]||"未分类",d=o(u),p=`${i}/${u}:${s}`;let c=a.find((e=>e.groupKey===p));c||(c={id:`group-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,groupKey:p,groupName:`${d}: ${s}`,isGroup:!0,groupLevel:n,children:[],items:[],count:0},c.groupClass=0===n?"level-1-group":1===n?"level-2-group":"level-3-group",a.push(c),r.set(p,c)),c.items.push(e),c.count=c.items.length,i=p,a=c.children,t=c}if(t){const l={...e,parentGroupKey:t.groupKey};t.children.push(l)}}));const u=[];function v(e,l=0){e.forEach((e=>{u.push(e);const a=e.children.filter((e=>e.isGroup));a.length>0?v(a,l+1):e.children.forEach((e=>{u.push(e)}))}))}v(n),w.value=u.length;const m=(f.value-1)*h.value,b=m+h.value;i.value=u.slice(m,b)},Ee=(0,$.KR)(!1),Ne=(0,$.KR)([{field:"",direction:"asc"}]),Xe=(0,o.EW)((()=>e.value.filter((e=>e.sortable&&"operation"!==e.prop)))),Oe=()=>{Ee.value=!0},ze=()=>{Ne.value.push({field:"",direction:"asc"})},Me=e=>{Ne.value.splice(e,1),0===Ne.value.length&&Ne.value.push({field:"",direction:"asc"})},Ie=()=>{if(Ne.value.some((e=>!e.field)))return void j.nk.warning("请选择所有排序字段");let e=[...i.value];Ne.value.forEach((({field:l,direction:a})=>{e.sort(((e,o)=>{let i=e[l],t=o[l];return isNaN(i)||isNaN(t)||(i=Number(i),t=Number(t)),"string"===typeof i&&"string"===typeof t?"asc"===a?i.localeCompare(t):t.localeCompare(i):"asc"===a?i>t?1:-1:i<t?1:-1}))})),i.value=e,Ee.value=!1,F.value&&el(F.value),j.nk.success("排序已应用")},Ae=()=>{U.value={level1:"",level2:"",level3:""},W.value="",F.value&&el(F.value),M(),T.value=!1,j.nk.success("已清除分组设置")},Ge=()=>{Ne.value=[{field:"",direction:"asc"}],F.value&&el(F.value),M(),Ee.value=!1,j.nk.success("已清除排序设置")},$e=(0,$.KR)(!1),je=(0,$.KR)([]),Be=(0,o.EW)({get:()=>je.value.every((e=>e.visible)),set:e=>{je.value.forEach((l=>l.visible=e))}}),qe=()=>{je.value=e.value.map((e=>({...e,visible:!1!==e.visible}))),$e.value=!0},Qe=e=>{je.value.forEach((l=>l.visible=e))},He=()=>{je.value=e.value.map((e=>({...e,visible:!0})))},Je=()=>{},Ye=()=>{e.value=e.value.map((e=>{const l=je.value.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}})),F.value&&el(F.value),$e.value=!1,j.nk.success("字段配置已更新")},Ze=()=>{localStorage.setItem("deliveryTrainsViews",JSON.stringify(V.value))},el=l=>{const a=V.value.findIndex((e=>e.id===l));a>-1&&(V.value[a]={...V.value[a],columns:e.value.map((e=>({prop:e.prop,visible:!1!==e.visible}))),filters:g.value,filterLogic:k.value,groupSettings:U.value,sortSettings:Ne.value},Ze())},ll=l=>{const a=V.value.find((e=>e.id===l));a&&(a.columns&&(e.value=e.value.map((e=>{const l=a.columns.find((l=>l.prop===e.prop));return{...e,visible:!l||l.visible}}))),a.filters&&(g.value=[...a.filters],k.value=a.filterLogic||"and"),a.groupSettings&&(U.value={...a.groupSettings}),a.sortSettings&&(Ne.value=[...a.sortSettings]),M())},al=(0,$.KR)(!1),ol=(0,$.KR)(null),il=e=>{console.log("费用已推送:",e),j.nk.success("费用推送成功")},tl=e=>{console.log("取消推送:",e),j.nk.success("已取消推送")},nl=e=>{switch(e.trim()){case"异常":return"danger";case"紧急":return"warning";default:return""}},rl=(e,l,a)=>{if(e[l]){if(Array.isArray(e[l])){const o=e[l].indexOf(a);if(o>-1){const a=[...e[l]];a.splice(o,1),e[l]=a}}else if("string"===typeof e[l]){const o=e[l].split(",").map((e=>e.trim())),i=o.indexOf(a);i>-1&&(o.splice(i,1),e[l]=o.join(","))}j.nk.success("标签已移除")}},ul=(0,$.KR)(!1),sl=(0,$.KR)(!1),dl=(0,$.KR)({memo:""}),pl=(0,$.KR)({content:"",type:"primary",files:[]}),cl=(0,$.KR)([{time:"2024-03-20 10:00:00",content:"已联系司机，预计下午到达",operator:"张三",type:"primary"},{time:"2024-03-20 15:30:00",content:"司机到达装货点，开始装货",operator:"李四",type:"warning"}]),vl=(0,$.KR)(null),ml=e=>{vl.value=e,dl.value.memo=e.memo||"",ul.value=!0},bl=()=>{vl.value&&(vl.value.memo=dl.value.memo,j.nk.success("保存成功"),ul.value=!1)},gl=e=>{vl.value=e,pl.value={content:"",type:"primary"},sl.value=!0},kl=e=>{console.log("预览文件:",e)},fl=(e,l)=>{console.log("移除文件:",e,l),pl.value.files=l},hl=e=>B.s.confirm(`确定移除 ${e.name}？`),wl=(e,l)=>{j.nk.warning(`当前限制选择 3 个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+l.length} 个文件`)},yl=e=>{console.log("预览历史文件:",e)},Cl=()=>{pl.value.content?(cl.value.unshift({time:(new Date).toLocaleString(),content:pl.value.content,type:pl.value.type,operator:"当前用户",files:pl.value.files}),pl.value={content:"",type:"primary",files:[]},j.nk.success("跟进记录已保存"),sl.value=!1):j.nk.warning("请输入跟进内容")},Fl=e=>{vl.value=e,pl.value={content:"",type:"danger"},sl.value=!0},Vl=(0,$.KR)(!1),_l=e=>{ol.value=e,Vl.value=!0},Ll=(0,$.KR)(!1),Sl=(0,$.KR)(null),Wl=(e,l)=>{switch(e){case"lastPod":Ml(l);break;case"deletePc":B.s.confirm(`确定要删除PC ${l.pcNumber} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{j.nk.success(`已删除PC ${l.pcNumber}`)})).catch((()=>{}));break}},Rl=(0,ue.rd)(),xl=(0,o.EW)((()=>2)),Dl=(0,o.EW)((()=>1)),Tl=(0,$.KR)(!1),Ul=(0,$.KR)(!1),Kl=(0,$.KR)(!1),Pl=(0,$.KR)(null),El=(0,$.KR)(null),Nl=(0,$.KR)([]),Xl=e=>{El.value=e,Kl.value=!0},Ol=async e=>{try{if(console.log("提交文件数据:",e),El.value){El.value.fileTag=e.fileTag,El.value.fileRemark=e.remark;const l=Nl.value.findIndex((e=>e.id===El.value.id));-1!==l&&(Nl.value[l]={...El.value})}j.nk.success("文件上传成功"),Kl.value=!1}catch(l){console.error("文件上传失败:",l),j.nk.error("文件上传失败")}},zl=()=>{Kl.value=!1,El.value=null},Ml=e=>{Pl.value=e,Ul.value=!0},Il=async e=>{try{if(console.log("提交POD数据:",e),Pl.value){Pl.value.podStatus="已上传",Pl.value.podUploadTime=e.receiptTime;const l=Nl.value.findIndex((e=>e.id===Pl.value.id));-1!==l&&(Nl.value[l]={...Pl.value})}j.nk.success("POD上传成功"),Ul.value=!1}catch(l){console.error("POD上传失败:",l),j.nk.error("POD上传失败")}},Al=()=>{Ul.value=!1,Pl.value=null},Gl=(0,$.KR)([{value:"delivery",label:"派送费"},{value:"abnormal",label:"异常费"},{value:"waiting",label:"等时费"},{value:"loading",label:"装车费"},{value:"other",label:"其他费用"}]),$l=()=>Gl.value,jl=e=>{console.log("费用类型已更改:",e.expenseType)};return{tableColumns:e,childColumns:l,tableData:a,displayData:i,loading:t,visibleColumns:n,selectedRows:r,warehouse:u,createDateType:s,dateRange:d,searchType:p,searchText:c,sendOrder:v,currentStatus:m,filterPanelVisible:b,activeFilters:g,filterLogic:k,currentPage:f,pageSize:h,totalItems:w,total:y,currentView:C,selectedCustomView:F,customViews:V,saveViewDialogVisible:_,viewOptionsDialogVisible:L,renameViewDialogVisible:S,groupField:W,viewForm:R,currentEditingView:x,renameForm:D,groupableFields:O,groupModalVisible:T,groupSettings:U,hasGroupedData:K,getGroupTagType:P,showGroupModal:Ue,applyGroupSettings:Ke,handleSaveView:q,saveView:Q,handleDeleteView:H,loadSavedViews:J,getStatusTagType:G,handleDetail:Y,handleCommand:Z,showFilterPanel:ee,showAddTrainDialog:le,handleExpandChange:ae,handleSelectionChange:A,handleSortChange:oe,handleSizeChange:te,handleCurrentChange:ne,handleSearch:re,applyFilters:ce,cancelFilters:ve,fetchData:z,applyFiltersAndPagination:M,groupData:I,handleViewOptions:me,handleRenameView:be,saveRenameView:ge,handleCopyView:ke,contextMenuVisible:fe,contextMenuX:he,contextMenuY:we,handleContextMenu:ye,closeContextMenu:Ce,editingCell:Fe,editDialogVisible:Ve,editingRow:_e,editingColumn:Le,editingForm:Se,handleCellClick:We,handleCellDbClick:Re,saveEdit:xe,saveDialogEdit:De,getOptionsForColumn:Te,getGroupColumnLabel:ie,sortModalVisible:Ee,sortSettings:Ne,sortableFields:Xe,showSortModal:Oe,addSortField:ze,removeSortField:Me,applySortSettings:Ie,clearGroupSettings:Ae,clearSortSettings:Ge,columnSettingsVisible:$e,columnSettingsList:je,allColumnsSelected:Be,showColumnSettings:qe,handleSelectAllColumns:Qe,resetColumnSettings:He,handleDragEnd:Je,applyColumnSettings:Ye,saveViewsToStorage:Ze,updateViewConfig:el,applyViewConfig:ll,expenseDialogVisible:al,currentTrainData:ol,handleExpensePushed:il,handlePushCancelled:tl,getTagType:nl,handleTagClose:rl,memoDialogVisible:ul,followUpDialogVisible:sl,memoForm:dl,followUpForm:pl,followUpHistory:cl,currentEditingTrain:vl,handleMemo:ml,saveMemo:bl,handleFollowUp:gl,handlePreview:kl,handleRemove:fl,beforeRemove:hl,handleExceed:wl,handleFilePreview:yl,pendingPODCount:xl,pendingFileCount:Dl,fileUploadDialogVisible:Tl,podDialogVisible:Ul,fileUploadWithTagVisible:Kl,currentPodRow:Pl,currentFileRow:El,fileList:Nl,handleFileUpload:Xl,handleFileUploadSubmit:Ol,handleFileUploadCancel:zl,handleUploadPod:Ml,handlePodSubmit:Il,handlePodCancel:Al,handleChildCommand:Wl,saveFollowUp:Cl,expenseTypes:Gl,getExpenseTypeOptions:$l,handleExpenseTypeChange:jl}}};var ve=a(6262);const me=(0,ve.A)(ce,[["render",G],["__scopeId","data-v-426bd2d2"]]),be=me}}]);
//# sourceMappingURL=522.23cfa766.js.map