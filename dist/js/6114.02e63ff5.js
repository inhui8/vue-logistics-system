"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[6114],{6114:(e,l,a)=>{a.r(l),a.d(l,{default:()=>Q});var t=a(641),o=a(33),i=a(3751);const r={class:"delivery-trains-container"},n={class:"filter-bar"},u={class:"filter-row"},s={class:"date-buttons"},d={class:"action-buttons"},p={class:"view-management"},c={class:"table-container"},g={class:"group-settings"},v={class:"group-level"},m={class:"group-level"},b={class:"group-level"},h={class:"dialog-footer"},f={class:"sort-rules-container"},y={class:"add-sort-rule"},C={class:"columns-container"},k={class:"column-item"};function w(e,l,a,w,S,F){const T=(0,t.g2)("el-option"),V=(0,t.g2)("el-select"),x=(0,t.g2)("el-date-picker"),_=(0,t.g2)("el-input"),K=(0,t.g2)("el-button"),R=(0,t.g2)("el-radio-button"),E=(0,t.g2)("el-radio-group"),A=(0,t.g2)("groupable-table-visactor"),N=(0,t.g2)("filter-panel"),W=(0,t.g2)("el-form-item"),L=(0,t.g2)("el-form"),D=(0,t.g2)("el-dialog"),M=(0,t.g2)("el-checkbox"),z=(0,t.g2)("draggable");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.Lk)("div",n,[(0,t.Lk)("div",u,[(0,t.bF)(V,{modelValue:e.warehouse,"onUpdate:modelValue":l[0]||(l[0]=l=>e.warehouse=l),placeholder:"美西二号仓",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"美西二号仓",value:"west2"}),(0,t.bF)(T,{label:"美西一号仓",value:"west1"}),(0,t.bF)(T,{label:"新泽西一号仓",value:"east1"}),(0,t.bF)(T,{label:"萨凡纳二号仓",value:"east2"}),(0,t.bF)(T,{label:"达拉斯三号仓",value:"east3"})])),_:1},8,["modelValue"]),(0,t.bF)(V,{modelValue:e.createDateType,"onUpdate:modelValue":l[1]||(l[1]=l=>e.createDateType=l),placeholder:"ETA",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"ETA",value:"eta"}),(0,t.bF)(T,{label:"提柜时间",value:"issue"}),(0,t.bF)(T,{label:"抵仓时间",value:"appointment"}),(0,t.bF)(T,{label:"预计拆柜时间",value:"expectedUnloading"}),(0,t.bF)(T,{label:"拆柜完成时间",value:"unloading"})])),_:1},8,["modelValue"]),(0,t.Lk)("div",s,[(0,t.bF)(x,{modelValue:e.dateRange,"onUpdate:modelValue":l[2]||(l[2]=l=>e.dateRange=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small",class:"date-range-picker",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},null,8,["modelValue"])]),(0,t.bF)(V,{modelValue:e.searchType,"onUpdate:modelValue":l[3]||(l[3]=l=>e.searchType=l),placeholder:"部分模糊搜索",size:"small",class:"filter-item"},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"部分模糊搜索",value:"trainNumber"}),(0,t.bF)(T,{label:"柜号",value:"containerNo"}),(0,t.bF)(T,{label:"SO号",value:"soNumber"}),(0,t.bF)(T,{label:"货件编号",value:"shipmentNumber"}),(0,t.bF)(T,{label:"追踪编号",value:"trackingNumber"})])),_:1},8,["modelValue"]),(0,t.bF)(_,{placeholder:"MEMO/跟进记录/ref/zip_code等",modelValue:e.searchText,"onUpdate:modelValue":l[4]||(l[4]=l=>e.searchText=l),size:"small",class:"search-input","prefix-icon":"el-icon-search"},null,8,["modelValue"]),(0,t.Lk)("div",d,[(0,t.bF)(K,{type:"primary",size:"small",onClick:e.handleSearch},{default:(0,t.k6)((()=>l[27]||(l[27]=[(0,t.eW)("查询")]))),_:1},8,["onClick"]),(0,t.bF)(K,{size:"small",type:"warning",onClick:l[5]||(l[5]=l=>e.handleBatchOperation("followUp"))},{default:(0,t.k6)((()=>l[28]||(l[28]=[(0,t.eW)("批量跟进")]))),_:1}),(0,t.bF)(K,{size:"small",type:"warning",onClick:l[6]||(l[6]=l=>e.handleBatchOperation("memo"))},{default:(0,t.k6)((()=>l[29]||(l[29]=[(0,t.eW)("批量MEMO")]))),_:1}),(0,t.bF)(K,{size:"small",type:"warning",onClick:l[7]||(l[7]=l=>e.handleBatchOperation("createPC"))},{default:(0,t.k6)((()=>l[30]||(l[30]=[(0,t.eW)("创建PC")]))),_:1}),(0,t.bF)(K,{size:"small"},{default:(0,t.k6)((()=>l[31]||(l[31]=[(0,t.eW)("导出列表")]))),_:1})])])]),(0,t.Lk)("div",p,[l[37]||(l[37]=(0,t.Lk)("span",{class:"view-label"},null,-1)),(0,t.bF)(E,{modelValue:e.currentView,"onUpdate:modelValue":l[8]||(l[8]=l=>e.currentView=l),size:"small",class:"status-view-group"},{default:(0,t.k6)((()=>[(0,t.bF)(R,{value:"all"},{default:(0,t.k6)((()=>[(0,t.eW)("全部("+(0,o.v_)(e.statusCounts.all||0)+")",1)])),_:1}),(0,t.bF)(R,{value:"pending"},{default:(0,t.k6)((()=>[(0,t.eW)("待处理("+(0,o.v_)(e.statusCounts.pending||0)+")",1)])),_:1}),(0,t.bF)(R,{value:"processing"},{default:(0,t.k6)((()=>[(0,t.eW)("处理中("+(0,o.v_)(e.statusCounts.processing||0)+")",1)])),_:1}),(0,t.bF)(R,{value:"completed"},{default:(0,t.k6)((()=>[(0,t.eW)("已完成("+(0,o.v_)(e.statusCounts.completed||0)+")",1)])),_:1}),(0,t.bF)(R,{value:"cancelled"},{default:(0,t.k6)((()=>[(0,t.eW)("已取消("+(0,o.v_)(e.statusCounts.cancelled||0)+")",1)])),_:1}),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.customViews,(l=>((0,t.uX)(),(0,t.Wv)(R,{key:l.id,label:l.id,onContextmenu:(0,i.D$)((a=>e.handleContextMenu(a,l)),["prevent"])},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(l.name),1)])),_:2},1032,["label","onContextmenu"])))),128))])),_:1},8,["modelValue"]),(0,t.bF)(K,{type:"text",size:"small",onClick:e.handleSaveView},{default:(0,t.k6)((()=>l[32]||(l[32]=[(0,t.eW)("新增视图")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"text",size:"small",onClick:e.showGroupModal},{default:(0,t.k6)((()=>l[33]||(l[33]=[(0,t.eW)("高级分组")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"text",size:"small",onClick:e.showSortModal},{default:(0,t.k6)((()=>l[34]||(l[34]=[(0,t.eW)("高级排序")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"text",size:"small",onClick:e.showFilterPanel},{default:(0,t.k6)((()=>l[35]||(l[35]=[(0,t.eW)("筛选")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"text",size:"small",onClick:e.showColumnSettings},{default:(0,t.k6)((()=>l[36]||(l[36]=[(0,t.eW)("字段配置")]))),_:1},8,["onClick"])]),(0,t.Lk)("div",c,[(0,t.bF)(A,{ref:"visactorTable",data:e.displayData,columns:e.tableColumns.filter((e=>!1!==e.visible)),"row-key":"id","group-fields":e.multiGroupFields.length>0?e.multiGroupFields:e.groupField?[e.groupField]:[],"show-selection":!0,"show-group-column":e.hasGroupData,"group-column-label":e.multiGroupFields.length>0?"多级分组":e.groupField?e.getColumnLabel(e.groupField):"分组","default-expand-all":!0,"show-pagination":!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[10,20,50,100],total:e.total,loading:e.loading,showUnclassified:!1,childColumns:e.childColumns,enableSubTable:!0,onSelectionChange:e.handleSelectionChange,onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange,onCellDblclick:e.handleCellDbClick,onSortChange:e.handleSortChange,onClearGrouping:e.handleClearGrouping,onCellValueChange:e.handleCellValueChange},null,8,["data","columns","group-fields","show-group-column","group-column-label","current-page","page-size","total","loading","childColumns","onSelectionChange","onSizeChange","onCurrentChange","onCellDblclick","onSortChange","onClearGrouping","onCellValueChange"])]),(0,t.bF)(N,{visible:e.filterPanelVisible,"onUpdate:visible":l[9]||(l[9]=l=>e.filterPanelVisible=l),columns:e.tableColumns.filter((e=>!1!==e.visible)),"existing-filters":e.activeFilters,"existing-logic":e.filterLogic,onApplyFilters:e.applyFilters,onCancel:e.cancelFilters},null,8,["visible","columns","existing-filters","existing-logic","onApplyFilters","onCancel"]),(0,t.bF)(D,{title:"保存视图",modelValue:e.saveViewDialogVisible,"onUpdate:modelValue":l[12]||(l[12]=l=>e.saveViewDialogVisible=l),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)(K,{onClick:l[11]||(l[11]=l=>e.saveViewDialogVisible=!1)},{default:(0,t.k6)((()=>l[38]||(l[38]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(K,{type:"primary",onClick:e.saveView},{default:(0,t.k6)((()=>l[39]||(l[39]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(L,{model:e.viewForm,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{label:"视图名称",required:""},{default:(0,t.k6)((()=>[(0,t.bF)(_,{modelValue:e.viewForm.name,"onUpdate:modelValue":l[10]||(l[10]=l=>e.viewForm.name=l),placeholder:"请输入视图名称"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(D,{title:"高级分组",modelValue:e.groupModalVisible,"onUpdate:modelValue":l[17]||(l[17]=l=>e.groupModalVisible=l),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",h,[(0,t.bF)(K,{onClick:l[16]||(l[16]=l=>e.groupModalVisible=!1)},{default:(0,t.k6)((()=>l[43]||(l[43]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(K,{type:"danger",onClick:e.clearGroupSettings},{default:(0,t.k6)((()=>l[44]||(l[44]=[(0,t.eW)("清除分组")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"primary",onClick:e.applyGroupSettings},{default:(0,t.k6)((()=>l[45]||(l[45]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",g,[(0,t.Lk)("div",v,[l[40]||(l[40]=(0,t.Lk)("span",{class:"group-level-label"},"一级分组：",-1)),(0,t.bF)(V,{modelValue:e.groupSettings.level1,"onUpdate:modelValue":l[13]||(l[13]=l=>e.groupSettings.level1=l),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(T,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t.Lk)("div",m,[l[41]||(l[41]=(0,t.Lk)("span",{class:"group-level-label"},"二级分组：",-1)),(0,t.bF)(V,{modelValue:e.groupSettings.level2,"onUpdate:modelValue":l[14]||(l[14]=l=>e.groupSettings.level2=l),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(T,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])]),(0,t.Lk)("div",b,[l[42]||(l[42]=(0,t.Lk)("span",{class:"group-level-label"},"三级分组：",-1)),(0,t.bF)(V,{modelValue:e.groupSettings.level3,"onUpdate:modelValue":l[15]||(l[15]=l=>e.groupSettings.level3=l),placeholder:"选择字段",style:{width:"280px"},clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.groupableFields,(e=>((0,t.uX)(),(0,t.Wv)(T,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue"]),(0,t.bF)(D,{title:"高级排序",modelValue:e.sortModalVisible,"onUpdate:modelValue":l[18]||(l[18]=l=>e.sortModalVisible=l),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.bF)(K,{onClick:e.cancelSorting},{default:(0,t.k6)((()=>l[47]||(l[47]=[(0,t.eW)("取消")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"primary",onClick:e.applySorting},{default:(0,t.k6)((()=>l[48]||(l[48]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",f,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.tempSortSettings,((l,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"sort-rule-item"},[(0,t.bF)(V,{modelValue:l.field,"onUpdate:modelValue":e=>l.field=e,placeholder:"请选择排序字段",style:{width:"200px","margin-right":"10px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.sortableFields,(e=>((0,t.uX)(),(0,t.Wv)(T,{key:e.prop,label:e.label,value:e.prop},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(V,{modelValue:l.order,"onUpdate:modelValue":e=>l.order=e,placeholder:"排序方式",style:{width:"120px","margin-right":"10px"}},{default:(0,t.k6)((()=>[(0,t.bF)(T,{label:"升序",value:"asc"}),(0,t.bF)(T,{label:"降序",value:"desc"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.bF)(K,{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",onClick:l=>e.removeTempSortRule(a)},null,8,["onClick"])])))),128)),(0,t.Lk)("div",y,[(0,t.bF)(K,{type:"primary",size:"small",onClick:e.addTempSortRule},{default:(0,t.k6)((()=>l[46]||(l[46]=[(0,t.eW)(" 添加排序规则 ")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),(0,t.bF)(D,{title:"字段配置",modelValue:e.columnSettingsVisible,"onUpdate:modelValue":l[20]||(l[20]=l=>e.columnSettingsVisible=l),width:"600px"},{footer:(0,t.k6)((()=>[(0,t.bF)(K,{onClick:e.resetColumnSettings},{default:(0,t.k6)((()=>l[51]||(l[51]=[(0,t.eW)("重置")]))),_:1},8,["onClick"]),(0,t.bF)(K,{onClick:e.cancelColumnSettings},{default:(0,t.k6)((()=>l[52]||(l[52]=[(0,t.eW)("取消")]))),_:1},8,["onClick"]),(0,t.bF)(K,{type:"primary",onClick:e.applyColumnSettings},{default:(0,t.k6)((()=>l[53]||(l[53]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",C,[l[50]||(l[50]=(0,t.Lk)("p",{class:"tip-text"},"拖拽调整列顺序，勾选/取消显示列：",-1)),(0,t.bF)(z,{modelValue:e.tempTableColumns,"onUpdate:modelValue":l[19]||(l[19]=l=>e.tempTableColumns=l),"item-key":"id",handle:".drag-handle","ghost-class":"ghost",animation:"300"},{item:(0,t.k6)((({element:e})=>[(0,t.Lk)("div",k,[(0,t.bF)(M,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"]),l[49]||(l[49]=(0,t.Lk)("i",{class:"el-icon-rank drag-handle"},null,-1))])])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"]),e.contextMenuVisible?((0,t.uX)(),(0,t.CE)("div",{key:0,class:"context-menu",style:(0,o.Tr)({left:e.contextMenuX+"px",top:e.contextMenuY+"px"}),onClick:l[22]||(l[22]=(0,i.D$)((()=>{}),["stop"]))},[(0,t.Lk)("div",{class:"context-menu-item",onClick:l[21]||(l[21]=l=>e.deleteView(e.currentEditingView.id))}," 删除视图 ")],4)):(0,t.Q3)("",!0),(0,t.bF)(D,{title:"编辑信息",modelValue:e.editDialogVisible,"onUpdate:modelValue":l[26]||(l[26]=l=>e.editDialogVisible=l),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.bF)(K,{onClick:l[25]||(l[25]=l=>e.editDialogVisible=!1)},{default:(0,t.k6)((()=>l[54]||(l[54]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(K,{type:"primary",onClick:e.saveDialogEdit},{default:(0,t.k6)((()=>l[55]||(l[55]=[(0,t.eW)("确定")]))),_:1},8,["onClick"])])),default:(0,t.k6)((()=>[(0,t.bF)(L,{model:e.editingForm,"label-width":"120px"},{default:(0,t.k6)((()=>[e.editingColumn.prop?((0,t.uX)(),(0,t.Wv)(W,{key:0,label:e.editingColumn.label},{default:(0,t.k6)((()=>[["appointmentStatus","tags"].includes(e.editingColumn.prop)?((0,t.uX)(),(0,t.Wv)(V,{key:0,modelValue:e.editingForm.value,"onUpdate:modelValue":l[23]||(l[23]=l=>e.editingForm.value=l),style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.getOptionsForColumn(e.editingColumn.prop),(e=>((0,t.uX)(),(0,t.Wv)(T,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):((0,t.uX)(),(0,t.Wv)(_,{key:1,modelValue:e.editingForm.value,"onUpdate:modelValue":l[24]||(l[24]=l=>e.editingForm.value=l),type:["zipCode","boxCount","weight","volume","palletCount"].includes(e.editingColumn.prop)?"number":"text"},null,8,["modelValue","type"]))])),_:1},8,["label"])):(0,t.Q3)("",!0)])),_:1},8,["model"])])),_:1},8,["modelValue"])])}var S=a(953),F=a(163),T=a(3344);const V={class:"groupable-table-vxe"},x={class:"flex items-center"},_={class:"group-count"},K={key:1,class:"leaf-node"},R={key:0,class:"subtable-container"},E={key:1,class:"no-subtable-data"},A={key:1,class:"operation-buttons"},N=["onClick"],W=["onClick"],L={key:1},D={key:0,class:"pagination-container"};function M(e,l,a,i,r,n){const u=(0,t.g2)("vxe-column"),s=(0,t.g2)("el-button"),d=(0,t.g2)("vxe-table"),p=(0,t.g2)("vxe-pager");return(0,t.uX)(),(0,t.CE)("div",V,[(0,t.bF)(d,{ref:"xTable",data:e.sortedData,"row-config":{keyField:e.rowKey,isHover:!0,isCurrent:!0},"tree-config":e.treeConfig,"checkbox-config":e.checkboxConfig,"filter-config":{remote:!1,showIcon:!0,iconNone:"vxe-icon-funnel",iconMatch:"vxe-icon-funnel"},"edit-config":{trigger:"click",mode:"cell"},"mouse-config":{selected:!1},border:"",stripe:"",resizable:"","show-header-overflow":"","show-overflow":"",loading:e.loading,height:e.height,onCheckboxChange:e.handleCheckboxChange,onCheckboxAll:e.handleCheckboxAll,onCellClick:e.handleCellClick,onCellDblclick:e.handleCellDblclick,onSortChange:e.handleSortChange,onFilterChange:e.handleFilterChange,onEditClosed:e.handleEditClosed},{default:(0,t.k6)((()=>[e.showSelection?((0,t.uX)(),(0,t.Wv)(u,{key:0,type:"checkbox",width:"50",align:"center",fixed:"left"})):(0,t.Q3)("",!0),e.showGroupColumn&&e.groupFields&&e.groupFields.length>0?((0,t.uX)(),(0,t.Wv)(u,{key:1,width:"220",align:"left",field:e.groupFields[0],title:"分组","tree-node":""},{header:(0,t.k6)((()=>[(0,t.Lk)("div",x,[l[1]||(l[1]=(0,t.Lk)("span",{class:"mr-2"},"分组",-1)),(0,t.bF)(s,{type:"primary",size:"small",plain:"",icon:"el-icon-delete",onClick:e.clearGrouping,title:"清空分组"},{default:(0,t.k6)((()=>l[0]||(l[0]=[(0,t.eW)("清空")]))),_:1},8,["onClick"])])])),default:(0,t.k6)((({row:l})=>[l.isGroup?((0,t.uX)(),(0,t.CE)("span",{key:0,class:(0,o.C4)(["group-title",`group-level-${l.groupLevel}`]),style:(0,o.Tr)({"margin-left":8*l.groupLevel+"px"})},[(0,t.Lk)("strong",null,(0,o.v_)(l.groupField||"分组")+":",1),(0,t.eW)(" "+(0,o.v_)(l.groupValue||"未分类")+" ",1),(0,t.Lk)("span",_,"("+(0,o.v_)(l._childCount||l.children.length)+")",1)],6)):((0,t.uX)(),(0,t.CE)("span",K,(0,o.v_)(e.getLeafDisplayValue(l)),1))])),_:1},8,["field"])):(0,t.Q3)("",!0),e.enableSubTable?((0,t.uX)(),(0,t.Wv)(u,{key:2,type:"expand",width:"60",align:"center"},{content:(0,t.k6)((({row:a})=>[a.subTableData&&a.subTableData.length>0?((0,t.uX)(),(0,t.CE)("div",R,[l[2]||(l[2]=(0,t.Lk)("h4",null,"子表格数据",-1)),(0,t.bF)(d,{data:a.subTableData,"row-config":{keyField:"id",isHover:!0},border:"",stripe:"",size:"small"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.childColumns,((e,l)=>((0,t.uX)(),(0,t.Wv)(u,{key:l,field:e.prop,title:e.label,width:e.width},null,8,["field","title","width"])))),128))])),_:2},1032,["data"])])):((0,t.uX)(),(0,t.CE)("div",E,l[3]||(l[3]=[(0,t.Lk)("span",null,"无子表格数据",-1)])))])),_:1})):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.visibleColumns,((a,i)=>((0,t.uX)(),(0,t.Wv)(u,{key:i,field:a.prop,title:a.label,width:a.width,sortable:a.sortable,fixed:a.fixed,filters:a.filterable?e.getColumnFilters(a.prop):null,"filter-multiple":a.filterable,"edit-render":a.editable?{name:"input"}:null},{default:(0,t.k6)((({row:i})=>["loadingStatus"!==a.prop||i.isGroup?"operation"!==a.prop||i.isGroup?"appointmentStatus"!==a.prop||i.isGroup?"tags"!==a.prop||i.isGroup?((0,t.uX)(),(0,t.CE)(t.FK,{key:4},[(0,t.eW)((0,o.v_)(i[a.prop]),1)],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:3},[i.tags?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},["string"===typeof i.tags?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)(e.getValidTags(i.tags),(l=>((0,t.uX)(),(0,t.CE)("span",{key:l,class:(0,o.C4)(["tag-item",`tag-${e.getTagType(l)}`])},(0,o.v_)(l),3)))),128)):((0,t.uX)(),(0,t.CE)("span",{key:1,class:(0,o.C4)(["tag-item",`tag-${e.getTagType(i.tags)}`])},(0,o.v_)(i.tags),3))],64)):((0,t.uX)(),(0,t.CE)("span",L,"未设置"))],64)):((0,t.uX)(),(0,t.CE)("div",{key:2,class:(0,o.C4)(["status-tag",`status-${e.getAppointmentStatusType(i.appointmentStatus)}`])},(0,o.v_)(i.appointmentStatus||"未设置"),3)):((0,t.uX)(),(0,t.CE)("div",A,[(0,t.Lk)("button",{class:"operation-btn",onClick:l=>e.handleDetail(i.id)},"详情",8,N),(0,t.Lk)("button",{class:"operation-btn more-btn",onClick:l=>e.handleMoreOperations(i.id)},l[4]||(l[4]=[(0,t.eW)(" 更多"),(0,t.Lk)("i",{class:"el-icon-arrow-down"},null,-1)]),8,W)])):((0,t.uX)(),(0,t.CE)("div",{key:0,class:(0,o.C4)(["status-tag",`status-${e.getStatusType(i.loadingStatus)}`])},(0,o.v_)(i.loadingStatus||""),3))])),_:2},1032,["field","title","width","sortable","fixed","filters","filter-multiple","edit-render"])))),128))])),_:1},8,["data","row-config","tree-config","checkbox-config","loading","height","onCheckboxChange","onCheckboxAll","onCellClick","onCellDblclick","onSortChange","onFilterChange","onEditClosed"]),e.showPagination?((0,t.uX)(),(0,t.CE)("div",D,[(0,t.bF)(p,{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,sizes:e.pageSizes,layouts:["PrevJump","PrevPage","JumpNumber","NextPage","NextJump","Sizes","Total"],onPageChange:e.handlePageChange},null,8,["current-page","page-size","total","sizes","onPageChange"])])):(0,t.Q3)("",!0)])}const z=(0,t.pM)({name:"GroupableTableVxe",props:{data:{type:Array,required:!0,default:()=>[]},columns:{type:Array,required:!0,default:()=>[]},rowKey:{type:String,default:"id"},groupFields:{type:Array,default:()=>[]},showSelection:{type:Boolean,default:!1},showGroupColumn:{type:Boolean,default:!1},groupColumnLabel:{type:String,default:"分组"},defaultExpandAll:{type:Boolean,default:!0},showPagination:{type:Boolean,default:!0},currentPage:{type:Number,default:1},pageSize:{type:Number,default:20},pageSizes:{type:Array,default:()=>[10,20,50,100]},total:{type:Number,default:0},loading:{type:Boolean,default:!1},height:{type:[String,Number],default:"auto"},showUnclassified:{type:Boolean,default:!1},childColumns:{type:Array,default:()=>[]},enableSubTable:{type:Boolean,default:!1}},emits:["selection-change","size-change","current-change","cell-click","cell-dblclick","row-click","row-dblclick","clear-grouping","group-cleared","filter-change","cell-value-change"],setup(e,{emit:l}){const a=(0,S.KR)(null),o=(0,S.KR)([]),i=(0,S.Kh)({property:null,order:null}),r=(0,S.Kh)({filters:{}}),n=(0,S.Kh)({}),u=(0,t.EW)((()=>e.groupFields&&e.groupFields.length>0?e.groupFields:[])),s=(0,t.EW)((()=>u.value.length>0)),d=(0,t.EW)((()=>s.value?{enabled:!0,children:"children",expandAll:e.defaultExpandAll,indent:16,line:!1,iconOpen:"vxe-icon-caret-down",iconClose:"vxe-icon-caret-right",iconRemoveInLeaf:!0}:{enabled:!1})),p=(0,t.EW)((()=>e.showSelection?{enabled:!0,strict:!1,highlight:!0,range:!0}:{enabled:!1})),c=(0,t.EW)((()=>e.columns.filter((e=>!1!==e.visible)))),g=(0,t.EW)((()=>{const l=l=>{for(const a in l)if("id"!==a&&a!==e.rowKey&&"children"!==a&&void 0!==l[a]&&null!==l[a]&&""!==l[a])return!0;return!1};let a=e.data;if(e.showUnclassified||(a=e.data.filter(l)),!s.value)return y(a,[]);const t=a.filter(l),o=e.showUnclassified?t:t.filter((e=>{const l=u.value.every((l=>void 0!==e[l]&&null!==e[l]&&""!==e[l]));return l}));return y(o,u.value)})),v=(e,l)=>{if(!l||!l.property||!l.order)return e;const{property:a,order:t}=l,o=u.value.length>0?u.value[0]:null,i=(e,l)=>{let a=0;return void 0===e||null===e||""===e?"asc"===t?1:-1:void 0===l||null===l||""===l?"asc"===t?-1:1:(a="number"===typeof e&&"number"===typeof l?e-l:String(e).localeCompare(String(l)),"asc"===t?a:-a)},r=e=>{if(!e||0===e.length)return e;if(a===o&&e.every((e=>e.isGroup)))return e.sort(((e,l)=>i(e.groupValue,l.groupValue)));const l=e.map((e=>(e.isGroup&&e.children&&e.children.length>0&&(e.children=r(e.children)),e)));return l.sort(((e,l)=>{if(e.isGroup&&!l.isGroup)return-1;if(!e.isGroup&&l.isGroup)return 1;if(e.isGroup&&l.isGroup&&a!==o)return 0;const t=e.isGroup?e.groupValue:e[a],r=l.isGroup?l.groupValue:l[a];return i(t,r)}))};return r([...e])},m=(0,t.EW)((()=>v(g.value,i))),b=l=>{const a={};e.columns.forEach((e=>{if(e.filterable&&"operation"!==e.prop){const t=new Set,o=l=>{l&&Array.isArray(l)&&l.forEach((l=>{l.isGroup||void 0===l[e.prop]||null===l[e.prop]||t.add(String(l[e.prop])),l.children&&l.children.length&&o(l.children)}))};o(l),a[e.prop]=Array.from(t).map((e=>({label:e,value:e})))}})),Object.assign(n,a)};(0,t.wB)((()=>e.data),(e=>{b(e)}),{immediate:!0,deep:!0});const h=e=>n[e]||[],f=()=>{i.property=null,i.order=null;const e=[...u.value];l("update:groupFields",[]),l("clear-grouping",e),(0,t.dY)((()=>{l("group-cleared")}))},y=(l,a)=>{if(!a||0===a.length||!l||0===l.length)return l.map((l=>{const a=e.data.find((a=>a[e.rowKey]===l[e.rowKey]));return a&&a.children&&(l.subTableData=a.children),delete l.children,l}));const t=l=>{const a=e.columns.find((e=>e.prop===l));return a?a.label:l};let o=1;const i=(l,r=0)=>{const n=a[r],u=r===a.length-1,s=new Map,d=[];l.forEach((e=>{const l=e[n];if(void 0===l||null===l||""===l)d.push(e);else{const a=String(l);s.has(a)||s.set(a,[]),s.get(a).push(e)}}));const p=[];if(s.forEach(((l,a)=>{const s={id:`group-${r}-${o++}`,isGroup:!0,groupLevel:r+1,groupField:t(n),groupValue:"undefined"===a||"null"===a?"未分类":a,[n]:a,_groupKey:a,_expanded:!0,children:[]};u?(s.children=l.map((l=>{const a=e.data.find((a=>a[e.rowKey]===l[e.rowKey]));return a&&a.children&&(l.subTableData=a.children),delete l.children,l})),s._childCount=s.children.length):(s.children=i(l,r+1),s._childCount=s.children.reduce(((e,l)=>e+(l.isGroup?l._childCount:1)),0)),s._childCount>0&&p.push(s)})),e.showUnclassified&&d.length>0){const l={id:`group-${r}-unclassified-${o++}`,isGroup:!0,groupLevel:r+1,groupField:t(n),groupValue:"未分类",_groupKey:"__unclassified__",_expanded:!0,children:[]};u?(l.children=d.map((l=>{const a=e.data.find((a=>a[e.rowKey]===l[e.rowKey]));return a&&a.children&&(l.subTableData=a.children),delete l.children,l})),l._childCount=l.children.length):(l.children=i(d,r+1),l._childCount=l.children.reduce(((e,l)=>e+(l.isGroup?l._childCount:1)),0)),l._childCount>0&&p.push(l)}return p};return i(l)},C=e=>e?e.split(",").map((e=>e.trim())).filter((e=>e)):[],k=l=>{if(!u.value||0===u.value.length)return"";const a=u.value[u.value.length-1],t=l[a];return void 0!==t&&null!==t&&""!==t||e.showUnclassified?void 0===t||null===t||""===t?"未分类":String(t):""},w=({records:a})=>{o.value=a.map((l=>l[e.rowKey])),l("selection-change",a)},F=({records:a})=>{o.value=a.map((l=>l[e.rowKey])),l("selection-change",a)},T=({row:e,column:a,$event:t})=>{e&&a&&(l("cell-click",{record:e,column:a.property,event:t}),l("row-click",e,t))},V=({row:e,column:a,$event:t})=>{e&&a&&(l("cell-dblclick",{record:e,column:a.property,event:t}),l("row-dblclick",e,t))},x=({property:e,order:l})=>{i.property=l?e:null,i.order=l},_=({column:e,property:a,values:t})=>{t&&t.length?r.filters[a]=t:delete r.filters[a],l("filter-change",{column:e,property:a,values:t,filters:{...r.filters}})},K=({currentPage:e,pageSize:a})=>{l("current-change",e),l("size-change",a)},R=e=>{window.handleDetail?.(e)},E=e=>{window.handleMoreOperations?.(e)},A=({row:o,column:i})=>{if(!o||!i)return;const r=e.data.find((l=>l[e.rowKey]===o[e.rowKey])),n=r?r[i.property]:void 0,u=o[i.property];u!==n?(console.log(`[GroupableTableVisactor] Edit closed. Field: ${i.property}, Old: ${n}, New: ${u}`),l("cell-value-change",{record:o,column:i.property,value:u,oldValue:n}),(0,t.dY)((()=>{if(a.value){const e=a.value.getColumnByField(i.property);e&&a.value.refreshColumn(e)}}))):console.log(`[GroupableTableVisactor] Edit closed. Field: ${i.property}. Value not changed.`),(0,t.dY)((()=>{a.value&&(a.value.clearSelected(),a.value.clearCurrentRow(),a.value.clearCurrentColumn())}))},N=()=>{a.value?.toggleAllCheckboxRow()},W=()=>{a.value?.clearCheckboxRow()},L=(e,l)=>{a.value&&(l?a.value.setCheckboxRow(e,!0):a.value.setCheckboxRow(e,!1))},D=e=>e?"待处理"===e?"warning":"处理中"===e?"primary":"已完成"===e?"success":"已取消"===e?"danger":"default":"default",M=e=>e?"未预约"===e?"warning":"已预约"===e?"success":"已取消"===e?"danger":"default":"default",z=e=>{if(!e)return"default";const l=String(e),a=l.toLowerCase();return a.includes("urgent")||a.includes("紧急")?"danger":a.includes("delay")||a.includes("延迟")?"warning":a.includes("completed")||a.includes("完成")?"success":"primary"},G=({row:l,column:a})=>{if(!l||!a)return!1;if(l.isGroup)return!1;const t=e.columns.find((e=>e.prop===a.property));return t&&!0===t.editable};return{xTable:a,selectedRowKeys:o,hasGrouping:s,treeConfig:d,checkboxConfig:p,sortedData:m,visibleColumns:c,getValidTags:C,getLeafDisplayValue:k,toggleAllSelection:N,clearSelection:W,toggleRowSelection:L,handleCheckboxChange:w,handleCheckboxAll:F,handleCellClick:T,handleCellDblclick:V,handleSortChange:x,handleFilterChange:_,handlePageChange:K,handleDetail:R,handleMoreOperations:E,getStatusType:D,getAppointmentStatusType:M,getTagType:z,clearGrouping:f,getColumnFilters:h,handleEditClosed:A,allowEditingCell:G}}});var G=a(6262);const P=(0,G.A)(z,[["render",M],["__scopeId","data-v-5c81ef96"]]),U=P;var X=a(432),O=a.n(X),$=a(8597),I=a(7443),B=a(7006);const q=Array.from({length:10}).map(((e,l)=>({id:l+1,loadingStatus:["待处理","处理中","已完成","已取消"][l%4],trainNumber:`TR${1e3+l}`,containerNo:`CN${2e3+l}`,soNumber:`SO${3e3+l}`,shipmentNumber:`SH${4e3+l}`,trackingNumber:`TK${5e3+l}`,warehouse:"west2",address:`123 Main St, Unit ${l}`,city:["Los Angeles","Seattle","New York","Miami","Dallas"][l%5],state:["CA","WA","NY","FL","TX"][l%5],zipCode:9e4+l,deliveryArea:"Area "+(l%10+1),appointmentStatus:["电话预约","平台预约","邮件预约","未预约"][l%4],deliveryAppointmentTime:`2024-04-${String(l%28+1).padStart(2,"0")} 10:00:00`,deliveryTime:`2024-04-${String(l%28+1).padStart(2,"0")} 14:00:00`,eta:`2024-04-${String(l%28+1).padStart(2,"0")}`,remarks:`备注信息 ${l}`}))),J=(0,t.pM)({name:"NewFBXVisactor",components:{FilterPanel:T.A,GroupableTableVisactor:U,draggable:O()},setup(){const e=(0,S.KR)(null),l=(0,S.KR)("west2"),a=(0,S.KR)("eta"),o=(0,S.KR)([]),i=(0,S.KR)("trainNumber"),r=(0,S.KR)(""),n=(0,S.KR)([]),u=(0,S.KR)([]),s=(0,S.KR)(!1),d=(0,S.KR)([]),p=(0,S.KR)(1),c=(0,S.KR)(20),g=(0,S.KR)(0),v=(0,S.KR)("all"),m=(0,S.KR)([]),b=(0,S.KR)({all:0,pending:0,processing:0,completed:0,cancelled:0}),h=(0,S.KR)(""),f=(0,S.KR)({field:"",order:"asc"}),y=(0,S.KR)(!1),C=(0,S.KR)([]),k=(0,S.KR)("and"),w=(0,S.KR)(!1),T=(0,S.KR)(!1),V=(0,S.KR)({name:"",columns:[]}),x=(0,S.KR)({value:""}),_=(0,S.KR)({}),K=(0,S.KR)(null),R=(0,S.KR)(!1),E=(0,S.KR)({level1:"",level2:"",level3:""}),A=(0,S.KR)(!1),N=(0,S.KR)([]),W=(0,S.KR)([]),L=(0,S.KR)(!1),D=(0,S.KR)([]),M=((0,S.KR)(!1),(0,S.KR)({memo:""}),(0,S.KR)(!1),(0,S.KR)({content:"",type:"primary"}),(0,S.KR)([]),(0,S.KR)(!1),(0,S.KR)([]),(0,S.KR)(!1)),z=(0,S.KR)(""),G=(0,S.KR)({followUp:"",memo:"",pcType:"delivery",targetWarehouse:""}),P=(0,S.KR)(!1),U=(0,S.KR)(0),X=(0,S.KR)(0),O=(0,S.KR)(null),J=(0,S.KR)({field:"",operator:"equals",value:""}),Y=((0,S.KR)({field:"",direction:"asc"}),(0,S.KR)({})),Q=(0,S.KR)(!1),H=(0,S.KR)(null),j=(0,S.KR)({left:"0px",top:"0px"}),Z=(0,S.KR)($.map((e=>({...e,visible:!0,sortable:!1!==e.sortable,filterable:"operation"!==e.prop,editable:["address","city","state","zipCode","deliveryArea","appointmentStatus","deliveryAppointmentTime","deliveryTime","deliveryCompany","deliveryDriver","driverPhone","followUpRecord","remarks","internalRemarks","tags"].includes(e.prop)})))),ee=(0,S.KR)(I),le=(0,t.EW)((()=>Z.value.filter((e=>!["operation"].includes(e.prop)&&!1!==e.visible)))),ae=(0,t.EW)((()=>Z.value.filter((e=>e.sortable&&!1!==e.visible)))),te=(0,t.EW)((()=>oe.value.length>0||!!h.value)),oe=((0,t.EW)((()=>{if("all"!==v.value&&"pending"!==v.value&&"processing"!==v.value&&"completed"!==v.value&&"cancelled"!==v.value){const e=m.value.find((e=>e.id===v.value));if(e)return e}return null})),(0,S.KR)([])),ie=async()=>{s.value=!0;try{await new Promise((e=>setTimeout(e,300))),Array.isArray(B)&&B.length>0?(console.log("使用导入的JSON数据源"),n.value=B):(console.log("导入的数据源为空，使用模拟数据"),n.value=q),console.log("加载的数据条数:",n.value.length),console.log("数据样例:",n.value.slice(0,2)),g.value=n.value.length;const e={all:n.value.length,pending:0,processing:0,completed:0,cancelled:0};n.value.forEach((l=>{"待处理"===l.loadingStatus?e.pending++:"处理中"===l.loadingStatus?e.processing++:"已完成"===l.loadingStatus?e.completed++:"已取消"===l.loadingStatus&&e.cancelled++})),b.value=e,console.log("状态统计:",e),re()}catch(e){console.error("获取数据失败:",e),console.log("发生错误，使用模拟数据"),n.value=q,g.value=q.length,re(),F.nk.error("获取数据失败: "+e.message)}finally{s.value=!1}},re=()=>{s.value=!0;let e=[...n.value];if("pending"===v.value?e=e.filter((e=>"待处理"===e.loadingStatus)):"processing"===v.value?e=e.filter((e=>"处理中"===e.loadingStatus)):"completed"===v.value?e=e.filter((e=>"已完成"===e.loadingStatus)):"cancelled"===v.value&&(e=e.filter((e=>"已取消"===e.loadingStatus))),r.value){const l=r.value.toLowerCase();e=e.filter((e=>{const a=e[i.value];return a&&a.toString().toLowerCase().includes(l)}))}h.value&&(e=ue(e,h.value)),N.value.length>0&&(e=Ye(e)),Je.value||(e=e.filter((e=>{for(const l in e)if(void 0!==e[l]&&null!==e[l]&&""!==e[l]&&"id"!==l)return!0;return!1}))),g.value=e.length;const l=(p.value-1)*c.value,a=l+c.value;u.value=e.slice(l,a),s.value=!1},ne=(e,l,a="and")=>e.filter((e=>{const t=l.map((l=>{const{field:a,operator:t,value:o}=l;if(!Object.prototype.hasOwnProperty.call(e,a))return!0;const i=e[a];switch(t){case"equals":return i==o;case"notEquals":return i!=o;case"contains":return i&&i.toString().includes(o);case"notContains":return!i||!i.toString().includes(o);case"startsWith":return i&&i.toString().startsWith(o);case"endsWith":return i&&i.toString().endsWith(o);case"greaterThan":return i>o;case"lessThan":return i<o;case"greaterThanOrEqual":return i>=o;case"lessThanOrEqual":return i<=o;case"empty":return!i||""===i.toString().trim();case"notEmpty":return i&&""!==i.toString().trim();default:return!0}}));return"and"===a?t.every((e=>e)):t.some((e=>e))})),ue=(e,l)=>{const a={},t=[];return e.forEach((e=>{const o=e[l],i=void 0===o||null===o?"未分组":String(o);a[i]||(a[i]={id:`group-${l}-${i}`,groupName:i,isGroup:!0,groupLevel:1,count:0,children:[]},t.push(a[i])),a[i].children.push(e),a[i].count++})),t},se=e=>e?"待处理"===e?"warning":"处理中"===e?"primary":"已完成"===e?"success":"已取消"===e?"danger":"default":"default",de=e=>e?"未预约"===e?"warning":"已预约"===e?"success":"已取消"===e?"danger":"default":"default",pe=e=>{if(!e)return"default";const l=e.toLowerCase();return l.includes("urgent")||l.includes("紧急")?"danger":l.includes("delay")||l.includes("延迟")?"warning":l.includes("completed")||l.includes("完成")?"success":"primary"},ce=()=>{const e={searchType:i.value,searchText:r.value,warehouse:l.value,dateRange:o.value,createDateType:a.value,filters:C.value,filterLogic:k.value,sortSettings:N.value,groupField:h.value};return e},ge=()=>{re()},ve=e=>{c.value=e,p.value=1,re()},me=e=>{p.value=e,re()},be=e=>{const l=n.value.find((l=>l.id===e));l&&(Y.value=l,Q.value=!0)},he=(e,l)=>{const a=n.value.find((l=>l.id===e));a&&(H.value=a,(0,t.dY)((()=>{P.value=!0,l&&(j.value={left:`${l.clientX}px`,top:`${l.clientY}px`})})))};(0,t.sV)((async()=>{const e=localStorage.getItem("fbx_visactor_custom_views");if(e)try{m.value=JSON.parse(e)}catch(l){console.error("加载自定义视图失败",l),m.value=[]}window.handleDetail=e=>{be(e)},window.handleMoreOperations=e=>{he(e)},await ie(),document.addEventListener("click",fe)})),(0,t.xo)((()=>{window.handleDetail=void 0,window.handleMoreOperations=void 0,document.removeEventListener("click",fe)}));const fe=()=>{P.value=!1};(0,t.wB)((()=>v.value),(()=>{if(p.value=1,"all"!==v.value&&"pending"!==v.value&&"processing"!==v.value&&"completed"!==v.value&&"cancelled"!==v.value){const e=m.value.find((e=>e.id===v.value));if(e&&e.conditions&&(e.conditions.filters&&(C.value=[...e.conditions.filters]),e.conditions.filterLogic&&(k.value=e.conditions.filterLogic),e.conditions.sortSettings&&(N.value=[...e.conditions.sortSettings]),e.conditions.groupField&&(h.value=e.conditions.groupField),e.columns&&Array.isArray(e.columns))){const l=new Map(Z.value.map((e=>[e.prop,e])));e.columns.forEach((e=>{if(l.has(e.prop)){const a=l.get(e.prop);a.visible=e.visible}}))}}re()}));const ye=()=>{y.value=!0},Ce=()=>{E.value={level1:"",level2:"",level3:""},R.value=!0},ke=()=>{const e=[];E.value.level1&&e.push(E.value.level1),E.value.level2&&e.push(E.value.level2),E.value.level3&&e.push(E.value.level3),Se(e),R.value=!1,F.nk.success("分组已应用")},we=()=>{E.value={level1:"",level2:"",level3:""},Se([]),F.nk.success("分组已清除")},Se=e=>{oe.value=e,re()},Fe=()=>{W.value=JSON.parse(JSON.stringify(N.value)),0===W.value.length&&Te(),A.value=!0},Te=()=>{W.value.push({field:"",order:"asc"})},Ve=e=>{W.value.splice(e,1)},xe=()=>{N.value=W.value.filter((e=>e.field)),A.value=!1,re()},_e=()=>{A.value=!1},Ke=()=>{D.value=JSON.parse(JSON.stringify(Z.value)),L.value=!0},Re=()=>{Z.value=JSON.parse(JSON.stringify(D.value)),L.value=!1,re()},Ee=()=>{L.value=!1},Ae=()=>{D.value=$.map((e=>({...e,visible:!0,sortable:!1!==e.sortable,editable:["address","city","state","zipCode","deliveryArea","appointmentStatus","deliveryAppointmentTime","deliveryTime","deliveryCompany","deliveryDriver","driverPhone","followUpRecord","remarks","internalRemarks","tags"].includes(e.prop)})))},Ne=()=>{V.value={name:"",columns:Z.value.filter((e=>!1!==e.visible)).map((e=>e.prop))},w.value=!0},We=()=>{if(!V.value.name)return void F.nk.warning("视图名称不能为空");const e={id:`view-${Date.now()}`,name:V.value.name,description:"",conditions:ce(),columns:Z.value.map((e=>({prop:e.prop,visible:!1!==e.visible})))};m.value.push(e),w.value=!1,localStorage.setItem("fbx_visactor_custom_views",JSON.stringify(m.value)),v.value=e.id,re(),F.nk.success("视图已保存")},Le=e=>{const l=m.value.findIndex((l=>l.id===e));l>-1&&(m.value.splice(l,1),localStorage.setItem("fbx_visactor_custom_views",JSON.stringify(m.value)),v.value===e&&(v.value="all",re()),F.nk.success("视图已删除")),P.value=!1},De=(e,l)=>{e.preventDefault(),U.value=e.clientX,X.value=e.clientY,K.value=l,P.value=!0},Me=({prop:e,order:l})=>{const a="ascending"===l?"asc":"descending"===l?"desc":null;N.value=a?[{field:e,order:a}]:[],re()},ze=e=>{0!==d.value.length?(z.value=e,"followUp"===e?G.value.followUp="":"memo"===e?G.value.memo="":"createPC"===e&&(G.value.pcType="delivery",G.value.targetWarehouse=""),M.value=!0):F.nk.warning("请先选择记录")},Ge=(e,l)=>{C.value=e,k.value=l,y.value=!1,re()},Pe=()=>{y.value=!1},Ue=e=>"appointmentStatus"===e?[{value:"电话预约",label:"电话预约"},{value:"平台预约",label:"平台预约"},{value:"邮件预约",label:"邮件预约"},{value:"未预约",label:"未预约"}]:"tags"===e?[{value:"加急",label:"加急"},{value:"特殊处理",label:"特殊处理"},{value:"延迟",label:"延迟"},{value:"紧急",label:"紧急"}]:[],Xe=()=>{_.value&&_.value.prop&&O.value&&(O.value[_.value.prop]=x.value.value,T.value=!1,re(),F.nk.success(`${_.value.label} 已更新`))},Oe=e=>{const l=Z.value.find((l=>l.prop===e));return l?l.label:"分组"},$e=e=>{d.value=e},Ie=({record:e,column:l,value:a,openEditDialog:t})=>{console.log("单元格双击",e,l,a,t),t&&(x.value.value=a,_.value=Z.value.find((e=>e.prop===l))||{},T.value=!0,O.value=e)},Be=()=>{v.value="all",r.value="",h.value="",C.value=[],n.value=q,g.value=q.length,u.value=q,console.log("使用测试数据，共",q.length,"条"),console.log("测试数据样例:",q[0]),F.nk.success("已加载测试数据，共"+q.length+"条")},qe=()=>{oe.value=[],h.value="",E.value={level1:"",level2:"",level3:""},re(),F.nk.success("分组已清除")},Je=(0,S.KR)(!0),Ye=e=>N.value&&0!==N.value.length?[...e].sort(((e,l)=>{for(const a of N.value){if(!a.field)continue;const t=e[a.field],o=l[a.field];if(e.isGroup||l.isGroup)return 0;if(void 0===t||null===t||""===t)return"asc"===a.order?1:-1;if(void 0===o||null===o||""===o)return"asc"===a.order?-1:1;let i=0;if("number"===typeof t&&"number"===typeof o)i=t-o;else{const e=String(t).toLowerCase(),l=String(o).toLowerCase();i=e.localeCompare(l)}if(0!==i)return"asc"===a.order?i:-i}return 0})):e,Qe=({record:e,column:l,value:a})=>{console.log("单元格值变化:",e,l,a);const t=n.value.find((l=>l.id===e.id));t?(console.log("找到原始记录:",t),t[l]=a,console.log("更新后的原始记录:",t)):console.warn("未在原始数据中找到记录:",e.id)};return{warehouse:l,createDateType:a,dateRange:o,searchType:i,searchText:r,loading:s,tableData:n,displayData:u,selectedRows:d,tableColumns:Z,childColumns:ee,currentPage:p,pageSize:c,total:g,currentView:v,customViews:m,statusCounts:b,saveViewDialogVisible:w,viewForm:V,groupField:h,sortConfig:f,groupSettings:E,groupModalVisible:R,sortModalVisible:A,tempSortSettings:W,sortSettings:N,columnSettingsVisible:L,tempTableColumns:D,filterPanelVisible:y,activeFilters:C,filterLogic:k,newFilter:J,editDialogVisible:T,editingForm:x,editingColumn:_,detailDialogVisible:Q,selectedRecord:H,menuPosition:j,contextMenuVisible:P,contextMenuX:U,contextMenuY:X,currentEditingView:K,visactorTable:e,groupableFields:le,sortableFields:ae,handleSizeChange:ve,handleCurrentChange:me,handleSearch:ge,handleDetail:be,handleMoreOperations:he,showFilterPanel:ye,showGroupModal:Ce,applyGroupSettings:ke,clearGroupSettings:we,showSortModal:Fe,addTempSortRule:Te,removeTempSortRule:Ve,applySorting:xe,cancelSorting:_e,showColumnSettings:Ke,applyColumnSettings:Re,cancelColumnSettings:Ee,resetColumnSettings:Ae,handleSaveView:Ne,saveView:We,deleteView:Le,handleContextMenu:De,handleBatchOperation:ze,handleSortChange:Me,refreshDisplayData:re,applyAdvancedFilters:ne,applyFilters:Ge,cancelFilters:Pe,getOptionsForColumn:Ue,saveDialogEdit:Xe,getAppointmentStatusType:de,getStatusTagType:se,getTagType:pe,getColumnLabel:Oe,handleSelectionChange:$e,handleCellDbClick:Ie,testWithMockData:Be,multiGroupFields:oe,hasGroupData:te,handleClearGrouping:qe,showEmptyRows:Je,handleCellValueChange:Qe}}}),Y=(0,G.A)(J,[["render",w],["__scopeId","data-v-28eb082c"]]),Q=Y},7006:e=>{e.exports=JSON.parse('[{"id":1,"containerNumber":"MAEU1234567","shippingNumber":"SH20240501001","customerService":"王小明","originalAddress":"123 Main St, Newark, NJ 07101","address":"456 Elm St","city":"Los Angeles","state":"CA","zipCode":"90001","deliveryArea":"城区","warehouseCode":"LA001","channel":"海运","boxCount":45,"weight":2500,"volume":65.5,"palletCount":8,"location":"A-12-05","eta":"2024-05-15","containerPickupTime":"2024-05-16 08:30:00","arrivalTime":"2024-05-16 10:15:00","expectedUnpackingTime":"2024-05-16 13:00:00","unpackingCompletedTime":"2024-05-16 16:45:00","appointmentNumber":"APP00125","deliveryAppointmentTime":"2024-05-18 09:00:00","deliveryTime":"2024-05-18 09:15:00","deliveryCompany":"速达物流","deliveryDriver":"李强","driverPhone":"13812345678","pcNumber":"PC2024050101","appointmentStatus":"已确认","tags":["优先处理","特殊货物"],"followUpRecord":"客户已确认送货时间","remarks":"请轻拿轻放，货物易碎","internalRemarks":"VIP客户，优先处理","quotationLianyu":5600,"shippingMark":"ACME-2024","platformQuotation":5800,"children":[{"id":101,"itemCode":"I2024050101","trackingNumber":"TRK000123456","productName":"电子显示器","quantity":20,"weight":500,"volume":12.5},{"id":102,"itemCode":"I2024050102","trackingNumber":"TRK000123457","productName":"服务器设备","quantity":5,"weight":750,"volume":18.2}]},{"id":2,"containerNumber":"CMAU7654321","shippingNumber":"SH20240501002","customerService":"李娜","originalAddress":"789 Oak St, Seattle, WA 98101","address":"321 Pine Rd","city":"San Francisco","state":"CA","zipCode":"94107","deliveryArea":"郊区","warehouseCode":"SF002","channel":"海运","boxCount":32,"weight":1800,"volume":48.2,"palletCount":6,"location":"B-08-12","eta":"2024-05-18","containerPickupTime":"2024-05-19 07:45:00","arrivalTime":"2024-05-19 09:30:00","expectedUnpackingTime":"2024-05-19 12:00:00","unpackingCompletedTime":"2024-05-19 15:30:00","appointmentNumber":"APP00126","deliveryAppointmentTime":"2024-05-21 14:00:00","deliveryTime":null,"deliveryCompany":"快捷物流","deliveryDriver":"张伟","driverPhone":"13898765432","pcNumber":"PC2024050102","appointmentStatus":"已预约","tags":["常规货物"],"followUpRecord":"等待确认送货时间","remarks":"送货前需电话联系","internalRemarks":"","quotationLianyu":4200,"shippingMark":"BETA-2024","platformQuotation":4500,"children":[{"id":201,"itemCode":"I2024050201","trackingNumber":"TRK000234567","productName":"办公家具","quantity":15,"weight":800,"volume":25.5}]},{"id":3,"containerNumber":"OOLU8765432","shippingNumber":"SH20240502001","customerService":"张伟","originalAddress":"456 Market St, New York, NY 10001","address":"789 Beach Blvd","city":"San Diego","state":"CA","zipCode":"92109","deliveryArea":"远郊","warehouseCode":"SD003","channel":"空运","boxCount":18,"weight":950,"volume":28.4,"palletCount":4,"location":"C-05-07","eta":"2024-05-20","containerPickupTime":"2024-05-20 09:00:00","arrivalTime":"2024-05-20 11:30:00","expectedUnpackingTime":"2024-05-20 14:00:00","unpackingCompletedTime":null,"appointmentNumber":"APP00127","deliveryAppointmentTime":null,"deliveryTime":null,"deliveryCompany":"安顺物流","deliveryDriver":"","driverPhone":"","pcNumber":"PC2024050201","appointmentStatus":"未预约","tags":["易碎品","高价值"],"followUpRecord":"待处理","remarks":"贵重物品，需专人签收","internalRemarks":"保价货物，谨慎操作","quotationLianyu":7800,"shippingMark":"GAMMA-2024","platformQuotation":8200,"children":[{"id":301,"itemCode":"I2024050301","trackingNumber":"TRK000345678","productName":"医疗设备","quantity":8,"weight":450,"volume":15.8},{"id":302,"itemCode":"I2024050302","trackingNumber":"TRK000345679","productName":"医用耗材","quantity":10,"weight":250,"volume":8.5}]}]')},7443:e=>{e.exports=JSON.parse('[{"prop":"itemCode","label":"货件编码","width":140,"sortable":true},{"prop":"trackingNumber","label":"追踪编号","width":160,"sortable":true},{"prop":"productName","label":"货物名称","width":200,"sortable":true},{"prop":"quantity","label":"数量","width":100,"sortable":true},{"prop":"weight","label":"重量(KG)","width":120,"sortable":true},{"prop":"volume","label":"体积(CBM)","width":120,"sortable":true}]')},8597:e=>{e.exports=JSON.parse('[{"prop":"containerNumber","label":"集装箱号","width":140,"sortable":true,"filterType":"text"},{"prop":"shippingNumber","label":"运单号","width":140,"sortable":true,"filterType":"text"},{"prop":"customerService","label":"客服","width":100,"sortable":true,"filterType":"text"},{"prop":"originalAddress","label":"原地址信息","width":180,"sortable":true,"filterType":"text"},{"prop":"address","label":"地址","width":180,"sortable":true,"filterType":"text"},{"prop":"city","label":"City","width":120,"sortable":true,"filterType":"text"},{"prop":"state","label":"State","width":100,"sortable":true,"filterType":"text"},{"prop":"zipCode","label":"Zip_Code","width":120,"sortable":true,"filterType":"text"},{"prop":"deliveryArea","label":"派送区域","width":120,"sortable":true,"filterType":"select","filterOptions":[{"label":"城区","value":"城区"},{"label":"郊区","value":"郊区"},{"label":"远郊","value":"远郊"},{"label":"跨州","value":"跨州"}]},{"prop":"warehouseCode","label":"仓库代码","width":120,"sortable":true,"filterType":"text"},{"prop":"channel","label":"渠道","width":100,"sortable":true,"filterType":"select","filterOptions":[{"label":"海运","value":"海运"},{"label":"空运","value":"空运"},{"label":"铁路","value":"铁路"},{"label":"公路","value":"公路"}]},{"prop":"boxCount","label":"箱数","width":80,"sortable":true,"filterType":"number"},{"prop":"weight","label":"重重","width":100,"sortable":true,"filterType":"number"},{"prop":"volume","label":"方数","width":100,"sortable":true,"filterType":"number"},{"prop":"palletCount","label":"板数","width":80,"sortable":true,"filterType":"number"},{"prop":"location","label":"库位","width":100,"sortable":true,"filterType":"text"},{"prop":"eta","label":"ETA","width":140,"sortable":true,"filterType":"date"},{"prop":"containerPickupTime","label":"提柜时间","width":140,"sortable":true,"filterType":"datetime"},{"prop":"arrivalTime","label":"抵仓时间","width":140,"sortable":true,"filterType":"datetime"},{"prop":"expectedUnpackingTime","label":"预计拆柜时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"unpackingCompletedTime","label":"拆柜完成时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"appointmentNumber","label":"预约号","width":120,"sortable":true,"filterType":"text"},{"prop":"deliveryAppointmentTime","label":"派送预约时间","width":160,"sortable":true,"filterType":"datetime"},{"prop":"deliveryTime","label":"送货时间","width":140,"sortable":true,"filterType":"datetime"},{"prop":"deliveryCompany","label":"送货公司","width":140,"sortable":true,"filterType":"text"},{"prop":"deliveryDriver","label":"送货司机","width":120,"sortable":true,"filterType":"text"},{"prop":"driverPhone","label":"司机电话","width":120,"sortable":true,"filterType":"text"},{"prop":"pcNumber","label":"PC号","width":120,"sortable":true,"filterType":"text"},{"prop":"appointmentStatus","label":"预约状态","width":120,"sortable":true,"filterType":"select","type":"status","options":[{"value":"未预约","type":"info"},{"value":"已预约","type":"warning"},{"value":"已确认","type":"primary"},{"value":"已抵达","type":"success"},{"value":"已取消","type":"danger"}],"filterOptions":[{"label":"未预约","value":"未预约"},{"label":"已预约","value":"已预约"},{"label":"已确认","value":"已确认"},{"label":"已抵达","value":"已抵达"},{"label":"已取消","value":"已取消"}]},{"prop":"tags","label":"标签","width":120,"sortable":false,"filterType":"select","type":"tags"},{"prop":"followUpRecord","label":"跟进记录","width":150,"sortable":false,"filterType":"text"},{"prop":"remarks","label":"MEMO","width":150,"sortable":false,"filterType":"text"},{"prop":"internalRemarks","label":"内部备注","width":150,"sortable":false,"filterType":"text"},{"prop":"quotationLianyu","label":"报价(联宇)","width":150,"sortable":true,"filterType":"number"},{"prop":"shippingMark","label":"唛头","width":120,"sortable":true,"filterType":"text"},{"prop":"platformQuotation","label":"询价平台报价","width":150,"sortable":true,"filterType":"number"},{"prop":"podPhoto","label":"POD照片","width":"120","sortable":true},{"prop":"operation","label":"操作","width":150,"fixed":"right","sortable":false,"type":"operation"}]')}}]);
//# sourceMappingURL=6114.02e63ff5.js.map