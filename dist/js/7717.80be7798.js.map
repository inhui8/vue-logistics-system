{"version":3,"file":"js/7717.80be7798.js","mappings":"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","sources":["webpack://vue-logistics-system/./src/views/MessageCenter/EmailManagement/EmailLog.vue","webpack://vue-logistics-system/./src/views/MessageCenter/EmailManagement/EmailLog.vue?d4b0"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-card shadow=\"never\">\r\n      <!-- 搜索区域 -->\r\n      <el-form :model=\"queryParams\" ref=\"queryFormRef\" :inline=\"true\" label-width=\"68px\">\r\n         <el-form-item label=\"收件邮箱\" prop=\"toMail\">\r\n          <el-input\r\n            v-model=\"queryParams.toMail\"\r\n            placeholder=\"请输入收件邮箱\"\r\n            clearable\r\n            @keyup.enter=\"handleQuery\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"发送账号\" prop=\"accountId\">\r\n           <el-select\r\n            v-model=\"queryParams.accountId\"\r\n            placeholder=\"请选择发送账号\"\r\n            clearable\r\n            style=\"width: 240px\"\r\n          >\r\n             <el-option\r\n                v-for=\"item in accountOptions\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\"\r\n              />\r\n           </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"模板编码\" prop=\"templateCode\">\r\n          <el-input\r\n            v-model=\"queryParams.templateCode\"\r\n            placeholder=\"请输入模板编码\"\r\n            clearable\r\n            @keyup.enter=\"handleQuery\"\r\n          />\r\n        </el-form-item>\r\n         <el-form-item label=\"发送状态\" prop=\"sendStatus\">\r\n           <el-select\r\n            v-model=\"queryParams.sendStatus\"\r\n            placeholder=\"请选择发送状态\"\r\n            clearable\r\n            style=\"width: 240px\"\r\n          >\r\n            <el-option label=\"发送成功\" :value=\"0\" />\r\n            <el-option label=\"发送失败\" :value=\"1\" />\r\n           </el-select>\r\n        </el-form-item>\r\n         <el-form-item label=\"发送时间\" prop=\"sendTimeRange\">\r\n           <el-date-picker\r\n              v-model=\"queryParams.sendTimeRange\"\r\n              type=\"datetimerange\"\r\n              start-placeholder=\"开始日期\"\r\n              end-placeholder=\"结束日期\"\r\n              value-format=\"YYYY-MM-DD HH:mm:ss\" \r\n              style=\"width: 240px\"\r\n            />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleQuery\">搜索</el-button>\r\n          <el-button icon=\"el-icon-refresh\" @click=\"resetQuery\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n    </el-card>\r\n\r\n     <el-card shadow=\"never\" class=\"mt-4\">\r\n      <!-- 表格区域 -->\r\n      <el-table v-loading=\"loading\" :data=\"logList\">\r\n        <el-table-column label=\"编号\" align=\"center\" prop=\"id\" width=\"80\"/>\r\n        <el-table-column label=\"发送邮箱账号\" align=\"center\" prop=\"fromMail\" width=\"180\" />\r\n        <el-table-column label=\"收件邮箱\" align=\"center\" prop=\"toMail\" width=\"180\" />\r\n        <el-table-column label=\"模板标题\" align=\"center\" prop=\"templateTitle\" show-overflow-tooltip/>\r\n        <el-table-column label=\"发送内容\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-button link type=\"primary\" @click=\"openContentDialog(scope.row.templateContent)\">查看</el-button>\r\n          </template>\r\n        </el-table-column>\r\n         <el-table-column label=\"发送参数\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-button link type=\"primary\" @click=\"openContentDialog(scope.row.templateParams)\">查看</el-button>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"发送状态\" align=\"center\" width=\"100\">\r\n           <template #default=\"scope\">\r\n            <el-tag :type=\"scope.row.sendStatus === 0 ? 'success' : 'danger'\">\r\n              {{ scope.row.sendStatus === 0 ? '成功' : '失败' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n         <el-table-column label=\"模板编号\" align=\"center\" prop=\"templateId\" width=\"100\"/>\r\n         <el-table-column label=\"消息编号\" align=\"center\" prop=\"messageId\" width=\"100\"/>\r\n        <el-table-column label=\"发送时间\" align=\"center\" prop=\"sendTime\" width=\"180\">\r\n          <template #default=\"scope\">\r\n            <span>{{ scope.row.sendTime ? new Date(scope.row.sendTime).toLocaleString() : '' }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"异常信息\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-button v-if=\"scope.row.sendStatus === 1\" link type=\"danger\" @click=\"openContentDialog(scope.row.exceptionMessage)\">\r\n              查看\r\n            </el-button>\r\n             <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 分页 -->\r\n      <el-pagination\r\n        v-show=\"total > 0\"\r\n        v-model:current-page=\"queryParams.pageNo\"\r\n        v-model:page-size=\"queryParams.pageSize\"\r\n        :total=\"total\"\r\n        :page-sizes=\"[10, 20, 30, 50]\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        @size-change=\"getList\"\r\n        @current-change=\"getList\"\r\n        class=\"mt-4 justify-end\"\r\n      />\r\n     </el-card>\r\n\r\n     <!-- 查看内容对话框 -->\r\n     <el-dialog title=\"查看详情\" v-model=\"contentDialogVisible\" width=\"700px\" append-to-body>\r\n       <div style=\"white-space: pre-wrap; word-break: break-all; max-height: 60vh; overflow-y: auto;\">\r\n         {{ contentToShow }}\r\n       </div>\r\n        <template #footer>\r\n         <el-button @click=\"contentDialogVisible = false\">关 闭</el-button>\r\n       </template>\r\n     </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue';\r\n\r\n// --- 数据定义 ---\r\nconst loading = ref(true);\r\nconst logList = ref([]);\r\nconst total = ref(0);\r\nconst queryFormRef = ref(null);\r\nconst accountOptions = ref([]); // 发送账号选项\r\nconst contentDialogVisible = ref(false);\r\nconst contentToShow = ref('');\r\n\r\nconst queryParams = reactive({\r\n  pageNo: 1,\r\n  pageSize: 10,\r\n  toMail: undefined,\r\n  accountId: undefined,\r\n  templateCode: undefined,\r\n  sendStatus: undefined,\r\n  sendTimeRange: [], // Renamed from sendTime\r\n});\r\n\r\n// --- 方法定义 ---\r\n\r\n// 获取账号选项 (模拟)\r\nconst getAccountOptions = () => {\r\n  // In real app, fetch from emailAccountApi.getList()\r\n  accountOptions.value = [\r\n    { value: 1, label: 'sender1@example.com' },\r\n    { value: 2, label: 'sender2@example.com' },\r\n    { value: 3, label: 'no-ssl@example.com' },\r\n    { value: 4, label: 'another@domain.net' },\r\n  ];\r\n};\r\n\r\n// 获取日志列表 (模拟)\r\nconst getList = () => {\r\n  loading.value = true;\r\n  // Process date range before sending query\r\n  const params = { ...queryParams };\r\n  if (params.sendTimeRange && params.sendTimeRange.length === 2) {\r\n    params.beginSendTime = params.sendTimeRange[0];\r\n    params.endSendTime = params.sendTimeRange[1];\r\n  }\r\n  delete params.sendTimeRange;\r\n\r\n  console.log('Fetching log list with params:', params);\r\n  // --- 模拟 API 调用 ---\r\n  setTimeout(() => {\r\n    const mockData = [\r\n      { id: 1001, userId: 1, userType: 1, toMail: 'user1@test.com', accountId: 1, fromMail: 'sender1@example.com', templateId: 101, templateCode: 'ORDER_CONFIRM', templateTitle: '您的订单 {orderNo} 已确认', templateContent: '尊敬的 {customerName}，您的订单 {orderNo} 已确认，感谢您的购买！', templateParams: '{\"customerName\": \"测试用户A\", \"orderNo\": \"ORD1001\"}', sendStatus: 0, sendTime: new Date(Date.now() - 3600000), messageId: 'msg-111', exceptionMessage: null },\r\n      { id: 1002, userId: 2, userType: 1, toMail: 'user2@test.com', accountId: 2, fromMail: 'sender2@example.com', templateId: 102, templateCode: 'PASSWORD_RESET', templateTitle: '密码重置请求', templateContent: '请点击以下链接重置您的密码：{resetLink}', templateParams: '{\"resetLink\": \"http://example.com/reset?token=abc\"}', sendStatus: 0, sendTime: new Date(Date.now() - 7200000), messageId: 'msg-222', exceptionMessage: null },\r\n      { id: 1003, userId: 3, userType: 2, toMail: 'admin@test.com', accountId: 1, fromMail: 'sender1@example.com', templateId: 103, templateCode: 'PROMOTION_NEWS', templateTitle: '最新优惠活动！', templateContent: '亲爱的用户，我们有新的优惠活动，详情请见：{promoLink}', templateParams: '{\"promoLink\": \"http://example.com/promo\"}', sendStatus: 1, sendTime: new Date(Date.now() - 10800000), messageId: 'msg-333', exceptionMessage: 'ConnectException: Connection refused' },\r\n      { id: 1004, userId: 1, userType: 1, toMail: 'user1_again@test.com', accountId: 4, fromMail: 'another@domain.net', templateId: 101, templateCode: 'ORDER_CONFIRM', templateTitle: '您的订单 {orderNo} 已确认', templateContent: '尊敬的 {customerName}，您的订单 {orderNo} 已确认，感谢您的购买！', templateParams: '{\"customerName\": \"测试用户B\", \"orderNo\": \"ORD1004\"}', sendStatus: 0, sendTime: new Date(Date.now() - 14400000), messageId: 'msg-444', exceptionMessage: null },\r\n    ];\r\n\r\n     // Simulate filtering based on queryParams (basic example)\r\n    let filteredData = mockData.filter(item => {\r\n      let match = true;\r\n      if (params.toMail && !item.toMail.includes(params.toMail)) match = false;\r\n      if (params.accountId && item.accountId !== params.accountId) match = false;\r\n      if (params.templateCode && !item.templateCode.includes(params.templateCode)) match = false;\r\n      if (params.sendStatus !== undefined && item.sendStatus !== params.sendStatus) match = false;\r\n       if (params.beginSendTime && new Date(item.sendTime) < new Date(params.beginSendTime)) match = false;\r\n       if (params.endSendTime && new Date(item.sendTime) > new Date(params.endSendTime)) match = false;\r\n      return match;\r\n    });\r\n\r\n    const start = (params.pageNo - 1) * params.pageSize;\r\n    const end = start + params.pageSize;\r\n    logList.value = filteredData.slice(start, end);\r\n    total.value = filteredData.length;\r\n    loading.value = false;\r\n  }, 500);\r\n  // --- 模拟结束 ---\r\n  // Actual API call:\r\n  // emailLogApi.getPage(params).then(res => { ... });\r\n};\r\n\r\n// 处理搜索\r\nconst handleQuery = () => {\r\n  queryParams.pageNo = 1;\r\n  getList();\r\n};\r\n\r\n// 重置搜索\r\nconst resetQuery = () => {\r\n  queryFormRef.value?.resetFields();\r\n  handleQuery();\r\n};\r\n\r\n// 打开内容查看弹窗\r\nconst openContentDialog = (content) => {\r\n  contentToShow.value = content;\r\n  contentDialogVisible.value = true;\r\n};\r\n\r\n// --- 生命周期钩子 ---\r\nonMounted(() => {\r\n  getList();\r\n  getAccountOptions();\r\n});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n/* Reusing styles */\r\n.app-container {\r\n  padding: 20px;\r\n}\r\n.flex {\r\n  display: flex;\r\n}\r\n.justify-between {\r\n  justify-content: space-between;\r\n}\r\n.justify-end {\r\n  justify-content: flex-end;\r\n}\r\n.mb-4 {\r\n  margin-bottom: 16px;\r\n}\r\n.mt-4 {\r\n  margin-top: 16px;\r\n}\r\n.el-table .cell .el-button {\r\n  margin-left: 5px;\r\n}\r\n.el-table .cell .el-button + .el-button {\r\n  margin-left: 5px;\r\n}\r\n</style> ","import script from \"./EmailLog.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./EmailLog.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./EmailLog.vue?vue&type=style&index=0&id=f28122ce&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f28122ce\"]])\n\nexport default __exports__"],"names":["loading","ref","logList","total","queryFormRef","accountOptions","contentDialogVisible","contentToShow","queryParams","reactive","pageNo","pageSize","toMail","undefined","accountId","templateCode","sendStatus","sendTimeRange","getAccountOptions","value","label","getList","params","length","beginSendTime","endSendTime","console","log","setTimeout","mockData","id","userId","userType","fromMail","templateId","templateTitle","templateContent","templateParams","sendTime","Date","now","messageId","exceptionMessage","filteredData","filter","item","match","includes","start","end","slice","handleQuery","resetQuery","resetFields","openContentDialog","content","onMounted","__exports__"],"sourceRoot":""}