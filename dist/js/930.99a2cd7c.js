"use strict";(self["webpackChunkvue_logistics_system"]=self["webpackChunkvue_logistics_system"]||[]).push([[930],{1930:(e,l,a)=>{a.r(l),a.d(l,{default:()=>g});var t=a(641),r=a(33),u=a(953),p=a(163),s=a(7918);const o={class:"alert-list-container"},n={__name:"AlertList",setup(e){const l=(0,u.KR)([{id:"supplier_1",name:"测试供应商A - 专做提框服务"},{id:"supplier_2",name:"测试供应商B - FBA派送专家"},{id:"supplier_3",name:"测试供应商C - 全能型选手"}]),a=(0,u.KR)([{id:"vehicle_1",plateNumber:"CA12345",supplierId:"supplier_1",supplierName:"测试供应商A - 专做提框服务"},{id:"vehicle_2",plateNumber:"NY98765",supplierId:"supplier_2",supplierName:"测试供应商B - FBA派送专家"},{id:"vehicle_3",plateNumber:"TX54321",supplierId:"supplier_3",supplierName:"测试供应商C - 全能型选手"},{id:"vehicle_4",plateNumber:"FL11223",supplierId:"supplier_1",supplierName:"测试供应商A - 专做提框服务"},{id:"vehicle_5",plateNumber:"AZ55667",supplierId:"supplier_2",supplierName:"测试供应商B - FBA派送专家"}]),n=(0,u.KR)([]),i=(e=100)=>{const l=["speeding","route_deviation","geo_fencing","prolonged_stop","fatigue_driving","gps_signal_lost"],t=["pending","processing","resolved"],r=[],u=Date.now();for(let p=0;p<e;p++){const e=a.value[Math.floor(Math.random()*a.value.length)],s=l[Math.floor(Math.random()*l.length)];let o="";switch(s){case"speeding":o=`速度达到 ${Math.floor(40*Math.random())+80} km/h (阈值 80 km/h)`;break;case"route_deviation":o="偏离预定路线 1.5 km";break;case"geo_fencing":o=`进入未授权区域 (ID: Zone_${Math.floor(5*Math.random())})`;break;case"prolonged_stop":o=`在非预定点停留 ${Math.floor(50*Math.random())+10} 分钟`;break;case"fatigue_driving":o="连续驾驶超过 4 小时";break;case"gps_signal_lost":o="GPS 信号丢失超过 5 分钟";break;default:o="未知详情"}r.push({id:"alert_"+(u-p),timestamp:new Date(u-Math.floor(7*Math.random()*24*60*60*1e3)).toLocaleString("sv-SE"),vehicleId:e.id,plateNumber:e.plateNumber,supplierId:e.supplierId,supplierName:e.supplierName,alertType:s,details:o,processStatus:t[Math.floor(Math.random()*t.length)]})}return r},d=[{value:"speeding",label:"超速报警",tag:"danger"},{value:"route_deviation",label:"偏离路线报警",tag:"warning"},{value:"geo_fencing",label:"电子围栏报警",tag:"warning"},{value:"prolonged_stop",label:"超时停留报警",tag:"warning"},{value:"fatigue_driving",label:"疲劳驾驶预警",tag:"danger"},{value:"gps_signal_lost",label:"GPS信号丢失报警",tag:"info"}],g={pending:{label:"待处理",tag:"danger"},processing:{label:"处理中",tag:"warning"},resolved:{label:"已解决",tag:"success"}},c=(0,u.Kh)({supplierId:"",plateNumber:"",alertType:"",processStatus:"",dateRange:[]}),b=(0,u.Kh)({currentPage:1,pageSize:10}),m=(0,t.EW)((()=>v.value.length)),v=(0,t.EW)((()=>n.value.filter((e=>{const l=!c.supplierId||e.supplierId===c.supplierId,a=!c.plateNumber||e.plateNumber.includes(c.plateNumber),t=!c.alertType||e.alertType===c.alertType,r=!c.processStatus||e.processStatus===c.processStatus,u=!c.dateRange||2!==c.dateRange.length||new Date(e.timestamp)>=new Date(c.dateRange[0])&&new Date(e.timestamp)<=new Date(c.dateRange[1]);return l&&a&&t&&r&&u})))),_=(0,t.EW)((()=>{const e=(b.currentPage-1)*b.pageSize,l=e+b.pageSize;return v.value.slice(e,l)})),k=(0,u.KR)(!1),f=(0,u.KR)(null),h=e=>d.find((l=>l.value===e))?.label||e,F=e=>d.find((l=>l.value===e))?.tag||"info",w=e=>g[e]?.label||e,y=e=>g[e]?.tag||"info",N=()=>{b.currentPage=1},S=e=>{b.pageSize=e,b.currentPage=1},C=e=>{b.currentPage=e},I=e=>{f.value=e,k.value=!0},V=(e,l)=>{const a=n.value.findIndex((l=>l.id===e.id));-1!==a?(n.value[a].processStatus=l,p.nk.success(`已将 ${e.plateNumber} 的预警标记为 ${w(l)}`),f.value&&f.value.id===e.id&&(f.value.processStatus=l)):p.nk.error("更新状态失败")},W=e=>{s.s.confirm(`确定将 ${e.plateNumber} 的 ${h(e.alertType)} 预警标记为已解决吗?`,"确认",{type:"success"}).then((()=>{V(e,"resolved")})).catch((()=>{}))},L=e=>{V(e,"processing")};return(0,t.sV)((()=>{n.value=i()})),(e,a)=>{const u=(0,t.g2)("el-option"),p=(0,t.g2)("el-select"),s=(0,t.g2)("el-form-item"),n=(0,t.g2)("el-input"),i=(0,t.g2)("el-date-picker"),g=(0,t.g2)("el-button"),v=(0,t.g2)("el-form"),V=(0,t.g2)("el-table-column"),M=(0,t.g2)("el-tag"),z=(0,t.g2)("el-table"),T=(0,t.g2)("el-pagination"),R=(0,t.g2)("el-dialog"),A=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.bF)(A,null,{header:(0,t.k6)((()=>a[7]||(a[7]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"异常预警列表")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(v,{inline:!0,model:c,class:"filter-form"},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"供应商"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:c.supplierId,"onUpdate:modelValue":a[0]||(a[0]=e=>c.supplierId=e),placeholder:"选择供应商",clearable:"",filterable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(l.value,(e=>((0,t.uX)(),(0,t.Wv)(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"车牌号"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{modelValue:c.plateNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>c.plateNumber=e),placeholder:"输入车牌号",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"预警类型"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:c.alertType,"onUpdate:modelValue":a[2]||(a[2]=e=>c.alertType=e),placeholder:"选择预警类型",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(d,(e=>(0,t.bF)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"处理状态"},{default:(0,t.k6)((()=>[(0,t.bF)(p,{modelValue:c.processStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>c.processStatus=e),placeholder:"选择处理状态",clearable:""},{default:(0,t.k6)((()=>[(0,t.bF)(u,{label:"待处理",value:"pending"}),(0,t.bF)(u,{label:"处理中",value:"processing"}),(0,t.bF)(u,{label:"已解决",value:"resolved"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"时间范围"},{default:(0,t.k6)((()=>[(0,t.bF)(i,{modelValue:c.dateRange,"onUpdate:modelValue":a[4]||(a[4]=e=>c.dateRange=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,null,{default:(0,t.k6)((()=>[(0,t.bF)(g,{type:"primary",onClick:N},{default:(0,t.k6)((()=>a[8]||(a[8]=[(0,t.eW)("查询")]))),_:1})])),_:1})])),_:1},8,["model"]),(0,t.bF)(z,{data:_.value,style:{width:"100%"},border:""},{default:(0,t.k6)((()=>[(0,t.bF)(V,{prop:"timestamp",label:"预警时间",width:"180",sortable:""}),(0,t.bF)(V,{prop:"plateNumber",label:"车牌号",width:"120"}),(0,t.bF)(V,{prop:"supplierName",label:"所属供应商",width:"200","show-overflow-tooltip":""}),(0,t.bF)(V,{prop:"alertType",label:"预警类型",width:"150"},{default:(0,t.k6)((e=>[(0,t.bF)(M,{type:F(e.row.alertType),effect:"plain"},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(h(e.row.alertType)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(V,{prop:"details",label:"预警详情","show-overflow-tooltip":""}),(0,t.bF)(V,{prop:"processStatus",label:"处理状态",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(M,{type:y(e.row.processStatus)},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(w(e.row.processStatus)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(V,{label:"操作",fixed:"right",width:"200"},{default:(0,t.k6)((e=>[(0,t.bF)(g,{text:"",type:"primary",size:"small",onClick:l=>I(e.row)},{default:(0,t.k6)((()=>a[9]||(a[9]=[(0,t.eW)("查看详情")]))),_:2},1032,["onClick"]),"resolved"!==e.row.processStatus?((0,t.uX)(),(0,t.Wv)(g,{key:0,text:"",type:"success",size:"small",onClick:l=>W(e.row)},{default:(0,t.k6)((()=>a[10]||(a[10]=[(0,t.eW)("标记解决")]))),_:2},1032,["onClick"])):(0,t.Q3)("",!0),"pending"===e.row.processStatus?((0,t.uX)(),(0,t.Wv)(g,{key:1,text:"",type:"warning",size:"small",onClick:l=>L(e.row)},{default:(0,t.k6)((()=>a[11]||(a[11]=[(0,t.eW)("标记处理中")]))),_:2},1032,["onClick"])):(0,t.Q3)("",!0)])),_:1})])),_:1},8,["data"]),(0,t.bF)(T,{style:{"margin-top":"20px","justify-content":"flex-end"},background:"",layout:"total, sizes, prev, pager, next, jumper",total:m.value,"page-sizes":[10,20,50,100],"page-size":b.pageSize,"current-page":b.currentPage,onSizeChange:S,onCurrentChange:C},null,8,["total","page-size","current-page"]),(0,t.bF)(R,{modelValue:k.value,"onUpdate:modelValue":a[6]||(a[6]=e=>k.value=e),title:"预警详情",width:"60%"},{footer:(0,t.k6)((()=>[(0,t.bF)(g,{onClick:a[5]||(a[5]=e=>k.value=!1)},{default:(0,t.k6)((()=>a[19]||(a[19]=[(0,t.eW)("关闭")]))),_:1})])),default:(0,t.k6)((()=>[(0,t.Lk)("p",null,[a[12]||(a[12]=(0,t.Lk)("strong",null,"时间:",-1)),(0,t.eW)(" "+(0,r.v_)(f.value?.timestamp),1)]),(0,t.Lk)("p",null,[a[13]||(a[13]=(0,t.Lk)("strong",null,"车辆:",-1)),(0,t.eW)(" "+(0,r.v_)(f.value?.plateNumber)+" ("+(0,r.v_)(f.value?.supplierName)+")",1)]),(0,t.Lk)("p",null,[a[14]||(a[14]=(0,t.Lk)("strong",null,"类型:",-1)),(0,t.eW)(" "+(0,r.v_)(h(f.value?.alertType)),1)]),(0,t.Lk)("p",null,[a[15]||(a[15]=(0,t.Lk)("strong",null,"详情:",-1)),(0,t.eW)(" "+(0,r.v_)(f.value?.details),1)]),(0,t.Lk)("p",null,[a[16]||(a[16]=(0,t.Lk)("strong",null,"处理状态:",-1)),(0,t.eW)(" "+(0,r.v_)(w(f.value?.processStatus)),1)]),(0,t.Lk)("p",null,[a[17]||(a[17]=(0,t.Lk)("strong",null,"处理备注 (待实现):",-1)),a[18]||(a[18]=(0,t.eW)()),(0,t.bF)(n,{type:"textarea",disabled:""})])])),_:1},8,["modelValue"])])),_:1})])}}};var i=a(6262);const d=(0,i.A)(n,[["__scopeId","data-v-98d1a196"]]),g=d}}]);
//# sourceMappingURL=930.99a2cd7c.js.map